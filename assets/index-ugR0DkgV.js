function _mergeNamespaces(n,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in n)){const o=Object.getOwnPropertyDescriptor(s,i);o&&Object.defineProperty(n,i,o.get?o:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();function makeMap(n,t){const r=Object.create(null),s=n.split(",");for(let i=0;i<s.length;i++)r[s[i]]=!0;return t?i=>!!r[i.toLowerCase()]:i=>!!r[i]}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),isModelListener=n=>n.startsWith("onUpdate:"),extend=Object.assign,remove=(n,t)=>{const r=n.indexOf(t);r>-1&&n.splice(r,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(n,t)=>hasOwnProperty$1.call(n,t),isArray=Array.isArray,isMap=n=>toTypeString(n)==="[object Map]",isSet=n=>toTypeString(n)==="[object Set]",isFunction$1=n=>typeof n=="function",isString$1=n=>typeof n=="string",isSymbol=n=>typeof n=="symbol",isObject$1=n=>n!==null&&typeof n=="object",isPromise$1=n=>(isObject$1(n)||isFunction$1(n))&&isFunction$1(n.then)&&isFunction$1(n.catch),objectToString=Object.prototype.toString,toTypeString=n=>objectToString.call(n),toRawType=n=>toTypeString(n).slice(8,-1),isPlainObject$1=n=>toTypeString(n)==="[object Object]",isIntegerKey=n=>isString$1(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=n=>{const t=Object.create(null);return r=>t[r]||(t[r]=n(r))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(n=>n.replace(camelizeRE,(t,r)=>r?r.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(n=>n.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(n=>n.charAt(0).toUpperCase()+n.slice(1)),toHandlerKey=cacheStringFunction(n=>n?`on${capitalize(n)}`:""),hasChanged=(n,t)=>!Object.is(n,t),invokeArrayFns=(n,t)=>{for(let r=0;r<n.length;r++)n[r](t)},def=(n,t,r)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value:r})},looseToNumber=n=>{const t=parseFloat(n);return isNaN(t)?n:t},toNumber=n=>{const t=isString$1(n)?Number(n):NaN;return isNaN(t)?n:t};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(n){if(isArray(n)){const t={};for(let r=0;r<n.length;r++){const s=n[r],i=isString$1(s)?parseStringStyle(s):normalizeStyle(s);if(i)for(const o in i)t[o]=i[o]}return t}else if(isString$1(n)||isObject$1(n))return n}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(n){const t={};return n.replace(styleCommentRE,"").split(listDelimiterRE).forEach(r=>{if(r){const s=r.split(propertyDelimiterRE);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function normalizeClass(n){let t="";if(isString$1(n))t=n;else if(isArray(n))for(let r=0;r<n.length;r++){const s=normalizeClass(n[r]);s&&(t+=s+" ")}else if(isObject$1(n))for(const r in n)n[r]&&(t+=r+" ");return t.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(n){return!!n||n===""}const toDisplayString=n=>isString$1(n)?n:n==null?"":isArray(n)||isObject$1(n)&&(n.toString===objectToString||!isFunction$1(n.toString))?JSON.stringify(n,replacer,2):String(n),replacer=(n,t)=>t&&t.__v_isRef?replacer(n,t.value):isMap(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[s,i],o)=>(r[stringifySymbol(s,o)+" =>"]=i,r),{})}:isSet(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>stringifySymbol(r))}:isSymbol(t)?stringifySymbol(t):isObject$1(t)&&!isArray(t)&&!isPlainObject$1(t)?String(t):t,stringifySymbol=(n,t="")=>{var r;return isSymbol(n)?`Symbol(${(r=n.description)!=null?r:t})`:n};let activeEffectScope;class EffectScope{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!t&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const r=activeEffectScope;try{return activeEffectScope=this,t()}finally{activeEffectScope=r}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(t){if(this._active){let r,s;for(r=0,s=this.effects.length;r<s;r++)this.effects[r].stop();for(r=0,s=this.cleanups.length;r<s;r++)this.cleanups[r]();if(this.scopes)for(r=0,s=this.scopes.length;r<s;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(n){return new EffectScope(n)}function recordEffectScope(n,t=activeEffectScope){t&&t.active&&t.effects.push(n)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(n){activeEffectScope&&activeEffectScope.cleanups.push(n)}const createDep=n=>{const t=new Set(n);return t.w=0,t.n=0,t},wasTracked=n=>(n.w&trackOpBit)>0,newTracked=n=>(n.n&trackOpBit)>0,initDepMarkers=({deps:n})=>{if(n.length)for(let t=0;t<n.length;t++)n[t].w|=trackOpBit},finalizeDepMarkers=n=>{const{deps:t}=n;if(t.length){let r=0;for(let s=0;s<t.length;s++){const i=t[s];wasTracked(i)&&!newTracked(i)?i.delete(n):t[r++]=i,i.w&=~trackOpBit,i.n&=~trackOpBit}t.length=r}},targetMap=new WeakMap;let effectTrackDepth=0,trackOpBit=1;const maxMarkerBits=30;let activeEffect;const ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");class ReactiveEffect{constructor(t,r=null,s){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,recordEffectScope(this,s)}run(){if(!this.active)return this.fn();let t=activeEffect,r=shouldTrack;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=activeEffect,activeEffect=this,shouldTrack=!0,trackOpBit=1<<++effectTrackDepth,effectTrackDepth<=maxMarkerBits?initDepMarkers(this):cleanupEffect(this),this.fn()}finally{effectTrackDepth<=maxMarkerBits&&finalizeDepMarkers(this),trackOpBit=1<<--effectTrackDepth,activeEffect=this.parent,shouldTrack=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){activeEffect===this?this.deferStop=!0:this.active&&(cleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function cleanupEffect(n){const{deps:t}=n;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(n);t.length=0}}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const n=trackStack.pop();shouldTrack=n===void 0?!0:n}function track(n,t,r){if(shouldTrack&&activeEffect){let s=targetMap.get(n);s||targetMap.set(n,s=new Map);let i=s.get(r);i||s.set(r,i=createDep()),trackEffects(i)}}function trackEffects(n,t){let r=!1;effectTrackDepth<=maxMarkerBits?newTracked(n)||(n.n|=trackOpBit,r=!wasTracked(n)):r=!n.has(activeEffect),r&&(n.add(activeEffect),activeEffect.deps.push(n))}function trigger(n,t,r,s,i,o){const l=targetMap.get(n);if(!l)return;let f=[];if(t==="clear")f=[...l.values()];else if(r==="length"&&isArray(n)){const u=Number(s);l.forEach((g,y)=>{(y==="length"||!isSymbol(y)&&y>=u)&&f.push(g)})}else switch(r!==void 0&&f.push(l.get(r)),t){case"add":isArray(n)?isIntegerKey(r)&&f.push(l.get("length")):(f.push(l.get(ITERATE_KEY)),isMap(n)&&f.push(l.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray(n)||(f.push(l.get(ITERATE_KEY)),isMap(n)&&f.push(l.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(n)&&f.push(l.get(ITERATE_KEY));break}if(f.length===1)f[0]&&triggerEffects(f[0]);else{const u=[];for(const g of f)g&&u.push(...g);triggerEffects(createDep(u))}}function triggerEffects(n,t){const r=isArray(n)?n:[...n];for(const s of r)s.computed&&triggerEffect(s);for(const s of r)s.computed||triggerEffect(s)}function triggerEffect(n,t){(n!==activeEffect||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}function getDepFromReactive(n,t){var r;return(r=targetMap.get(n))==null?void 0:r.get(t)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(isSymbol)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const n={};return["includes","indexOf","lastIndexOf"].forEach(t=>{n[t]=function(...r){const s=toRaw(this);for(let o=0,l=this.length;o<l;o++)track(s,"get",o+"");const i=s[t](...r);return i===-1||i===!1?s[t](...r.map(toRaw)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{n[t]=function(...r){pauseTracking();const s=toRaw(this)[t].apply(this,r);return resetTracking(),s}}),n}function hasOwnProperty(n){const t=toRaw(this);return track(t,"has",n),t.hasOwnProperty(n)}class BaseReactiveHandler{constructor(t=!1,r=!1){this._isReadonly=t,this._shallow=r}get(t,r,s){const i=this._isReadonly,o=this._shallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return o;if(r==="__v_raw")return s===(i?o?shallowReadonlyMap:readonlyMap:o?shallowReactiveMap:reactiveMap).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const l=isArray(t);if(!i){if(l&&hasOwn(arrayInstrumentations,r))return Reflect.get(arrayInstrumentations,r,s);if(r==="hasOwnProperty")return hasOwnProperty}const f=Reflect.get(t,r,s);return(isSymbol(r)?builtInSymbols.has(r):isNonTrackableKeys(r))||(i||track(t,"get",r),o)?f:isRef(f)?l&&isIntegerKey(r)?f:f.value:isObject$1(f)?i?readonly(f):reactive(f):f}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(t=!1){super(!1,t)}set(t,r,s,i){let o=t[r];if(isReadonly(o)&&isRef(o)&&!isRef(s))return!1;if(!this._shallow&&(!isShallow(s)&&!isReadonly(s)&&(o=toRaw(o),s=toRaw(s)),!isArray(t)&&isRef(o)&&!isRef(s)))return o.value=s,!0;const l=isArray(t)&&isIntegerKey(r)?Number(r)<t.length:hasOwn(t,r),f=Reflect.set(t,r,s,i);return t===toRaw(i)&&(l?hasChanged(s,o)&&trigger(t,"set",r,s):trigger(t,"add",r,s)),f}deleteProperty(t,r){const s=hasOwn(t,r);t[r];const i=Reflect.deleteProperty(t,r);return i&&s&&trigger(t,"delete",r,void 0),i}has(t,r){const s=Reflect.has(t,r);return(!isSymbol(r)||!builtInSymbols.has(r))&&track(t,"has",r),s}ownKeys(t){return track(t,"iterate",isArray(t)?"length":ITERATE_KEY),Reflect.ownKeys(t)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=n=>n,getProto=n=>Reflect.getPrototypeOf(n);function get$1(n,t,r=!1,s=!1){n=n.__v_raw;const i=toRaw(n),o=toRaw(t);r||(hasChanged(t,o)&&track(i,"get",t),track(i,"get",o));const{has:l}=getProto(i),f=s?toShallow:r?toReadonly:toReactive;if(l.call(i,t))return f(n.get(t));if(l.call(i,o))return f(n.get(o));n!==i&&n.get(t)}function has(n,t=!1){const r=this.__v_raw,s=toRaw(r),i=toRaw(n);return t||(hasChanged(n,i)&&track(s,"has",n),track(s,"has",i)),n===i?r.has(n):r.has(n)||r.has(i)}function size(n,t=!1){return n=n.__v_raw,!t&&track(toRaw(n),"iterate",ITERATE_KEY),Reflect.get(n,"size",n)}function add$3(n){n=toRaw(n);const t=toRaw(this);return getProto(t).has.call(t,n)||(t.add(n),trigger(t,"add",n,n)),this}function set$1(n,t){t=toRaw(t);const r=toRaw(this),{has:s,get:i}=getProto(r);let o=s.call(r,n);o||(n=toRaw(n),o=s.call(r,n));const l=i.call(r,n);return r.set(n,t),o?hasChanged(t,l)&&trigger(r,"set",n,t):trigger(r,"add",n,t),this}function deleteEntry(n){const t=toRaw(this),{has:r,get:s}=getProto(t);let i=r.call(t,n);i||(n=toRaw(n),i=r.call(t,n)),s&&s.call(t,n);const o=t.delete(n);return i&&trigger(t,"delete",n,void 0),o}function clear(){const n=toRaw(this),t=n.size!==0,r=n.clear();return t&&trigger(n,"clear",void 0,void 0),r}function createForEach(n,t){return function(s,i){const o=this,l=o.__v_raw,f=toRaw(l),u=t?toShallow:n?toReadonly:toReactive;return!n&&track(f,"iterate",ITERATE_KEY),l.forEach((g,y)=>s.call(i,u(g),u(y),o))}}function createIterableMethod(n,t,r){return function(...s){const i=this.__v_raw,o=toRaw(i),l=isMap(o),f=n==="entries"||n===Symbol.iterator&&l,u=n==="keys"&&l,g=i[n](...s),y=r?toShallow:t?toReadonly:toReactive;return!t&&track(o,"iterate",u?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:a,done:m}=g.next();return m?{value:a,done:m}:{value:f?[y(a[0]),y(a[1])]:y(a),done:m}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function createInstrumentations(){const n={get(o){return get$1(this,o)},get size(){return size(this)},has,add:add$3,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},t={get(o){return get$1(this,o,!1,!0)},get size(){return size(this)},has,add:add$3,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},r={get(o){return get$1(this,o,!0)},get size(){return size(this,!0)},has(o){return has.call(this,o,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},s={get(o){return get$1(this,o,!0,!0)},get size(){return size(this,!0)},has(o){return has.call(this,o,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=createIterableMethod(o,!1,!1),r[o]=createIterableMethod(o,!0,!1),t[o]=createIterableMethod(o,!1,!0),s[o]=createIterableMethod(o,!0,!0)}),[n,r,t,s]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(n,t){const r=t?n?shallowReadonlyInstrumentations:shallowInstrumentations:n?readonlyInstrumentations:mutableInstrumentations;return(s,i,o)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?s:Reflect.get(hasOwn(r,i)&&i in s?r:s,i,o)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(n){return n.__v_skip||!Object.isExtensible(n)?0:targetTypeMap(toRawType(n))}function reactive(n){return isReadonly(n)?n:createReactiveObject(n,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(n){return createReactiveObject(n,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(n){return createReactiveObject(n,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(n,t,r,s,i){if(!isObject$1(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const o=i.get(n);if(o)return o;const l=getTargetType(n);if(l===0)return n;const f=new Proxy(n,l===2?s:r);return i.set(n,f),f}function isReactive(n){return isReadonly(n)?isReactive(n.__v_raw):!!(n&&n.__v_isReactive)}function isReadonly(n){return!!(n&&n.__v_isReadonly)}function isShallow(n){return!!(n&&n.__v_isShallow)}function isProxy(n){return isReactive(n)||isReadonly(n)}function toRaw(n){const t=n&&n.__v_raw;return t?toRaw(t):n}function markRaw(n){return def(n,"__v_skip",!0),n}const toReactive=n=>isObject$1(n)?reactive(n):n,toReadonly=n=>isObject$1(n)?readonly(n):n;function trackRefValue(n){shouldTrack&&activeEffect&&(n=toRaw(n),trackEffects(n.dep||(n.dep=createDep())))}function triggerRefValue(n,t){n=toRaw(n);const r=n.dep;r&&triggerEffects(r)}function isRef(n){return!!(n&&n.__v_isRef===!0)}function ref(n){return createRef(n,!1)}function createRef(n,t){return isRef(n)?n:new RefImpl(n,t)}class RefImpl{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:toRaw(t),this._value=r?t:toReactive(t)}get value(){return trackRefValue(this),this._value}set value(t){const r=this.__v_isShallow||isShallow(t)||isReadonly(t);t=r?t:toRaw(t),hasChanged(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:toReactive(t),triggerRefValue(this))}}function unref(n){return isRef(n)?n.value:n}const shallowUnwrapHandlers={get:(n,t,r)=>unref(Reflect.get(n,t,r)),set:(n,t,r,s)=>{const i=n[t];return isRef(i)&&!isRef(r)?(i.value=r,!0):Reflect.set(n,t,r,s)}};function proxyRefs(n){return isReactive(n)?n:new Proxy(n,shallowUnwrapHandlers)}function toRefs(n){const t=isArray(n)?new Array(n.length):{};for(const r in n)t[r]=propertyToRef(n,r);return t}class ObjectRefImpl{constructor(t,r,s){this._object=t,this._key=r,this._defaultValue=s,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}function propertyToRef(n,t,r){const s=n[t];return isRef(s)?s:new ObjectRefImpl(n,t,r)}class ComputedRefImpl{constructor(t,r,s,i){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new ReactiveEffect(t,()=>{this._dirty||(this._dirty=!0,triggerRefValue(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=s}get value(){const t=toRaw(this);return trackRefValue(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function computed$1(n,t,r=!1){let s,i;const o=isFunction$1(n);return o?(s=n,i=NOOP):(s=n.get,i=n.set),new ComputedRefImpl(s,i,o||!i,r)}function warn$1(n,...t){}function callWithErrorHandling(n,t,r,s){let i;try{i=s?n(...s):n()}catch(o){handleError(o,t,r)}return i}function callWithAsyncErrorHandling(n,t,r,s){if(isFunction$1(n)){const o=callWithErrorHandling(n,t,r,s);return o&&isPromise$1(o)&&o.catch(l=>{handleError(l,t,r)}),o}const i=[];for(let o=0;o<n.length;o++)i.push(callWithAsyncErrorHandling(n[o],t,r,s));return i}function handleError(n,t,r,s=!0){const i=t?t.vnode:null;if(t){let o=t.parent;const l=t.proxy,f=r;for(;o;){const g=o.ec;if(g){for(let y=0;y<g.length;y++)if(g[y](n,l,f)===!1)return}o=o.parent}const u=t.appContext.config.errorHandler;if(u){callWithErrorHandling(u,null,10,[n,l,f]);return}}logError(n,r,i,s)}function logError(n,t,r,s=!0){console.error(n)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(n){const t=currentFlushPromise||resolvedPromise;return n?t.then(this?n.bind(this):n):t}function findInsertionIndex(n){let t=flushIndex+1,r=queue.length;for(;t<r;){const s=t+r>>>1,i=queue[s],o=getId(i);o<n||o===n&&i.pre?t=s+1:r=s}return t}function queueJob(n){(!queue.length||!queue.includes(n,isFlushing&&n.allowRecurse?flushIndex+1:flushIndex))&&(n.id==null?queue.push(n):queue.splice(findInsertionIndex(n.id),0,n),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(n){const t=queue.indexOf(n);t>flushIndex&&queue.splice(t,1)}function queuePostFlushCb(n){isArray(n)?pendingPostFlushCbs.push(...n):(!activePostFlushCbs||!activePostFlushCbs.includes(n,n.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(n),queueFlush()}function flushPreFlushCbs(n,t,r=isFlushing?flushIndex+1:0){for(;r<queue.length;r++){const s=queue[r];if(s&&s.pre){if(n&&s.id!==n.uid)continue;queue.splice(r,1),r--,s()}}}function flushPostFlushCbs(n){if(pendingPostFlushCbs.length){const t=[...new Set(pendingPostFlushCbs)];if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...t);return}for(activePostFlushCbs=t,activePostFlushCbs.sort((r,s)=>getId(r)-getId(s)),postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=n=>n.id==null?1/0:n.id,comparator=(n,t)=>{const r=getId(n)-getId(t);if(r===0){if(n.pre&&!t.pre)return-1;if(t.pre&&!n.pre)return 1}return r};function flushJobs(n){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const t=queue[flushIndex];t&&t.active!==!1&&callWithErrorHandling(t,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(n,t,...r){if(n.isUnmounted)return;const s=n.vnode.props||EMPTY_OBJ;let i=r;const o=t.startsWith("update:"),l=o&&t.slice(7);if(l&&l in s){const y=`${l==="modelValue"?"model":l}Modifiers`,{number:a,trim:m}=s[y]||EMPTY_OBJ;m&&(i=r.map(_=>isString$1(_)?_.trim():_)),a&&(i=r.map(looseToNumber))}let f,u=s[f=toHandlerKey(t)]||s[f=toHandlerKey(camelize(t))];!u&&o&&(u=s[f=toHandlerKey(hyphenate(t))]),u&&callWithAsyncErrorHandling(u,n,6,i);const g=s[f+"Once"];if(g){if(!n.emitted)n.emitted={};else if(n.emitted[f])return;n.emitted[f]=!0,callWithAsyncErrorHandling(g,n,6,i)}}function normalizeEmitsOptions(n,t,r=!1){const s=t.emitsCache,i=s.get(n);if(i!==void 0)return i;const o=n.emits;let l={},f=!1;if(!isFunction$1(n)){const u=g=>{const y=normalizeEmitsOptions(g,t,!0);y&&(f=!0,extend(l,y))};!r&&t.mixins.length&&t.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}return!o&&!f?(isObject$1(n)&&s.set(n,null),null):(isArray(o)?o.forEach(u=>l[u]=null):extend(l,o),isObject$1(n)&&s.set(n,l),l)}function isEmitListener(n,t){return!n||!isOn(t)?!1:(t=t.slice(2).replace(/Once$/,""),hasOwn(n,t[0].toLowerCase()+t.slice(1))||hasOwn(n,hyphenate(t))||hasOwn(n,t))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(n){const t=currentRenderingInstance;return currentRenderingInstance=n,currentScopeId=n&&n.type.__scopeId||null,t}function pushScopeId(n){currentScopeId=n}function popScopeId(){currentScopeId=null}function withCtx(n,t=currentRenderingInstance,r){if(!t||n._n)return n;const s=(...i)=>{s._d&&setBlockTracking(-1);const o=setCurrentRenderingInstance(t);let l;try{l=n(...i)}finally{setCurrentRenderingInstance(o),s._d&&setBlockTracking(1)}return l};return s._n=!0,s._c=!0,s._d=!0,s}function markAttrsAccessed(){}function renderComponentRoot(n){const{type:t,vnode:r,proxy:s,withProxy:i,props:o,propsOptions:[l],slots:f,attrs:u,emit:g,render:y,renderCache:a,data:m,setupState:_,ctx:b,inheritAttrs:c}=n;let w,S;const E=setCurrentRenderingInstance(n);try{if(r.shapeFlag&4){const A=i||s,T=A;w=normalizeVNode(y.call(T,A,a,o,_,m,b)),S=u}else{const A=t;w=normalizeVNode(A.length>1?A(o,{attrs:u,slots:f,emit:g}):A(o,null)),S=t.props?u:getFunctionalFallthrough(u)}}catch(A){blockStack.length=0,handleError(A,n,1),w=createVNode(Comment)}let I=w;if(S&&c!==!1){const A=Object.keys(S),{shapeFlag:T}=I;A.length&&T&7&&(l&&A.some(isModelListener)&&(S=filterModelListeners(S,l)),I=cloneVNode(I,S))}return r.dirs&&(I=cloneVNode(I),I.dirs=I.dirs?I.dirs.concat(r.dirs):r.dirs),r.transition&&(I.transition=r.transition),w=I,setCurrentRenderingInstance(E),w}const getFunctionalFallthrough=n=>{let t;for(const r in n)(r==="class"||r==="style"||isOn(r))&&((t||(t={}))[r]=n[r]);return t},filterModelListeners=(n,t)=>{const r={};for(const s in n)(!isModelListener(s)||!(s.slice(9)in t))&&(r[s]=n[s]);return r};function shouldUpdateComponent(n,t,r){const{props:s,children:i,component:o}=n,{props:l,children:f,patchFlag:u}=t,g=o.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return s?hasPropsChanged(s,l,g):!!l;if(u&8){const y=t.dynamicProps;for(let a=0;a<y.length;a++){const m=y[a];if(l[m]!==s[m]&&!isEmitListener(g,m))return!0}}}else return(i||f)&&(!f||!f.$stable)?!0:s===l?!1:s?l?hasPropsChanged(s,l,g):!0:!!l;return!1}function hasPropsChanged(n,t,r){const s=Object.keys(t);if(s.length!==Object.keys(n).length)return!0;for(let i=0;i<s.length;i++){const o=s[i];if(t[o]!==n[o]&&!isEmitListener(r,o))return!0}return!1}function updateHOCHostEl({vnode:n,parent:t},r){for(;t&&t.subTree===n;)(n=t.vnode).el=r,t=t.parent}const COMPONENTS="components",DIRECTIVES="directives";function resolveComponent(n,t){return resolveAsset(COMPONENTS,n,!0,t)||n}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(n){return isString$1(n)?resolveAsset(COMPONENTS,n,!1)||n:n||NULL_DYNAMIC_COMPONENT}function resolveDirective(n){return resolveAsset(DIRECTIVES,n)}function resolveAsset(n,t,r=!0,s=!1){const i=currentRenderingInstance||currentInstance;if(i){const o=i.type;if(n===COMPONENTS){const f=getComponentName(o,!1);if(f&&(f===t||f===camelize(t)||f===capitalize(camelize(t))))return o}const l=resolve(i[n]||o[n],t)||resolve(i.appContext[n],t);return!l&&s?o:l}}function resolve(n,t){return n&&(n[t]||n[camelize(t)]||n[capitalize(camelize(t))])}const isSuspense=n=>n.__isSuspense;function queueEffectWithSuspense(n,t){t&&t.pendingBranch?isArray(n)?t.effects.push(...n):t.effects.push(n):queuePostFlushCb(n)}const INITIAL_WATCHER_VALUE={};function watch(n,t,r){return doWatch(n,t,r)}function doWatch(n,t,{immediate:r,deep:s,flush:i,onTrack:o,onTrigger:l}=EMPTY_OBJ){var f;const u=getCurrentScope()===((f=currentInstance)==null?void 0:f.scope)?currentInstance:null;let g,y=!1,a=!1;if(isRef(n)?(g=()=>n.value,y=isShallow(n)):isReactive(n)?(g=()=>n,s=!0):isArray(n)?(a=!0,y=n.some(A=>isReactive(A)||isShallow(A)),g=()=>n.map(A=>{if(isRef(A))return A.value;if(isReactive(A))return traverse(A);if(isFunction$1(A))return callWithErrorHandling(A,u,2)})):isFunction$1(n)?t?g=()=>callWithErrorHandling(n,u,2):g=()=>{if(!(u&&u.isUnmounted))return m&&m(),callWithAsyncErrorHandling(n,u,3,[_])}:g=NOOP,t&&s){const A=g;g=()=>traverse(A())}let m,_=A=>{m=E.onStop=()=>{callWithErrorHandling(A,u,4),m=E.onStop=void 0}},b;if(isInSSRComponentSetup)if(_=NOOP,t?r&&callWithAsyncErrorHandling(t,u,3,[g(),a?[]:void 0,_]):g(),i==="sync"){const A=useSSRContext();b=A.__watcherHandles||(A.__watcherHandles=[])}else return NOOP;let c=a?new Array(n.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const w=()=>{if(E.active)if(t){const A=E.run();(s||y||(a?A.some((T,O)=>hasChanged(T,c[O])):hasChanged(A,c)))&&(m&&m(),callWithAsyncErrorHandling(t,u,3,[A,c===INITIAL_WATCHER_VALUE?void 0:a&&c[0]===INITIAL_WATCHER_VALUE?[]:c,_]),c=A)}else E.run()};w.allowRecurse=!!t;let S;i==="sync"?S=w:i==="post"?S=()=>queuePostRenderEffect(w,u&&u.suspense):(w.pre=!0,u&&(w.id=u.uid),S=()=>queueJob(w));const E=new ReactiveEffect(g,S);t?r?w():c=E.run():i==="post"?queuePostRenderEffect(E.run.bind(E),u&&u.suspense):E.run();const I=()=>{E.stop(),u&&u.scope&&remove(u.scope.effects,E)};return b&&b.push(I),I}function instanceWatch(n,t,r){const s=this.proxy,i=isString$1(n)?n.includes(".")?createPathGetter(s,n):()=>s[n]:n.bind(s,s);let o;isFunction$1(t)?o=t:(o=t.handler,r=t);const l=currentInstance;setCurrentInstance(this);const f=doWatch(i,o.bind(s),r);return l?setCurrentInstance(l):unsetCurrentInstance(),f}function createPathGetter(n,t){const r=t.split(".");return()=>{let s=n;for(let i=0;i<r.length&&s;i++)s=s[r[i]];return s}}function traverse(n,t){if(!isObject$1(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),isRef(n))traverse(n.value,t);else if(isArray(n))for(let r=0;r<n.length;r++)traverse(n[r],t);else if(isSet(n)||isMap(n))n.forEach(r=>{traverse(r,t)});else if(isPlainObject$1(n))for(const r in n)traverse(n[r],t);return n}function withDirectives(n,t){const r=currentRenderingInstance;if(r===null)return n;const s=getExposeProxy(r)||r.proxy,i=n.dirs||(n.dirs=[]);for(let o=0;o<t.length;o++){let[l,f,u,g=EMPTY_OBJ]=t[o];l&&(isFunction$1(l)&&(l={mounted:l,updated:l}),l.deep&&traverse(f),i.push({dir:l,instance:s,value:f,oldValue:void 0,arg:u,modifiers:g}))}return n}function invokeDirectiveHook(n,t,r,s){const i=n.dirs,o=t&&t.dirs;for(let l=0;l<i.length;l++){const f=i[l];o&&(f.oldValue=o[l].value);let u=f.dir[s];u&&(pauseTracking(),callWithAsyncErrorHandling(u,r,8,[n.el,f,n,t]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey=Symbol("_enterCb");function useTransitionState(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{n.isMounted=!0}),onBeforeUnmount(()=>{n.isUnmounting=!0}),n}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(n,{slots:t}){const r=getCurrentInstance(),s=useTransitionState();let i;return()=>{const o=t.default&&getTransitionRawChildren(t.default(),!0);if(!o||!o.length)return;let l=o[0];if(o.length>1){for(const c of o)if(c.type!==Comment){l=c;break}}const f=toRaw(n),{mode:u}=f;if(s.isLeaving)return emptyPlaceholder(l);const g=getKeepAliveChild(l);if(!g)return emptyPlaceholder(l);const y=resolveTransitionHooks(g,f,s,r);setTransitionHooks(g,y);const a=r.subTree,m=a&&getKeepAliveChild(a);let _=!1;const{getTransitionKey:b}=g.type;if(b){const c=b();i===void 0?i=c:c!==i&&(i=c,_=!0)}if(m&&m.type!==Comment&&(!isSameVNodeType(g,m)||_)){const c=resolveTransitionHooks(m,f,s,r);if(setTransitionHooks(m,c),u==="out-in")return s.isLeaving=!0,c.afterLeave=()=>{s.isLeaving=!1,r.update.active!==!1&&r.update()},emptyPlaceholder(l);u==="in-out"&&g.type!==Comment&&(c.delayLeave=(w,S,E)=>{const I=getLeavingNodesForType(s,m);I[String(m.key)]=m,w[leaveCbKey]=()=>{S(),w[leaveCbKey]=void 0,delete y.delayedLeave},y.delayedLeave=E})}return l}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(n,t){const{leavingVNodes:r}=n;let s=r.get(t.type);return s||(s=Object.create(null),r.set(t.type,s)),s}function resolveTransitionHooks(n,t,r,s){const{appear:i,mode:o,persisted:l=!1,onBeforeEnter:f,onEnter:u,onAfterEnter:g,onEnterCancelled:y,onBeforeLeave:a,onLeave:m,onAfterLeave:_,onLeaveCancelled:b,onBeforeAppear:c,onAppear:w,onAfterAppear:S,onAppearCancelled:E}=t,I=String(n.key),A=getLeavingNodesForType(r,n),T=(k,P)=>{k&&callWithAsyncErrorHandling(k,s,9,P)},O=(k,P)=>{const N=P[1];T(k,P),isArray(k)?k.every(L=>L.length<=1)&&N():k.length<=1&&N()},C={mode:o,persisted:l,beforeEnter(k){let P=f;if(!r.isMounted)if(i)P=c||f;else return;k[leaveCbKey]&&k[leaveCbKey](!0);const N=A[I];N&&isSameVNodeType(n,N)&&N.el[leaveCbKey]&&N.el[leaveCbKey](),T(P,[k])},enter(k){let P=u,N=g,L=y;if(!r.isMounted)if(i)P=w||u,N=S||g,L=E||y;else return;let F=!1;const V=k[enterCbKey]=j=>{F||(F=!0,j?T(L,[k]):T(N,[k]),C.delayedLeave&&C.delayedLeave(),k[enterCbKey]=void 0)};P?O(P,[k,V]):V()},leave(k,P){const N=String(n.key);if(k[enterCbKey]&&k[enterCbKey](!0),r.isUnmounting)return P();T(a,[k]);let L=!1;const F=k[leaveCbKey]=V=>{L||(L=!0,P(),V?T(b,[k]):T(_,[k]),k[leaveCbKey]=void 0,A[N]===n&&delete A[N])};A[N]=n,m?O(m,[k,F]):F()},clone(k){return resolveTransitionHooks(k,t,r,s)}};return C}function emptyPlaceholder(n){if(isKeepAlive(n))return n=cloneVNode(n),n.children=null,n}function getKeepAliveChild(n){return isKeepAlive(n)?n.children?n.children[0]:void 0:n}function setTransitionHooks(n,t){n.shapeFlag&6&&n.component?setTransitionHooks(n.component.subTree,t):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function getTransitionRawChildren(n,t=!1,r){let s=[],i=0;for(let o=0;o<n.length;o++){let l=n[o];const f=r==null?l.key:String(r)+String(l.key!=null?l.key:o);l.type===Fragment?(l.patchFlag&128&&i++,s=s.concat(getTransitionRawChildren(l.children,t,f))):(t||l.type!==Comment)&&s.push(f!=null?cloneVNode(l,{key:f}):l)}if(i>1)for(let o=0;o<s.length;o++)s[o].patchFlag=-2;return s}const isAsyncWrapper=n=>!!n.type.__asyncLoader,isKeepAlive=n=>n.type.__isKeepAlive;function onActivated(n,t){registerKeepAliveHook(n,"a",t)}function onDeactivated(n,t){registerKeepAliveHook(n,"da",t)}function registerKeepAliveHook(n,t,r=currentInstance){const s=n.__wdc||(n.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(injectHook(t,s,r),r){let i=r.parent;for(;i&&i.parent;)isKeepAlive(i.parent.vnode)&&injectToKeepAliveRoot(s,t,r,i),i=i.parent}}function injectToKeepAliveRoot(n,t,r,s){const i=injectHook(t,n,s,!0);onUnmounted(()=>{remove(s[t],i)},r)}function injectHook(n,t,r=currentInstance,s=!1){if(r){const i=r[n]||(r[n]=[]),o=t.__weh||(t.__weh=(...l)=>{if(r.isUnmounted)return;pauseTracking(),setCurrentInstance(r);const f=callWithAsyncErrorHandling(t,r,n,l);return unsetCurrentInstance(),resetTracking(),f});return s?i.unshift(o):i.push(o),o}}const createHook=n=>(t,r=currentInstance)=>(!isInSSRComponentSetup||n==="sp")&&injectHook(n,(...s)=>t(...s),r),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(n,t=currentInstance){injectHook("ec",n,t)}function renderList(n,t,r,s){let i;const o=r&&r[s];if(isArray(n)||isString$1(n)){i=new Array(n.length);for(let l=0,f=n.length;l<f;l++)i[l]=t(n[l],l,void 0,o&&o[l])}else if(typeof n=="number"){i=new Array(n);for(let l=0;l<n;l++)i[l]=t(l+1,l,void 0,o&&o[l])}else if(isObject$1(n))if(n[Symbol.iterator])i=Array.from(n,(l,f)=>t(l,f,void 0,o&&o[f]));else{const l=Object.keys(n);i=new Array(l.length);for(let f=0,u=l.length;f<u;f++){const g=l[f];i[f]=t(n[g],g,f,o&&o[f])}}else i=[];return r&&(r[s]=i),i}function createSlots(n,t){for(let r=0;r<t.length;r++){const s=t[r];if(isArray(s))for(let i=0;i<s.length;i++)n[s[i].name]=s[i].fn;else s&&(n[s.name]=s.key?(...i)=>{const o=s.fn(...i);return o&&(o.key=s.key),o}:s.fn)}return n}function renderSlot(n,t,r={},s,i){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return t!=="default"&&(r.name=t),createVNode("slot",r,s&&s());let o=n[t];o&&o._c&&(o._d=!1),openBlock();const l=o&&ensureValidVNode(o(r)),f=createBlock(Fragment,{key:r.key||l&&l.key||`_${t}`},l||(s?s():[]),l&&n._===1?64:-2);return!i&&f.scopeId&&(f.slotScopeIds=[f.scopeId+"-s"]),o&&o._c&&(o._d=!0),f}function ensureValidVNode(n){return n.some(t=>isVNode(t)?!(t.type===Comment||t.type===Fragment&&!ensureValidVNode(t.children)):!0)?n:null}function toHandlers(n,t){const r={};for(const s in n)r[t&&/[A-Z]/.test(s)?`on:${s}`:toHandlerKey(s)]=n[s];return r}const getPublicInstance=n=>n?isStatefulComponent(n)?getExposeProxy(n)||n.proxy:getPublicInstance(n.parent):null,publicPropertiesMap=extend(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>getPublicInstance(n.parent),$root:n=>getPublicInstance(n.root),$emit:n=>n.emit,$options:n=>resolveMergedOptions(n),$forceUpdate:n=>n.f||(n.f=()=>queueJob(n.update)),$nextTick:n=>n.n||(n.n=nextTick.bind(n.proxy)),$watch:n=>instanceWatch.bind(n)}),hasSetupBinding=(n,t)=>n!==EMPTY_OBJ&&!n.__isScriptSetup&&hasOwn(n,t),PublicInstanceProxyHandlers={get({_:n},t){const{ctx:r,setupState:s,data:i,props:o,accessCache:l,type:f,appContext:u}=n;let g;if(t[0]!=="$"){const _=l[t];if(_!==void 0)switch(_){case 1:return s[t];case 2:return i[t];case 4:return r[t];case 3:return o[t]}else{if(hasSetupBinding(s,t))return l[t]=1,s[t];if(i!==EMPTY_OBJ&&hasOwn(i,t))return l[t]=2,i[t];if((g=n.propsOptions[0])&&hasOwn(g,t))return l[t]=3,o[t];if(r!==EMPTY_OBJ&&hasOwn(r,t))return l[t]=4,r[t];shouldCacheAccess&&(l[t]=0)}}const y=publicPropertiesMap[t];let a,m;if(y)return t==="$attrs"&&track(n,"get",t),y(n);if((a=f.__cssModules)&&(a=a[t]))return a;if(r!==EMPTY_OBJ&&hasOwn(r,t))return l[t]=4,r[t];if(m=u.config.globalProperties,hasOwn(m,t))return m[t]},set({_:n},t,r){const{data:s,setupState:i,ctx:o}=n;return hasSetupBinding(i,t)?(i[t]=r,!0):s!==EMPTY_OBJ&&hasOwn(s,t)?(s[t]=r,!0):hasOwn(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(o[t]=r,!0)},has({_:{data:n,setupState:t,accessCache:r,ctx:s,appContext:i,propsOptions:o}},l){let f;return!!r[l]||n!==EMPTY_OBJ&&hasOwn(n,l)||hasSetupBinding(t,l)||(f=o[0])&&hasOwn(f,l)||hasOwn(s,l)||hasOwn(publicPropertiesMap,l)||hasOwn(i.config.globalProperties,l)},defineProperty(n,t,r){return r.get!=null?n._.accessCache[t]=0:hasOwn(r,"value")&&this.set(n,t,r.value,null),Reflect.defineProperty(n,t,r)}};function normalizePropsOrEmits(n){return isArray(n)?n.reduce((t,r)=>(t[r]=null,t),{}):n}let shouldCacheAccess=!0;function applyOptions(n){const t=resolveMergedOptions(n),r=n.proxy,s=n.ctx;shouldCacheAccess=!1,t.beforeCreate&&callHook$1(t.beforeCreate,n,"bc");const{data:i,computed:o,methods:l,watch:f,provide:u,inject:g,created:y,beforeMount:a,mounted:m,beforeUpdate:_,updated:b,activated:c,deactivated:w,beforeDestroy:S,beforeUnmount:E,destroyed:I,unmounted:A,render:T,renderTracked:O,renderTriggered:C,errorCaptured:k,serverPrefetch:P,expose:N,inheritAttrs:L,components:F,directives:V,filters:j}=t;if(g&&resolveInjections(g,s,null),l)for(const X in l){const J=l[X];isFunction$1(J)&&(s[X]=J.bind(r))}if(i){const X=i.call(r,r);isObject$1(X)&&(n.data=reactive(X))}if(shouldCacheAccess=!0,o)for(const X in o){const J=o[X],Y=isFunction$1(J)?J.bind(r,r):isFunction$1(J.get)?J.get.bind(r,r):NOOP,te=!isFunction$1(J)&&isFunction$1(J.set)?J.set.bind(r):NOOP,se=computed({get:Y,set:te});Object.defineProperty(s,X,{enumerable:!0,configurable:!0,get:()=>se.value,set:de=>se.value=de})}if(f)for(const X in f)createWatcher(f[X],s,r,X);if(u){const X=isFunction$1(u)?u.call(r):u;Reflect.ownKeys(X).forEach(J=>{provide(J,X[J])})}y&&callHook$1(y,n,"c");function U(X,J){isArray(J)?J.forEach(Y=>X(Y.bind(r))):J&&X(J.bind(r))}if(U(onBeforeMount,a),U(onMounted,m),U(onBeforeUpdate,_),U(onUpdated,b),U(onActivated,c),U(onDeactivated,w),U(onErrorCaptured,k),U(onRenderTracked,O),U(onRenderTriggered,C),U(onBeforeUnmount,E),U(onUnmounted,A),U(onServerPrefetch,P),isArray(N))if(N.length){const X=n.exposed||(n.exposed={});N.forEach(J=>{Object.defineProperty(X,J,{get:()=>r[J],set:Y=>r[J]=Y})})}else n.exposed||(n.exposed={});T&&n.render===NOOP&&(n.render=T),L!=null&&(n.inheritAttrs=L),F&&(n.components=F),V&&(n.directives=V)}function resolveInjections(n,t,r=NOOP){isArray(n)&&(n=normalizeInject(n));for(const s in n){const i=n[s];let o;isObject$1(i)?"default"in i?o=inject(i.from||s,i.default,!0):o=inject(i.from||s):o=inject(i),isRef(o)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):t[s]=o}}function callHook$1(n,t,r){callWithAsyncErrorHandling(isArray(n)?n.map(s=>s.bind(t.proxy)):n.bind(t.proxy),t,r)}function createWatcher(n,t,r,s){const i=s.includes(".")?createPathGetter(r,s):()=>r[s];if(isString$1(n)){const o=t[n];isFunction$1(o)&&watch(i,o)}else if(isFunction$1(n))watch(i,n.bind(r));else if(isObject$1(n))if(isArray(n))n.forEach(o=>createWatcher(o,t,r,s));else{const o=isFunction$1(n.handler)?n.handler.bind(r):t[n.handler];isFunction$1(o)&&watch(i,o,n)}}function resolveMergedOptions(n){const t=n.type,{mixins:r,extends:s}=t,{mixins:i,optionsCache:o,config:{optionMergeStrategies:l}}=n.appContext,f=o.get(t);let u;return f?u=f:!i.length&&!r&&!s?u=t:(u={},i.length&&i.forEach(g=>mergeOptions(u,g,l,!0)),mergeOptions(u,t,l)),isObject$1(t)&&o.set(t,u),u}function mergeOptions(n,t,r,s=!1){const{mixins:i,extends:o}=t;o&&mergeOptions(n,o,r,!0),i&&i.forEach(l=>mergeOptions(n,l,r,!0));for(const l in t)if(!(s&&l==="expose")){const f=internalOptionMergeStrats[l]||r&&r[l];n[l]=f?f(n[l],t[l]):t[l]}return n}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(n,t){return t?n?function(){return extend(isFunction$1(n)?n.call(this,this):n,isFunction$1(t)?t.call(this,this):t)}:t:n}function mergeInject(n,t){return mergeObjectOptions(normalizeInject(n),normalizeInject(t))}function normalizeInject(n){if(isArray(n)){const t={};for(let r=0;r<n.length;r++)t[n[r]]=n[r];return t}return n}function mergeAsArray(n,t){return n?[...new Set([].concat(n,t))]:t}function mergeObjectOptions(n,t){return n?extend(Object.create(null),n,t):t}function mergeEmitsOrPropsOptions(n,t){return n?isArray(n)&&isArray(t)?[...new Set([...n,...t])]:extend(Object.create(null),normalizePropsOrEmits(n),normalizePropsOrEmits(t??{})):t}function mergeWatchOptions(n,t){if(!n)return t;if(!t)return n;const r=extend(Object.create(null),n);for(const s in t)r[s]=mergeAsArray(n[s],t[s]);return r}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(n,t){return function(s,i=null){isFunction$1(s)||(s=extend({},s)),i!=null&&!isObject$1(i)&&(i=null);const o=createAppContext(),l=new WeakSet;let f=!1;const u=o.app={_uid:uid$1++,_component:s,_props:i,_container:null,_context:o,_instance:null,version,get config(){return o.config},set config(g){},use(g,...y){return l.has(g)||(g&&isFunction$1(g.install)?(l.add(g),g.install(u,...y)):isFunction$1(g)&&(l.add(g),g(u,...y))),u},mixin(g){return o.mixins.includes(g)||o.mixins.push(g),u},component(g,y){return y?(o.components[g]=y,u):o.components[g]},directive(g,y){return y?(o.directives[g]=y,u):o.directives[g]},mount(g,y,a){if(!f){const m=createVNode(s,i);return m.appContext=o,y&&t?t(m,g):n(m,g,a),f=!0,u._container=g,g.__vue_app__=u,getExposeProxy(m.component)||m.component.proxy}},unmount(){f&&(n(null,u._container),delete u._container.__vue_app__)},provide(g,y){return o.provides[g]=y,u},runWithContext(g){currentApp=u;try{return g()}finally{currentApp=null}}};return u}}let currentApp=null;function provide(n,t){if(currentInstance){let r=currentInstance.provides;const s=currentInstance.parent&&currentInstance.parent.provides;s===r&&(r=currentInstance.provides=Object.create(s)),r[n]=t}}function inject(n,t,r=!1){const s=currentInstance||currentRenderingInstance;if(s||currentApp){const i=s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:currentApp._context.provides;if(i&&n in i)return i[n];if(arguments.length>1)return r&&isFunction$1(t)?t.call(s&&s.proxy):t}}function hasInjectionContext(){return!!(currentInstance||currentRenderingInstance||currentApp)}function initProps(n,t,r,s=!1){const i={},o={};def(o,InternalObjectKey,1),n.propsDefaults=Object.create(null),setFullProps(n,t,i,o);for(const l in n.propsOptions[0])l in i||(i[l]=void 0);r?n.props=s?i:shallowReactive(i):n.type.props?n.props=i:n.props=o,n.attrs=o}function updateProps(n,t,r,s){const{props:i,attrs:o,vnode:{patchFlag:l}}=n,f=toRaw(i),[u]=n.propsOptions;let g=!1;if((s||l>0)&&!(l&16)){if(l&8){const y=n.vnode.dynamicProps;for(let a=0;a<y.length;a++){let m=y[a];if(isEmitListener(n.emitsOptions,m))continue;const _=t[m];if(u)if(hasOwn(o,m))_!==o[m]&&(o[m]=_,g=!0);else{const b=camelize(m);i[b]=resolvePropValue(u,f,b,_,n,!1)}else _!==o[m]&&(o[m]=_,g=!0)}}}else{setFullProps(n,t,i,o)&&(g=!0);let y;for(const a in f)(!t||!hasOwn(t,a)&&((y=hyphenate(a))===a||!hasOwn(t,y)))&&(u?r&&(r[a]!==void 0||r[y]!==void 0)&&(i[a]=resolvePropValue(u,f,a,void 0,n,!0)):delete i[a]);if(o!==f)for(const a in o)(!t||!hasOwn(t,a))&&(delete o[a],g=!0)}g&&trigger(n,"set","$attrs")}function setFullProps(n,t,r,s){const[i,o]=n.propsOptions;let l=!1,f;if(t)for(let u in t){if(isReservedProp(u))continue;const g=t[u];let y;i&&hasOwn(i,y=camelize(u))?!o||!o.includes(y)?r[y]=g:(f||(f={}))[y]=g:isEmitListener(n.emitsOptions,u)||(!(u in s)||g!==s[u])&&(s[u]=g,l=!0)}if(o){const u=toRaw(r),g=f||EMPTY_OBJ;for(let y=0;y<o.length;y++){const a=o[y];r[a]=resolvePropValue(i,u,a,g[a],n,!hasOwn(g,a))}}return l}function resolvePropValue(n,t,r,s,i,o){const l=n[r];if(l!=null){const f=hasOwn(l,"default");if(f&&s===void 0){const u=l.default;if(l.type!==Function&&!l.skipFactory&&isFunction$1(u)){const{propsDefaults:g}=i;r in g?s=g[r]:(setCurrentInstance(i),s=g[r]=u.call(null,t),unsetCurrentInstance())}else s=u}l[0]&&(o&&!f?s=!1:l[1]&&(s===""||s===hyphenate(r))&&(s=!0))}return s}function normalizePropsOptions(n,t,r=!1){const s=t.propsCache,i=s.get(n);if(i)return i;const o=n.props,l={},f=[];let u=!1;if(!isFunction$1(n)){const y=a=>{u=!0;const[m,_]=normalizePropsOptions(a,t,!0);extend(l,m),_&&f.push(..._)};!r&&t.mixins.length&&t.mixins.forEach(y),n.extends&&y(n.extends),n.mixins&&n.mixins.forEach(y)}if(!o&&!u)return isObject$1(n)&&s.set(n,EMPTY_ARR),EMPTY_ARR;if(isArray(o))for(let y=0;y<o.length;y++){const a=camelize(o[y]);validatePropName(a)&&(l[a]=EMPTY_OBJ)}else if(o)for(const y in o){const a=camelize(y);if(validatePropName(a)){const m=o[y],_=l[a]=isArray(m)||isFunction$1(m)?{type:m}:extend({},m);if(_){const b=getTypeIndex(Boolean,_.type),c=getTypeIndex(String,_.type);_[0]=b>-1,_[1]=c<0||b<c,(b>-1||hasOwn(_,"default"))&&f.push(a)}}}const g=[l,f];return isObject$1(n)&&s.set(n,g),g}function validatePropName(n){return n[0]!=="$"}function getType(n){const t=n&&n.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:n===null?"null":""}function isSameType(n,t){return getType(n)===getType(t)}function getTypeIndex(n,t){return isArray(t)?t.findIndex(r=>isSameType(r,n)):isFunction$1(t)&&isSameType(t,n)?0:-1}const isInternalKey=n=>n[0]==="_"||n==="$stable",normalizeSlotValue=n=>isArray(n)?n.map(normalizeVNode):[normalizeVNode(n)],normalizeSlot=(n,t,r)=>{if(t._n)return t;const s=withCtx((...i)=>normalizeSlotValue(t(...i)),r);return s._c=!1,s},normalizeObjectSlots=(n,t,r)=>{const s=n._ctx;for(const i in n){if(isInternalKey(i))continue;const o=n[i];if(isFunction$1(o))t[i]=normalizeSlot(i,o,s);else if(o!=null){const l=normalizeSlotValue(o);t[i]=()=>l}}},normalizeVNodeSlots=(n,t)=>{const r=normalizeSlotValue(t);n.slots.default=()=>r},initSlots=(n,t)=>{if(n.vnode.shapeFlag&32){const r=t._;r?(n.slots=toRaw(t),def(t,"_",r)):normalizeObjectSlots(t,n.slots={})}else n.slots={},t&&normalizeVNodeSlots(n,t);def(n.slots,InternalObjectKey,1)},updateSlots=(n,t,r)=>{const{vnode:s,slots:i}=n;let o=!0,l=EMPTY_OBJ;if(s.shapeFlag&32){const f=t._;f?r&&f===1?o=!1:(extend(i,t),!r&&f===1&&delete i._):(o=!t.$stable,normalizeObjectSlots(t,i)),l=t}else t&&(normalizeVNodeSlots(n,t),l={default:1});if(o)for(const f in i)!isInternalKey(f)&&l[f]==null&&delete i[f]};function setRef(n,t,r,s,i=!1){if(isArray(n)){n.forEach((m,_)=>setRef(m,t&&(isArray(t)?t[_]:t),r,s,i));return}if(isAsyncWrapper(s)&&!i)return;const o=s.shapeFlag&4?getExposeProxy(s.component)||s.component.proxy:s.el,l=i?null:o,{i:f,r:u}=n,g=t&&t.r,y=f.refs===EMPTY_OBJ?f.refs={}:f.refs,a=f.setupState;if(g!=null&&g!==u&&(isString$1(g)?(y[g]=null,hasOwn(a,g)&&(a[g]=null)):isRef(g)&&(g.value=null)),isFunction$1(u))callWithErrorHandling(u,f,12,[l,y]);else{const m=isString$1(u),_=isRef(u);if(m||_){const b=()=>{if(n.f){const c=m?hasOwn(a,u)?a[u]:y[u]:u.value;i?isArray(c)&&remove(c,o):isArray(c)?c.includes(o)||c.push(o):m?(y[u]=[o],hasOwn(a,u)&&(a[u]=y[u])):(u.value=[o],n.k&&(y[n.k]=u.value))}else m?(y[u]=l,hasOwn(a,u)&&(a[u]=l)):_&&(u.value=l,n.k&&(y[n.k]=l))};l?(b.id=-1,queuePostRenderEffect(b,r)):b()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(n){return baseCreateRenderer(n)}function baseCreateRenderer(n,t){const r=getGlobalThis();r.__VUE__=!0;const{insert:s,remove:i,patchProp:o,createElement:l,createText:f,createComment:u,setText:g,setElementText:y,parentNode:a,nextSibling:m,setScopeId:_=NOOP,insertStaticContent:b}=n,c=(G,Q,ie,le=null,ue=null,he=null,ve=!1,be=null,ye=!!Q.dynamicChildren)=>{if(G===Q)return;G&&!isSameVNodeType(G,Q)&&(le=Te(G),de(G,ue,he,!0),G=null),Q.patchFlag===-2&&(ye=!1,Q.dynamicChildren=null);const{type:B,ref:M,shapeFlag:D}=Q;switch(B){case Text:w(G,Q,ie,le);break;case Comment:S(G,Q,ie,le);break;case Static:G==null&&E(Q,ie,le,ve);break;case Fragment:F(G,Q,ie,le,ue,he,ve,be,ye);break;default:D&1?T(G,Q,ie,le,ue,he,ve,be,ye):D&6?V(G,Q,ie,le,ue,he,ve,be,ye):(D&64||D&128)&&B.process(G,Q,ie,le,ue,he,ve,be,ye,Ae)}M!=null&&ue&&setRef(M,G&&G.ref,he,Q||G,!Q)},w=(G,Q,ie,le)=>{if(G==null)s(Q.el=f(Q.children),ie,le);else{const ue=Q.el=G.el;Q.children!==G.children&&g(ue,Q.children)}},S=(G,Q,ie,le)=>{G==null?s(Q.el=u(Q.children||""),ie,le):Q.el=G.el},E=(G,Q,ie,le)=>{[G.el,G.anchor]=b(G.children,Q,ie,le,G.el,G.anchor)},I=({el:G,anchor:Q},ie,le)=>{let ue;for(;G&&G!==Q;)ue=m(G),s(G,ie,le),G=ue;s(Q,ie,le)},A=({el:G,anchor:Q})=>{let ie;for(;G&&G!==Q;)ie=m(G),i(G),G=ie;i(Q)},T=(G,Q,ie,le,ue,he,ve,be,ye)=>{ve=ve||Q.type==="svg",G==null?O(Q,ie,le,ue,he,ve,be,ye):P(G,Q,ue,he,ve,be,ye)},O=(G,Q,ie,le,ue,he,ve,be)=>{let ye,B;const{type:M,props:D,shapeFlag:z,transition:Z,dirs:oe}=G;if(ye=G.el=l(G.type,he,D&&D.is,D),z&8?y(ye,G.children):z&16&&k(G.children,ye,null,le,ue,he&&M!=="foreignObject",ve,be),oe&&invokeDirectiveHook(G,null,le,"created"),C(ye,G,G.scopeId,ve,le),D){for(const Ee in D)Ee!=="value"&&!isReservedProp(Ee)&&o(ye,Ee,null,D[Ee],he,G.children,le,ue,Ie);"value"in D&&o(ye,"value",null,D.value),(B=D.onVnodeBeforeMount)&&invokeVNodeHook(B,le,G)}oe&&invokeDirectiveHook(G,null,le,"beforeMount");const ae=needTransition(ue,Z);ae&&Z.beforeEnter(ye),s(ye,Q,ie),((B=D&&D.onVnodeMounted)||ae||oe)&&queuePostRenderEffect(()=>{B&&invokeVNodeHook(B,le,G),ae&&Z.enter(ye),oe&&invokeDirectiveHook(G,null,le,"mounted")},ue)},C=(G,Q,ie,le,ue)=>{if(ie&&_(G,ie),le)for(let he=0;he<le.length;he++)_(G,le[he]);if(ue){let he=ue.subTree;if(Q===he){const ve=ue.vnode;C(G,ve,ve.scopeId,ve.slotScopeIds,ue.parent)}}},k=(G,Q,ie,le,ue,he,ve,be,ye=0)=>{for(let B=ye;B<G.length;B++){const M=G[B]=be?cloneIfMounted(G[B]):normalizeVNode(G[B]);c(null,M,Q,ie,le,ue,he,ve,be)}},P=(G,Q,ie,le,ue,he,ve)=>{const be=Q.el=G.el;let{patchFlag:ye,dynamicChildren:B,dirs:M}=Q;ye|=G.patchFlag&16;const D=G.props||EMPTY_OBJ,z=Q.props||EMPTY_OBJ;let Z;ie&&toggleRecurse(ie,!1),(Z=z.onVnodeBeforeUpdate)&&invokeVNodeHook(Z,ie,Q,G),M&&invokeDirectiveHook(Q,G,ie,"beforeUpdate"),ie&&toggleRecurse(ie,!0);const oe=ue&&Q.type!=="foreignObject";if(B?N(G.dynamicChildren,B,be,ie,le,oe,he):ve||J(G,Q,be,null,ie,le,oe,he,!1),ye>0){if(ye&16)L(be,Q,D,z,ie,le,ue);else if(ye&2&&D.class!==z.class&&o(be,"class",null,z.class,ue),ye&4&&o(be,"style",D.style,z.style,ue),ye&8){const ae=Q.dynamicProps;for(let Ee=0;Ee<ae.length;Ee++){const Pe=ae[Ee],$e=D[Pe],Ke=z[Pe];(Ke!==$e||Pe==="value")&&o(be,Pe,$e,Ke,ue,G.children,ie,le,Ie)}}ye&1&&G.children!==Q.children&&y(be,Q.children)}else!ve&&B==null&&L(be,Q,D,z,ie,le,ue);((Z=z.onVnodeUpdated)||M)&&queuePostRenderEffect(()=>{Z&&invokeVNodeHook(Z,ie,Q,G),M&&invokeDirectiveHook(Q,G,ie,"updated")},le)},N=(G,Q,ie,le,ue,he,ve)=>{for(let be=0;be<Q.length;be++){const ye=G[be],B=Q[be],M=ye.el&&(ye.type===Fragment||!isSameVNodeType(ye,B)||ye.shapeFlag&70)?a(ye.el):ie;c(ye,B,M,null,le,ue,he,ve,!0)}},L=(G,Q,ie,le,ue,he,ve)=>{if(ie!==le){if(ie!==EMPTY_OBJ)for(const be in ie)!isReservedProp(be)&&!(be in le)&&o(G,be,ie[be],null,ve,Q.children,ue,he,Ie);for(const be in le){if(isReservedProp(be))continue;const ye=le[be],B=ie[be];ye!==B&&be!=="value"&&o(G,be,B,ye,ve,Q.children,ue,he,Ie)}"value"in le&&o(G,"value",ie.value,le.value)}},F=(G,Q,ie,le,ue,he,ve,be,ye)=>{const B=Q.el=G?G.el:f(""),M=Q.anchor=G?G.anchor:f("");let{patchFlag:D,dynamicChildren:z,slotScopeIds:Z}=Q;Z&&(be=be?be.concat(Z):Z),G==null?(s(B,ie,le),s(M,ie,le),k(Q.children,ie,M,ue,he,ve,be,ye)):D>0&&D&64&&z&&G.dynamicChildren?(N(G.dynamicChildren,z,ie,ue,he,ve,be),(Q.key!=null||ue&&Q===ue.subTree)&&traverseStaticChildren(G,Q,!0)):J(G,Q,ie,M,ue,he,ve,be,ye)},V=(G,Q,ie,le,ue,he,ve,be,ye)=>{Q.slotScopeIds=be,G==null?Q.shapeFlag&512?ue.ctx.activate(Q,ie,le,ve,ye):j(Q,ie,le,ue,he,ve,ye):K(G,Q,ye)},j=(G,Q,ie,le,ue,he,ve)=>{const be=G.component=createComponentInstance(G,le,ue);if(isKeepAlive(G)&&(be.ctx.renderer=Ae),setupComponent(be),be.asyncDep){if(ue&&ue.registerDep(be,U),!G.el){const ye=be.subTree=createVNode(Comment);S(null,ye,Q,ie)}return}U(be,G,Q,ie,ue,he,ve)},K=(G,Q,ie)=>{const le=Q.component=G.component;if(shouldUpdateComponent(G,Q,ie))if(le.asyncDep&&!le.asyncResolved){X(le,Q,ie);return}else le.next=Q,invalidateJob(le.update),le.update();else Q.el=G.el,le.vnode=Q},U=(G,Q,ie,le,ue,he,ve)=>{const be=()=>{if(G.isMounted){let{next:M,bu:D,u:z,parent:Z,vnode:oe}=G,ae=M,Ee;toggleRecurse(G,!1),M?(M.el=oe.el,X(G,M,ve)):M=oe,D&&invokeArrayFns(D),(Ee=M.props&&M.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Ee,Z,M,oe),toggleRecurse(G,!0);const Pe=renderComponentRoot(G),$e=G.subTree;G.subTree=Pe,c($e,Pe,a($e.el),Te($e),G,ue,he),M.el=Pe.el,ae===null&&updateHOCHostEl(G,Pe.el),z&&queuePostRenderEffect(z,ue),(Ee=M.props&&M.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Ee,Z,M,oe),ue)}else{let M;const{el:D,props:z}=Q,{bm:Z,m:oe,parent:ae}=G,Ee=isAsyncWrapper(Q);if(toggleRecurse(G,!1),Z&&invokeArrayFns(Z),!Ee&&(M=z&&z.onVnodeBeforeMount)&&invokeVNodeHook(M,ae,Q),toggleRecurse(G,!0),D&&Re){const Pe=()=>{G.subTree=renderComponentRoot(G),Re(D,G.subTree,G,ue,null)};Ee?Q.type.__asyncLoader().then(()=>!G.isUnmounted&&Pe()):Pe()}else{const Pe=G.subTree=renderComponentRoot(G);c(null,Pe,ie,le,G,ue,he),Q.el=Pe.el}if(oe&&queuePostRenderEffect(oe,ue),!Ee&&(M=z&&z.onVnodeMounted)){const Pe=Q;queuePostRenderEffect(()=>invokeVNodeHook(M,ae,Pe),ue)}(Q.shapeFlag&256||ae&&isAsyncWrapper(ae.vnode)&&ae.vnode.shapeFlag&256)&&G.a&&queuePostRenderEffect(G.a,ue),G.isMounted=!0,Q=ie=le=null}},ye=G.effect=new ReactiveEffect(be,()=>queueJob(B),G.scope),B=G.update=()=>ye.run();B.id=G.uid,toggleRecurse(G,!0),B()},X=(G,Q,ie)=>{Q.component=G;const le=G.vnode.props;G.vnode=Q,G.next=null,updateProps(G,Q.props,le,ie),updateSlots(G,Q.children,ie),pauseTracking(),flushPreFlushCbs(G),resetTracking()},J=(G,Q,ie,le,ue,he,ve,be,ye=!1)=>{const B=G&&G.children,M=G?G.shapeFlag:0,D=Q.children,{patchFlag:z,shapeFlag:Z}=Q;if(z>0){if(z&128){te(B,D,ie,le,ue,he,ve,be,ye);return}else if(z&256){Y(B,D,ie,le,ue,he,ve,be,ye);return}}Z&8?(M&16&&Ie(B,ue,he),D!==B&&y(ie,D)):M&16?Z&16?te(B,D,ie,le,ue,he,ve,be,ye):Ie(B,ue,he,!0):(M&8&&y(ie,""),Z&16&&k(D,ie,le,ue,he,ve,be,ye))},Y=(G,Q,ie,le,ue,he,ve,be,ye)=>{G=G||EMPTY_ARR,Q=Q||EMPTY_ARR;const B=G.length,M=Q.length,D=Math.min(B,M);let z;for(z=0;z<D;z++){const Z=Q[z]=ye?cloneIfMounted(Q[z]):normalizeVNode(Q[z]);c(G[z],Z,ie,null,ue,he,ve,be,ye)}B>M?Ie(G,ue,he,!0,!1,D):k(Q,ie,le,ue,he,ve,be,ye,D)},te=(G,Q,ie,le,ue,he,ve,be,ye)=>{let B=0;const M=Q.length;let D=G.length-1,z=M-1;for(;B<=D&&B<=z;){const Z=G[B],oe=Q[B]=ye?cloneIfMounted(Q[B]):normalizeVNode(Q[B]);if(isSameVNodeType(Z,oe))c(Z,oe,ie,null,ue,he,ve,be,ye);else break;B++}for(;B<=D&&B<=z;){const Z=G[D],oe=Q[z]=ye?cloneIfMounted(Q[z]):normalizeVNode(Q[z]);if(isSameVNodeType(Z,oe))c(Z,oe,ie,null,ue,he,ve,be,ye);else break;D--,z--}if(B>D){if(B<=z){const Z=z+1,oe=Z<M?Q[Z].el:le;for(;B<=z;)c(null,Q[B]=ye?cloneIfMounted(Q[B]):normalizeVNode(Q[B]),ie,oe,ue,he,ve,be,ye),B++}}else if(B>z)for(;B<=D;)de(G[B],ue,he,!0),B++;else{const Z=B,oe=B,ae=new Map;for(B=oe;B<=z;B++){const nt=Q[B]=ye?cloneIfMounted(Q[B]):normalizeVNode(Q[B]);nt.key!=null&&ae.set(nt.key,B)}let Ee,Pe=0;const $e=z-oe+1;let Ke=!1,Ge=0;const ot=new Array($e);for(B=0;B<$e;B++)ot[B]=0;for(B=Z;B<=D;B++){const nt=G[B];if(Pe>=$e){de(nt,ue,he,!0);continue}let yt;if(nt.key!=null)yt=ae.get(nt.key);else for(Ee=oe;Ee<=z;Ee++)if(ot[Ee-oe]===0&&isSameVNodeType(nt,Q[Ee])){yt=Ee;break}yt===void 0?de(nt,ue,he,!0):(ot[yt-oe]=B+1,yt>=Ge?Ge=yt:Ke=!0,c(nt,Q[yt],ie,null,ue,he,ve,be,ye),Pe++)}const Nt=Ke?getSequence(ot):EMPTY_ARR;for(Ee=Nt.length-1,B=$e-1;B>=0;B--){const nt=oe+B,yt=Q[nt],_n=nt+1<M?Q[nt+1].el:le;ot[B]===0?c(null,yt,ie,_n,ue,he,ve,be,ye):Ke&&(Ee<0||B!==Nt[Ee]?se(yt,ie,_n,2):Ee--)}}},se=(G,Q,ie,le,ue=null)=>{const{el:he,type:ve,transition:be,children:ye,shapeFlag:B}=G;if(B&6){se(G.component.subTree,Q,ie,le);return}if(B&128){G.suspense.move(Q,ie,le);return}if(B&64){ve.move(G,Q,ie,Ae);return}if(ve===Fragment){s(he,Q,ie);for(let D=0;D<ye.length;D++)se(ye[D],Q,ie,le);s(G.anchor,Q,ie);return}if(ve===Static){I(G,Q,ie);return}if(le!==2&&B&1&&be)if(le===0)be.beforeEnter(he),s(he,Q,ie),queuePostRenderEffect(()=>be.enter(he),ue);else{const{leave:D,delayLeave:z,afterLeave:Z}=be,oe=()=>s(he,Q,ie),ae=()=>{D(he,()=>{oe(),Z&&Z()})};z?z(he,oe,ae):ae()}else s(he,Q,ie)},de=(G,Q,ie,le=!1,ue=!1)=>{const{type:he,props:ve,ref:be,children:ye,dynamicChildren:B,shapeFlag:M,patchFlag:D,dirs:z}=G;if(be!=null&&setRef(be,null,ie,G,!0),M&256){Q.ctx.deactivate(G);return}const Z=M&1&&z,oe=!isAsyncWrapper(G);let ae;if(oe&&(ae=ve&&ve.onVnodeBeforeUnmount)&&invokeVNodeHook(ae,Q,G),M&6)ge(G.component,ie,le);else{if(M&128){G.suspense.unmount(ie,le);return}Z&&invokeDirectiveHook(G,null,Q,"beforeUnmount"),M&64?G.type.remove(G,Q,ie,ue,Ae,le):B&&(he!==Fragment||D>0&&D&64)?Ie(B,Q,ie,!1,!0):(he===Fragment&&D&384||!ue&&M&16)&&Ie(ye,Q,ie),le&&Se(G)}(oe&&(ae=ve&&ve.onVnodeUnmounted)||Z)&&queuePostRenderEffect(()=>{ae&&invokeVNodeHook(ae,Q,G),Z&&invokeDirectiveHook(G,null,Q,"unmounted")},ie)},Se=G=>{const{type:Q,el:ie,anchor:le,transition:ue}=G;if(Q===Fragment){we(ie,le);return}if(Q===Static){A(G);return}const he=()=>{i(ie),ue&&!ue.persisted&&ue.afterLeave&&ue.afterLeave()};if(G.shapeFlag&1&&ue&&!ue.persisted){const{leave:ve,delayLeave:be}=ue,ye=()=>ve(ie,he);be?be(G.el,he,ye):ye()}else he()},we=(G,Q)=>{let ie;for(;G!==Q;)ie=m(G),i(G),G=ie;i(Q)},ge=(G,Q,ie)=>{const{bum:le,scope:ue,update:he,subTree:ve,um:be}=G;le&&invokeArrayFns(le),ue.stop(),he&&(he.active=!1,de(ve,G,Q,ie)),be&&queuePostRenderEffect(be,Q),queuePostRenderEffect(()=>{G.isUnmounted=!0},Q),Q&&Q.pendingBranch&&!Q.isUnmounted&&G.asyncDep&&!G.asyncResolved&&G.suspenseId===Q.pendingId&&(Q.deps--,Q.deps===0&&Q.resolve())},Ie=(G,Q,ie,le=!1,ue=!1,he=0)=>{for(let ve=he;ve<G.length;ve++)de(G[ve],Q,ie,le,ue)},Te=G=>G.shapeFlag&6?Te(G.component.subTree):G.shapeFlag&128?G.suspense.next():m(G.anchor||G.el),Ce=(G,Q,ie)=>{G==null?Q._vnode&&de(Q._vnode,null,null,!0):c(Q._vnode||null,G,Q,null,null,null,ie),flushPreFlushCbs(),flushPostFlushCbs(),Q._vnode=G},Ae={p:c,um:de,m:se,r:Se,mt:j,mc:k,pc:J,pbc:N,n:Te,o:n};let Me,Re;return t&&([Me,Re]=t(Ae)),{render:Ce,hydrate:Me,createApp:createAppAPI(Ce,Me)}}function toggleRecurse({effect:n,update:t},r){n.allowRecurse=t.allowRecurse=r}function needTransition(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function traverseStaticChildren(n,t,r=!1){const s=n.children,i=t.children;if(isArray(s)&&isArray(i))for(let o=0;o<s.length;o++){const l=s[o];let f=i[o];f.shapeFlag&1&&!f.dynamicChildren&&((f.patchFlag<=0||f.patchFlag===32)&&(f=i[o]=cloneIfMounted(i[o]),f.el=l.el),r||traverseStaticChildren(l,f)),f.type===Text&&(f.el=l.el)}}function getSequence(n){const t=n.slice(),r=[0];let s,i,o,l,f;const u=n.length;for(s=0;s<u;s++){const g=n[s];if(g!==0){if(i=r[r.length-1],n[i]<g){t[s]=i,r.push(s);continue}for(o=0,l=r.length-1;o<l;)f=o+l>>1,n[r[f]]<g?o=f+1:l=f;g<n[r[o]]&&(o>0&&(t[s]=r[o-1]),r[o]=s)}}for(o=r.length,l=r[o-1];o-- >0;)r[o]=l,l=t[l];return r}const isTeleport=n=>n.__isTeleport,isTeleportDisabled=n=>n&&(n.disabled||n.disabled===""),isTargetSVG=n=>typeof SVGElement<"u"&&n instanceof SVGElement,resolveTarget=(n,t)=>{const r=n&&n.to;return isString$1(r)?t?t(r):null:r},TeleportImpl={name:"Teleport",__isTeleport:!0,process(n,t,r,s,i,o,l,f,u,g){const{mc:y,pc:a,pbc:m,o:{insert:_,querySelector:b,createText:c,createComment:w}}=g,S=isTeleportDisabled(t.props);let{shapeFlag:E,children:I,dynamicChildren:A}=t;if(n==null){const T=t.el=c(""),O=t.anchor=c("");_(T,r,s),_(O,r,s);const C=t.target=resolveTarget(t.props,b),k=t.targetAnchor=c("");C&&(_(k,C),l=l||isTargetSVG(C));const P=(N,L)=>{E&16&&y(I,N,L,i,o,l,f,u)};S?P(r,O):C&&P(C,k)}else{t.el=n.el;const T=t.anchor=n.anchor,O=t.target=n.target,C=t.targetAnchor=n.targetAnchor,k=isTeleportDisabled(n.props),P=k?r:O,N=k?T:C;if(l=l||isTargetSVG(O),A?(m(n.dynamicChildren,A,P,i,o,l,f),traverseStaticChildren(n,t,!0)):u||a(n,t,P,N,i,o,l,f,!1),S)k?t.props&&n.props&&t.props.to!==n.props.to&&(t.props.to=n.props.to):moveTeleport(t,r,T,g,1);else if((t.props&&t.props.to)!==(n.props&&n.props.to)){const L=t.target=resolveTarget(t.props,b);L&&moveTeleport(t,L,null,g,0)}else k&&moveTeleport(t,O,C,g,1)}updateCssVars(t)},remove(n,t,r,s,{um:i,o:{remove:o}},l){const{shapeFlag:f,children:u,anchor:g,targetAnchor:y,target:a,props:m}=n;if(a&&o(y),l&&o(g),f&16){const _=l||!isTeleportDisabled(m);for(let b=0;b<u.length;b++){const c=u[b];i(c,t,r,_,!!c.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(n,t,r,{o:{insert:s},m:i},o=2){o===0&&s(n.targetAnchor,t,r);const{el:l,anchor:f,shapeFlag:u,children:g,props:y}=n,a=o===2;if(a&&s(l,t,r),(!a||isTeleportDisabled(y))&&u&16)for(let m=0;m<g.length;m++)i(g[m],t,r,2);a&&s(f,t,r)}function hydrateTeleport(n,t,r,s,i,o,{o:{nextSibling:l,parentNode:f,querySelector:u}},g){const y=t.target=resolveTarget(t.props,u);if(y){const a=y._lpa||y.firstChild;if(t.shapeFlag&16)if(isTeleportDisabled(t.props))t.anchor=g(l(n),t,f(n),r,s,i,o),t.targetAnchor=a;else{t.anchor=l(n);let m=a;for(;m;)if(m=l(m),m&&m.nodeType===8&&m.data==="teleport anchor"){t.targetAnchor=m,y._lpa=t.targetAnchor&&l(t.targetAnchor);break}g(a,t,y,r,s,i,o)}updateCssVars(t)}return t.anchor&&l(t.anchor)}const Teleport=TeleportImpl;function updateCssVars(n){const t=n.ctx;if(t&&t.ut){let r=n.children[0].el;for(;r&&r!==n.targetAnchor;)r.nodeType===1&&r.setAttribute("data-v-owner",t.uid),r=r.nextSibling;t.ut()}}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(n=!1){blockStack.push(currentBlock=n?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(n){isBlockTreeEnabled+=n}function setupBlock(n){return n.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(n),n}function createElementBlock(n,t,r,s,i,o){return setupBlock(createBaseVNode(n,t,r,s,i,o,!0))}function createBlock(n,t,r,s,i){return setupBlock(createVNode(n,t,r,s,i,!0))}function isVNode(n){return n?n.__v_isVNode===!0:!1}function isSameVNodeType(n,t){return n.type===t.type&&n.key===t.key}const InternalObjectKey="__vInternal",normalizeKey=({key:n})=>n??null,normalizeRef=({ref:n,ref_key:t,ref_for:r})=>(typeof n=="number"&&(n=""+n),n!=null?isString$1(n)||isRef(n)||isFunction$1(n)?{i:currentRenderingInstance,r:n,k:t,f:!!r}:n:null);function createBaseVNode(n,t=null,r=null,s=0,i=null,o=n===Fragment?0:1,l=!1,f=!1){const u={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&normalizeKey(t),ref:t&&normalizeRef(t),scopeId:currentScopeId,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return f?(normalizeChildren(u,r),o&128&&n.normalize(u)):r&&(u.shapeFlag|=isString$1(r)?8:16),isBlockTreeEnabled>0&&!l&&currentBlock&&(u.patchFlag>0||o&6)&&u.patchFlag!==32&&currentBlock.push(u),u}const createVNode=_createVNode;function _createVNode(n,t=null,r=null,s=0,i=null,o=!1){if((!n||n===NULL_DYNAMIC_COMPONENT)&&(n=Comment),isVNode(n)){const f=cloneVNode(n,t,!0);return r&&normalizeChildren(f,r),isBlockTreeEnabled>0&&!o&&currentBlock&&(f.shapeFlag&6?currentBlock[currentBlock.indexOf(n)]=f:currentBlock.push(f)),f.patchFlag|=-2,f}if(isClassComponent(n)&&(n=n.__vccOpts),t){t=guardReactiveProps(t);let{class:f,style:u}=t;f&&!isString$1(f)&&(t.class=normalizeClass(f)),isObject$1(u)&&(isProxy(u)&&!isArray(u)&&(u=extend({},u)),t.style=normalizeStyle(u))}const l=isString$1(n)?1:isSuspense(n)?128:isTeleport(n)?64:isObject$1(n)?4:isFunction$1(n)?2:0;return createBaseVNode(n,t,r,s,i,l,o,!0)}function guardReactiveProps(n){return n?isProxy(n)||InternalObjectKey in n?extend({},n):n:null}function cloneVNode(n,t,r=!1){const{props:s,ref:i,patchFlag:o,children:l}=n,f=t?mergeProps(s||{},t):s;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:f,key:f&&normalizeKey(f),ref:t&&t.ref?r&&i?isArray(i)?i.concat(normalizeRef(t)):[i,normalizeRef(t)]:normalizeRef(t):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:l,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==Fragment?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&cloneVNode(n.ssContent),ssFallback:n.ssFallback&&cloneVNode(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function createTextVNode(n=" ",t=0){return createVNode(Text,null,n,t)}function createCommentVNode(n="",t=!1){return t?(openBlock(),createBlock(Comment,null,n)):createVNode(Comment,null,n)}function normalizeVNode(n){return n==null||typeof n=="boolean"?createVNode(Comment):isArray(n)?createVNode(Fragment,null,n.slice()):typeof n=="object"?cloneIfMounted(n):createVNode(Text,null,String(n))}function cloneIfMounted(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:cloneVNode(n)}function normalizeChildren(n,t){let r=0;const{shapeFlag:s}=n;if(t==null)t=null;else if(isArray(t))r=16;else if(typeof t=="object")if(s&65){const i=t.default;i&&(i._c&&(i._d=!1),normalizeChildren(n,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!(InternalObjectKey in t)?t._ctx=currentRenderingInstance:i===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else isFunction$1(t)?(t={default:t,_ctx:currentRenderingInstance},r=32):(t=String(t),s&64?(r=16,t=[createTextVNode(t)]):r=8);n.children=t,n.shapeFlag|=r}function mergeProps(...n){const t={};for(let r=0;r<n.length;r++){const s=n[r];for(const i in s)if(i==="class")t.class!==s.class&&(t.class=normalizeClass([t.class,s.class]));else if(i==="style")t.style=normalizeStyle([t.style,s.style]);else if(isOn(i)){const o=t[i],l=s[i];l&&o!==l&&!(isArray(o)&&o.includes(l))&&(t[i]=o?[].concat(o,l):l)}else i!==""&&(t[i]=s[i])}return t}function invokeVNodeHook(n,t,r,s=null){callWithAsyncErrorHandling(n,t,7,[r,s])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(n,t,r){const s=n.type,i=(t?t.appContext:n.appContext)||emptyAppContext,o={uid:uid++,vnode:n,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(s,i),emitsOptions:normalizeEmitsOptions(s,i),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:s.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=emit.bind(null,o),n.ce&&n.ce(o),o}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,globalCurrentInstanceSetters,settersKey="__VUE_INSTANCE_SETTERS__";(globalCurrentInstanceSetters=getGlobalThis()[settersKey])||(globalCurrentInstanceSetters=getGlobalThis()[settersKey]=[]),globalCurrentInstanceSetters.push(n=>currentInstance=n),internalSetCurrentInstance=n=>{globalCurrentInstanceSetters.length>1?globalCurrentInstanceSetters.forEach(t=>t(n)):globalCurrentInstanceSetters[0](n)};const setCurrentInstance=n=>{internalSetCurrentInstance(n),n.scope.on()},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(n){return n.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(n,t=!1){isInSSRComponentSetup=t;const{props:r,children:s}=n.vnode,i=isStatefulComponent(n);initProps(n,r,i,t),initSlots(n,s);const o=i?setupStatefulComponent(n,t):void 0;return isInSSRComponentSetup=!1,o}function setupStatefulComponent(n,t){const r=n.type;n.accessCache=Object.create(null),n.proxy=markRaw(new Proxy(n.ctx,PublicInstanceProxyHandlers));const{setup:s}=r;if(s){const i=n.setupContext=s.length>1?createSetupContext(n):null;setCurrentInstance(n),pauseTracking();const o=callWithErrorHandling(s,n,0,[n.props,i]);if(resetTracking(),unsetCurrentInstance(),isPromise$1(o)){if(o.then(unsetCurrentInstance,unsetCurrentInstance),t)return o.then(l=>{handleSetupResult(n,l,t)}).catch(l=>{handleError(l,n,0)});n.asyncDep=o}else handleSetupResult(n,o,t)}else finishComponentSetup(n,t)}function handleSetupResult(n,t,r){isFunction$1(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:isObject$1(t)&&(n.setupState=proxyRefs(t)),finishComponentSetup(n,r)}let compile;function finishComponentSetup(n,t,r){const s=n.type;if(!n.render){if(!t&&compile&&!s.render){const i=s.template||resolveMergedOptions(n).template;if(i){const{isCustomElement:o,compilerOptions:l}=n.appContext.config,{delimiters:f,compilerOptions:u}=s,g=extend(extend({isCustomElement:o,delimiters:f},l),u);s.render=compile(i,g)}}n.render=s.render||NOOP}{setCurrentInstance(n),pauseTracking();try{applyOptions(n)}finally{resetTracking(),unsetCurrentInstance()}}}function getAttrsProxy(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(t,r){return track(n,"get","$attrs"),t[r]}}))}function createSetupContext(n){const t=r=>{n.exposed=r||{}};return{get attrs(){return getAttrsProxy(n)},slots:n.slots,emit:n.emit,expose:t}}function getExposeProxy(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(proxyRefs(markRaw(n.exposed)),{get(t,r){if(r in t)return t[r];if(r in publicPropertiesMap)return publicPropertiesMap[r](n)},has(t,r){return r in t||r in publicPropertiesMap}}))}function getComponentName(n,t=!0){return isFunction$1(n)?n.displayName||n.name:n.name||t&&n.__name}function isClassComponent(n){return isFunction$1(n)&&"__vccOpts"in n}const computed=(n,t)=>computed$1(n,t,isInSSRComponentSetup);function h(n,t,r){const s=arguments.length;return s===2?isObject$1(t)&&!isArray(t)?isVNode(t)?createVNode(n,null,[t]):createVNode(n,t):createVNode(n,null,t):(s>3?r=Array.prototype.slice.call(arguments,2):s===3&&isVNode(r)&&(r=[r]),createVNode(n,t,r))}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey),version="3.3.11",svgNS="http://www.w3.org/2000/svg",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(n,t,r)=>{t.insertBefore(n,r||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,r,s)=>{const i=t?doc.createElementNS(svgNS,n):doc.createElement(n,r?{is:r}:void 0);return n==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:n=>doc.createTextNode(n),createComment:n=>doc.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>doc.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,r,s,i,o){const l=r?r.previousSibling:t.lastChild;if(i&&(i===o||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===o||!(i=i.nextSibling)););else{templateContainer.innerHTML=s?`<svg>${n}</svg>`:n;const f=templateContainer.content;if(s){const u=f.firstChild;for(;u.firstChild;)f.appendChild(u.firstChild);f.removeChild(u)}t.insertBefore(f,r)}return[l?l.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition=(n,{slots:t})=>h(BaseTransition,resolveTransitionProps(n),t);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Transition.props=extend({},BaseTransitionPropsValidators,DOMTransitionPropsValidators);const callHook=(n,t=[])=>{isArray(n)?n.forEach(r=>r(...t)):n&&n(...t)},hasExplicitCallback=n=>n?isArray(n)?n.some(t=>t.length>1):n.length>1:!1;function resolveTransitionProps(n){const t={};for(const F in n)F in DOMTransitionPropsValidators||(t[F]=n[F]);if(n.css===!1)return t;const{name:r="v",type:s,duration:i,enterFromClass:o=`${r}-enter-from`,enterActiveClass:l=`${r}-enter-active`,enterToClass:f=`${r}-enter-to`,appearFromClass:u=o,appearActiveClass:g=l,appearToClass:y=f,leaveFromClass:a=`${r}-leave-from`,leaveActiveClass:m=`${r}-leave-active`,leaveToClass:_=`${r}-leave-to`}=n,b=normalizeDuration(i),c=b&&b[0],w=b&&b[1],{onBeforeEnter:S,onEnter:E,onEnterCancelled:I,onLeave:A,onLeaveCancelled:T,onBeforeAppear:O=S,onAppear:C=E,onAppearCancelled:k=I}=t,P=(F,V,j)=>{removeTransitionClass(F,V?y:f),removeTransitionClass(F,V?g:l),j&&j()},N=(F,V)=>{F._isLeaving=!1,removeTransitionClass(F,a),removeTransitionClass(F,_),removeTransitionClass(F,m),V&&V()},L=F=>(V,j)=>{const K=F?C:E,U=()=>P(V,F,j);callHook(K,[V,U]),nextFrame(()=>{removeTransitionClass(V,F?u:o),addTransitionClass(V,F?y:f),hasExplicitCallback(K)||whenTransitionEnds(V,s,c,U)})};return extend(t,{onBeforeEnter(F){callHook(S,[F]),addTransitionClass(F,o),addTransitionClass(F,l)},onBeforeAppear(F){callHook(O,[F]),addTransitionClass(F,u),addTransitionClass(F,g)},onEnter:L(!1),onAppear:L(!0),onLeave(F,V){F._isLeaving=!0;const j=()=>N(F,V);addTransitionClass(F,a),forceReflow(),addTransitionClass(F,m),nextFrame(()=>{F._isLeaving&&(removeTransitionClass(F,a),addTransitionClass(F,_),hasExplicitCallback(A)||whenTransitionEnds(F,s,w,j))}),callHook(A,[F,j])},onEnterCancelled(F){P(F,!1),callHook(I,[F])},onAppearCancelled(F){P(F,!0),callHook(k,[F])},onLeaveCancelled(F){N(F),callHook(T,[F])}})}function normalizeDuration(n){if(n==null)return null;if(isObject$1(n))return[NumberOf(n.enter),NumberOf(n.leave)];{const t=NumberOf(n);return[t,t]}}function NumberOf(n){return toNumber(n)}function addTransitionClass(n,t){t.split(/\s+/).forEach(r=>r&&n.classList.add(r)),(n[vtcKey]||(n[vtcKey]=new Set)).add(t)}function removeTransitionClass(n,t){t.split(/\s+/).forEach(s=>s&&n.classList.remove(s));const r=n[vtcKey];r&&(r.delete(t),r.size||(n[vtcKey]=void 0))}function nextFrame(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let endId=0;function whenTransitionEnds(n,t,r,s){const i=n._endId=++endId,o=()=>{i===n._endId&&s()};if(r)return setTimeout(o,r);const{type:l,timeout:f,propCount:u}=getTransitionInfo(n,t);if(!l)return s();const g=l+"end";let y=0;const a=()=>{n.removeEventListener(g,m),o()},m=_=>{_.target===n&&++y>=u&&a()};setTimeout(()=>{y<u&&a()},f+1),n.addEventListener(g,m)}function getTransitionInfo(n,t){const r=window.getComputedStyle(n),s=b=>(r[b]||"").split(", "),i=s(`${TRANSITION}Delay`),o=s(`${TRANSITION}Duration`),l=getTimeout(i,o),f=s(`${ANIMATION}Delay`),u=s(`${ANIMATION}Duration`),g=getTimeout(f,u);let y=null,a=0,m=0;t===TRANSITION?l>0&&(y=TRANSITION,a=l,m=o.length):t===ANIMATION?g>0&&(y=ANIMATION,a=g,m=u.length):(a=Math.max(l,g),y=a>0?l>g?TRANSITION:ANIMATION:null,m=y?y===TRANSITION?o.length:u.length:0);const _=y===TRANSITION&&/\b(transform|all)(,|$)/.test(s(`${TRANSITION}Property`).toString());return{type:y,timeout:a,propCount:m,hasTransform:_}}function getTimeout(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((r,s)=>toMs(r)+toMs(n[s])))}function toMs(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(n,t,r){const s=n[vtcKey];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?n.removeAttribute("class"):r?n.setAttribute("class",t):n.className=t}const vShowOldKey=Symbol("_vod");function patchStyle(n,t,r){const s=n.style,i=isString$1(r);if(r&&!i){if(t&&!isString$1(t))for(const o in t)r[o]==null&&setStyle(s,o,"");for(const o in r)setStyle(s,o,r[o])}else{const o=s.display;i?t!==r&&(s.cssText=r):t&&n.removeAttribute("style"),vShowOldKey in n&&(s.display=o)}}const importantRE=/\s*!important$/;function setStyle(n,t,r){if(isArray(r))r.forEach(s=>setStyle(n,t,s));else if(r==null&&(r=""),t.startsWith("--"))n.setProperty(t,r);else{const s=autoPrefix(n,t);importantRE.test(r)?n.setProperty(hyphenate(s),r.replace(importantRE,""),"important"):n[s]=r}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(n,t){const r=prefixCache[t];if(r)return r;let s=camelize(t);if(s!=="filter"&&s in n)return prefixCache[t]=s;s=capitalize(s);for(let i=0;i<prefixes.length;i++){const o=prefixes[i]+s;if(o in n)return prefixCache[t]=o}return t}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(n,t,r,s,i){if(s&&t.startsWith("xlink:"))r==null?n.removeAttributeNS(xlinkNS,t.slice(6,t.length)):n.setAttributeNS(xlinkNS,t,r);else{const o=isSpecialBooleanAttr(t);r==null||o&&!includeBooleanAttr(r)?n.removeAttribute(t):n.setAttribute(t,o?"":r)}}function patchDOMProp(n,t,r,s,i,o,l){if(t==="innerHTML"||t==="textContent"){s&&l(s,i,o),n[t]=r??"";return}const f=n.tagName;if(t==="value"&&f!=="PROGRESS"&&!f.includes("-")){n._value=r;const g=f==="OPTION"?n.getAttribute("value"):n.value,y=r??"";g!==y&&(n.value=y),r==null&&n.removeAttribute(t);return}let u=!1;if(r===""||r==null){const g=typeof n[t];g==="boolean"?r=includeBooleanAttr(r):r==null&&g==="string"?(r="",u=!0):g==="number"&&(r=0,u=!0)}try{n[t]=r}catch{}u&&n.removeAttribute(t)}function addEventListener$1(n,t,r,s){n.addEventListener(t,r,s)}function removeEventListener$1(n,t,r,s){n.removeEventListener(t,r,s)}const veiKey=Symbol("_vei");function patchEvent(n,t,r,s,i=null){const o=n[veiKey]||(n[veiKey]={}),l=o[t];if(s&&l)l.value=s;else{const[f,u]=parseName(t);if(s){const g=o[t]=createInvoker(s,i);addEventListener$1(n,f,g,u)}else l&&(removeEventListener$1(n,f,l,u),o[t]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(n){let t;if(optionsModifierRE.test(n)){t={};let s;for(;s=n.match(optionsModifierRE);)n=n.slice(0,n.length-s[0].length),t[s[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):hyphenate(n.slice(2)),t]}let cachedNow=0;const p$1=Promise.resolve(),getNow=()=>cachedNow||(p$1.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(n,t){const r=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=r.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(s,r.value),t,5,[s])};return r.value=n,r.attached=getNow(),r}function patchStopImmediatePropagation(n,t){if(isArray(t)){const r=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{r.call(n),n._stopped=!0},t.map(s=>i=>!i._stopped&&s&&s(i))}else return t}const isNativeOn=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,patchProp=(n,t,r,s,i=!1,o,l,f,u)=>{t==="class"?patchClass(n,s,i):t==="style"?patchStyle(n,r,s):isOn(t)?isModelListener(t)||patchEvent(n,t,r,s,l):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):shouldSetAsProp(n,t,s,i))?patchDOMProp(n,t,s,o,l,f,u):(t==="true-value"?n._trueValue=s:t==="false-value"&&(n._falseValue=s),patchAttr(n,t,s,i))};function shouldSetAsProp(n,t,r,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in n&&isNativeOn(t)&&isFunction$1(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return isNativeOn(t)&&isString$1(r)?!1:t in n}const rendererOptions=extend({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...n)=>{const t=ensureRenderer().createApp(...n),{mount:r}=t;return t.mount=s=>{const i=normalizeContainer(s);if(!i)return;const o=t._component;!isFunction$1(o)&&!o.render&&!o.template&&(o.template=i.innerHTML),i.innerHTML="";const l=r(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),l},t};function normalizeContainer(n){return isString$1(n)?document.querySelector(n):n}var isVue2=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let activePinia;const setActivePinia=n=>activePinia=n,piniaSymbol=Symbol();function isPlainObject(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var MutationType;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(MutationType||(MutationType={}));function createPinia(){const n=effectScope(!0),t=n.run(()=>ref({}));let r=[],s=[];const i=markRaw({install(o){setActivePinia(i),i._a=o,o.provide(piniaSymbol,i),o.config.globalProperties.$pinia=i,s.forEach(l=>r.push(l)),s=[]},use(o){return!this._a&&!isVue2?s.push(o):r.push(o),this},_p:r,_a:null,_e:n,_s:new Map,state:t});return i}const noop=()=>{};function addSubscription(n,t,r,s=noop){n.push(t);const i=()=>{const o=n.indexOf(t);o>-1&&(n.splice(o,1),s())};return!r&&getCurrentScope()&&onScopeDispose(i),i}function triggerSubscriptions(n,...t){n.slice().forEach(r=>{r(...t)})}const fallbackRunWithContext=n=>n();function mergeReactiveObjects(n,t){n instanceof Map&&t instanceof Map&&t.forEach((r,s)=>n.set(s,r)),n instanceof Set&&t instanceof Set&&t.forEach(n.add,n);for(const r in t){if(!t.hasOwnProperty(r))continue;const s=t[r],i=n[r];isPlainObject(i)&&isPlainObject(s)&&n.hasOwnProperty(r)&&!isRef(s)&&!isReactive(s)?n[r]=mergeReactiveObjects(i,s):n[r]=s}return n}const skipHydrateSymbol=Symbol();function shouldHydrate(n){return!isPlainObject(n)||!n.hasOwnProperty(skipHydrateSymbol)}const{assign}=Object;function isComputed(n){return!!(isRef(n)&&n.effect)}function createOptionsStore(n,t,r,s){const{state:i,actions:o,getters:l}=t,f=r.state.value[n];let u;function g(){f||(r.state.value[n]=i?i():{});const y=toRefs(r.state.value[n]);return assign(y,o,Object.keys(l||{}).reduce((a,m)=>(a[m]=markRaw(computed(()=>{setActivePinia(r);const _=r._s.get(n);return l[m].call(_,_)})),a),{}))}return u=createSetupStore(n,g,t,r,s,!0),u}function createSetupStore(n,t,r={},s,i,o){let l;const f=assign({actions:{}},r),u={deep:!0};let g,y,a=[],m=[],_;const b=s.state.value[n];!o&&!b&&(s.state.value[n]={}),ref({});let c;function w(k){let P;g=y=!1,typeof k=="function"?(k(s.state.value[n]),P={type:MutationType.patchFunction,storeId:n,events:_}):(mergeReactiveObjects(s.state.value[n],k),P={type:MutationType.patchObject,payload:k,storeId:n,events:_});const N=c=Symbol();nextTick().then(()=>{c===N&&(g=!0)}),y=!0,triggerSubscriptions(a,P,s.state.value[n])}const S=o?function(){const{state:P}=r,N=P?P():{};this.$patch(L=>{assign(L,N)})}:noop;function E(){l.stop(),a=[],m=[],s._s.delete(n)}function I(k,P){return function(){setActivePinia(s);const N=Array.from(arguments),L=[],F=[];function V(U){L.push(U)}function j(U){F.push(U)}triggerSubscriptions(m,{args:N,name:k,store:T,after:V,onError:j});let K;try{K=P.apply(this&&this.$id===n?this:T,N)}catch(U){throw triggerSubscriptions(F,U),U}return K instanceof Promise?K.then(U=>(triggerSubscriptions(L,U),U)).catch(U=>(triggerSubscriptions(F,U),Promise.reject(U))):(triggerSubscriptions(L,K),K)}}const A={_p:s,$id:n,$onAction:addSubscription.bind(null,m),$patch:w,$reset:S,$subscribe(k,P={}){const N=addSubscription(a,k,P.detached,()=>L()),L=l.run(()=>watch(()=>s.state.value[n],F=>{(P.flush==="sync"?y:g)&&k({storeId:n,type:MutationType.direct,events:_},F)},assign({},u,P)));return N},$dispose:E},T=reactive(A);s._s.set(n,T);const C=(s._a&&s._a.runWithContext||fallbackRunWithContext)(()=>s._e.run(()=>(l=effectScope()).run(t)));for(const k in C){const P=C[k];if(isRef(P)&&!isComputed(P)||isReactive(P))o||(b&&shouldHydrate(P)&&(isRef(P)?P.value=b[k]:mergeReactiveObjects(P,b[k])),s.state.value[n][k]=P);else if(typeof P=="function"){const N=I(k,P);C[k]=N,f.actions[k]=P}}return assign(T,C),assign(toRaw(T),C),Object.defineProperty(T,"$state",{get:()=>s.state.value[n],set:k=>{w(P=>{assign(P,k)})}}),s._p.forEach(k=>{assign(T,l.run(()=>k({store:T,app:s._a,pinia:s,options:f})))}),b&&o&&r.hydrate&&r.hydrate(T.$state,b),g=!0,y=!0,T}function defineStore(n,t,r){let s,i;const o=typeof t=="function";typeof n=="string"?(s=n,i=o?r:t):(i=n,s=n.id);function l(f,u){const g=hasInjectionContext();return f=f||(g?inject(piniaSymbol,null):null),f&&setActivePinia(f),f=activePinia,f._s.has(s)||(o?createSetupStore(s,t,i,f):createOptionsStore(s,i,f)),f._s.get(s)}return l.$id=s,l}function _createForOfIteratorHelper$1(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=_unsupportedIterableToArray$2$1(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,i=function(){};return{s:i,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(g){throw g},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,f;return{s:function(){r=r.call(n)},n:function(){var g=r.next();return o=g.done,g},e:function(g){l=!0,f=g},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(l)throw f}}}}function _toConsumableArray$2$1(n){return _arrayWithoutHoles$2$1(n)||_iterableToArray$2$1(n)||_unsupportedIterableToArray$2$1(n)||_nonIterableSpread$2$1()}function _nonIterableSpread$2$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$2$1(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _arrayWithoutHoles$2$1(n){if(Array.isArray(n))return _arrayLikeToArray$2$1(n)}function _typeof$2$1(n){"@babel/helpers - typeof";return _typeof$2$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2$1(n)}function _slicedToArray$1$1(n,t){return _arrayWithHoles$1$1(n)||_iterableToArrayLimit$1$1(n,t)||_unsupportedIterableToArray$2$1(n,t)||_nonIterableRest$1$1()}function _nonIterableRest$1$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$2$1(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$2$1(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$2$1(n,t)}}function _arrayLikeToArray$2$1(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function _iterableToArrayLimit$1$1(n,t){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,i,o,l,f=[],u=!0,g=!1;try{if(o=(r=r.call(n)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(s=o.call(r)).done)&&(f.push(s.value),f.length!==t);u=!0);}catch(y){g=!0,i=y}finally{try{if(!u&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(g)throw i}}return f}}function _arrayWithHoles$1$1(n){if(Array.isArray(n))return n}var DomHandler={innerWidth:function(t){if(t){var r=t.offsetWidth,s=getComputedStyle(t);return r+=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),r}return 0},width:function(t){if(t){var r=t.offsetWidth,s=getComputedStyle(t);return r-=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),r}return 0},getWindowScrollTop:function(){var t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)},getWindowScrollLeft:function(){var t=document.documentElement;return(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)},getOuterWidth:function(t,r){if(t){var s=t.offsetWidth;if(r){var i=getComputedStyle(t);s+=parseFloat(i.marginLeft)+parseFloat(i.marginRight)}return s}return 0},getOuterHeight:function(t,r){if(t){var s=t.offsetHeight;if(r){var i=getComputedStyle(t);s+=parseFloat(i.marginTop)+parseFloat(i.marginBottom)}return s}return 0},getClientHeight:function(t,r){if(t){var s=t.clientHeight;if(r){var i=getComputedStyle(t);s+=parseFloat(i.marginTop)+parseFloat(i.marginBottom)}return s}return 0},getViewport:function(){var t=window,r=document,s=r.documentElement,i=r.getElementsByTagName("body")[0],o=t.innerWidth||s.clientWidth||i.clientWidth,l=t.innerHeight||s.clientHeight||i.clientHeight;return{width:o,height:l}},getOffset:function(t){if(t){var r=t.getBoundingClientRect();return{top:r.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:r.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}return{top:"auto",left:"auto"}},index:function(t){if(t)for(var r=t.parentNode.childNodes,s=0,i=0;i<r.length;i++){if(r[i]===t)return s;r[i].nodeType===1&&s++}return-1},addMultipleClasses:function(t,r){var s=this;t&&r&&[r].flat().filter(Boolean).forEach(function(i){return i.split(" ").forEach(function(o){return s.addClass(t,o)})})},removeMultipleClasses:function(t,r){var s=this;t&&r&&[r].flat().filter(Boolean).forEach(function(i){return i.split(" ").forEach(function(o){return s.removeClass(t,o)})})},addClass:function(t,r){t&&r&&!this.hasClass(t,r)&&(t.classList?t.classList.add(r):t.className+=" "+r)},removeClass:function(t,r){t&&r&&(t.classList?t.classList.remove(r):t.className=t.className.replace(new RegExp("(^|\\b)"+r.split(" ").join("|")+"(\\b|$)","gi")," "))},hasClass:function(t,r){return t?t.classList?t.classList.contains(r):new RegExp("(^| )"+r+"( |$)","gi").test(t.className):!1},addStyles:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t&&Object.entries(r).forEach(function(s){var i=_slicedToArray$1$1(s,2),o=i[0],l=i[1];return t.style[o]=l})},find:function(t,r){return this.isElement(t)?t.querySelectorAll(r):[]},findSingle:function(t,r){return this.isElement(t)?t.querySelector(r):null},createElement:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t){var s=document.createElement(t);this.setAttributes(s,r);for(var i=arguments.length,o=new Array(i>2?i-2:0),l=2;l<i;l++)o[l-2]=arguments[l];return s.append.apply(s,o),s}},setAttribute:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;this.isElement(t)&&s!==null&&s!==void 0&&t.setAttribute(r,s)},setAttributes:function(t){var r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.isElement(t)){var i=function o(l,f){var u,g,y=t!=null&&(u=t.$attrs)!==null&&u!==void 0&&u[l]?[t==null||(g=t.$attrs)===null||g===void 0?void 0:g[l]]:[];return[f].flat().reduce(function(a,m){if(m!=null){var _=_typeof$2$1(m);if(_==="string"||_==="number")a.push(m);else if(_==="object"){var b=Array.isArray(m)?o(l,m):Object.entries(m).map(function(c){var w=_slicedToArray$1$1(c,2),S=w[0],E=w[1];return l==="style"&&(E||E===0)?"".concat(S.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),":").concat(E):E?S:void 0});a=b.length?a.concat(b.filter(function(c){return!!c})):a}}return a},y)};Object.entries(s).forEach(function(o){var l=_slicedToArray$1$1(o,2),f=l[0],u=l[1];if(u!=null){var g=f.match(/^on(.+)/);g?t.addEventListener(g[1].toLowerCase(),u):f==="p-bind"?r.setAttributes(t,u):(u=f==="class"?_toConsumableArray$2$1(new Set(i("class",u))).join(" ").trim():f==="style"?i("style",u).join(";").trim():u,(t.$attrs=t.$attrs||{})&&(t.$attrs[f]=u),t.setAttribute(f,u))}})}},getAttribute:function(t,r){if(this.isElement(t)){var s=t.getAttribute(r);return isNaN(s)?s==="true"||s==="false"?s==="true":s:+s}},isAttributeEquals:function(t,r,s){return this.isElement(t)?this.getAttribute(t,r)===s:!1},isAttributeNotEquals:function(t,r,s){return!this.isAttributeEquals(t,r,s)},getHeight:function(t){if(t){var r=t.offsetHeight,s=getComputedStyle(t);return r-=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)+parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth),r}return 0},getWidth:function(t){if(t){var r=t.offsetWidth,s=getComputedStyle(t);return r-=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight)+parseFloat(s.borderLeftWidth)+parseFloat(s.borderRightWidth),r}return 0},absolutePosition:function(t,r){if(t){var s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),i=s.height,o=s.width,l=r.offsetHeight,f=r.offsetWidth,u=r.getBoundingClientRect(),g=this.getWindowScrollTop(),y=this.getWindowScrollLeft(),a=this.getViewport(),m,_;u.top+l+i>a.height?(m=u.top+g-i,t.style.transformOrigin="bottom",m<0&&(m=g)):(m=l+u.top+g,t.style.transformOrigin="top"),u.left+o>a.width?_=Math.max(0,u.left+y+f-o):_=u.left+y,t.style.top=m+"px",t.style.left=_+"px"}},relativePosition:function(t,r){if(t){var s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:this.getHiddenElementDimensions(t),i=r.offsetHeight,o=r.getBoundingClientRect(),l=this.getViewport(),f,u;o.top+i+s.height>l.height?(f=-1*s.height,t.style.transformOrigin="bottom",o.top+f<0&&(f=-1*o.top)):(f=i,t.style.transformOrigin="top"),s.width>l.width?u=o.left*-1:o.left+s.width>l.width?u=(o.left+s.width-l.width)*-1:u=0,t.style.top=f+"px",t.style.left=u+"px"}},nestedPosition:function(t,r){if(t){var s=t.parentElement,i=this.getOffset(s),o=this.getViewport(),l=t.offsetParent?t.offsetWidth:this.getHiddenElementOuterWidth(t),f=this.getOuterWidth(s.children[0]),u;parseInt(i.left,10)+f+l>o.width-this.calculateScrollbarWidth()?parseInt(i.left,10)<l?r%2===1?u=parseInt(i.left,10)?"-"+parseInt(i.left,10)+"px":"100%":r%2===0&&(u=o.width-l-this.calculateScrollbarWidth()+"px"):u="-100%":u="100%",t.style.top="0px",t.style.left=u}},getParents:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.parentNode===null?r:this.getParents(t.parentNode,r.concat([t.parentNode]))},getScrollableParents:function(t){var r=[];if(t){var s=this.getParents(t),i=/(auto|scroll)/,o=function(w){try{var S=window.getComputedStyle(w,null);return i.test(S.getPropertyValue("overflow"))||i.test(S.getPropertyValue("overflowX"))||i.test(S.getPropertyValue("overflowY"))}catch{return!1}},l=_createForOfIteratorHelper$1(s),f;try{for(l.s();!(f=l.n()).done;){var u=f.value,g=u.nodeType===1&&u.dataset.scrollselectors;if(g){var y=g.split(","),a=_createForOfIteratorHelper$1(y),m;try{for(a.s();!(m=a.n()).done;){var _=m.value,b=this.findSingle(u,_);b&&o(b)&&r.push(b)}}catch(c){a.e(c)}finally{a.f()}}u.nodeType!==9&&o(u)&&r.push(u)}}catch(c){l.e(c)}finally{l.f()}}return r},getHiddenElementOuterHeight:function(t){if(t){t.style.visibility="hidden",t.style.display="block";var r=t.offsetHeight;return t.style.display="none",t.style.visibility="visible",r}return 0},getHiddenElementOuterWidth:function(t){if(t){t.style.visibility="hidden",t.style.display="block";var r=t.offsetWidth;return t.style.display="none",t.style.visibility="visible",r}return 0},getHiddenElementDimensions:function(t){if(t){var r={};return t.style.visibility="hidden",t.style.display="block",r.width=t.offsetWidth,r.height=t.offsetHeight,t.style.display="none",t.style.visibility="visible",r}return 0},fadeIn:function(t,r){if(t){t.style.opacity=0;var s=+new Date,i=0,o=function l(){i=+t.style.opacity+(new Date().getTime()-s)/r,t.style.opacity=i,s=+new Date,+i<1&&(window.requestAnimationFrame&&requestAnimationFrame(l)||setTimeout(l,16))};o()}},fadeOut:function(t,r){if(t)var s=1,i=50,o=r,l=i/o,f=setInterval(function(){s-=l,s<=0&&(s=0,clearInterval(f)),t.style.opacity=s},i)},getUserAgent:function(){return navigator.userAgent},appendChild:function(t,r){if(this.isElement(r))r.appendChild(t);else if(r.el&&r.elElement)r.elElement.appendChild(t);else throw new Error("Cannot append "+r+" to "+t)},isElement:function(t){return(typeof HTMLElement>"u"?"undefined":_typeof$2$1(HTMLElement))==="object"?t instanceof HTMLElement:t&&_typeof$2$1(t)==="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName=="string"},scrollInView:function(t,r){var s=getComputedStyle(t).getPropertyValue("borderTopWidth"),i=s?parseFloat(s):0,o=getComputedStyle(t).getPropertyValue("paddingTop"),l=o?parseFloat(o):0,f=t.getBoundingClientRect(),u=r.getBoundingClientRect(),g=u.top+document.body.scrollTop-(f.top+document.body.scrollTop)-i-l,y=t.scrollTop,a=t.clientHeight,m=this.getOuterHeight(r);g<0?t.scrollTop=y+g:g+m>a&&(t.scrollTop=y+g-a+m)},clearSelection:function(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}},getSelection:function(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null},calculateScrollbarWidth:function(){if(this.calculatedScrollbarWidth!=null)return this.calculatedScrollbarWidth;var t=document.createElement("div");this.addStyles(t,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(t);var r=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),this.calculatedScrollbarWidth=r,r},calculateBodyScrollbarWidth:function(){return window.innerWidth-document.documentElement.offsetWidth},getBrowser:function(){if(!this.browser){var t=this.resolveUserAgent();this.browser={},t.browser&&(this.browser[t.browser]=!0,this.browser.version=t.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser},resolveUserAgent:function(){var t=navigator.userAgent.toLowerCase(),r=/(chrome)[ ]([\w.]+)/.exec(t)||/(webkit)[ ]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ ]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:r[1]||"",version:r[2]||"0"}},isVisible:function(t){return t&&t.offsetParent!=null},invokeElementMethod:function(t,r,s){t[r].apply(t,s)},isExist:function(t){return!!(t!==null&&typeof t<"u"&&t.nodeName&&t.parentNode)},isClient:function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)},focus:function(t,r){t&&document.activeElement!==t&&t.focus(r)},isFocusableElement:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.isElement(t)?t.matches('button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])'.concat(r,`,
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r)):!1},getFocusableElements:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=this.find(t,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])'.concat(r,`,
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r,`,
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(r)),i=[],o=_createForOfIteratorHelper$1(s),l;try{for(o.s();!(l=o.n()).done;){var f=l.value;getComputedStyle(f).display!="none"&&getComputedStyle(f).visibility!="hidden"&&i.push(f)}}catch(u){o.e(u)}finally{o.f()}return i},getFirstFocusableElement:function(t,r){var s=this.getFocusableElements(t,r);return s.length>0?s[0]:null},getLastFocusableElement:function(t,r){var s=this.getFocusableElements(t,r);return s.length>0?s[s.length-1]:null},getNextFocusableElement:function(t,r,s){var i=this.getFocusableElements(t,s),o=i.length>0?i.findIndex(function(f){return f===r}):-1,l=o>-1&&i.length>=o+1?o+1:-1;return l>-1?i[l]:null},getPreviousElementSibling:function(t,r){for(var s=t.previousElementSibling;s;){if(s.matches(r))return s;s=s.previousElementSibling}return null},getNextElementSibling:function(t,r){for(var s=t.nextElementSibling;s;){if(s.matches(r))return s;s=s.nextElementSibling}return null},isClickable:function(t){if(t){var r=t.nodeName,s=t.parentElement&&t.parentElement.nodeName;return r==="INPUT"||r==="TEXTAREA"||r==="BUTTON"||r==="A"||s==="INPUT"||s==="TEXTAREA"||s==="BUTTON"||s==="A"||!!t.closest(".p-button, .p-checkbox, .p-radiobutton")}return!1},applyStyle:function(t,r){if(typeof r=="string")t.style.cssText=r;else for(var s in r)t.style[s]=r[s]},isIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isAndroid:function(){return/(android)/i.test(navigator.userAgent)},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},hasCSSAnimation:function(t){if(t){var r=getComputedStyle(t),s=parseFloat(r.getPropertyValue("animation-duration")||"0");return s>0}return!1},hasCSSTransition:function(t){if(t){var r=getComputedStyle(t),s=parseFloat(r.getPropertyValue("transition-duration")||"0");return s>0}return!1},exportCSV:function(t,r){var s=new Blob([t],{type:"application/csv;charset=utf-8;"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(s,r+".csv");else{var i=document.createElement("a");i.download!==void 0?(i.setAttribute("href",URL.createObjectURL(s)),i.setAttribute("download",r+".csv"),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)):(t="data:text/csv;charset=utf-8,"+t,window.open(encodeURI(t)))}},blockBodyScroll:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"p-overflow-hidden";document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,t)},unblockBodyScroll:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"p-overflow-hidden";document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,t)}};function _typeof$1$2(n){"@babel/helpers - typeof";return _typeof$1$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1$2(n)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,_toPropertyKey$a(s.key),s)}}function _createClass(n,t,r){return t&&_defineProperties(n.prototype,t),r&&_defineProperties(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function _toPropertyKey$a(n){var t=_toPrimitive$a(n,"string");return _typeof$1$2(t)==="symbol"?t:String(t)}function _toPrimitive$a(n,t){if(_typeof$1$2(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$1$2(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var ConnectedOverlayScrollHandler=function(){function n(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};_classCallCheck(this,n),this.element=t,this.listener=r}return _createClass(n,[{key:"bindScrollListener",value:function(){this.scrollableParents=DomHandler.getScrollableParents(this.element);for(var r=0;r<this.scrollableParents.length;r++)this.scrollableParents[r].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var r=0;r<this.scrollableParents.length;r++)this.scrollableParents[r].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}]),n}();function primebus(){var n=new Map;return{on:function(r,s){var i=n.get(r);i?i.push(s):i=[s],n.set(r,i)},off:function(r,s){var i=n.get(r);i&&i.splice(i.indexOf(s)>>>0,1)},emit:function(r,s){var i=n.get(r);i&&i.slice().map(function(o){o(s)})}}}function _slicedToArray$2(n,t){return _arrayWithHoles$2(n)||_iterableToArrayLimit$2(n,t)||_unsupportedIterableToArray$1$1(n,t)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArrayLimit$2(n,t){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,i,o,l,f=[],u=!0,g=!1;try{if(o=(r=r.call(n)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(s=o.call(r)).done)&&(f.push(s.value),f.length!==t);u=!0);}catch(y){g=!0,i=y}finally{try{if(!u&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(g)throw i}}return f}}function _arrayWithHoles$2(n){if(Array.isArray(n))return n}function _toConsumableArray$1$1(n){return _arrayWithoutHoles$1$1(n)||_iterableToArray$1$1(n)||_unsupportedIterableToArray$1$1(n)||_nonIterableSpread$1$1()}function _nonIterableSpread$1$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$1$1(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _arrayWithoutHoles$1$1(n){if(Array.isArray(n))return _arrayLikeToArray$1$1(n)}function _createForOfIteratorHelper$2(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=_unsupportedIterableToArray$1$1(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,i=function(){};return{s:i,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(g){throw g},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,f;return{s:function(){r=r.call(n)},n:function(){var g=r.next();return o=g.done,g},e:function(g){l=!0,f=g},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(l)throw f}}}}function _unsupportedIterableToArray$1$1(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$1$1(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1$1(n,t)}}function _arrayLikeToArray$1$1(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function _typeof$a(n){"@babel/helpers - typeof";return _typeof$a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$a(n)}var ObjectUtils={equals:function(t,r,s){return s?this.resolveFieldData(t,s)===this.resolveFieldData(r,s):this.deepEquals(t,r)},deepEquals:function(t,r){if(t===r)return!0;if(t&&r&&_typeof$a(t)=="object"&&_typeof$a(r)=="object"){var s=Array.isArray(t),i=Array.isArray(r),o,l,f;if(s&&i){if(l=t.length,l!=r.length)return!1;for(o=l;o--!==0;)if(!this.deepEquals(t[o],r[o]))return!1;return!0}if(s!=i)return!1;var u=t instanceof Date,g=r instanceof Date;if(u!=g)return!1;if(u&&g)return t.getTime()==r.getTime();var y=t instanceof RegExp,a=r instanceof RegExp;if(y!=a)return!1;if(y&&a)return t.toString()==r.toString();var m=Object.keys(t);if(l=m.length,l!==Object.keys(r).length)return!1;for(o=l;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,m[o]))return!1;for(o=l;o--!==0;)if(f=m[o],!this.deepEquals(t[f],r[f]))return!1;return!0}return t!==t&&r!==r},resolveFieldData:function(t,r){if(!t||!r)return null;try{var s=t[r];if(this.isNotEmpty(s))return s}catch{}if(Object.keys(t).length){if(this.isFunction(r))return r(t);if(r.indexOf(".")===-1)return t[r];for(var i=r.split("."),o=t,l=0,f=i.length;l<f;++l){if(o==null)return null;o=o[i[l]]}return o}return null},getItemValue:function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return this.isFunction(t)?t.apply(void 0,s):t},filter:function(t,r,s){var i=[];if(t){var o=_createForOfIteratorHelper$2(t),l;try{for(o.s();!(l=o.n()).done;){var f=l.value,u=_createForOfIteratorHelper$2(r),g;try{for(u.s();!(g=u.n()).done;){var y=g.value;if(String(this.resolveFieldData(f,y)).toLowerCase().indexOf(s.toLowerCase())>-1){i.push(f);break}}}catch(a){u.e(a)}finally{u.f()}}}catch(a){o.e(a)}finally{o.f()}}return i},reorderArray:function(t,r,s){t&&r!==s&&(s>=t.length&&(s%=t.length,r%=t.length),t.splice(s,0,t.splice(r,1)[0]))},findIndexInList:function(t,r){var s=-1;if(r){for(var i=0;i<r.length;i++)if(r[i]===t){s=i;break}}return s},contains:function(t,r){if(t!=null&&r&&r.length){var s=_createForOfIteratorHelper$2(r),i;try{for(s.s();!(i=s.n()).done;){var o=i.value;if(this.equals(t,o))return!0}}catch(l){s.e(l)}finally{s.f()}}return!1},insertIntoOrderedArray:function(t,r,s,i){if(s.length>0){for(var o=!1,l=0;l<s.length;l++){var f=this.findIndexInList(s[l],i);if(f>r){s.splice(l,0,t),o=!0;break}}o||s.push(t)}else s.push(t)},removeAccents:function(t){return t&&t.search(/[\xC0-\xFF]/g)>-1&&(t=t.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),t},getVNodeProp:function(t,r){var s=t.props;if(s){var i=r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=Object.prototype.hasOwnProperty.call(s,i)?i:r;return t.type.extends.props[r].type===Boolean&&s[o]===""?!0:s[o]}return null},toFlatCase:function(t){return this.isString(t)?t.replace(/(-|_)/g,"").toLowerCase():t},toKebabCase:function(t){return this.isString(t)?t.replace(/(_)/g,"-").replace(/[A-Z]/g,function(r,s){return s===0?r:"-"+r.toLowerCase()}).toLowerCase():t},toCapitalCase:function(t){return this.isString(t,{empty:!1})?t[0].toUpperCase()+t.slice(1):t},isEmpty:function(t){return t==null||t===""||Array.isArray(t)&&t.length===0||!(t instanceof Date)&&_typeof$a(t)==="object"&&Object.keys(t).length===0},isNotEmpty:function(t){return!this.isEmpty(t)},isFunction:function(t){return!!(t&&t.constructor&&t.call&&t.apply)},isObject:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t instanceof Object&&t.constructor===Object&&(r||Object.keys(t).length!==0)},isDate:function(t){return t instanceof Date&&t.constructor===Date},isArray:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Array.isArray(t)&&(r||t.length!==0)},isString:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return typeof t=="string"&&(r||t!=="")},isPrintableCharacter:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return this.isNotEmpty(t)&&t.length===1&&t.match(/\S| /)},findLast:function(t,r){var s;if(this.isNotEmpty(t))try{s=t.findLast(r)}catch{s=_toConsumableArray$1$1(t).reverse().find(r)}return s},findLastIndex:function(t,r){var s=-1;if(this.isNotEmpty(t))try{s=t.findLastIndex(r)}catch{s=t.lastIndexOf(_toConsumableArray$1$1(t).reverse().find(r))}return s},sort:function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,l=this.compare(t,r,i,s),f=s;return(this.isEmpty(t)||this.isEmpty(r))&&(f=o===1?s:o),f*l},compare:function(t,r,s){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=-1,l=this.isEmpty(t),f=this.isEmpty(r);return l&&f?o=0:l?o=i:f?o=-i:typeof t=="string"&&typeof r=="string"?o=s(t,r):o=t<r?-1:t>r?1:0,o},localeComparator:function(){return new Intl.Collator(void 0,{numeric:!0}).compare},nestedKeys:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return Object.entries(r).reduce(function(i,o){var l=_slicedToArray$2(o,2),f=l[0],u=l[1],g=s?"".concat(s,".").concat(f):f;return t.isObject(u)?i=i.concat(t.nestedKeys(u,g)):i.push(g),i},[])}},lastId=0;function UniqueComponentId(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pv_id_";return lastId++,"".concat(n).concat(lastId)}function _toConsumableArray$3(n){return _arrayWithoutHoles$3(n)||_iterableToArray$3(n)||_unsupportedIterableToArray$6(n)||_nonIterableSpread$3()}function _nonIterableSpread$3(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$6(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$6(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$6(n,t)}}function _iterableToArray$3(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _arrayWithoutHoles$3(n){if(Array.isArray(n))return _arrayLikeToArray$6(n)}function _arrayLikeToArray$6(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function handler(){var n=[],t=function(f,u){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:999,y=i(f,u,g),a=y.value+(y.key===f?0:g)+1;return n.push({key:f,value:a}),a},r=function(f){n=n.filter(function(u){return u.value!==f})},s=function(f,u){return i(f,u).value},i=function(f,u){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return _toConsumableArray$3(n).reverse().find(function(y){return u?!0:y.key===f})||{key:f,value:g}},o=function(f){return f&&parseInt(f.style.zIndex,10)||0};return{get:o,set:function(f,u,g){u&&(u.style.zIndex=String(t(f,!0,g)))},clear:function(f){f&&(r(o(f)),f.style.zIndex="")},getCurrent:function(f){return s(f,!0)}}}var ZIndexUtils=handler(),FilterMatchMode={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",IN:"in",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",BETWEEN:"between",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"};function _createForOfIteratorHelper(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=_unsupportedIterableToArray$5(n))||t&&n&&typeof n.length=="number"){r&&(n=r);var s=0,i=function(){};return{s:i,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(g){throw g},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,f;return{s:function(){r=r.call(n)},n:function(){var g=r.next();return o=g.done,g},e:function(g){l=!0,f=g},f:function(){try{!o&&r.return!=null&&r.return()}finally{if(l)throw f}}}}function _unsupportedIterableToArray$5(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$5(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$5(n,t)}}function _arrayLikeToArray$5(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}var FilterService={filter:function(t,r,s,i,o){var l=[];if(!t)return l;var f=_createForOfIteratorHelper(t),u;try{for(f.s();!(u=f.n()).done;){var g=u.value;if(typeof g=="string"){if(this.filters[i](g,s,o)){l.push(g);continue}}else{var y=_createForOfIteratorHelper(r),a;try{for(y.s();!(a=y.n()).done;){var m=a.value,_=ObjectUtils.resolveFieldData(g,m);if(this.filters[i](_,s,o)){l.push(g);break}}}catch(b){y.e(b)}finally{y.f()}}}}catch(b){f.e(b)}finally{f.f()}return l},filters:{startsWith:function(t,r,s){if(r==null||r.trim()==="")return!0;if(t==null)return!1;var i=ObjectUtils.removeAccents(r.toString()).toLocaleLowerCase(s),o=ObjectUtils.removeAccents(t.toString()).toLocaleLowerCase(s);return o.slice(0,i.length)===i},contains:function(t,r,s){if(r==null||typeof r=="string"&&r.trim()==="")return!0;if(t==null)return!1;var i=ObjectUtils.removeAccents(r.toString()).toLocaleLowerCase(s),o=ObjectUtils.removeAccents(t.toString()).toLocaleLowerCase(s);return o.indexOf(i)!==-1},notContains:function(t,r,s){if(r==null||typeof r=="string"&&r.trim()==="")return!0;if(t==null)return!1;var i=ObjectUtils.removeAccents(r.toString()).toLocaleLowerCase(s),o=ObjectUtils.removeAccents(t.toString()).toLocaleLowerCase(s);return o.indexOf(i)===-1},endsWith:function(t,r,s){if(r==null||r.trim()==="")return!0;if(t==null)return!1;var i=ObjectUtils.removeAccents(r.toString()).toLocaleLowerCase(s),o=ObjectUtils.removeAccents(t.toString()).toLocaleLowerCase(s);return o.indexOf(i,o.length-i.length)!==-1},equals:function(t,r,s){return r==null||typeof r=="string"&&r.trim()===""?!0:t==null?!1:t.getTime&&r.getTime?t.getTime()===r.getTime():ObjectUtils.removeAccents(t.toString()).toLocaleLowerCase(s)==ObjectUtils.removeAccents(r.toString()).toLocaleLowerCase(s)},notEquals:function(t,r,s){return r==null||typeof r=="string"&&r.trim()===""?!1:t==null?!0:t.getTime&&r.getTime?t.getTime()!==r.getTime():ObjectUtils.removeAccents(t.toString()).toLocaleLowerCase(s)!=ObjectUtils.removeAccents(r.toString()).toLocaleLowerCase(s)},in:function(t,r){if(r==null||r.length===0)return!0;for(var s=0;s<r.length;s++)if(ObjectUtils.equals(t,r[s]))return!0;return!1},between:function(t,r){return r==null||r[0]==null||r[1]==null?!0:t==null?!1:t.getTime?r[0].getTime()<=t.getTime()&&t.getTime()<=r[1].getTime():r[0]<=t&&t<=r[1]},lt:function(t,r){return r==null?!0:t==null?!1:t.getTime&&r.getTime?t.getTime()<r.getTime():t<r},lte:function(t,r){return r==null?!0:t==null?!1:t.getTime&&r.getTime?t.getTime()<=r.getTime():t<=r},gt:function(t,r){return r==null?!0:t==null?!1:t.getTime&&r.getTime?t.getTime()>r.getTime():t>r},gte:function(t,r){return r==null?!0:t==null?!1:t.getTime&&r.getTime?t.getTime()>=r.getTime():t>=r},dateIs:function(t,r){return r==null?!0:t==null?!1:t.toDateString()===r.toDateString()},dateIsNot:function(t,r){return r==null?!0:t==null?!1:t.toDateString()!==r.toDateString()},dateBefore:function(t,r){return r==null?!0:t==null?!1:t.getTime()<r.getTime()},dateAfter:function(t,r){return r==null?!0:t==null?!1:t.getTime()>r.getTime()}},register:function(t,r){this.filters[t]=r}};function _typeof$9(n){"@babel/helpers - typeof";return _typeof$9=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$9(n)}function ownKeys$8(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$8(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$8(Object(r),!0).forEach(function(s){_defineProperty$9(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$8(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$9(n,t,r){return t=_toPropertyKey$9(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$9(n){var t=_toPrimitive$9(n,"string");return _typeof$9(t)==="symbol"?t:String(t)}function _toPrimitive$9(n,t){if(_typeof$9(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$9(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var defaultOptions={ripple:!1,inputStyle:"outlined",locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"Page {page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}},filterMatchModeOptions:{text:[FilterMatchMode.STARTS_WITH,FilterMatchMode.CONTAINS,FilterMatchMode.NOT_CONTAINS,FilterMatchMode.ENDS_WITH,FilterMatchMode.EQUALS,FilterMatchMode.NOT_EQUALS],numeric:[FilterMatchMode.EQUALS,FilterMatchMode.NOT_EQUALS,FilterMatchMode.LESS_THAN,FilterMatchMode.LESS_THAN_OR_EQUAL_TO,FilterMatchMode.GREATER_THAN,FilterMatchMode.GREATER_THAN_OR_EQUAL_TO],date:[FilterMatchMode.DATE_IS,FilterMatchMode.DATE_IS_NOT,FilterMatchMode.DATE_BEFORE,FilterMatchMode.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},unstyled:!1,csp:{nonce:void 0}},PrimeVueSymbol=Symbol();function switchTheme(n,t,r,s){if(n!==t){var i=document.getElementById(r),o=i.cloneNode(!0),l=i.getAttribute("href").replace(n,t);o.setAttribute("id",r+"-clone"),o.setAttribute("href",l),o.addEventListener("load",function(){i.remove(),o.setAttribute("id",r),s&&s()}),i.parentNode&&i.parentNode.insertBefore(o,i.nextSibling)}}var PrimeVue={install:function(t,r){var s=r?_objectSpread$8(_objectSpread$8({},defaultOptions),r):_objectSpread$8({},defaultOptions),i={config:reactive(s),changeTheme:switchTheme};t.config.globalProperties.$primevue=i,t.provide(PrimeVueSymbol,i)}};function _typeof$8(n){"@babel/helpers - typeof";return _typeof$8=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$8(n)}function ownKeys$7(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$7(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$7(Object(r),!0).forEach(function(s){_defineProperty$8(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$7(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$8(n,t,r){return t=_toPropertyKey$8(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$8(n){var t=_toPrimitive$8(n,"string");return _typeof$8(t)==="symbol"?t:String(t)}function _toPrimitive$8(n,t){if(_typeof$8(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$8(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function tryOnMounted(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;getCurrentInstance()?onMounted(n):t?n():nextTick(n)}var _id=0;function useStyle(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=ref(!1),s=ref(n),i=ref(null),o=DomHandler.isClient()?window.document:void 0,l=t.document,f=l===void 0?o:l,u=t.immediate,g=u===void 0?!0:u,y=t.manual,a=y===void 0?!1:y,m=t.name,_=m===void 0?"style_".concat(++_id):m,b=t.id,c=b===void 0?void 0:b,w=t.media,S=w===void 0?void 0:w,E=t.nonce,I=E===void 0?void 0:E,A=t.props,T=A===void 0?{}:A,O=function(){},C=function(N){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(f){var F=_objectSpread$7(_objectSpread$7({},T),L),V=F.name||_,j=F.id||c,K=F.nonce||I;i.value=f.querySelector('style[data-primevue-style-id="'.concat(V,'"]'))||f.getElementById(j)||f.createElement("style"),i.value.isConnected||(s.value=N||n,DomHandler.setAttributes(i.value,{type:"text/css",id:j,media:S,nonce:K}),f.head.appendChild(i.value),DomHandler.setAttribute(i.value,"data-primevue-style-id",_),DomHandler.setAttributes(i.value,F)),!r.value&&(O=watch(s,function(U){i.value.textContent=U},{immediate:!0}),r.value=!0)}},k=function(){!f||!r.value||(O(),DomHandler.isExist(i.value)&&f.head.removeChild(i.value),r.value=!1)};return g&&!a&&tryOnMounted(C),{id:c,name:_,css:s,unload:k,load:C,isLoaded:readonly(r)}}function _typeof$7(n){"@babel/helpers - typeof";return _typeof$7=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$7(n)}function _slicedToArray$1(n,t){return _arrayWithHoles$1(n)||_iterableToArrayLimit$1(n,t)||_unsupportedIterableToArray$4(n,t)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$4(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$4(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$4(n,t)}}function _arrayLikeToArray$4(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function _iterableToArrayLimit$1(n,t){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,i,o,l,f=[],u=!0,g=!1;try{if(o=(r=r.call(n)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(s=o.call(r)).done)&&(f.push(s.value),f.length!==t);u=!0);}catch(y){g=!0,i=y}finally{try{if(!u&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(g)throw i}}return f}}function _arrayWithHoles$1(n){if(Array.isArray(n))return n}function ownKeys$6(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$6(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$6(Object(r),!0).forEach(function(s){_defineProperty$7(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$6(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$7(n,t,r){return t=_toPropertyKey$7(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$7(n){var t=_toPrimitive$7(n,"string");return _typeof$7(t)==="symbol"?t:String(t)}function _toPrimitive$7(n,t){if(_typeof$7(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$7(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var css$7=`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
}

.p-hidden-accessible input,
.p-hidden-accessible select {
    transform: scale(0);
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: var(--scrollbar-width);
}
`,classes$6={},inlineStyles={},BaseStyle={name:"base",css:css$7,classes:classes$6,inlineStyles,loadStyle:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.css?useStyle(this.css,_objectSpread$6({name:this.name},t)):{}},getStyleSheet:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var s=Object.entries(r).reduce(function(i,o){var l=_slicedToArray$1(o,2),f=l[0],u=l[1];return i.push("".concat(f,'="').concat(u,'"'))&&i},[]).join(" ");return'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(s,">").concat(this.css).concat(t,"</style>")}return""},extend:function(t){return _objectSpread$6(_objectSpread$6({},this),{},{css:void 0},t)}},css$6=`
@layer primevue {
    .p-badge {
        display: inline-block;
        border-radius: 10px;
        text-align: center;
        padding: 0 .5rem;
    }

    .p-overlay-badge {
        position: relative;
    }

    .p-overlay-badge .p-badge {
        position: absolute;
        top: 0;
        right: 0;
        transform: translate(50%,-50%);
        transform-origin: 100% 0;
        margin: 0;
    }

    .p-badge-dot {
        width: .5rem;
        min-width: .5rem;
        height: .5rem;
        border-radius: 50%;
        padding: 0;
    }

    .p-badge-no-gutter {
        padding: 0;
        border-radius: 50%;
    }
}
`,classes$5={root:function(t){var r=t.props,s=t.instance;return["p-badge p-component",{"p-badge-no-gutter":ObjectUtils.isNotEmpty(r.value)&&String(r.value).length===1,"p-badge-dot":ObjectUtils.isEmpty(r.value)&&!s.$slots.default,"p-badge-lg":r.size==="large","p-badge-xl":r.size==="xlarge","p-badge-info":r.severity==="info","p-badge-success":r.severity==="success","p-badge-warning":r.severity==="warning","p-badge-danger":r.severity==="danger"}]}},BadgeStyle=BaseStyle.extend({name:"badge",css:css$6,classes:classes$5});function _typeof$1$1(n){"@babel/helpers - typeof";return _typeof$1$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1$1(n)}function ownKeys$1$1(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$1$1(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$1$1(Object(r),!0).forEach(function(s){_defineProperty$1$1(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$1$1(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$1$1(n,t,r){return t=_toPropertyKey$1$1(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$1$1(n){var t=_toPrimitive$1$1(n,"string");return _typeof$1$1(t)==="symbol"?t:String(t)}function _toPrimitive$1$1(n,t){if(_typeof$1$1(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$1$1(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var buttonCSS=`
.p-button {
    display: inline-flex;
    cursor: pointer;
    user-select: none;
    align-items: center;
    vertical-align: bottom;
    text-align: center;
    overflow: hidden;
    position: relative;
}

.p-button-label {
    flex: 1 1 auto;
}

.p-button-icon-right {
    order: 1;
}

.p-button:disabled {
    cursor: default;
}

.p-button-icon-only {
    justify-content: center;
}

.p-button-icon-only .p-button-label {
    visibility: hidden;
    width: 0;
    flex: 0 0 auto;
}

.p-button-vertical {
    flex-direction: column;
}

.p-button-icon-bottom {
    order: 2;
}

.p-buttonset .p-button {
    margin: 0;
}

.p-buttonset .p-button:not(:last-child), .p-buttonset .p-button:not(:last-child):hover {
    border-right: 0 none;
}

.p-buttonset .p-button:not(:first-of-type):not(:last-of-type) {
    border-radius: 0;
}

.p-buttonset .p-button:first-of-type:not(:only-of-type) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.p-buttonset .p-button:last-of-type:not(:only-of-type) {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}

.p-buttonset .p-button:focus {
    position: relative;
    z-index: 1;
}
`,checkboxCSS=`
.p-checkbox {
    display: inline-flex;
    cursor: pointer;
    user-select: none;
    vertical-align: bottom;
    position: relative;
}

.p-checkbox.p-checkbox-disabled {
    cursor: default;
}

.p-checkbox-box {
    display: flex;
    justify-content: center;
    align-items: center;
}
`,inputTextCSS=`
.p-fluid .p-inputtext {
    width: 100%;
}

/* InputGroup */
.p-inputgroup {
    display: flex;
    align-items: stretch;
    width: 100%;
}

.p-inputgroup-addon {
    display: flex;
    align-items: center;
    justify-content: center;
}

.p-inputgroup .p-float-label {
    display: flex;
    align-items: stretch;
    width: 100%;
}

.p-inputgroup .p-inputtext,
.p-fluid .p-inputgroup .p-inputtext,
.p-inputgroup .p-inputwrapper,
.p-fluid .p-inputgroup .p-input {
    flex: 1 1 auto;
    width: 1%;
}

/* Floating Label */
.p-float-label {
    display: block;
    position: relative;
}

.p-float-label label {
    position: absolute;
    pointer-events: none;
    top: 50%;
    margin-top: -.5rem;
    transition-property: all;
    transition-timing-function: ease;
    line-height: 1;
}

.p-float-label textarea ~ label {
    top: 1rem;
}

.p-float-label input:focus ~ label,
.p-float-label input.p-filled ~ label,
.p-float-label input:-webkit-autofill ~ label,
.p-float-label textarea:focus ~ label,
.p-float-label textarea.p-filled ~ label,
.p-float-label .p-inputwrapper-focus ~ label,
.p-float-label .p-inputwrapper-filled ~ label {
    top: -.75rem;
    font-size: 12px;
}


.p-float-label .p-placeholder,
.p-float-label input::placeholder,
.p-float-label .p-inputtext::placeholder {
    opacity: 0;
    transition-property: all;
    transition-timing-function: ease;
}

.p-float-label .p-focus .p-placeholder,
.p-float-label input:focus::placeholder,
.p-float-label .p-inputtext:focus::placeholder {
    opacity: 1;
    transition-property: all;
    transition-timing-function: ease;
}

.p-input-icon-left,
.p-input-icon-right {
    position: relative;
    display: inline-block;
}

.p-input-icon-left > i,
.p-input-icon-left > svg,
.p-input-icon-right > i,
.p-input-icon-right > svg {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}

.p-fluid .p-input-icon-left,
.p-fluid .p-input-icon-right {
    display: block;
    width: 100%;
}
`,radioButtonCSS=`
.p-radiobutton {
    position: relative;
    display: inline-flex;
    cursor: pointer;
    user-select: none;
    vertical-align: bottom;
}

.p-radiobutton.p-radiobutton-disabled {
    cursor: default;
}

.p-radiobutton-box {
    display: flex;
    justify-content: center;
    align-items: center;
}

.p-radiobutton-icon {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transform: translateZ(0) scale(.1);
    border-radius: 50%;
    visibility: hidden;
}

.p-radiobutton-box.p-highlight .p-radiobutton-icon {
    transform: translateZ(0) scale(1.0, 1.0);
    visibility: visible;
}
`,css$5=`
@layer primevue {
.p-component, .p-component * {
    box-sizing: border-box;
}

.p-hidden-space {
    visibility: hidden;
}

.p-reset {
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
    text-decoration: none;
    font-size: 100%;
    list-style: none;
}

.p-disabled, .p-disabled * {
    cursor: default !important;
    pointer-events: none;
    user-select: none;
}

.p-component-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-unselectable-text {
    user-select: none;
}

.p-sr-only {
    border: 0;
    clip: rect(1px, 1px, 1px, 1px);
    clip-path: inset(50%);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
    word-wrap: normal !important;
}

.p-link {
	text-align: left;
	background-color: transparent;
	margin: 0;
	padding: 0;
	border: none;
    cursor: pointer;
    user-select: none;
}

.p-link:disabled {
	cursor: default;
}

/* Non vue overlay animations */
.p-connected-overlay {
    opacity: 0;
    transform: scaleY(0.8);
    transition: transform .12s cubic-bezier(0, 0, 0.2, 1), opacity .12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-visible {
    opacity: 1;
    transform: scaleY(1);
}

.p-connected-overlay-hidden {
    opacity: 0;
    transform: scaleY(1);
    transition: opacity .1s linear;
}

/* Vue based overlay animations */
.p-connected-overlay-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-connected-overlay-leave-to {
    opacity: 0;
}

.p-connected-overlay-enter-active {
    transition: transform .12s cubic-bezier(0, 0, 0.2, 1), opacity .12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-leave-active {
    transition: opacity .1s linear;
}

/* Toggleable Content */
.p-toggleable-content-enter-from,
.p-toggleable-content-leave-to {
    max-height: 0;
}

.p-toggleable-content-enter-to,
.p-toggleable-content-leave-from {
    max-height: 1000px;
}

.p-toggleable-content-leave-active {
    overflow: hidden;
    transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);
}

.p-toggleable-content-enter-active {
    overflow: hidden;
    transition: max-height 1s ease-in-out;
}
`.concat(buttonCSS,`
`).concat(checkboxCSS,`
`).concat(inputTextCSS,`
`).concat(radioButtonCSS,`
}
`),BaseComponentStyle=BaseStyle.extend({name:"common",css:css$5,loadGlobalStyle:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return useStyle(t,_objectSpread$1$1({name:"global"},r))}});function _typeof$6(n){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$6(n)}function ownKeys$5(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$5(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$5(Object(r),!0).forEach(function(s){_defineProperty$6(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$5(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$6(n,t,r){return t=_toPropertyKey$6(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$6(n){var t=_toPrimitive$6(n,"string");return _typeof$6(t)==="symbol"?t:String(t)}function _toPrimitive$6(n,t){if(_typeof$6(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$6(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var script$f={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(t){if(!t){var r,s;BaseComponentStyle.loadStyle({nonce:(r=this.$config)===null||r===void 0||(r=r.csp)===null||r===void 0?void 0:r.nonce}),this.$options.style&&this.$style.loadStyle({nonce:(s=this.$config)===null||s===void 0||(s=s.csp)===null||s===void 0?void 0:s.nonce})}}}},beforeCreate:function(){var t,r,s,i,o,l,f,u,g,y,a,m=(t=this.pt)===null||t===void 0?void 0:t._usept,_=m?(r=this.pt)===null||r===void 0||(r=r.originalValue)===null||r===void 0?void 0:r[this.$.type.name]:void 0,b=m?(s=this.pt)===null||s===void 0||(s=s.value)===null||s===void 0?void 0:s[this.$.type.name]:this.pt;(i=b||_)===null||i===void 0||(i=i.hooks)===null||i===void 0||(o=i.onBeforeCreate)===null||o===void 0||o.call(i);var c=(l=this.$config)===null||l===void 0||(l=l.pt)===null||l===void 0?void 0:l._usept,w=c?(f=this.$primevue)===null||f===void 0||(f=f.config)===null||f===void 0||(f=f.pt)===null||f===void 0?void 0:f.originalValue:void 0,S=c?(u=this.$primevue)===null||u===void 0||(u=u.config)===null||u===void 0||(u=u.pt)===null||u===void 0?void 0:u.value:(g=this.$primevue)===null||g===void 0||(g=g.config)===null||g===void 0?void 0:g.pt;(y=S||w)===null||y===void 0||(y=y[this.$.type.name])===null||y===void 0||(y=y.hooks)===null||y===void 0||(a=y.onBeforeCreate)===null||a===void 0||a.call(y)},created:function(){this._hook("onCreated")},beforeMount:function(){var t;BaseStyle.loadStyle({nonce:(t=this.$config)===null||t===void 0||(t=t.csp)===null||t===void 0?void 0:t.nonce}),this._loadGlobalStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._hook("onUnmounted")},methods:{_hook:function(t){if(!this.$options.hostName){var r=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(t)),s=this._useDefaultPT(this._getOptionValue,"hooks.".concat(t));r==null||r(),s==null||s()}},_loadGlobalStyles:function(){var t,r=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);ObjectUtils.isNotEmpty(r)&&BaseComponentStyle.loadGlobalStyle(r,{nonce:(t=this.$config)===null||t===void 0||(t=t.csp)===null||t===void 0?void 0:t.nonce})},_getHostInstance:function(t){return t?this.$options.hostName?t.$.type.name===this.$options.hostName?t:this._getHostInstance(t.$parentInstance):t.$parentInstance:void 0},_getPropValue:function(t){var r;return this[t]||((r=this._getHostInstance(this))===null||r===void 0?void 0:r[t])},_getOptionValue:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=ObjectUtils.toFlatCase(r).split("."),o=i.shift();return o?ObjectUtils.isObject(t)?this._getOptionValue(ObjectUtils.getItemValue(t[Object.keys(t).find(function(l){return ObjectUtils.toFlatCase(l)===o})||""],s),i.join("."),s):void 0:ObjectUtils.getItemValue(t,s)},_getPTValue:function(){var t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,l="data-pc-",f=/./g.test(s)&&!!i[s.split(".")[0]],u=this._getPropValue("ptOptions")||((t=this.$config)===null||t===void 0?void 0:t.ptOptions)||{},g=u.mergeSections,y=g===void 0?!0:g,a=u.mergeProps,m=a===void 0?!1:a,_=o?f?this._useGlobalPT(this._getPTClassValue,s,i):this._useDefaultPT(this._getPTClassValue,s,i):void 0,b=f?void 0:this._usePT(this._getPT(r,this.$name),this._getPTClassValue,s,_objectSpread$5(_objectSpread$5({},i),{},{global:_||{}})),c=s!=="transition"&&_objectSpread$5(_objectSpread$5({},s==="root"&&_defineProperty$6({},"".concat(l,"name"),ObjectUtils.toFlatCase(this.$.type.name))),{},_defineProperty$6({},"".concat(l,"section"),ObjectUtils.toFlatCase(s)));return y||!y&&b?m?mergeProps(_,b,c):_objectSpread$5(_objectSpread$5(_objectSpread$5({},_),b),c):_objectSpread$5(_objectSpread$5({},b),c)},_getPTClassValue:function(){var t=this._getOptionValue.apply(this,arguments);return ObjectUtils.isString(t)||ObjectUtils.isArray(t)?{class:t}:t},_getPT:function(t){var r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,o=function(f){var u,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=i?i(f):f,a=ObjectUtils.toFlatCase(s),m=ObjectUtils.toFlatCase(r.$name);return(u=g?a!==m?y==null?void 0:y[a]:void 0:y==null?void 0:y[a])!==null&&u!==void 0?u:y};return t!=null&&t.hasOwnProperty("_usept")?{_usept:t._usept,originalValue:o(t.originalValue),value:o(t.value)}:o(t,!0)},_usePT:function(t,r,s,i){var o=function(c){return r(c,s,i)};if(t!=null&&t.hasOwnProperty("_usept")){var l,f=t._usept||((l=this.$config)===null||l===void 0?void 0:l.ptOptions)||{},u=f.mergeSections,g=u===void 0?!0:u,y=f.mergeProps,a=y===void 0?!1:y,m=o(t.originalValue),_=o(t.value);return m===void 0&&_===void 0?void 0:ObjectUtils.isString(_)?_:ObjectUtils.isString(m)?m:g||!g&&_?a?mergeProps(m,_):_objectSpread$5(_objectSpread$5({},m),_):_}return o(t)},_useGlobalPT:function(t,r,s){return this._usePT(this.globalPT,t,r,s)},_useDefaultPT:function(t,r,s){return this._usePT(this.defaultPT,t,r,s)},ptm:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,t,_objectSpread$5(_objectSpread$5({},this.$params),r))},ptmo:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(t,r,_objectSpread$5({instance:this},s),!1)},cx:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,t,_objectSpread$5(_objectSpread$5({},this.$params),r))},sx:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(r){var i=this._getOptionValue(this.$style.inlineStyles,t,_objectSpread$5(_objectSpread$5({},this.$params),s)),o=this._getOptionValue(BaseComponentStyle.inlineStyles,t,_objectSpread$5(_objectSpread$5({},this.$params),s));return[o,i]}}},computed:{globalPT:function(){var t,r=this;return this._getPT((t=this.$config)===null||t===void 0?void 0:t.pt,void 0,function(s){return ObjectUtils.getItemValue(s,{instance:r})})},defaultPT:function(){var t,r=this;return this._getPT((t=this.$config)===null||t===void 0?void 0:t.pt,void 0,function(s){return r._getOptionValue(s,r.$name,_objectSpread$5({},r.$params))||ObjectUtils.getItemValue(s,_objectSpread$5({},r.$params))})},isUnstyled:function(){var t;return this.unstyled!==void 0?this.unstyled:(t=this.$config)===null||t===void 0?void 0:t.unstyled},$params:function(){var t=this.$parentInstance||this.$parent;return{instance:this,props:this.$props,state:this.$data,parent:{instance:t,props:t==null?void 0:t.$props,state:t==null?void 0:t.$data},parentInstance:t}},$style:function(){return _objectSpread$5(_objectSpread$5({classes:void 0,inlineStyles:void 0,loadStyle:function(){},loadCustomStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$config:function(){var t;return(t=this.$primevue)===null||t===void 0?void 0:t.config},$name:function(){return this.$options.hostName||this.$.type.name}}},script$1$5={name:"BaseBadge",extends:script$f,props:{value:{type:[String,Number],default:null},severity:{type:String,default:null},size:{type:String,default:null}},style:BadgeStyle,provide:function(){return{$parentInstance:this}}},script$e={name:"Badge",extends:script$1$5};function render$c(n,t,r,s,i,o){return openBlock(),createElementBlock("span",mergeProps({class:n.cx("root")},n.ptm("root"),{"data-pc-name":"badge"}),[renderSlot(n.$slots,"default",{},function(){return[createTextVNode(toDisplayString(n.value),1)]})],16)}script$e.render=render$c;var css$4=`
.p-icon {
    display: inline-block;
}

.p-icon-spin {
    -webkit-animation: p-icon-spin 2s infinite linear;
    animation: p-icon-spin 2s infinite linear;
}

@-webkit-keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}

@keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}
`,BaseIconStyle=BaseStyle.extend({name:"baseicon",css:css$4}),script$d={name:"BaseIcon",extends:script$f,props:{label:{type:String,default:void 0},spin:{type:Boolean,default:!1}},style:BaseIconStyle,beforeMount:function(){var t;BaseIconStyle.loadStyle({nonce:(t=this.$config)===null||t===void 0||(t=t.csp)===null||t===void 0?void 0:t.nonce})},methods:{pti:function(){var t=ObjectUtils.isEmpty(this.label);return{class:["p-icon",{"p-icon-spin":this.spin}],role:t?void 0:"img","aria-label":t?void 0:this.label,"aria-hidden":t}}},computed:{$config:function(){var t;return(t=this.$primevue)===null||t===void 0?void 0:t.config}}},script$c={name:"SpinnerIcon",extends:script$d,computed:{pathId:function(){return"pv_icon_clip_".concat(UniqueComponentId())}}},_hoisted_1$f=["clipPath"],_hoisted_2$b=createBaseVNode("path",{d:"M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z",fill:"currentColor"},null,-1),_hoisted_3$6=[_hoisted_2$b],_hoisted_4$4=["id"],_hoisted_5$4=createBaseVNode("rect",{width:"14",height:"14",fill:"white"},null,-1),_hoisted_6$4=[_hoisted_5$4];function render$b(n,t,r,s,i,o){return openBlock(),createElementBlock("svg",mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.pti()),[createBaseVNode("g",{clipPath:"url(#".concat(o.pathId,")")},_hoisted_3$6,8,_hoisted_1$f),createBaseVNode("defs",null,[createBaseVNode("clipPath",{id:"".concat(o.pathId)},_hoisted_6$4,8,_hoisted_4$4)])],16)}script$c.render=render$b;function _typeof$5(n){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$5(n)}function _slicedToArray(n,t){return _arrayWithHoles(n)||_iterableToArrayLimit(n,t)||_unsupportedIterableToArray$3(n,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$3(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$3(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$3(n,t)}}function _arrayLikeToArray$3(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function _iterableToArrayLimit(n,t){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var s,i,o,l,f=[],u=!0,g=!1;try{if(o=(r=r.call(n)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(s=o.call(r)).done)&&(f.push(s.value),f.length!==t);u=!0);}catch(y){g=!0,i=y}finally{try{if(!u&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(g)throw i}}return f}}function _arrayWithHoles(n){if(Array.isArray(n))return n}function ownKeys$4(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$4(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$4(Object(r),!0).forEach(function(s){_defineProperty$5(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$4(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$5(n,t,r){return t=_toPropertyKey$5(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$5(n){var t=_toPrimitive$5(n,"string");return _typeof$5(t)==="symbol"?t:String(t)}function _toPrimitive$5(n,t){if(_typeof$5(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$5(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var BaseDirective={_getMeta:function(){return[ObjectUtils.isObject(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],ObjectUtils.getItemValue(ObjectUtils.isObject(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(t,r){var s,i,o;return(s=(t==null||(i=t.instance)===null||i===void 0?void 0:i.$primevue)||(r==null||(o=r.ctx)===null||o===void 0||(o=o.appContext)===null||o===void 0||(o=o.config)===null||o===void 0||(o=o.globalProperties)===null||o===void 0?void 0:o.$primevue))===null||s===void 0?void 0:s.config},_getOptionValue:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=ObjectUtils.toFlatCase(r).split("."),o=i.shift();return o?ObjectUtils.isObject(t)?BaseDirective._getOptionValue(ObjectUtils.getItemValue(t[Object.keys(t).find(function(l){return ObjectUtils.toFlatCase(l)===o})||""],s),i.join("."),s):void 0:ObjectUtils.getItemValue(t,s)},_getPTValue:function(){var t,r,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=function(){var I=BaseDirective._getOptionValue.apply(BaseDirective,arguments);return ObjectUtils.isString(I)||ObjectUtils.isArray(I)?{class:I}:I},g="data-pc-",y=((t=s.binding)===null||t===void 0||(t=t.value)===null||t===void 0?void 0:t.ptOptions)||((r=s.$config)===null||r===void 0?void 0:r.ptOptions)||{},a=y.mergeSections,m=a===void 0?!0:a,_=y.mergeProps,b=_===void 0?!1:_,c=f?BaseDirective._useDefaultPT(s,s.defaultPT(),u,o,l):void 0,w=BaseDirective._usePT(s,BaseDirective._getPT(i,s.$name),u,o,_objectSpread$4(_objectSpread$4({},l),{},{global:c||{}})),S=_objectSpread$4(_objectSpread$4({},o==="root"&&_defineProperty$5({},"".concat(g,"name"),ObjectUtils.toFlatCase(s.$name))),{},_defineProperty$5({},"".concat(g,"section"),ObjectUtils.toFlatCase(o)));return m||!m&&w?b?mergeProps(c,w,S):_objectSpread$4(_objectSpread$4(_objectSpread$4({},c),w),S):_objectSpread$4(_objectSpread$4({},w),S)},_getPT:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0,i=function(l){var f,u=s?s(l):l,g=ObjectUtils.toFlatCase(r);return(f=u==null?void 0:u[g])!==null&&f!==void 0?f:u};return t!=null&&t.hasOwnProperty("_usept")?{_usept:t._usept,originalValue:i(t.originalValue),value:i(t.value)}:i(t)},_usePT:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,l=function(w){return s(w,i,o)};if(r!=null&&r.hasOwnProperty("_usept")){var f,u=r._usept||((f=t.$config)===null||f===void 0?void 0:f.ptOptions)||{},g=u.mergeSections,y=g===void 0?!0:g,a=u.mergeProps,m=a===void 0?!1:a,_=l(r.originalValue),b=l(r.value);return _===void 0&&b===void 0?void 0:ObjectUtils.isString(b)?b:ObjectUtils.isString(_)?_:y||!y&&b?m?mergeProps(_,b):_objectSpread$4(_objectSpread$4({},_),b):b}return l(r)},_useDefaultPT:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return BaseDirective._usePT(t,r,s,i,o)},_hook:function(t,r,s,i,o,l){var f,u,g="on".concat(ObjectUtils.toCapitalCase(r)),y=BaseDirective._getConfig(i,o),a=s==null?void 0:s.$instance,m=BaseDirective._usePT(a,BaseDirective._getPT(i==null||(f=i.value)===null||f===void 0?void 0:f.pt,t),BaseDirective._getOptionValue,"hooks.".concat(g)),_=BaseDirective._useDefaultPT(a,y==null||(u=y.pt)===null||u===void 0||(u=u.directives)===null||u===void 0?void 0:u[t],BaseDirective._getOptionValue,"hooks.".concat(g)),b={el:s,binding:i,vnode:o,prevVnode:l};m==null||m(a,b),_==null||_(a,b)},_extend:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=function(o,l,f,u,g){var y,a;l._$instances=l._$instances||{};var m=BaseDirective._getConfig(f,u),_=l._$instances[t]||{},b=ObjectUtils.isEmpty(_)?_objectSpread$4(_objectSpread$4({},r),r==null?void 0:r.methods):{};l._$instances[t]=_objectSpread$4(_objectSpread$4({},_),{},{$name:t,$host:l,$binding:f,$modifiers:f==null?void 0:f.modifiers,$value:f==null?void 0:f.value,$el:_.$el||l||void 0,$style:_objectSpread$4({classes:void 0,inlineStyles:void 0,loadStyle:function(){}},r==null?void 0:r.style),$config:m,defaultPT:function(){return BaseDirective._getPT(m==null?void 0:m.pt,void 0,function(w){var S;return w==null||(S=w.directives)===null||S===void 0?void 0:S[t]})},isUnstyled:function(){var w,S;return((w=l.$instance)===null||w===void 0||(w=w.$binding)===null||w===void 0||(w=w.value)===null||w===void 0?void 0:w.unstyled)!==void 0?(S=l.$instance)===null||S===void 0||(S=S.$binding)===null||S===void 0||(S=S.value)===null||S===void 0?void 0:S.unstyled:m==null?void 0:m.unstyled},ptm:function(){var w,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return BaseDirective._getPTValue(l.$instance,(w=l.$instance)===null||w===void 0||(w=w.$binding)===null||w===void 0||(w=w.value)===null||w===void 0?void 0:w.pt,S,_objectSpread$4({},E))},ptmo:function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return BaseDirective._getPTValue(l.$instance,w,S,E,!1)},cx:function(){var w,S,E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(w=l.$instance)!==null&&w!==void 0&&w.isUnstyled()?void 0:BaseDirective._getOptionValue((S=l.$instance)===null||S===void 0||(S=S.$style)===null||S===void 0?void 0:S.classes,E,_objectSpread$4({},I))},sx:function(){var w,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return E?BaseDirective._getOptionValue((w=l.$instance)===null||w===void 0||(w=w.$style)===null||w===void 0?void 0:w.inlineStyles,S,_objectSpread$4({},I)):void 0}},b),l.$instance=l._$instances[t],(y=(a=l.$instance)[o])===null||y===void 0||y.call(a,l,f,u,g),BaseDirective._hook(t,o,l,f,u,g)};return{created:function(o,l,f,u){s("created",o,l,f,u)},beforeMount:function(o,l,f,u){var g,y,a,m,_=BaseDirective._getConfig(l,f);BaseStyle.loadStyle(void 0,{nonce:_==null||(g=_.csp)===null||g===void 0?void 0:g.nonce}),!((y=o.$instance)!==null&&y!==void 0&&y.isUnstyled())&&((a=o.$instance)===null||a===void 0||(a=a.$style)===null||a===void 0||a.loadStyle(void 0,{nonce:_==null||(m=_.csp)===null||m===void 0?void 0:m.nonce})),s("beforeMount",o,l,f,u)},mounted:function(o,l,f,u){s("mounted",o,l,f,u)},beforeUpdate:function(o,l,f,u){s("beforeUpdate",o,l,f,u)},updated:function(o,l,f,u){s("updated",o,l,f,u)},beforeUnmount:function(o,l,f,u){s("beforeUnmount",o,l,f,u)},unmounted:function(o,l,f,u){s("unmounted",o,l,f,u)}}},extend:function(){var t=BaseDirective._getMeta.apply(BaseDirective,arguments),r=_slicedToArray(t,2),s=r[0],i=r[1];return _objectSpread$4({extend:function(){var l=BaseDirective._getMeta.apply(BaseDirective,arguments),f=_slicedToArray(l,2),u=f[0],g=f[1];return BaseDirective.extend(u,_objectSpread$4(_objectSpread$4(_objectSpread$4({},i),i==null?void 0:i.methods),g))}},BaseDirective._extend(s,i))}},css$3=`
@keyframes ripple {
    100% {
        opacity: 0;
        transform: scale(2.5);
    }
}

@layer primevue {
    .p-ripple {
        overflow: hidden;
        position: relative;
    }

    .p-ink {
        display: block;
        position: absolute;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 100%;
        transform: scale(0);
        pointer-events: none;
    }

    .p-ink-active {
        animation: ripple 0.4s linear;
    }

    .p-ripple-disabled .p-ink {
        display: none !important;
    }
}
`,classes$4={root:"p-ink"},RippleStyle=BaseStyle.extend({name:"ripple",css:css$3,classes:classes$4}),BaseRipple=BaseDirective.extend({style:RippleStyle});function _toConsumableArray$2(n){return _arrayWithoutHoles$2(n)||_iterableToArray$2(n)||_unsupportedIterableToArray$2(n)||_nonIterableSpread$2()}function _nonIterableSpread$2(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$2(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$2(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$2(n,t)}}function _iterableToArray$2(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _arrayWithoutHoles$2(n){if(Array.isArray(n))return _arrayLikeToArray$2(n)}function _arrayLikeToArray$2(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}var Ripple=BaseRipple.extend("ripple",{mounted:function(t){var r,s=t==null||(r=t.$instance)===null||r===void 0?void 0:r.$config;s&&s.ripple&&(this.create(t),this.bindEvents(t),t.setAttribute("data-pd-ripple",!0))},unmounted:function(t){this.remove(t)},timeout:void 0,methods:{bindEvents:function(t){t.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(t){t.removeEventListener("mousedown",this.onMouseDown.bind(this))},create:function(t){var r=DomHandler.createElement("span",{role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this),"p-bind":this.ptm("root")});t.appendChild(r),this.$el=r},remove:function(t){var r=this.getInk(t);r&&(this.unbindEvents(t),r.removeEventListener("animationend",this.onAnimationEnd),r.remove())},onMouseDown:function(t){var r=this,s=t.currentTarget,i=this.getInk(s);if(!(!i||getComputedStyle(i,null).display==="none")){if(!this.isUnstyled()&&DomHandler.removeClass(i,"p-ink-active"),i.setAttribute("data-p-ink-active","false"),!DomHandler.getHeight(i)&&!DomHandler.getWidth(i)){var o=Math.max(DomHandler.getOuterWidth(s),DomHandler.getOuterHeight(s));i.style.height=o+"px",i.style.width=o+"px"}var l=DomHandler.getOffset(s),f=t.pageX-l.left+document.body.scrollTop-DomHandler.getWidth(i)/2,u=t.pageY-l.top+document.body.scrollLeft-DomHandler.getHeight(i)/2;i.style.top=u+"px",i.style.left=f+"px",!this.isUnstyled()&&DomHandler.addClass(i,"p-ink-active"),i.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){i&&(!r.isUnstyled()&&DomHandler.removeClass(i,"p-ink-active"),i.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(t){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&DomHandler.removeClass(t.currentTarget,"p-ink-active"),t.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(t){return t&&t.children?_toConsumableArray$2(t.children).find(function(r){return DomHandler.getAttribute(r,"data-pc-name")==="ripple"}):void 0}}});function _typeof$4(n){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$4(n)}function _defineProperty$4(n,t,r){return t=_toPropertyKey$4(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$4(n){var t=_toPrimitive$4(n,"string");return _typeof$4(t)==="symbol"?t:String(t)}function _toPrimitive$4(n,t){if(_typeof$4(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$4(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var classes$3={root:function(t){var r=t.instance,s=t.props;return["p-button p-component",_defineProperty$4(_defineProperty$4(_defineProperty$4(_defineProperty$4(_defineProperty$4(_defineProperty$4(_defineProperty$4(_defineProperty$4({"p-button-icon-only":r.hasIcon&&!s.label&&!s.badge,"p-button-vertical":(s.iconPos==="top"||s.iconPos==="bottom")&&s.label,"p-disabled":r.$attrs.disabled||r.$attrs.disabled===""||s.loading,"p-button-loading":s.loading,"p-button-loading-label-only":s.loading&&!r.hasIcon&&s.label,"p-button-link":s.link},"p-button-".concat(s.severity),s.severity),"p-button-raised",s.raised),"p-button-rounded",s.rounded),"p-button-text",s.text),"p-button-outlined",s.outlined),"p-button-sm",s.size==="small"),"p-button-lg",s.size==="large"),"p-button-plain",s.plain)]},loadingIcon:"p-button-loading-icon pi-spin",icon:function(t){var r=t.props;return["p-button-icon",{"p-button-icon-left":r.iconPos==="left"&&r.label,"p-button-icon-right":r.iconPos==="right"&&r.label,"p-button-icon-top":r.iconPos==="top"&&r.label,"p-button-icon-bottom":r.iconPos==="bottom"&&r.label}]},label:"p-button-label"},ButtonStyle=BaseStyle.extend({name:"button",classes:classes$3}),script$1$4={name:"BaseButton",extends:script$f,props:{label:{type:String,default:null},icon:{type:String,default:null},iconPos:{type:String,default:"left"},iconClass:{type:String,default:null},badge:{type:String,default:null},badgeClass:{type:String,default:null},badgeSeverity:{type:String,default:null},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},link:{type:Boolean,default:!1},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},plain:{type:Boolean,default:!1}},style:ButtonStyle,provide:function(){return{$parentInstance:this}}},script$b={name:"Button",extends:script$1$4,methods:{getPTOptions:function(t){return this.ptm(t,{context:{disabled:this.disabled}})}},computed:{disabled:function(){return this.$attrs.disabled||this.$attrs.disabled===""||this.loading},defaultAriaLabel:function(){return this.label?this.label+(this.badge?" "+this.badge:""):this.$attrs.ariaLabel},hasIcon:function(){return this.icon||this.$slots.icon}},components:{SpinnerIcon:script$c,Badge:script$e},directives:{ripple:Ripple}},_hoisted_1$e=["aria-label","disabled","data-pc-severity"];function render$a(n,t,r,s,i,o){var l=resolveComponent("SpinnerIcon"),f=resolveComponent("Badge"),u=resolveDirective("ripple");return withDirectives((openBlock(),createElementBlock("button",mergeProps({class:n.cx("root"),type:"button","aria-label":o.defaultAriaLabel,disabled:o.disabled},o.getPTOptions("root"),{"data-pc-name":"button","data-pc-severity":n.severity}),[renderSlot(n.$slots,"default",{},function(){return[n.loading?renderSlot(n.$slots,"loadingicon",{key:0,class:normalizeClass([n.cx("loadingIcon"),n.cx("icon")])},function(){return[n.loadingIcon?(openBlock(),createElementBlock("span",mergeProps({key:0,class:[n.cx("loadingIcon"),n.cx("icon"),n.loadingIcon]},n.ptm("loadingIcon")),null,16)):(openBlock(),createBlock(l,mergeProps({key:1,class:[n.cx("loadingIcon"),n.cx("icon")],spin:""},n.ptm("loadingIcon")),null,16,["class"]))]}):renderSlot(n.$slots,"icon",{key:1,class:normalizeClass([n.cx("icon")])},function(){return[n.icon?(openBlock(),createElementBlock("span",mergeProps({key:0,class:[n.cx("icon"),n.icon,n.iconClass]},n.ptm("icon")),null,16)):createCommentVNode("",!0)]}),createBaseVNode("span",mergeProps({class:n.cx("label")},n.ptm("label")),toDisplayString(n.label||" "),17),n.badge?(openBlock(),createBlock(f,mergeProps({key:2,value:n.badge,class:n.badgeClass,severity:n.badgeSeverity,unstyled:n.unstyled},n.ptm("badge")),null,16,["value","class","severity","unstyled"])):createCommentVNode("",!0)]})],16,_hoisted_1$e)),[[u]])}script$b.render=render$a;var script$a={name:"AngleDownIcon",extends:script$d},_hoisted_1$d=createBaseVNode("path",{d:"M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z",fill:"currentColor"},null,-1),_hoisted_2$a=[_hoisted_1$d];function render$9(n,t,r,s,i,o){return openBlock(),createElementBlock("svg",mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.pti()),_hoisted_2$a,16)}script$a.render=render$9;var script$9={name:"AngleUpIcon",extends:script$d},_hoisted_1$c=createBaseVNode("path",{d:"M10.4134 9.49931C10.3148 9.49977 10.2172 9.48055 10.1262 9.44278C10.0352 9.405 9.95263 9.34942 9.88338 9.27931L6.88338 6.27931L3.88338 9.27931C3.73811 9.34946 3.57409 9.3709 3.41567 9.34044C3.25724 9.30999 3.11286 9.22926 3.00395 9.11025C2.89504 8.99124 2.82741 8.84028 2.8111 8.67978C2.79478 8.51928 2.83065 8.35781 2.91338 8.21931L6.41338 4.71931C6.55401 4.57886 6.74463 4.49997 6.94338 4.49997C7.14213 4.49997 7.33276 4.57886 7.47338 4.71931L10.9734 8.21931C11.1138 8.35994 11.1927 8.55056 11.1927 8.74931C11.1927 8.94806 11.1138 9.13868 10.9734 9.27931C10.9007 9.35315 10.8132 9.41089 10.7168 9.44879C10.6203 9.48669 10.5169 9.5039 10.4134 9.49931Z",fill:"currentColor"},null,-1),_hoisted_2$9=[_hoisted_1$c];function render$8(n,t,r,s,i,o){return openBlock(),createElementBlock("svg",mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.pti()),_hoisted_2$9,16)}script$9.render=render$8;var classes$2={root:function(t){var r=t.instance,s=t.props;return["p-inputtext p-component",{"p-filled":r.filled,"p-inputtext-sm":s.size==="small","p-inputtext-lg":s.size==="large"}]}},InputTextStyle=BaseStyle.extend({name:"inputtext",classes:classes$2}),script$1$3={name:"BaseInputText",extends:script$f,props:{modelValue:null,size:{type:String,default:null}},style:InputTextStyle,provide:function(){return{$parentInstance:this}}},script$8={name:"InputText",extends:script$1$3,emits:["update:modelValue"],methods:{getPTOptions:function(t){return this.ptm(t,{context:{filled:this.filled,disabled:this.$attrs.disabled||this.$attrs.disabled===""}})},onInput:function(t){this.$emit("update:modelValue",t.target.value)}},computed:{filled:function(){return this.modelValue!=null&&this.modelValue.toString().length>0}}},_hoisted_1$b=["value"];function render$7(n,t,r,s,i,o){return openBlock(),createElementBlock("input",mergeProps({class:n.cx("root"),value:n.modelValue,onInput:t[0]||(t[0]=function(){return o.onInput&&o.onInput.apply(o,arguments)})},o.getPTOptions("root"),{"data-pc-name":"inputtext"}),null,16,_hoisted_1$b)}script$8.render=render$7;var css$2=`
@layer primevue {
    .p-inputnumber {
        display: inline-flex;
    }

    .p-inputnumber-button {
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
    }

    .p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,
    .p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label {
        display: none;
    }

    .p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        padding: 0;
    }

    .p-inputnumber-buttons-stacked .p-inputnumber-input {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    .p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down {
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border-bottom-left-radius: 0;
        padding: 0;
    }

    .p-inputnumber-buttons-stacked .p-inputnumber-button-group {
        display: flex;
        flex-direction: column;
    }

    .p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button {
        flex: 1 1 auto;
    }

    .p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up {
        order: 3;
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    .p-inputnumber-buttons-horizontal .p-inputnumber-input {
        order: 2;
        border-radius: 0;
    }

    .p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down {
        order: 1;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    .p-inputnumber-buttons-vertical {
        flex-direction: column;
    }

    .p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up {
        order: 1;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        width: 100%;
    }

    .p-inputnumber-buttons-vertical .p-inputnumber-input {
        order: 2;
        border-radius: 0;
        text-align: center;
    }

    .p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down {
        order: 3;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        width: 100%;
    }

    .p-inputnumber-input {
        flex: 1 1 auto;
    }

    .p-fluid .p-inputnumber {
        width: 100%;
    }

    .p-fluid .p-inputnumber .p-inputnumber-input {
        width: 1%;
    }

    .p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input {
        width: 100%;
    }
}
`,classes$1={root:function(t){var r=t.instance,s=t.props;return["p-inputnumber p-component p-inputwrapper",{"p-inputwrapper-filled":r.filled||s.allowEmpty===!1,"p-inputwrapper-focus":r.focused,"p-inputnumber-buttons-stacked":s.showButtons&&s.buttonLayout==="stacked","p-inputnumber-buttons-horizontal":s.showButtons&&s.buttonLayout==="horizontal","p-inputnumber-buttons-vertical":s.showButtons&&s.buttonLayout==="vertical"}]},input:"p-inputnumber-input",buttonGroup:"p-inputnumber-button-group",incrementButton:function(t){var r=t.instance,s=t.props;return["p-inputnumber-button p-inputnumber-button-up",{"p-disabled":s.showButtons&&s.max!==null&&r.maxBoundry()}]},decrementButton:function(t){var r=t.instance,s=t.props;return["p-inputnumber-button p-inputnumber-button-down",{"p-disabled":s.showButtons&&s.min!==null&&r.minBoundry()}]}},InputNumberStyle=BaseStyle.extend({name:"inputnumber",css:css$2,classes:classes$1}),script$1$2={name:"BaseInputNumber",extends:script$f,props:{modelValue:{type:Number,default:null},format:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!1},buttonLayout:{type:String,default:"stacked"},incrementButtonClass:{type:String,default:null},decrementButtonClass:{type:String,default:null},incrementButtonIcon:{type:String,default:void 0},decrementButtonIcon:{type:String,default:void 0},locale:{type:String,default:void 0},localeMatcher:{type:String,default:void 0},mode:{type:String,default:"decimal"},prefix:{type:String,default:null},suffix:{type:String,default:null},currency:{type:String,default:void 0},currencyDisplay:{type:String,default:void 0},useGrouping:{type:Boolean,default:!0},minFractionDigits:{type:Number,default:void 0},maxFractionDigits:{type:Number,default:void 0},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:1},allowEmpty:{type:Boolean,default:!0},highlightOnFocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},inputProps:{type:null,default:null},incrementButtonProps:{type:null,default:null},decrementButtonProps:{type:null,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:InputNumberStyle,provide:function(){return{$parentInstance:this}}};function _typeof$3(n){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$3(n)}function ownKeys$3(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$3(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$3(Object(r),!0).forEach(function(s){_defineProperty$3(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$3(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$3(n,t,r){return t=_toPropertyKey$3(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$3(n){var t=_toPrimitive$3(n,"string");return _typeof$3(t)==="symbol"?t:String(t)}function _toPrimitive$3(n,t){if(_typeof$3(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$3(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function _toConsumableArray$1(n){return _arrayWithoutHoles$1(n)||_iterableToArray$1(n)||_unsupportedIterableToArray$1(n)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray$1(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray$1(n,t)}}function _iterableToArray$1(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _arrayWithoutHoles$1(n){if(Array.isArray(n))return _arrayLikeToArray$1(n)}function _arrayLikeToArray$1(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}var script$7={name:"InputNumber",extends:script$1$2,emits:["update:modelValue","input","focus","blur"],numberFormat:null,_numeral:null,_decimal:null,_group:null,_minusSign:null,_currency:null,_suffix:null,_prefix:null,_index:null,groupChar:"",isSpecialChar:null,prefixChar:null,suffixChar:null,timer:null,data:function(){return{d_modelValue:this.modelValue,focused:!1}},watch:{modelValue:function(t){this.d_modelValue=t},locale:function(t,r){this.updateConstructParser(t,r)},localeMatcher:function(t,r){this.updateConstructParser(t,r)},mode:function(t,r){this.updateConstructParser(t,r)},currency:function(t,r){this.updateConstructParser(t,r)},currencyDisplay:function(t,r){this.updateConstructParser(t,r)},useGrouping:function(t,r){this.updateConstructParser(t,r)},minFractionDigits:function(t,r){this.updateConstructParser(t,r)},maxFractionDigits:function(t,r){this.updateConstructParser(t,r)},suffix:function(t,r){this.updateConstructParser(t,r)},prefix:function(t,r){this.updateConstructParser(t,r)}},created:function(){this.constructParser()},methods:{getOptions:function(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}},constructParser:function(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());var t=_toConsumableArray$1(new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)).reverse(),r=new Map(t.map(function(s,i){return[s,i]}));this._numeral=new RegExp("[".concat(t.join(""),"]"),"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=function(s){return r.get(s)}},updateConstructParser:function(t,r){t!==r&&this.constructParser()},escapeRegExp:function(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getDecimalExpression:function(){var t=new Intl.NumberFormat(this.locale,_objectSpread$3(_objectSpread$3({},this.getOptions()),{},{useGrouping:!1}));return new RegExp("[".concat(t.format(1.1).replace(this._currency,"").trim().replace(this._numeral,""),"]"),"g")},getGroupingExpression:function(){var t=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=t.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp("[".concat(this.groupChar,"]"),"g")},getMinusSignExpression:function(){var t=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp("[".concat(t.format(-1).trim().replace(this._numeral,""),"]"),"g")},getCurrencyExpression:function(){if(this.currency){var t=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp("[".concat(t.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,""),"]"),"g")}return new RegExp("[]","g")},getPrefixExpression:function(){if(this.prefix)this.prefixChar=this.prefix;else{var t=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=t.format(1).split("1")[0]}return new RegExp("".concat(this.escapeRegExp(this.prefixChar||"")),"g")},getSuffixExpression:function(){if(this.suffix)this.suffixChar=this.suffix;else{var t=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=t.format(1).split("1")[1]}return new RegExp("".concat(this.escapeRegExp(this.suffixChar||"")),"g")},formatValue:function(t){if(t!=null){if(t==="-")return t;if(this.format){var r=new Intl.NumberFormat(this.locale,this.getOptions()),s=r.format(t);return this.prefix&&(s=this.prefix+s),this.suffix&&(s=s+this.suffix),s}return t.toString()}return""},parseValue:function(t){var r=t.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(r){if(r==="-")return r;var s=+r;return isNaN(s)?null:s}return null},repeat:function(t,r,s){var i=this;if(!this.readonly){var o=r||500;this.clearTimer(),this.timer=setTimeout(function(){i.repeat(t,40,s)},o),this.spin(t,s)}},spin:function(t,r){if(this.$refs.input){var s=this.step*r,i=this.parseValue(this.$refs.input.$el.value)||0,o=this.validateValue(i+s);this.updateInput(o,null,"spin"),this.updateModel(t,o),this.handleOnInput(t,i,o)}},onUpButtonMouseDown:function(t){this.disabled||(this.$refs.input.$el.focus(),this.repeat(t,null,1),t.preventDefault())},onUpButtonMouseUp:function(){this.disabled||this.clearTimer()},onUpButtonMouseLeave:function(){this.disabled||this.clearTimer()},onUpButtonKeyUp:function(){this.disabled||this.clearTimer()},onUpButtonKeyDown:function(t){(t.keyCode===32||t.keyCode===13)&&this.repeat(t,null,1)},onDownButtonMouseDown:function(t){this.disabled||(this.$refs.input.$el.focus(),this.repeat(t,null,-1),t.preventDefault())},onDownButtonMouseUp:function(){this.disabled||this.clearTimer()},onDownButtonMouseLeave:function(){this.disabled||this.clearTimer()},onDownButtonKeyUp:function(){this.disabled||this.clearTimer()},onDownButtonKeyDown:function(t){(t.keyCode===32||t.keyCode===13)&&this.repeat(t,null,-1)},onUserInput:function(){this.isSpecialChar&&(this.$refs.input.$el.value=this.lastValue),this.isSpecialChar=!1},onInputKeyDown:function(t){if(!this.readonly){if(this.lastValue=t.target.value,t.shiftKey||t.altKey){this.isSpecialChar=!0;return}var r=t.target.selectionStart,s=t.target.selectionEnd,i=t.target.value,o=null;switch(t.altKey&&t.preventDefault(),t.code){case"ArrowUp":this.spin(t,1),t.preventDefault();break;case"ArrowDown":this.spin(t,-1),t.preventDefault();break;case"ArrowLeft":this.isNumeralChar(i.charAt(r-1))||t.preventDefault();break;case"ArrowRight":this.isNumeralChar(i.charAt(r))||t.preventDefault();break;case"Tab":case"Enter":case"NumpadEnter":o=this.validateValue(this.parseValue(i)),this.$refs.input.$el.value=this.formatValue(o),this.$refs.input.$el.setAttribute("aria-valuenow",o),this.updateModel(t,o);break;case"Backspace":{if(t.preventDefault(),r===s){var l=i.charAt(r-1),f=this.getDecimalCharIndexes(i),u=f.decimalCharIndex,g=f.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(l)){var y=this.getDecimalLength(i);if(this._group.test(l))this._group.lastIndex=0,o=i.slice(0,r-2)+i.slice(r-1);else if(this._decimal.test(l))this._decimal.lastIndex=0,y?this.$refs.input.$el.setSelectionRange(r-1,r-1):o=i.slice(0,r-1)+i.slice(r);else if(u>0&&r>u){var a=this.isDecimalMode()&&(this.minFractionDigits||0)<y?"":"0";o=i.slice(0,r-1)+a+i.slice(r)}else g===1?(o=i.slice(0,r-1)+"0"+i.slice(r),o=this.parseValue(o)>0?o:""):o=i.slice(0,r-1)+i.slice(r)}this.updateValue(t,o,null,"delete-single")}else o=this.deleteRange(i,r,s),this.updateValue(t,o,null,"delete-range");break}case"Delete":if(t.preventDefault(),r===s){var m=i.charAt(r),_=this.getDecimalCharIndexes(i),b=_.decimalCharIndex,c=_.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(m)){var w=this.getDecimalLength(i);if(this._group.test(m))this._group.lastIndex=0,o=i.slice(0,r)+i.slice(r+2);else if(this._decimal.test(m))this._decimal.lastIndex=0,w?this.$refs.input.$el.setSelectionRange(r+1,r+1):o=i.slice(0,r)+i.slice(r+1);else if(b>0&&r>b){var S=this.isDecimalMode()&&(this.minFractionDigits||0)<w?"":"0";o=i.slice(0,r)+S+i.slice(r+1)}else c===1?(o=i.slice(0,r)+"0"+i.slice(r+1),o=this.parseValue(o)>0?o:""):o=i.slice(0,r)+i.slice(r+1)}this.updateValue(t,o,null,"delete-back-single")}else o=this.deleteRange(i,r,s),this.updateValue(t,o,null,"delete-range");break;case"Home":this.min&&(this.updateModel(t,this.min),t.preventDefault());break;case"End":this.max&&(this.updateModel(t,this.max),t.preventDefault());break}}},onInputKeyPress:function(t){if(!this.readonly){t.preventDefault();var r=t.which||t.keyCode,s=String.fromCharCode(r),i=this.isDecimalSign(s),o=this.isMinusSign(s);(48<=r&&r<=57||o||i)&&this.insert(t,s,{isDecimalSign:i,isMinusSign:o})}},onPaste:function(t){t.preventDefault();var r=(t.clipboardData||window.clipboardData).getData("Text");if(r){var s=this.parseValue(r);s!=null&&this.insert(t,s.toString())}},allowMinusSign:function(){return this.min===null||this.min<0},isMinusSign:function(t){return this._minusSign.test(t)||t==="-"?(this._minusSign.lastIndex=0,!0):!1},isDecimalSign:function(t){return this._decimal.test(t)?(this._decimal.lastIndex=0,!0):!1},isDecimalMode:function(){return this.mode==="decimal"},getDecimalCharIndexes:function(t){var r=t.search(this._decimal);this._decimal.lastIndex=0;var s=t.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,""),i=s.search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:r,decimalCharIndexWithoutPrefix:i}},getCharIndexes:function(t){var r=t.search(this._decimal);this._decimal.lastIndex=0;var s=t.search(this._minusSign);this._minusSign.lastIndex=0;var i=t.search(this._suffix);this._suffix.lastIndex=0;var o=t.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:r,minusCharIndex:s,suffixCharIndex:i,currencyCharIndex:o}},insert:function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{isDecimalSign:!1,isMinusSign:!1},i=r.search(this._minusSign);if(this._minusSign.lastIndex=0,!(!this.allowMinusSign()&&i!==-1)){var o=this.$refs.input.$el.selectionStart,l=this.$refs.input.$el.selectionEnd,f=this.$refs.input.$el.value.trim(),u=this.getCharIndexes(f),g=u.decimalCharIndex,y=u.minusCharIndex,a=u.suffixCharIndex,m=u.currencyCharIndex,_;if(s.isMinusSign)o===0&&(_=f,(y===-1||l!==0)&&(_=this.insertText(f,r,0,l)),this.updateValue(t,_,r,"insert"));else if(s.isDecimalSign)g>0&&o===g?this.updateValue(t,f,r,"insert"):g>o&&g<l?(_=this.insertText(f,r,o,l),this.updateValue(t,_,r,"insert")):g===-1&&this.maxFractionDigits&&(_=this.insertText(f,r,o,l),this.updateValue(t,_,r,"insert"));else{var b=this.numberFormat.resolvedOptions().maximumFractionDigits,c=o!==l?"range-insert":"insert";if(g>0&&o>g){if(o+r.length-(g+1)<=b){var w=m>=o?m-1:a>=o?a:f.length;_=f.slice(0,o)+r+f.slice(o+r.length,w)+f.slice(w),this.updateValue(t,_,r,c)}}else _=this.insertText(f,r,o,l),this.updateValue(t,_,r,c)}}},insertText:function(t,r,s,i){var o=r==="."?r:r.split(".");if(o.length===2){var l=t.slice(s,i).search(this._decimal);return this._decimal.lastIndex=0,l>0?t.slice(0,s)+this.formatValue(r)+t.slice(i):t||this.formatValue(r)}else return i-s===t.length?this.formatValue(r):s===0?r+t.slice(i):i===t.length?t.slice(0,s)+r:t.slice(0,s)+r+t.slice(i)},deleteRange:function(t,r,s){var i;return s-r===t.length?i="":r===0?i=t.slice(s):s===t.length?i=t.slice(0,r):i=t.slice(0,r)+t.slice(s),i},initCursor:function(){var t=this.$refs.input.$el.selectionStart,r=this.$refs.input.$el.value,s=r.length,i=null,o=(this.prefixChar||"").length;r=r.replace(this._prefix,""),t=t-o;var l=r.charAt(t);if(this.isNumeralChar(l))return t+o;for(var f=t-1;f>=0;)if(l=r.charAt(f),this.isNumeralChar(l)){i=f+o;break}else f--;if(i!==null)this.$refs.input.$el.setSelectionRange(i+1,i+1);else{for(f=t;f<s;)if(l=r.charAt(f),this.isNumeralChar(l)){i=f+o;break}else f++;i!==null&&this.$refs.input.$el.setSelectionRange(i,i)}return i||0},onInputClick:function(){var t=this.$refs.input.$el.value;!this.readonly&&t!==DomHandler.getSelection()&&this.initCursor()},isNumeralChar:function(t){return t.length===1&&(this._numeral.test(t)||this._decimal.test(t)||this._group.test(t)||this._minusSign.test(t))?(this.resetRegex(),!0):!1},resetRegex:function(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0},updateValue:function(t,r,s,i){var o=this.$refs.input.$el.value,l=null;r!=null&&(l=this.parseValue(r),l=!l&&!this.allowEmpty?0:l,this.updateInput(l,s,i,r),this.handleOnInput(t,o,l))},handleOnInput:function(t,r,s){this.isValueChanged(r,s)&&this.$emit("input",{originalEvent:t,value:s,formattedValue:r})},isValueChanged:function(t,r){if(r===null&&t!==null)return!0;if(r!=null){var s=typeof t=="string"?this.parseValue(t):t;return r!==s}return!1},validateValue:function(t){return t==="-"||t==null?null:this.min!=null&&t<this.min?this.min:this.max!=null&&t>this.max?this.max:t},updateInput:function(t,r,s,i){r=r||"";var o=this.$refs.input.$el.value,l=this.formatValue(t),f=o.length;if(l!==i&&(l=this.concatValues(l,i)),f===0){this.$refs.input.$el.value=l,this.$refs.input.$el.setSelectionRange(0,0);var u=this.initCursor(),g=u+r.length;this.$refs.input.$el.setSelectionRange(g,g)}else{var y=this.$refs.input.$el.selectionStart,a=this.$refs.input.$el.selectionEnd;this.$refs.input.$el.value=l;var m=l.length;if(s==="range-insert"){var _=this.parseValue((o||"").slice(0,y)),b=_!==null?_.toString():"",c=b.split("").join("(".concat(this.groupChar,")?")),w=new RegExp(c,"g");w.test(l);var S=r.split("").join("(".concat(this.groupChar,")?")),E=new RegExp(S,"g");E.test(l.slice(w.lastIndex)),a=w.lastIndex+E.lastIndex,this.$refs.input.$el.setSelectionRange(a,a)}else if(m===f)s==="insert"||s==="delete-back-single"?this.$refs.input.$el.setSelectionRange(a+1,a+1):s==="delete-single"?this.$refs.input.$el.setSelectionRange(a-1,a-1):(s==="delete-range"||s==="spin")&&this.$refs.input.$el.setSelectionRange(a,a);else if(s==="delete-back-single"){var I=o.charAt(a-1),A=o.charAt(a),T=f-m,O=this._group.test(A);O&&T===1?a+=1:!O&&this.isNumeralChar(I)&&(a+=-1*T+1),this._group.lastIndex=0,this.$refs.input.$el.setSelectionRange(a,a)}else if(o==="-"&&s==="insert"){this.$refs.input.$el.setSelectionRange(0,0);var C=this.initCursor(),k=C+r.length+1;this.$refs.input.$el.setSelectionRange(k,k)}else a=a+(m-f),this.$refs.input.$el.setSelectionRange(a,a)}this.$refs.input.$el.setAttribute("aria-valuenow",t)},concatValues:function(t,r){if(t&&r){var s=r.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?s!==-1?t.replace(this.suffixChar,"").split(this._decimal)[0]+r.replace(this.suffixChar,"").slice(s)+this.suffixChar:t:s!==-1?t.split(this._decimal)[0]+r.slice(s):t}return t},getDecimalLength:function(t){if(t){var r=t.split(this._decimal);if(r.length===2)return r[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0},updateModel:function(t,r){this.d_modelValue=r,this.$emit("update:modelValue",r)},onInputFocus:function(t){this.focused=!0,!this.disabled&&!this.readonly&&this.$refs.input.$el.value!==DomHandler.getSelection()&&this.highlightOnFocus&&t.target.select(),this.$emit("focus",t)},onInputBlur:function(t){this.focused=!1;var r=t.target,s=this.validateValue(this.parseValue(r.value));this.$emit("blur",{originalEvent:t,value:r.value}),r.value=this.formatValue(s),r.setAttribute("aria-valuenow",s),this.updateModel(t,s)},clearTimer:function(){this.timer&&clearInterval(this.timer)},maxBoundry:function(){return this.d_modelValue>=this.max},minBoundry:function(){return this.d_modelValue<=this.min}},computed:{filled:function(){return this.modelValue!=null&&this.modelValue.toString().length>0},upButtonListeners:function(){var t=this;return{mousedown:function(s){return t.onUpButtonMouseDown(s)},mouseup:function(s){return t.onUpButtonMouseUp(s)},mouseleave:function(s){return t.onUpButtonMouseLeave(s)},keydown:function(s){return t.onUpButtonKeyDown(s)},keyup:function(s){return t.onUpButtonKeyUp(s)}}},downButtonListeners:function(){var t=this;return{mousedown:function(s){return t.onDownButtonMouseDown(s)},mouseup:function(s){return t.onDownButtonMouseUp(s)},mouseleave:function(s){return t.onDownButtonMouseLeave(s)},keydown:function(s){return t.onDownButtonKeyDown(s)},keyup:function(s){return t.onDownButtonKeyUp(s)}}},formattedValue:function(){var t=!this.modelValue&&!this.allowEmpty?0:this.modelValue;return this.formatValue(t)},getFormatter:function(){return this.numberFormat}},components:{INInputText:script$8,INButton:script$b,AngleUpIcon:script$9,AngleDownIcon:script$a}};function render$6(n,t,r,s,i,o){var l=resolveComponent("INInputText"),f=resolveComponent("INButton");return openBlock(),createElementBlock("span",mergeProps({class:n.cx("root")},n.ptm("root"),{"data-pc-name":"inputnumber"}),[createVNode(l,mergeProps({ref:"input",id:n.inputId,role:"spinbutton",class:[n.cx("input"),n.inputClass],style:n.inputStyle,value:o.formattedValue,"aria-valuemin":n.min,"aria-valuemax":n.max,"aria-valuenow":n.modelValue,disabled:n.disabled,readonly:n.readonly,placeholder:n.placeholder,"aria-labelledby":n.ariaLabelledby,"aria-label":n.ariaLabel,onInput:o.onUserInput,onKeydown:o.onInputKeyDown,onKeypress:o.onInputKeyPress,onPaste:o.onPaste,onClick:o.onInputClick,onFocus:o.onInputFocus,onBlur:o.onInputBlur},n.inputProps,{pt:n.ptm("input"),unstyled:n.unstyled,"data-pc-section":"input"}),null,16,["id","class","style","value","aria-valuemin","aria-valuemax","aria-valuenow","disabled","readonly","placeholder","aria-labelledby","aria-label","onInput","onKeydown","onKeypress","onPaste","onClick","onFocus","onBlur","pt","unstyled"]),n.showButtons&&n.buttonLayout==="stacked"?(openBlock(),createElementBlock("span",mergeProps({key:0,class:n.cx("buttonGroup")},n.ptm("buttonGroup")),[createVNode(f,mergeProps({class:[n.cx("incrementButton"),n.incrementButtonClass]},toHandlers(o.upButtonListeners),{disabled:n.disabled,tabindex:-1,"aria-hidden":"true"},n.incrementButtonProps,{pt:n.ptm("incrementButton"),unstyled:n.unstyled,"data-pc-section":"incrementbutton"}),{icon:withCtx(function(){return[renderSlot(n.$slots,"incrementbuttonicon",{},function(){return[(openBlock(),createBlock(resolveDynamicComponent(n.incrementButtonIcon?"span":"AngleUpIcon"),mergeProps({class:n.incrementButtonIcon},n.ptm("incrementButton").icon,{"data-pc-section":"incrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","pt","unstyled"]),createVNode(f,mergeProps({class:[n.cx("decrementButton"),n.decrementButtonClass]},toHandlers(o.downButtonListeners),{disabled:n.disabled,tabindex:-1,"aria-hidden":"true"},n.decrementButtonProps,{pt:n.ptm("decrementButton"),unstyled:n.unstyled,"data-pc-section":"decrementbutton"}),{icon:withCtx(function(){return[renderSlot(n.$slots,"decrementbuttonicon",{},function(){return[(openBlock(),createBlock(resolveDynamicComponent(n.decrementButtonIcon?"span":"AngleDownIcon"),mergeProps({class:n.decrementButtonIcon},n.ptm("decrementButton").icon,{"data-pc-section":"decrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","pt","unstyled"])],16)):createCommentVNode("",!0),n.showButtons&&n.buttonLayout!=="stacked"?(openBlock(),createBlock(f,mergeProps({key:1,class:[n.cx("incrementButton"),n.incrementButtonClass]},toHandlers(o.upButtonListeners),{disabled:n.disabled,tabindex:-1,"aria-hidden":"true"},n.incrementButtonProps,{pt:n.ptm("incrementButton"),unstyled:n.unstyled,"data-pc-section":"incrementbutton"}),{icon:withCtx(function(){return[renderSlot(n.$slots,"incrementbuttonicon",{},function(){return[(openBlock(),createBlock(resolveDynamicComponent(n.incrementButtonIcon?"span":"AngleUpIcon"),mergeProps({class:n.incrementButtonIcon},n.ptm("incrementButton").icon,{"data-pc-section":"incrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","pt","unstyled"])):createCommentVNode("",!0),n.showButtons&&n.buttonLayout!=="stacked"?(openBlock(),createBlock(f,mergeProps({key:2,class:[n.cx("decrementButton"),n.decrementButtonClass]},toHandlers(o.downButtonListeners),{disabled:n.disabled,tabindex:-1,"aria-hidden":"true"},n.decrementButtonProps,{pt:n.ptm("decrementButton"),unstyled:n.unstyled,"data-pc-section":"decrementbutton"}),{icon:withCtx(function(){return[renderSlot(n.$slots,"decrementbuttonicon",{},function(){return[(openBlock(),createBlock(resolveDynamicComponent(n.decrementButtonIcon?"span":"AngleDownIcon"),mergeProps({class:n.decrementButtonIcon},n.ptm("decrementButton").icon,{"data-pc-section":"decrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","pt","unstyled"])):createCommentVNode("",!0)],16)}script$7.render=render$6;var script$6={name:"ChevronDownIcon",extends:script$d},_hoisted_1$a=createBaseVNode("path",{d:"M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z",fill:"currentColor"},null,-1),_hoisted_2$8=[_hoisted_1$a];function render$5(n,t,r,s,i,o){return openBlock(),createElementBlock("svg",mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.pti()),_hoisted_2$8,16)}script$6.render=render$5;var script$5={name:"FilterIcon",extends:script$d,computed:{pathId:function(){return"pv_icon_clip_".concat(UniqueComponentId())}}},_hoisted_1$9=["clipPath"],_hoisted_2$7=createBaseVNode("path",{d:"M8.64708 14H5.35296C5.18981 13.9979 5.03395 13.9321 4.91858 13.8167C4.8032 13.7014 4.73745 13.5455 4.73531 13.3824V7L0.329431 0.98C0.259794 0.889466 0.217389 0.780968 0.20718 0.667208C0.19697 0.553448 0.219379 0.439133 0.271783 0.337647C0.324282 0.236453 0.403423 0.151519 0.500663 0.0920138C0.597903 0.0325088 0.709548 0.000692754 0.823548 0H13.1765C13.2905 0.000692754 13.4021 0.0325088 13.4994 0.0920138C13.5966 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7826 0.780968 13.7402 0.889466 13.6706 0.98L9.26472 7V13.3824C9.26259 13.5455 9.19683 13.7014 9.08146 13.8167C8.96609 13.9321 8.81022 13.9979 8.64708 14ZM5.97061 12.7647H8.02943V6.79412C8.02878 6.66289 8.07229 6.53527 8.15296 6.43177L11.9412 1.23529H2.05884L5.86355 6.43177C5.94422 6.53527 5.98773 6.66289 5.98708 6.79412L5.97061 12.7647Z",fill:"currentColor"},null,-1),_hoisted_3$5=[_hoisted_2$7],_hoisted_4$3=["id"],_hoisted_5$3=createBaseVNode("rect",{width:"14",height:"14",fill:"white"},null,-1),_hoisted_6$3=[_hoisted_5$3];function render$4(n,t,r,s,i,o){return openBlock(),createElementBlock("svg",mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.pti()),[createBaseVNode("g",{clipPath:"url(#".concat(o.pathId,")")},_hoisted_3$5,8,_hoisted_1$9),createBaseVNode("defs",null,[createBaseVNode("clipPath",{id:"".concat(o.pathId)},_hoisted_6$3,8,_hoisted_4$3)])],16)}script$5.render=render$4;var script$4={name:"TimesIcon",extends:script$d},_hoisted_1$8=createBaseVNode("path",{d:"M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z",fill:"currentColor"},null,-1),_hoisted_2$6=[_hoisted_1$8];function render$3(n,t,r,s,i,o){return openBlock(),createElementBlock("svg",mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.pti()),_hoisted_2$6,16)}script$4.render=render$3;var OverlayEventBus=primebus(),script$3={name:"Portal",props:{appendTo:{type:String,default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=DomHandler.isClient()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function render$2(n,t,r,s,i,o){return o.inline?renderSlot(n.$slots,"default",{key:0}):i.mounted?(openBlock(),createBlock(Teleport,{key:1,to:r.appendTo},[renderSlot(n.$slots,"default")],8,["to"])):createCommentVNode("",!0)}script$3.render=render$2;var css$1=`
.p-virtualscroller {
    position: relative;
    overflow: auto;
    contain: strict;
    transform: translateZ(0);
    will-change: scroll-position;
    outline: 0 none;
}

.p-virtualscroller-content {
    position: absolute;
    top: 0;
    left: 0;
    /* contain: content; */
    min-height: 100%;
    min-width: 100%;
    will-change: transform;
}

.p-virtualscroller-spacer {
    position: absolute;
    top: 0;
    left: 0;
    height: 1px;
    width: 1px;
    transform-origin: 0 0;
    pointer-events: none;
}

.p-virtualscroller .p-virtualscroller-loader {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-virtualscroller-loader.p-component-overlay {
    display: flex;
    align-items: center;
    justify-content: center;
}

.p-virtualscroller-loading-icon {
    font-size: 2rem;
}

.p-virtualscroller-loading-icon.p-icon {
    width: 2rem;
    height: 2rem;
}

.p-virtualscroller-horizontal > .p-virtualscroller-content {
    display: flex;
}

/* Inline */
.p-virtualscroller-inline .p-virtualscroller-content {
    position: static;
}
`,VirtualScrollerStyle=BaseStyle.extend({name:"virtualscroller",css:css$1}),script$1$1={name:"BaseVirtualScroller",extends:script$f,props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},resizeDelay:{type:Number,default:10},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1},tabindex:{type:Number,default:0},inline:{type:Boolean,default:!1},step:{type:Number,default:0},appendOnly:{type:Boolean,default:!1},autoSize:{type:Boolean,default:!1}},style:VirtualScrollerStyle,provide:function(){return{$parentInstance:this}},beforeMount:function(){VirtualScrollerStyle.loadStyle()}};function _typeof$2(n){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2(n)}function ownKeys$2(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$2(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$2(Object(r),!0).forEach(function(s){_defineProperty$2(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$2(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$2(n,t,r){return t=_toPropertyKey$2(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$2(n){var t=_toPrimitive$2(n,"string");return _typeof$2(t)==="symbol"?t:String(t)}function _toPrimitive$2(n,t){if(_typeof$2(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$2(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var script$2={name:"VirtualScroller",extends:script$1$1,emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],data:function(){return{first:this.isBoth()?{rows:0,cols:0}:0,last:this.isBoth()?{rows:0,cols:0}:0,page:this.isBoth()?{rows:0,cols:0}:0,numItemsInViewport:this.isBoth()?{rows:0,cols:0}:0,lastScrollPos:this.isBoth()?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,resizeTimeout:null,defaultWidth:0,defaultHeight:0,defaultContentWidth:0,defaultContentHeight:0,isRangeChanged:!1,lazyLoadState:{},resizeListener:null,initialized:!1,watch:{numToleratedItems:function(t){this.d_numToleratedItems=t},loading:function(t){this.d_loading=t},items:function(t,r){(!r||r.length!==(t||[]).length)&&(this.init(),this.calculateAutoSize())},itemSize:function(){this.init(),this.calculateAutoSize()},orientation:function(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},scrollHeight:function(){this.init(),this.calculateAutoSize()},scrollWidth:function(){this.init(),this.calculateAutoSize()}},mounted:function(){this.viewInit(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0,this.lazyLoadState=this.lazyLoadState||{}},updated:function(){!this.initialized&&this.viewInit()},unmounted:function(){this.unbindResizeListener(),this.initialized=!1},methods:{viewInit:function(){DomHandler.isVisible(this.element)&&(this.setContentEl(this.content),this.init(),this.bindResizeListener(),this.defaultWidth=DomHandler.getWidth(this.element),this.defaultHeight=DomHandler.getHeight(this.element),this.defaultContentWidth=DomHandler.getWidth(this.content),this.defaultContentHeight=DomHandler.getHeight(this.content),this.initialized=!0)},init:function(){this.disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize())},isVertical:function(){return this.orientation==="vertical"},isHorizontal:function(){return this.orientation==="horizontal"},isBoth:function(){return this.orientation==="both"},scrollTo:function(t){this.lastScrollPos=this.both?{top:0,left:0}:0,this.element&&this.element.scrollTo(t)},scrollToIndex:function(t){var r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",i=this.isBoth(),o=this.isHorizontal(),l=this.first,f=this.calculateNumItems(),u=f.numToleratedItems,g=this.getContentPosition(),y=this.itemSize,a=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,E=arguments.length>1?arguments[1]:void 0;return S<=E?0:S},m=function(S,E,I){return S*E+I},_=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.scrollTo({left:S,top:E,behavior:s})},b=i?{rows:0,cols:0}:0,c=!1;i?(b={rows:a(t[0],u[0]),cols:a(t[1],u[1])},_(m(b.cols,y[1],g.left),m(b.rows,y[0],g.top)),c=b.rows!==l.rows||b.cols!==l.cols):(b=a(t,u),o?_(m(b,y,g.left),0):_(0,m(b,y,g.top)),c=b!==l),this.isRangeChanged=c,this.first=b},scrollInView:function(t,r){var s=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"auto";if(r){var o=this.isBoth(),l=this.isHorizontal(),f=this.getRenderedRange(),u=f.first,g=f.viewport,y=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return s.scrollTo({left:w,top:S,behavior:i})},a=r==="to-start",m=r==="to-end";if(a){if(o)g.first.rows-u.rows>t[0]?y(g.first.cols*this.itemSize[1],(g.first.rows-1)*this.itemSize[0]):g.first.cols-u.cols>t[1]&&y((g.first.cols-1)*this.itemSize[1],g.first.rows*this.itemSize[0]);else if(g.first-u>t){var _=(g.first-1)*this.itemSize;l?y(_,0):y(0,_)}}else if(m){if(o)g.last.rows-u.rows<=t[0]+1?y(g.first.cols*this.itemSize[1],(g.first.rows+1)*this.itemSize[0]):g.last.cols-u.cols<=t[1]+1&&y((g.first.cols+1)*this.itemSize[1],g.first.rows*this.itemSize[0]);else if(g.last-u<=t+1){var b=(g.first+1)*this.itemSize;l?y(b,0):y(0,b)}}}else this.scrollToIndex(t,i)},getRenderedRange:function(){var t=function(a,m){return Math.floor(a/(m||a))},r=this.first,s=0;if(this.element){var i=this.isBoth(),o=this.isHorizontal(),l=this.element.scrollTop,f=l.scrollTop,u=l.scrollLeft;if(i)r={rows:t(f,this.itemSize[0]),cols:t(u,this.itemSize[1])},s={rows:r.rows+this.numItemsInViewport.rows,cols:r.cols+this.numItemsInViewport.cols};else{var g=o?u:f;r=t(g,this.itemSize),s=r+this.numItemsInViewport}}return{first:this.first,last:this.last,viewport:{first:r,last:s}}},calculateNumItems:function(){var t=this.isBoth(),r=this.isHorizontal(),s=this.itemSize,i=this.getContentPosition(),o=this.element?this.element.offsetWidth-i.left:0,l=this.element?this.element.offsetHeight-i.top:0,f=function(m,_){return Math.ceil(m/(_||m))},u=function(m){return Math.ceil(m/2)},g=t?{rows:f(l,s[0]),cols:f(o,s[1])}:f(r?o:l,s),y=this.d_numToleratedItems||(t?[u(g.rows),u(g.cols)]:u(g));return{numItemsInViewport:g,numToleratedItems:y}},calculateOptions:function(){var t=this,r=this.isBoth(),s=this.first,i=this.calculateNumItems(),o=i.numItemsInViewport,l=i.numToleratedItems,f=function(y,a,m){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return t.getLast(y+a+(y<m?2:3)*m,_)},u=r?{rows:f(s.rows,o.rows,l[0]),cols:f(s.cols,o.cols,l[1],!0)}:f(s,o,l);this.last=u,this.numItemsInViewport=o,this.d_numToleratedItems=l,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=r?Array.from({length:o.rows}).map(function(){return Array.from({length:o.cols})}):Array.from({length:o})),this.lazy&&Promise.resolve().then(function(){t.lazyLoadState={first:t.step?r?{rows:0,cols:s.cols}:0:s,last:Math.min(t.step?t.step:u,t.items.length)},t.$emit("lazy-load",t.lazyLoadState)})},calculateAutoSize:function(){var t=this;this.autoSize&&!this.d_loading&&Promise.resolve().then(function(){if(t.content){var r=t.isBoth(),s=t.isHorizontal(),i=t.isVertical();t.content.style.minHeight=t.content.style.minWidth="auto",t.content.style.position="relative",t.element.style.contain="none";var o=[DomHandler.getWidth(t.content),DomHandler.getHeight(t.content)],l=o[0],f=o[1];l!==t.defaultContentWidth&&(t.element.style.width=""),f!==t.defaultContentHeight&&(t.element.style.height="");var u=[DomHandler.getWidth(t.element),DomHandler.getHeight(t.element)],g=u[0],y=u[1];(r||s)&&(t.element.style.width=g<t.defaultWidth?g+"px":t.scrollWidth||t.defaultWidth+"px"),(r||i)&&(t.element.style.height=y<t.defaultHeight?y+"px":t.scrollHeight||t.defaultHeight+"px"),t.content.style.minHeight=t.content.style.minWidth="",t.content.style.position="",t.element.style.contain=""}})},getLast:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return this.items?Math.min(r?(this.columns||this.items[0]).length:this.items.length,t):0},getContentPosition:function(){if(this.content){var t=getComputedStyle(this.content),r=parseFloat(t.paddingLeft)+Math.max(parseFloat(t.left)||0,0),s=parseFloat(t.paddingRight)+Math.max(parseFloat(t.right)||0,0),i=parseFloat(t.paddingTop)+Math.max(parseFloat(t.top)||0,0),o=parseFloat(t.paddingBottom)+Math.max(parseFloat(t.bottom)||0,0);return{left:r,right:s,top:i,bottom:o,x:r+s,y:i+o}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize:function(){var t=this;if(this.element){var r=this.isBoth(),s=this.isHorizontal(),i=this.element.parentElement,o=this.scrollWidth||"".concat(this.element.offsetWidth||i.offsetWidth,"px"),l=this.scrollHeight||"".concat(this.element.offsetHeight||i.offsetHeight,"px"),f=function(g,y){return t.element.style[g]=y};r||s?(f("height",l),f("width",o)):f("height",l)}},setSpacerSize:function(){var t=this,r=this.items;if(r){var s=this.isBoth(),i=this.isHorizontal(),o=this.getContentPosition(),l=function(u,g,y){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return t.spacerStyle=_objectSpread$2(_objectSpread$2({},t.spacerStyle),_defineProperty$2({},"".concat(u),(g||[]).length*y+a+"px"))};s?(l("height",r,this.itemSize[0],o.y),l("width",this.columns||r[1],this.itemSize[1],o.x)):i?l("width",this.columns||r,this.itemSize,o.x):l("height",r,this.itemSize,o.y)}},setContentPosition:function(t){var r=this;if(this.content&&!this.appendOnly){var s=this.isBoth(),i=this.isHorizontal(),o=t?t.first:this.first,l=function(y,a){return y*a},f=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.contentStyle=_objectSpread$2(_objectSpread$2({},r.contentStyle),{transform:"translate3d(".concat(y,"px, ").concat(a,"px, 0)")})};if(s)f(l(o.cols,this.itemSize[1]),l(o.rows,this.itemSize[0]));else{var u=l(o,this.itemSize);i?f(u,0):f(0,u)}}},onScrollPositionChange:function(t){var r=this,s=t.target,i=this.isBoth(),o=this.isHorizontal(),l=this.getContentPosition(),f=function(L,F){return L?L>F?L-F:L:0},u=function(L,F){return Math.floor(L/(F||L))},g=function(L,F,V,j,K,U){return L<=K?K:U?V-j-K:F+K-1},y=function(L,F,V,j,K,U,X){return L<=U?0:Math.max(0,X?L<F?V:L-U:L>F?V:L-2*U)},a=function(L,F,V,j,K,U){var X=F+j+2*K;return L>=K&&(X+=K+1),r.getLast(X,U)},m=f(s.scrollTop,l.top),_=f(s.scrollLeft,l.left),b=i?{rows:0,cols:0}:0,c=this.last,w=!1,S=this.lastScrollPos;if(i){var E=this.lastScrollPos.top<=m,I=this.lastScrollPos.left<=_;if(!this.appendOnly||this.appendOnly&&(E||I)){var A={rows:u(m,this.itemSize[0]),cols:u(_,this.itemSize[1])},T={rows:g(A.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],E),cols:g(A.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],I)};b={rows:y(A.rows,T.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],E),cols:y(A.cols,T.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],I)},c={rows:a(A.rows,b.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:a(A.cols,b.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},w=b.rows!==this.first.rows||c.rows!==this.last.rows||b.cols!==this.first.cols||c.cols!==this.last.cols||this.isRangeChanged,S={top:m,left:_}}}else{var O=o?_:m,C=this.lastScrollPos<=O;if(!this.appendOnly||this.appendOnly&&C){var k=u(O,this.itemSize),P=g(k,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,C);b=y(k,P,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,C),c=a(k,b,this.last,this.numItemsInViewport,this.d_numToleratedItems),w=b!==this.first||c!==this.last||this.isRangeChanged,S=O}}return{first:b,last:c,isRangeChanged:w,scrollPos:S}},onScrollChange:function(t){var r=this.onScrollPositionChange(t),s=r.first,i=r.last,o=r.isRangeChanged,l=r.scrollPos;if(o){var f={first:s,last:i};if(this.setContentPosition(f),this.first=s,this.last=i,this.lastScrollPos=l,this.$emit("scroll-index-change",f),this.lazy&&this.isPageChanged(s)){var u={first:this.step?Math.min(this.getPageByFirst(s)*this.step,this.items.length-this.step):s,last:Math.min(this.step?(this.getPageByFirst(s)+1)*this.step:i,this.items.length)},g=this.lazyLoadState.first!==u.first||this.lazyLoadState.last!==u.last;g&&this.$emit("lazy-load",u),this.lazyLoadState=u}}},onScroll:function(t){var r=this;if(this.$emit("scroll",t),this.delay&&this.isPageChanged()){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){var s=this.onScrollPositionChange(t),i=s.isRangeChanged,o=i||(this.step?this.isPageChanged():!1);o&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(function(){r.onScrollChange(t),r.d_loading&&r.showLoader&&(!r.lazy||r.loading===void 0)&&(r.d_loading=!1,r.page=r.getPageByFirst())},this.delay)}else this.onScrollChange(t)},onResize:function(){var t=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){if(DomHandler.isVisible(t.element)){var r=t.isBoth(),s=t.isVertical(),i=t.isHorizontal(),o=[DomHandler.getWidth(t.element),DomHandler.getHeight(t.element)],l=o[0],f=o[1],u=l!==t.defaultWidth,g=f!==t.defaultHeight,y=r?u||g:i?u:s?g:!1;y&&(t.d_numToleratedItems=t.numToleratedItems,t.defaultWidth=l,t.defaultHeight=f,t.defaultContentWidth=DomHandler.getWidth(t.content),t.defaultContentHeight=DomHandler.getHeight(t.content),t.init())}},this.resizeDelay)},bindResizeListener:function(){this.resizeListener||(this.resizeListener=this.onResize.bind(this),window.addEventListener("resize",this.resizeListener),window.addEventListener("orientationchange",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),window.removeEventListener("orientationchange",this.resizeListener),this.resizeListener=null)},getOptions:function(t){var r=(this.items||[]).length,s=this.isBoth()?this.first.rows+t:this.first+t;return{index:s,count:r,first:s===0,last:s===r-1,even:s%2===0,odd:s%2!==0}},getLoaderOptions:function(t,r){var s=this.loaderArr.length;return _objectSpread$2({index:t,count:s,first:t===0,last:t===s-1,even:t%2===0,odd:t%2!==0},r)},getPageByFirst:function(t){return Math.floor(((t??this.first)+this.d_numToleratedItems*4)/(this.step||1))},isPageChanged:function(t){return this.step?this.page!==this.getPageByFirst(t??this.first):!0},setContentEl:function(t){this.content=t||this.content||DomHandler.findSingle(this.element,'[data-pc-section="content"]')},elementRef:function(t){this.element=t},contentRef:function(t){this.content=t}},computed:{containerClass:function(){return["p-virtualscroller",this.class,{"p-virtualscroller-inline":this.inline,"p-virtualscroller-both p-both-scroll":this.isBoth(),"p-virtualscroller-horizontal p-horizontal-scroll":this.isHorizontal()}]},contentClass:function(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass:function(){return["p-virtualscroller-loader",{"p-component-overlay":!this.$slots.loader}]},loadedItems:function(){var t=this;return this.items&&!this.d_loading?this.isBoth()?this.items.slice(this.appendOnly?0:this.first.rows,this.last.rows).map(function(r){return t.columns?r:r.slice(t.appendOnly?0:t.first.cols,t.last.cols)}):this.isHorizontal()&&this.columns?this.items:this.items.slice(this.appendOnly?0:this.first,this.last):[]},loadedRows:function(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns:function(){if(this.columns){var t=this.isBoth(),r=this.isHorizontal();if(t||r)return this.d_loading&&this.loaderDisabled?t?this.loaderArr[0]:this.loaderArr:this.columns.slice(t?this.first.cols:this.first,t?this.last.cols:this.last)}return this.columns}},components:{SpinnerIcon:script$c}},_hoisted_1$7=["tabindex"];function render$1(n,t,r,s,i,o){var l=resolveComponent("SpinnerIcon");return n.disabled?(openBlock(),createElementBlock(Fragment,{key:1},[renderSlot(n.$slots,"default"),renderSlot(n.$slots,"content",{items:n.items,rows:n.items,columns:o.loadedColumns})],64)):(openBlock(),createElementBlock("div",mergeProps({key:0,ref:o.elementRef,class:o.containerClass,tabindex:n.tabindex,style:n.style,onScroll:t[0]||(t[0]=function(){return o.onScroll&&o.onScroll.apply(o,arguments)})},n.ptm("root"),{"data-pc-name":"virtualscroller"}),[renderSlot(n.$slots,"content",{styleClass:o.contentClass,items:o.loadedItems,getItemOptions:o.getOptions,loading:i.d_loading,getLoaderOptions:o.getLoaderOptions,itemSize:n.itemSize,rows:o.loadedRows,columns:o.loadedColumns,contentRef:o.contentRef,spacerStyle:i.spacerStyle,contentStyle:i.contentStyle,vertical:o.isVertical(),horizontal:o.isHorizontal(),both:o.isBoth()},function(){return[createBaseVNode("div",mergeProps({ref:o.contentRef,class:o.contentClass,style:i.contentStyle},n.ptm("content")),[(openBlock(!0),createElementBlock(Fragment,null,renderList(o.loadedItems,function(f,u){return renderSlot(n.$slots,"item",{key:u,item:f,options:o.getOptions(u)})}),128))],16)]}),n.showSpacer?(openBlock(),createElementBlock("div",mergeProps({key:0,class:"p-virtualscroller-spacer",style:i.spacerStyle},n.ptm("spacer")),null,16)):createCommentVNode("",!0),!n.loaderDisabled&&n.showLoader&&i.d_loading?(openBlock(),createElementBlock("div",mergeProps({key:1,class:o.loaderClass},n.ptm("loader")),[n.$slots&&n.$slots.loader?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(i.loaderArr,function(f,u){return renderSlot(n.$slots,"loader",{key:u,options:o.getLoaderOptions(u,o.isBoth()&&{numCols:n.d_numItemsInViewport.cols})})}),128)):createCommentVNode("",!0),renderSlot(n.$slots,"loadingicon",{},function(){return[createVNode(l,mergeProps({spin:"",class:"p-virtualscroller-loading-icon"},n.ptm("loadingIcon")),null,16)]})],16)):createCommentVNode("",!0)],16,_hoisted_1$7))}script$2.render=render$1;var css=`
@layer primevue {
    .p-dropdown {
        display: inline-flex;
        cursor: pointer;
        position: relative;
        user-select: none;
    }

    .p-dropdown-clear-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
    }

    .p-dropdown-trigger {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .p-dropdown-label {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        flex: 1 1 auto;
        width: 1%;
        text-overflow: ellipsis;
        cursor: pointer;
    }

    .p-dropdown-label-empty {
        overflow: hidden;
        opacity: 0;
    }

    input.p-dropdown-label {
        cursor: default;
    }

    .p-dropdown .p-dropdown-panel {
        min-width: 100%;
    }

    .p-dropdown-panel {
        position: absolute;
        top: 0;
        left: 0;
    }

    .p-dropdown-items-wrapper {
        overflow: auto;
    }

    .p-dropdown-item {
        cursor: pointer;
        font-weight: normal;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
    }

    .p-dropdown-item-group {
        cursor: auto;
    }

    .p-dropdown-items {
        margin: 0;
        padding: 0;
        list-style-type: none;
    }

    .p-dropdown-filter {
        width: 100%;
    }

    .p-dropdown-filter-container {
        position: relative;
    }

    .p-dropdown-filter-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
    }

    .p-fluid .p-dropdown {
        display: flex;
    }

    .p-fluid .p-dropdown .p-dropdown-label {
        width: 1%;
    }
}
`,classes={root:function(t){var r=t.instance,s=t.props,i=t.state;return["p-dropdown p-component p-inputwrapper",{"p-disabled":s.disabled,"p-dropdown-clearable":s.showClear&&!s.disabled,"p-focus":i.focused,"p-inputwrapper-filled":r.hasSelectedOption,"p-inputwrapper-focus":i.focused||i.overlayVisible,"p-overlay-open":i.overlayVisible}]},input:function(t){var r=t.instance,s=t.props;return["p-dropdown-label p-inputtext",{"p-placeholder":!s.editable&&r.label===s.placeholder,"p-dropdown-label-empty":!s.editable&&!r.$slots.value&&(r.label==="p-emptylabel"||r.label.length===0)}]},clearIcon:"p-dropdown-clear-icon",trigger:"p-dropdown-trigger",loadingicon:"p-dropdown-trigger-icon",dropdownIcon:"p-dropdown-trigger-icon",panel:function(t){var r=t.instance;return["p-dropdown-panel p-component",{"p-input-filled":r.$primevue.config.inputStyle==="filled","p-ripple-disabled":r.$primevue.config.ripple===!1}]},header:"p-dropdown-header",filterContainer:"p-dropdown-filter-container",filterInput:"p-dropdown-filter p-inputtext p-component",filterIcon:"p-dropdown-filter-icon",wrapper:"p-dropdown-items-wrapper",list:"p-dropdown-items",itemGroup:"p-dropdown-item-group",item:function(t){var r=t.instance,s=t.state,i=t.option,o=t.focusedOption;return["p-dropdown-item",{"p-highlight":r.isSelected(i),"p-focus":s.focusedOptionIndex===o,"p-disabled":r.isOptionDisabled(i)}]},emptyMessage:"p-dropdown-empty-message"},DropdownStyle=BaseStyle.extend({name:"dropdown",css,classes}),script$1={name:"BaseDropdown",extends:script$f,props:{modelValue:null,options:Array,optionLabel:[String,Function],optionValue:[String,Function],optionDisabled:[String,Function],optionGroupLabel:[String,Function],optionGroupChildren:[String,Function],scrollHeight:{type:String,default:"200px"},filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},editable:Boolean,placeholder:{type:String,default:null},disabled:{type:Boolean,default:!1},dataKey:null,showClear:{type:Boolean,default:!1},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},inputProps:{type:null,default:null},panelClass:{type:[String,Object],default:null},panelStyle:{type:Object,default:null},panelProps:{type:null,default:null},filterInputProps:{type:null,default:null},clearIconProps:{type:null,default:null},appendTo:{type:String,default:"body"},loading:{type:Boolean,default:!1},clearIcon:{type:String,default:void 0},dropdownIcon:{type:String,default:void 0},filterIcon:{type:String,default:void 0},loadingIcon:{type:String,default:void 0},resetFilterOnHide:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},autoOptionFocus:{type:Boolean,default:!0},autoFilterFocus:{type:Boolean,default:!1},selectOnFocus:{type:Boolean,default:!1},filterMessage:{type:String,default:null},selectionMessage:{type:String,default:null},emptySelectionMessage:{type:String,default:null},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},tabindex:{type:Number,default:0},ariaLabel:{type:String,default:null},ariaLabelledby:{type:String,default:null}},style:DropdownStyle,provide:function(){return{$parentInstance:this}}};function _typeof$1(n){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1(n)}function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_unsupportedIterableToArray(n)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(n,t)}}function _iterableToArray(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _arrayWithoutHoles(n){if(Array.isArray(n))return _arrayLikeToArray(n)}function _arrayLikeToArray(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=n[r];return s}function ownKeys$1(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread$1(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$1(Object(r),!0).forEach(function(s){_defineProperty$1(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys$1(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty$1(n,t,r){return t=_toPropertyKey$1(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey$1(n){var t=_toPrimitive$1(n,"string");return _typeof$1(t)==="symbol"?t:String(t)}function _toPrimitive$1(n,t){if(_typeof$1(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof$1(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var script={name:"Dropdown",extends:script$1,emits:["update:modelValue","change","focus","blur","before-show","before-hide","show","hide","filter"],outsideClickListener:null,scrollHandler:null,resizeListener:null,overlay:null,list:null,virtualScroller:null,searchTimeout:null,searchValue:null,isModelValueChanged:!1,focusOnHover:!1,data:function(){return{id:this.$attrs.id,focused:!1,focusedOptionIndex:-1,filterValue:null,overlayVisible:!1}},watch:{"$attrs.id":function(t){this.id=t||UniqueComponentId()},modelValue:function(){this.isModelValueChanged=!0},options:function(){this.autoUpdateModel()}},mounted:function(){this.id=this.id||UniqueComponentId(),this.autoUpdateModel()},updated:function(){this.overlayVisible&&this.isModelValueChanged&&this.scrollInView(this.findSelectedOptionIndex()),this.isModelValueChanged=!1},beforeUnmount:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(ZIndexUtils.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex:function(t,r){return this.virtualScrollerDisabled?t:r&&r(t).index},getOptionLabel:function(t){return this.optionLabel?ObjectUtils.resolveFieldData(t,this.optionLabel):t},getOptionValue:function(t){return this.optionValue?ObjectUtils.resolveFieldData(t,this.optionValue):t},getOptionRenderKey:function(t,r){return(this.dataKey?ObjectUtils.resolveFieldData(t,this.dataKey):this.getOptionLabel(t))+"_"+r},getPTItemOptions:function(t,r,s,i){return this.ptm(i,{context:{selected:this.isSelected(t),focused:this.focusedOptionIndex===this.getOptionIndex(s,r),disabled:this.isOptionDisabled(t)}})},isOptionDisabled:function(t){return this.optionDisabled?ObjectUtils.resolveFieldData(t,this.optionDisabled):!1},isOptionGroup:function(t){return this.optionGroupLabel&&t.optionGroup&&t.group},getOptionGroupLabel:function(t){return ObjectUtils.resolveFieldData(t,this.optionGroupLabel)},getOptionGroupChildren:function(t){return ObjectUtils.resolveFieldData(t,this.optionGroupChildren)},getAriaPosInset:function(t){var r=this;return(this.optionGroupLabel?t-this.visibleOptions.slice(0,t).filter(function(s){return r.isOptionGroup(s)}).length:t)+1},show:function(t){this.$emit("before-show"),this.overlayVisible=!0,this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1,t&&DomHandler.focus(this.$refs.focusInput)},hide:function(t){var r=this,s=function(){r.$emit("before-hide"),r.overlayVisible=!1,r.focusedOptionIndex=-1,r.searchValue="",r.resetFilterOnHide&&(r.filterValue=null),t&&DomHandler.focus(r.$refs.focusInput)};setTimeout(function(){s()},0)},onFocus:function(t){this.disabled||(this.focused=!0,this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1,this.overlayVisible&&this.scrollInView(this.focusedOptionIndex),this.$emit("focus",t))},onBlur:function(t){this.focused=!1,this.focusedOptionIndex=-1,this.searchValue="",this.$emit("blur",t)},onKeyDown:function(t){if(this.disabled){t.preventDefault();return}var r=t.metaKey||t.ctrlKey;switch(t.code){case"ArrowDown":this.onArrowDownKey(t);break;case"ArrowUp":this.onArrowUpKey(t,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(t,this.editable);break;case"Delete":this.onDeleteKey(t);case"Home":this.onHomeKey(t,this.editable);break;case"End":this.onEndKey(t,this.editable);break;case"PageDown":this.onPageDownKey(t);break;case"PageUp":this.onPageUpKey(t);break;case"Space":this.onSpaceKey(t,this.editable);break;case"Enter":case"NumpadEnter":this.onEnterKey(t);break;case"Escape":this.onEscapeKey(t);break;case"Tab":this.onTabKey(t);break;case"Backspace":this.onBackspaceKey(t,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!r&&ObjectUtils.isPrintableCharacter(t.key)&&(!this.overlayVisible&&this.show(),!this.editable&&this.searchOptions(t,t.key));break}},onEditableInput:function(t){var r=t.target.value;this.searchValue="";var s=this.searchOptions(t,r);!s&&(this.focusedOptionIndex=-1),this.updateModel(t,r)},onContainerClick:function(t){this.disabled||this.loading||t.target.tagName==="INPUT"||t.target.getAttribute("data-pc-section")==="clearicon"||t.target.closest('[data-pc-section="clearicon"]')||(!this.overlay||!this.overlay.contains(t.target))&&(this.overlayVisible?this.hide(!0):this.show(!0))},onClearClick:function(t){this.updateModel(t,null)},onFirstHiddenFocus:function(t){var r=t.relatedTarget===this.$refs.focusInput?DomHandler.getFirstFocusableElement(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;DomHandler.focus(r)},onLastHiddenFocus:function(t){var r=t.relatedTarget===this.$refs.focusInput?DomHandler.getLastFocusableElement(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;DomHandler.focus(r)},onOptionSelect:function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=this.getOptionValue(r);this.updateModel(t,i),s&&this.hide(!0)},onOptionMouseMove:function(t,r){this.focusOnHover&&this.changeFocusedOptionIndex(t,r)},onFilterChange:function(t){var r=t.target.value;this.filterValue=r,this.focusedOptionIndex=-1,this.$emit("filter",{originalEvent:t,value:r}),!this.virtualScrollerDisabled&&this.virtualScroller.scrollToIndex(0)},onFilterKeyDown:function(t){switch(t.code){case"ArrowDown":this.onArrowDownKey(t);break;case"ArrowUp":this.onArrowUpKey(t,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(t,!0);break;case"Home":this.onHomeKey(t,!0);break;case"End":this.onEndKey(t,!0);break;case"Enter":this.onEnterKey(t);break;case"Escape":this.onEscapeKey(t);break;case"Tab":this.onTabKey(t,!0);break}},onFilterBlur:function(){this.focusedOptionIndex=-1},onFilterUpdated:function(){this.overlayVisible&&this.alignOverlay()},onOverlayClick:function(t){OverlayEventBus.emit("overlay-click",{originalEvent:t,target:this.$el})},onOverlayKeyDown:function(t){switch(t.code){case"Escape":this.onEscapeKey(t);break}},onDeleteKey:function(t){this.showClear&&(this.updateModel(t,null),t.preventDefault())},onArrowDownKey:function(t){var r=this.focusedOptionIndex!==-1?this.findNextOptionIndex(this.focusedOptionIndex):this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(t,r),!this.overlayVisible&&this.show(),t.preventDefault()},onArrowUpKey:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.altKey&&!r)this.focusedOptionIndex!==-1&&this.onOptionSelect(t,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(),t.preventDefault();else{var s=this.focusedOptionIndex!==-1?this.findPrevOptionIndex(this.focusedOptionIndex):this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(t,s),!this.overlayVisible&&this.show(),t.preventDefault()}},onArrowLeftKey:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r&&(this.focusedOptionIndex=-1)},onHomeKey:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r?(t.currentTarget.setSelectionRange(0,0),this.focusedOptionIndex=-1):(this.changeFocusedOptionIndex(t,this.findFirstOptionIndex()),!this.overlayVisible&&this.show()),t.preventDefault()},onEndKey:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r){var s=t.currentTarget,i=s.value.length;s.setSelectionRange(i,i),this.focusedOptionIndex=-1}else this.changeFocusedOptionIndex(t,this.findLastOptionIndex()),!this.overlayVisible&&this.show();t.preventDefault()},onPageUpKey:function(t){this.scrollInView(0),t.preventDefault()},onPageDownKey:function(t){this.scrollInView(this.visibleOptions.length-1),t.preventDefault()},onEnterKey:function(t){this.overlayVisible?(this.focusedOptionIndex!==-1&&this.onOptionSelect(t,this.visibleOptions[this.focusedOptionIndex]),this.hide()):this.onArrowDownKey(t),t.preventDefault()},onSpaceKey:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!r&&this.onEnterKey(t)},onEscapeKey:function(t){this.overlayVisible&&this.hide(!0),t.preventDefault()},onTabKey:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r||(this.overlayVisible&&this.hasFocusableElements()?(DomHandler.focus(this.$refs.firstHiddenFocusableElementOnOverlay),t.preventDefault()):(this.focusedOptionIndex!==-1&&this.onOptionSelect(t,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(this.filter)))},onBackspaceKey:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r&&!this.overlayVisible&&this.show()},onOverlayEnter:function(t){ZIndexUtils.set("overlay",t,this.$primevue.config.zIndex.overlay),DomHandler.addStyles(t,{position:"absolute",top:"0",left:"0"}),this.alignOverlay(),this.scrollInView(),this.autoFilterFocus&&DomHandler.focus(this.$refs.filterInput)},onOverlayAfterEnter:function(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onOverlayLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.overlay=null},onOverlayAfterLeave:function(t){ZIndexUtils.clear(t)},alignOverlay:function(){this.appendTo==="self"?DomHandler.relativePosition(this.overlay,this.$el):(this.overlay.style.minWidth=DomHandler.getOuterWidth(this.$el)+"px",DomHandler.absolutePosition(this.overlay,this.$el))},bindOutsideClickListener:function(){var t=this;this.outsideClickListener||(this.outsideClickListener=function(r){t.overlayVisible&&t.overlay&&!t.$el.contains(r.target)&&!t.overlay.contains(r.target)&&t.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener:function(){var t=this;this.scrollHandler||(this.scrollHandler=new ConnectedOverlayScrollHandler(this.$refs.container,function(){t.overlayVisible&&t.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var t=this;this.resizeListener||(this.resizeListener=function(){t.overlayVisible&&!DomHandler.isTouchDevice()&&t.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},hasFocusableElements:function(){return DomHandler.getFocusableElements(this.overlay,':not([data-p-hidden-focusable="true"])').length>0},isOptionMatched:function(t){return this.isValidOption(t)&&this.getOptionLabel(t).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))},isValidOption:function(t){return ObjectUtils.isNotEmpty(t)&&!(this.isOptionDisabled(t)||this.isOptionGroup(t))},isValidSelectedOption:function(t){return this.isValidOption(t)&&this.isSelected(t)},isSelected:function(t){return this.isValidOption(t)&&ObjectUtils.equals(this.modelValue,this.getOptionValue(t),this.equalityKey)},findFirstOptionIndex:function(){var t=this;return this.visibleOptions.findIndex(function(r){return t.isValidOption(r)})},findLastOptionIndex:function(){var t=this;return ObjectUtils.findLastIndex(this.visibleOptions,function(r){return t.isValidOption(r)})},findNextOptionIndex:function(t){var r=this,s=t<this.visibleOptions.length-1?this.visibleOptions.slice(t+1).findIndex(function(i){return r.isValidOption(i)}):-1;return s>-1?s+t+1:t},findPrevOptionIndex:function(t){var r=this,s=t>0?ObjectUtils.findLastIndex(this.visibleOptions.slice(0,t),function(i){return r.isValidOption(i)}):-1;return s>-1?s:t},findSelectedOptionIndex:function(){var t=this;return this.hasSelectedOption?this.visibleOptions.findIndex(function(r){return t.isValidSelectedOption(r)}):-1},findFirstFocusedOptionIndex:function(){var t=this.findSelectedOptionIndex();return t<0?this.findFirstOptionIndex():t},findLastFocusedOptionIndex:function(){var t=this.findSelectedOptionIndex();return t<0?this.findLastOptionIndex():t},searchOptions:function(t,r){var s=this;this.searchValue=(this.searchValue||"")+r;var i=-1,o=!1;return this.focusedOptionIndex!==-1?(i=this.visibleOptions.slice(this.focusedOptionIndex).findIndex(function(l){return s.isOptionMatched(l)}),i=i===-1?this.visibleOptions.slice(0,this.focusedOptionIndex).findIndex(function(l){return s.isOptionMatched(l)}):i+this.focusedOptionIndex):i=this.visibleOptions.findIndex(function(l){return s.isOptionMatched(l)}),i!==-1&&(o=!0),i===-1&&this.focusedOptionIndex===-1&&(i=this.findFirstFocusedOptionIndex()),i!==-1&&this.changeFocusedOptionIndex(t,i),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){s.searchValue="",s.searchTimeout=null},500),o},changeFocusedOptionIndex:function(t,r){this.focusedOptionIndex!==r&&(this.focusedOptionIndex=r,this.scrollInView(),this.selectOnFocus&&this.onOptionSelect(t,this.visibleOptions[r],!1))},scrollInView:function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,s=r!==-1?"".concat(this.id,"_").concat(r):this.focusedOptionId,i=DomHandler.findSingle(this.list,'li[id="'.concat(s,'"]'));i?i.scrollIntoView&&i.scrollIntoView({block:"nearest",inline:"start"}):this.virtualScrollerDisabled||setTimeout(function(){t.virtualScroller&&t.virtualScroller.scrollToIndex(r!==-1?r:t.focusedOptionIndex)},0)},autoUpdateModel:function(){this.selectOnFocus&&this.autoOptionFocus&&!this.hasSelectedOption&&(this.focusedOptionIndex=this.findFirstFocusedOptionIndex(),this.onOptionSelect(null,this.visibleOptions[this.focusedOptionIndex],!1))},updateModel:function(t,r){this.$emit("update:modelValue",r),this.$emit("change",{originalEvent:t,value:r})},flatOptions:function(t){var r=this;return(t||[]).reduce(function(s,i,o){s.push({optionGroup:i,group:!0,index:o});var l=r.getOptionGroupChildren(i);return l&&l.forEach(function(f){return s.push(f)}),s},[])},overlayRef:function(t){this.overlay=t},listRef:function(t,r){this.list=t,r&&r(t)},virtualScrollerRef:function(t){this.virtualScroller=t}},computed:{visibleOptions:function(){var t=this,r=this.optionGroupLabel?this.flatOptions(this.options):this.options||[];if(this.filterValue){var s=FilterService.filter(r,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);if(this.optionGroupLabel){var i=this.options||[],o=[];return i.forEach(function(l){var f=t.getOptionGroupChildren(l),u=f.filter(function(g){return s.includes(g)});u.length>0&&o.push(_objectSpread$1(_objectSpread$1({},l),{},_defineProperty$1({},typeof t.optionGroupChildren=="string"?t.optionGroupChildren:"items",_toConsumableArray(u))))}),this.flatOptions(o)}return s}return r},hasSelectedOption:function(){return ObjectUtils.isNotEmpty(this.modelValue)},label:function(){var t=this.findSelectedOptionIndex();return t!==-1?this.getOptionLabel(this.visibleOptions[t]):this.placeholder||"p-emptylabel"},editableInputValue:function(){var t=this.findSelectedOptionIndex();return t!==-1?this.getOptionLabel(this.visibleOptions[t]):this.modelValue||""},equalityKey:function(){return this.optionValue?null:this.dataKey},searchFields:function(){return this.filterFields||[this.optionLabel]},filterResultMessageText:function(){return ObjectUtils.isNotEmpty(this.visibleOptions)?this.filterMessageText.replaceAll("{0}",this.visibleOptions.length):this.emptyFilterMessageText},filterMessageText:function(){return this.filterMessage||this.$primevue.config.locale.searchMessage||""},emptyFilterMessageText:function(){return this.emptyFilterMessage||this.$primevue.config.locale.emptySearchMessage||this.$primevue.config.locale.emptyFilterMessage||""},emptyMessageText:function(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage||""},selectionMessageText:function(){return this.selectionMessage||this.$primevue.config.locale.selectionMessage||""},emptySelectionMessageText:function(){return this.emptySelectionMessage||this.$primevue.config.locale.emptySelectionMessage||""},selectedMessageText:function(){return this.hasSelectedOption?this.selectionMessageText.replaceAll("{0}","1"):this.emptySelectionMessageText},focusedOptionId:function(){return this.focusedOptionIndex!==-1?"".concat(this.id,"_").concat(this.focusedOptionIndex):null},ariaSetSize:function(){var t=this;return this.visibleOptions.filter(function(r){return!t.isOptionGroup(r)}).length},virtualScrollerDisabled:function(){return!this.virtualScrollerOptions}},directives:{ripple:Ripple},components:{VirtualScroller:script$2,Portal:script$3,TimesIcon:script$4,ChevronDownIcon:script$6,SpinnerIcon:script$c,FilterIcon:script$5}};function _typeof(n){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(n)}function ownKeys(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.push.apply(r,s)}return r}function _objectSpread(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(s){_defineProperty(n,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(r,s))})}return n}function _defineProperty(n,t,r){return t=_toPropertyKey(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _toPropertyKey(n){var t=_toPrimitive(n,"string");return _typeof(t)==="symbol"?t:String(t)}function _toPrimitive(n,t){if(_typeof(n)!=="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var s=r.call(n,t||"default");if(_typeof(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}var _hoisted_1$6=["id"],_hoisted_2$5=["id","value","placeholder","tabindex","disabled","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant"],_hoisted_3$4=["id","tabindex","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-disabled"],_hoisted_4$2=["value","placeholder","aria-owns","aria-activedescendant"],_hoisted_5$2=["id"],_hoisted_6$2=["id"],_hoisted_7$2=["id","aria-label","aria-selected","aria-disabled","aria-setsize","aria-posinset","onClick","onMousemove","data-p-highlight","data-p-focused","data-p-disabled"];function render(n,t,r,s,i,o){var l=resolveComponent("SpinnerIcon"),f=resolveComponent("VirtualScroller"),u=resolveComponent("Portal"),g=resolveDirective("ripple");return openBlock(),createElementBlock("div",mergeProps({ref:"container",id:i.id,class:n.cx("root"),onClick:t[15]||(t[15]=function(){return o.onContainerClick&&o.onContainerClick.apply(o,arguments)})},n.ptm("root"),{"data-pc-name":"dropdown"}),[n.editable?(openBlock(),createElementBlock("input",mergeProps({key:0,ref:"focusInput",id:n.inputId,type:"text",class:[n.cx("input"),n.inputClass],style:n.inputStyle,value:o.editableInputValue,placeholder:n.placeholder,tabindex:n.disabled?-1:n.tabindex,disabled:n.disabled,autocomplete:"off",role:"combobox","aria-label":n.ariaLabel,"aria-labelledby":n.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":i.overlayVisible,"aria-controls":i.id+"_list","aria-activedescendant":i.focused?o.focusedOptionId:void 0,onFocus:t[0]||(t[0]=function(){return o.onFocus&&o.onFocus.apply(o,arguments)}),onBlur:t[1]||(t[1]=function(){return o.onBlur&&o.onBlur.apply(o,arguments)}),onKeydown:t[2]||(t[2]=function(){return o.onKeyDown&&o.onKeyDown.apply(o,arguments)}),onInput:t[3]||(t[3]=function(){return o.onEditableInput&&o.onEditableInput.apply(o,arguments)})},_objectSpread(_objectSpread({},n.inputProps),n.ptm("input"))),null,16,_hoisted_2$5)):(openBlock(),createElementBlock("span",mergeProps({key:1,ref:"focusInput",id:n.inputId,class:[n.cx("input"),n.inputClass],style:n.inputStyle,tabindex:n.disabled?-1:n.tabindex,role:"combobox","aria-label":n.ariaLabel||(o.label==="p-emptylabel"?void 0:o.label),"aria-labelledby":n.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":i.overlayVisible,"aria-controls":i.id+"_list","aria-activedescendant":i.focused?o.focusedOptionId:void 0,"aria-disabled":n.disabled,onFocus:t[4]||(t[4]=function(){return o.onFocus&&o.onFocus.apply(o,arguments)}),onBlur:t[5]||(t[5]=function(){return o.onBlur&&o.onBlur.apply(o,arguments)}),onKeydown:t[6]||(t[6]=function(){return o.onKeyDown&&o.onKeyDown.apply(o,arguments)})},_objectSpread(_objectSpread({},n.inputProps),n.ptm("input"))),[renderSlot(n.$slots,"value",{value:n.modelValue,placeholder:n.placeholder},function(){return[createTextVNode(toDisplayString(o.label==="p-emptylabel"?" ":o.label||"empty"),1)]})],16,_hoisted_3$4)),n.showClear&&n.modelValue!=null?renderSlot(n.$slots,"clearicon",{key:2,class:normalizeClass(n.cx("clearIcon")),onClick:o.onClearClick,clearCallback:o.onClearClick},function(){return[(openBlock(),createBlock(resolveDynamicComponent(n.clearIcon?"i":"TimesIcon"),mergeProps({ref:"clearIcon",class:[n.cx("clearIcon"),n.clearIcon],onClick:o.onClearClick},_objectSpread(_objectSpread({},n.clearIconProps),n.ptm("clearIcon")),{"data-pc-section":"clearicon"}),null,16,["class","onClick"]))]}):createCommentVNode("",!0),createBaseVNode("div",mergeProps({class:n.cx("trigger")},n.ptm("trigger")),[n.loading?renderSlot(n.$slots,"loadingicon",{key:0,class:normalizeClass(n.cx("loadingIcon"))},function(){return[n.loadingIcon?(openBlock(),createElementBlock("span",mergeProps({key:0,class:[n.cx("loadingIcon"),"pi-spin",n.loadingIcon],"aria-hidden":"true"},n.ptm("loadingIcon")),null,16)):(openBlock(),createBlock(l,mergeProps({key:1,class:n.cx("loadingIcon"),spin:"","aria-hidden":"true"},n.ptm("loadingIcon")),null,16,["class"]))]}):renderSlot(n.$slots,"dropdownicon",{key:1,class:normalizeClass(n.cx("dropdownIcon"))},function(){return[(openBlock(),createBlock(resolveDynamicComponent(n.dropdownIcon?"span":"ChevronDownIcon"),mergeProps({class:[n.cx("dropdownIcon"),n.dropdownIcon],"aria-hidden":"true"},n.ptm("dropdownIcon")),null,16,["class"]))]})],16),createVNode(u,{appendTo:n.appendTo},{default:withCtx(function(){return[createVNode(Transition,mergeProps({name:"p-connected-overlay",onEnter:o.onOverlayEnter,onAfterEnter:o.onOverlayAfterEnter,onLeave:o.onOverlayLeave,onAfterLeave:o.onOverlayAfterLeave},n.ptm("transition")),{default:withCtx(function(){return[i.overlayVisible?(openBlock(),createElementBlock("div",mergeProps({key:0,ref:o.overlayRef,class:[n.cx("panel"),n.panelClass],style:n.panelStyle,onClick:t[13]||(t[13]=function(){return o.onOverlayClick&&o.onOverlayClick.apply(o,arguments)}),onKeydown:t[14]||(t[14]=function(){return o.onOverlayKeyDown&&o.onOverlayKeyDown.apply(o,arguments)})},_objectSpread(_objectSpread({},n.panelProps),n.ptm("panel"))),[createBaseVNode("span",mergeProps({ref:"firstHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:t[7]||(t[7]=function(){return o.onFirstHiddenFocus&&o.onFirstHiddenFocus.apply(o,arguments)})},n.ptm("hiddenFirstFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16),renderSlot(n.$slots,"header",{value:n.modelValue,options:o.visibleOptions}),n.filter?(openBlock(),createElementBlock("div",mergeProps({key:0,class:n.cx("header")},n.ptm("header")),[createBaseVNode("div",mergeProps({class:n.cx("filterContainer")},n.ptm("filterContainer")),[createBaseVNode("input",mergeProps({ref:"filterInput",type:"text",value:i.filterValue,onVnodeMounted:t[8]||(t[8]=function(){return o.onFilterUpdated&&o.onFilterUpdated.apply(o,arguments)}),class:n.cx("filterInput"),placeholder:n.filterPlaceholder,role:"searchbox",autocomplete:"off","aria-owns":i.id+"_list","aria-activedescendant":o.focusedOptionId,onKeydown:t[9]||(t[9]=function(){return o.onFilterKeyDown&&o.onFilterKeyDown.apply(o,arguments)}),onBlur:t[10]||(t[10]=function(){return o.onFilterBlur&&o.onFilterBlur.apply(o,arguments)}),onInput:t[11]||(t[11]=function(){return o.onFilterChange&&o.onFilterChange.apply(o,arguments)})},_objectSpread(_objectSpread({},n.filterInputProps),n.ptm("filterInput"))),null,16,_hoisted_4$2),renderSlot(n.$slots,"filtericon",{class:normalizeClass(n.cx("filterIcon"))},function(){return[(openBlock(),createBlock(resolveDynamicComponent(n.filterIcon?"span":"FilterIcon"),mergeProps({class:[n.cx("filterIcon"),n.filterIcon]},n.ptm("filterIcon")),null,16,["class"]))]})],16),createBaseVNode("span",mergeProps({role:"status","aria-live":"polite",class:"p-hidden-accessible"},n.ptm("hiddenFilterResult"),{"data-p-hidden-accessible":!0}),toDisplayString(o.filterResultMessageText),17)],16)):createCommentVNode("",!0),createBaseVNode("div",mergeProps({class:n.cx("wrapper"),style:{"max-height":o.virtualScrollerDisabled?n.scrollHeight:""}},n.ptm("wrapper")),[createVNode(f,mergeProps({ref:o.virtualScrollerRef},n.virtualScrollerOptions,{items:o.visibleOptions,style:{height:n.scrollHeight},tabindex:-1,disabled:o.virtualScrollerDisabled,pt:n.ptm("virtualScroller")}),createSlots({content:withCtx(function(y){var a=y.styleClass,m=y.contentRef,_=y.items,b=y.getItemOptions,c=y.contentStyle,w=y.itemSize;return[createBaseVNode("ul",mergeProps({ref:function(E){return o.listRef(E,m)},id:i.id+"_list",class:[n.cx("list"),a],style:c,role:"listbox"},n.ptm("list")),[(openBlock(!0),createElementBlock(Fragment,null,renderList(_,function(S,E){return openBlock(),createElementBlock(Fragment,{key:o.getOptionRenderKey(S,o.getOptionIndex(E,b))},[o.isOptionGroup(S)?(openBlock(),createElementBlock("li",mergeProps({key:0,id:i.id+"_"+o.getOptionIndex(E,b),style:{height:w?w+"px":void 0},class:n.cx("itemGroup"),role:"option"},n.ptm("itemGroup")),[renderSlot(n.$slots,"optiongroup",{option:S.optionGroup,index:o.getOptionIndex(E,b)},function(){return[createTextVNode(toDisplayString(o.getOptionGroupLabel(S.optionGroup)),1)]})],16,_hoisted_6$2)):withDirectives((openBlock(),createElementBlock("li",mergeProps({key:1,id:i.id+"_"+o.getOptionIndex(E,b),class:n.cx("item",{option:S,focusedOption:o.getOptionIndex(E,b)}),style:{height:w?w+"px":void 0},role:"option","aria-label":o.getOptionLabel(S),"aria-selected":o.isSelected(S),"aria-disabled":o.isOptionDisabled(S),"aria-setsize":o.ariaSetSize,"aria-posinset":o.getAriaPosInset(o.getOptionIndex(E,b)),onClick:function(A){return o.onOptionSelect(A,S)},onMousemove:function(A){return o.onOptionMouseMove(A,o.getOptionIndex(E,b))},"data-p-highlight":o.isSelected(S),"data-p-focused":i.focusedOptionIndex===o.getOptionIndex(E,b),"data-p-disabled":o.isOptionDisabled(S)},o.getPTItemOptions(S,b,E,"item")),[renderSlot(n.$slots,"option",{option:S,index:o.getOptionIndex(E,b)},function(){return[createTextVNode(toDisplayString(o.getOptionLabel(S)),1)]})],16,_hoisted_7$2)),[[g]])],64)}),128)),i.filterValue&&(!_||_&&_.length===0)?(openBlock(),createElementBlock("li",mergeProps({key:0,class:n.cx("emptyMessage"),role:"option"},n.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[renderSlot(n.$slots,"emptyfilter",{},function(){return[createTextVNode(toDisplayString(o.emptyFilterMessageText),1)]})],16)):!n.options||n.options&&n.options.length===0?(openBlock(),createElementBlock("li",mergeProps({key:1,class:n.cx("emptyMessage"),role:"option"},n.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[renderSlot(n.$slots,"empty",{},function(){return[createTextVNode(toDisplayString(o.emptyMessageText),1)]})],16)):createCommentVNode("",!0)],16,_hoisted_5$2)]}),_:2},[n.$slots.loader?{name:"loader",fn:withCtx(function(y){var a=y.options;return[renderSlot(n.$slots,"loader",{options:a})]}),key:"0"}:void 0]),1040,["items","style","disabled","pt"])],16),renderSlot(n.$slots,"footer",{value:n.modelValue,options:o.visibleOptions}),!n.options||n.options&&n.options.length===0?(openBlock(),createElementBlock("span",mergeProps({key:1,role:"status","aria-live":"polite",class:"p-hidden-accessible"},n.ptm("hiddenEmptyMessage"),{"data-p-hidden-accessible":!0}),toDisplayString(o.emptyMessageText),17)):createCommentVNode("",!0),createBaseVNode("span",mergeProps({role:"status","aria-live":"polite",class:"p-hidden-accessible"},n.ptm("hiddenSelectedMessage"),{"data-p-hidden-accessible":!0}),toDisplayString(o.selectedMessageText),17),createBaseVNode("span",mergeProps({ref:"lastHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:t[12]||(t[12]=function(){return o.onLastHiddenFocus&&o.onLastHiddenFocus.apply(o,arguments)})},n.ptm("hiddenLastFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16)],16)):createCommentVNode("",!0)]}),_:3},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])],16,_hoisted_1$6)}script.render=render;function isObject(n){return typeof n=="object"&&n!==null}function normalizeOptions(n,t){return n=isObject(n)?n:Object.create(null),new Proxy(n,{get(r,s,i){return s==="key"?Reflect.get(r,s,i):Reflect.get(r,s,i)||Reflect.get(t,s,i)}})}function get(n,t){return t.reduce((r,s)=>r==null?void 0:r[s],n)}function set(n,t,r){return t.slice(0,-1).reduce((s,i)=>/^(__proto__)$/.test(i)?{}:s[i]=s[i]||{},n)[t[t.length-1]]=r,n}function pick$1(n,t){return t.reduce((r,s)=>{const i=s.split(".");return set(r,i,get(n,i))},{})}function parsePersistence(n,t){return r=>{var s;try{const{storage:i=localStorage,beforeRestore:o=void 0,afterRestore:l=void 0,serializer:f={serialize:JSON.stringify,deserialize:JSON.parse},key:u=t.$id,paths:g=null,debug:y=!1}=r;return{storage:i,beforeRestore:o,afterRestore:l,serializer:f,key:((s=n.key)!=null?s:a=>a)(typeof u=="string"?u:u(t.$id)),paths:g,debug:y}}catch(i){return r.debug&&console.error("[pinia-plugin-persistedstate]",i),null}}}function hydrateStore(n,{storage:t,serializer:r,key:s,debug:i}){try{const o=t==null?void 0:t.getItem(s);o&&n.$patch(r==null?void 0:r.deserialize(o))}catch(o){i&&console.error("[pinia-plugin-persistedstate]",o)}}function persistState(n,{storage:t,serializer:r,key:s,paths:i,debug:o}){try{const l=Array.isArray(i)?pick$1(n,i):n;t.setItem(s,r.serialize(l))}catch(l){o&&console.error("[pinia-plugin-persistedstate]",l)}}function createPersistedState(n={}){return t=>{const{auto:r=!1}=n,{options:{persist:s=r},store:i,pinia:o}=t;if(!s)return;if(!(i.$id in o.state.value)){const f=o._s.get(i.$id.replace("__hot:",""));f&&Promise.resolve().then(()=>f.$persist());return}const l=(Array.isArray(s)?s.map(f=>normalizeOptions(f,n)):[normalizeOptions(s,n)]).map(parsePersistence(n,i)).filter(Boolean);i.$persist=()=>{l.forEach(f=>{persistState(i.$state,f)})},i.$hydrate=({runHooks:f=!0}={})=>{l.forEach(u=>{const{beforeRestore:g,afterRestore:y}=u;f&&(g==null||g(t)),hydrateStore(i,u),f&&(y==null||y(t))})},l.forEach(f=>{const{beforeRestore:u,afterRestore:g}=f;u==null||u(t),hydrateStore(i,f),g==null||g(t),i.$subscribe((y,a)=>{persistState(a,f)},{detached:!0})})}}var src_default=createPersistedState();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EPSILON_FLOAT32=1e-7,EPSILON_FLOAT16=1e-4;class DataStorage{constructor(t,r){this.backend=t,this.dataMover=r,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,r){this.dataIdsCount++,this.data.set(t,r)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class KernelBackend{refCount(t){return notYetImplemented("refCount")}incRef(t){return notYetImplemented("incRef")}timerAvailable(){return!0}time(t){return notYetImplemented("time")}read(t){return notYetImplemented("read")}readSync(t){return notYetImplemented("readSync")}readToGPU(t,r){return notYetImplemented("readToGPU")}numDataIds(){return notYetImplemented("numDataIds")}disposeData(t,r){return notYetImplemented("disposeData")}write(t,r,s){return notYetImplemented("write")}move(t,r,s,i,o){return notYetImplemented("move")}createTensorFromGPUData(t,r,s){return notYetImplemented("createTensorFromGPUData")}memory(){return notYetImplemented("memory")}floatPrecision(){return notYetImplemented("floatPrecision")}epsilon(){return this.floatPrecision()===32?EPSILON_FLOAT32:EPSILON_FLOAT16}dispose(){return notYetImplemented("dispose")}}function notYetImplemented(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function clamp(n,t,r){return Math.max(n,Math.min(t,r))}function swap(n,t,r){const s=n[t];n[t]=n[r],n[r]=s}function assert(n,t){if(!n)throw new Error(typeof t=="string"?t:t())}function assertShapesMatch(n,t,r=""){assert(arraysEqual(n,t),()=>r+` Shapes ${n} and ${t} must match`)}function sizeFromShape(n){if(n.length===0)return 1;let t=n[0];for(let r=1;r<n.length;r++)t*=n[r];return t}function arraysEqual(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(let r=0;r<n.length;r++)if(n[r]!==t[r])return!1;return!0}function isInt(n){return n%1===0}function rightPad(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function inferFromImplicitShape(n,t){let r=1,s=-1;for(let o=0;o<n.length;++o)if(n[o]>=0)r*=n[o];else if(n[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(n[o]<0)throw Error(`Shapes can not be < 0. Found ${n[o]} at dim ${o}`);if(s===-1){if(t>0&&t!==r)throw Error(`Size(${t}) must match the product of shape ${n}`);return n}if(r===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(t%r!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${r}`);const i=n.slice();return i[s]=t/r,i}function parseAxisParam(n,t){const r=t.length;return n=n==null?t.map((s,i)=>i):[].concat(n),assert(n.every(s=>s>=-r&&s<r),()=>`All values in axis param must be in range [-${r}, ${r}) but got axis ${n}`),assert(n.every(s=>isInt(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?r+s:s)}function getTypedArrayFromDType(n,t){return getArrayFromDType(n,t)}function getArrayFromDType(n,t){let r=null;if(n==null||n==="float32")r=new Float32Array(t);else if(n==="int32")r=new Int32Array(t);else if(n==="bool")r=new Uint8Array(t);else if(n==="string")r=new Array(t);else throw new Error(`Unknown data type ${n}`);return r}function checkConversionForErrors(n,t){for(let r=0;r<n.length;r++){const s=n[r];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function isValidDtype(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function hasEncodingLoss(n,t){return!(t==="complex64"||t==="float32"&&n!=="complex64"||t==="int32"&&n!=="float32"&&n!=="complex64"||t==="bool"&&n==="bool")}function bytesPerElement(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function bytesFromStringArray(n){if(n==null)return 0;let t=0;return n.forEach(r=>t+=r.length),t}function isString(n){return typeof n=="string"||n instanceof String}function isBoolean(n){return typeof n=="boolean"}function isNumber(n){return typeof n=="number"}function inferDtype(n){return Array.isArray(n)?inferDtype(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":isNumber(n)?"float32":isString(n)?"string":isBoolean(n)?"bool":"float32"}function isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)}function computeStrides(n){const t=n.length;if(t<2)return[];const r=new Array(t-1);r[t-2]=n[t-1];for(let s=t-3;s>=0;--s)r[s]=r[s+1]*n[s+1];return r}function createNestedArray(n,t,r,s=!1){const i=new Array;if(t.length===1){const o=t[0]*(s?2:1);for(let l=0;l<o;l++)i[l]=r[n+l]}else{const o=t[0],l=t.slice(1),f=l.reduce((u,g)=>u*g)*(s?2:1);for(let u=0;u<o;u++)i[u]=createNestedArray(n+u*f,l,r,s)}return i}function toNestedArray(n,t,r=!1){if(n.length===0)return t[0];const s=n.reduce((i,o)=>i*o)*(r?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${n}] does not match the input size ${t.length}${r?" for a complex tensor":""}.`);return createNestedArray(0,n,t,r)}function convertBackendValuesAndArrayBuffer(n,t){if(Array.isArray(n))return n;if(t==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(t==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${t}`)}function makeOnesTypedArray(n,t){const r=makeZerosTypedArray(n,t);for(let s=0;s<r.length;s++)r[s]=1;return r}function makeZerosTypedArray(n,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${t}`)}function makeZerosNestedTypedArray(n,t){const r=n.reduce((s,i)=>s*i,1);if(t==null||t==="float32")return toNestedArray(n,new Float32Array(r));if(t==="int32")return toNestedArray(n,new Int32Array(r));if(t==="bool")return toNestedArray(n,new Uint8Array(r));throw new Error(`Unknown data type ${t}`)}function assertNonNegativeIntegerDimensions(n){n.forEach(t=>{assert(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function locToIndex(n,t,r){if(t===0)return 0;if(t===1)return n[0];let s=n[n.length-1];for(let i=0;i<n.length-1;++i)s+=r[i]*n[i];return s}function indexToLoc(n,t,r){if(t===0)return[];if(t===1)return[n];const s=new Array(t);for(let i=0;i<s.length-1;++i)s[i]=Math.floor(n/r[i]),n-=s[i]*r[i];return s[s.length-1]=n,s}function isPromise(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TENSORFLOWJS_FLAGS_PREFIX="tfjsflags";class Environment{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=getQueryParams,this.populateURLFlags()}setPlatform(t,r){this.platform!=null&&(env().getBool("IS_TEST")||env().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=r}registerFlag(t,r,s){if(this.flagRegistry[t]={evaluationFn:r,setHook:s},this.urlFlags[t]!=null){const i=this.urlFlags[t];env().getBool("IS_TEST")||env().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const r=this.evaluateFlag(t);if(isPromise(r))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=r,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,r){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=r,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(r)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);TENSORFLOWJS_FLAGS_PREFIX in t&&t[TENSORFLOWJS_FLAGS_PREFIX].split(",").forEach(s=>{const[i,o]=s.split(":");this.urlFlags[i]=parseValue(i,o)})}}function getQueryParams(n){const t={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(r,...s)=>(decodeParam(t,s[0],s[1]),s.join("="))),t}function decodeParam(n,t,r){n[decodeURIComponent(t)]=decodeURIComponent(r||"")}function parseValue(n,t){const r=t.toLowerCase();return r==="true"||r==="false"?r==="true":`${+r}`===r?+r:t}function env(){return ENV$1}let ENV$1=null;function setEnvironmentGlobal(n){ENV$1=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let globalNameSpace;function getGlobalNamespace(){if(globalNameSpace==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");globalNameSpace=n}return globalNameSpace}function getGlobalMap(){const n=getGlobalNamespace();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function getGlobal(n,t){const r=getGlobalMap();if(r.has(n))return r.get(n);{const s=t();return r.set(n,s),r.get(n)}}const Abs="Abs",Acos="Acos",Acosh="Acosh",Add="Add",AddN="AddN",All="All",Any="Any",ArgMax="ArgMax",ArgMin="ArgMin",Asin="Asin",Asinh="Asinh",Atan="Atan",Atanh="Atanh",Atan2="Atan2",AvgPool="AvgPool",AvgPoolGrad="AvgPoolGrad",AvgPool3D="AvgPool3D",AvgPool3DGrad="AvgPool3DGrad",BatchMatMul="BatchMatMul",BatchToSpaceND="BatchToSpaceND",Bincount="Bincount",BitwiseAnd="BitwiseAnd",BroadcastArgs="BroadcastArgs",Cast="Cast",Ceil="Ceil",ClipByValue="ClipByValue",Complex="Complex",ComplexAbs="ComplexAbs",Concat="Concat",Conv2D="Conv2D",Conv2DBackpropFilter="Conv2DBackpropFilter",Conv2DBackpropInput="Conv2DBackpropInput",Conv3D="Conv3D",Conv3DBackpropFilterV2="Conv3DBackpropFilterV2",Conv3DBackpropInputV2="Conv3DBackpropInputV2",Cos="Cos",Cosh="Cosh",Cumprod="Cumprod",Cumsum="Cumsum",CropAndResize="CropAndResize",DenseBincount="DenseBincount",DepthToSpace="DepthToSpace",DepthwiseConv2dNative="DepthwiseConv2dNative",DepthwiseConv2dNativeBackpropFilter="DepthwiseConv2dNativeBackpropFilter",DepthwiseConv2dNativeBackpropInput="DepthwiseConv2dNativeBackpropInput",Diag="Diag",Dilation2D="Dilation2D",Dilation2DBackpropInput="Dilation2DBackpropInput",Dilation2DBackpropFilter="Dilation2DBackpropFilter",Draw="Draw",RealDiv="RealDiv",Einsum="Einsum",Elu="Elu",EluGrad="EluGrad",Erf="Erf",Equal="Equal",Exp="Exp",ExpandDims="ExpandDims",Expm1="Expm1",FFT="FFT",Fill="Fill",FlipLeftRight="FlipLeftRight",Floor="Floor",FloorDiv="FloorDiv",FusedBatchNorm="FusedBatchNorm",GatherV2="GatherV2",GatherNd="GatherNd",Greater="Greater",GreaterEqual="GreaterEqual",Identity="Identity",IFFT="IFFT",Imag="Imag",IsFinite="IsFinite",IsInf="IsInf",IsNan="IsNan",LeakyRelu="LeakyRelu",Less="Less",LessEqual="LessEqual",LinSpace="LinSpace",Log="Log",Log1p="Log1p",LogicalAnd="LogicalAnd",LogicalNot="LogicalNot",LogicalOr="LogicalOr",LRN="LRN",LRNGrad="LRNGrad",Max="Max",Maximum="Maximum",MaxPool="MaxPool",MaxPoolGrad="MaxPoolGrad",MaxPool3D="MaxPool3D",MaxPool3DGrad="MaxPool3DGrad",MaxPoolWithArgmax="MaxPoolWithArgmax",Mean="Mean",Min="Min",Minimum="Minimum",MirrorPad="MirrorPad",Mod="Mod",Multinomial="Multinomial",Multiply="Multiply",Neg="Neg",NotEqual="NotEqual",NonMaxSuppressionV3="NonMaxSuppressionV3",NonMaxSuppressionV4="NonMaxSuppressionV4",NonMaxSuppressionV5="NonMaxSuppressionV5",OnesLike="OnesLike",OneHot="OneHot",Pack="Pack",PadV2="PadV2",Pow="Pow",Prelu="Prelu",Prod="Prod",RaggedGather="RaggedGather",RaggedRange="RaggedRange",RaggedTensorToTensor="RaggedTensorToTensor",Range="Range",Real="Real",Reciprocal="Reciprocal",Relu="Relu",Reshape="Reshape",ResizeNearestNeighbor="ResizeNearestNeighbor",ResizeNearestNeighborGrad="ResizeNearestNeighborGrad",ResizeBilinear="ResizeBilinear",ResizeBilinearGrad="ResizeBilinearGrad",Relu6="Relu6",Reverse="Reverse",Round="Round",Rsqrt="Rsqrt",ScatterNd="ScatterNd",TensorScatterUpdate="TensorScatterUpdate",SearchSorted="SearchSorted",Select="Select",Selu="Selu",Slice="Slice",Sin="Sin",Sinh="Sinh",Sign="Sign",Sigmoid="Sigmoid",Softplus="Softplus",Sqrt="Sqrt",Sum="Sum",SpaceToBatchND="SpaceToBatchND",SplitV="SplitV",Softmax="Softmax",SparseFillEmptyRows="SparseFillEmptyRows",SparseReshape="SparseReshape",SparseSegmentMean="SparseSegmentMean",SparseSegmentSum="SparseSegmentSum",SparseToDense="SparseToDense",SquaredDifference="SquaredDifference",Square="Square",StaticRegexReplace="StaticRegexReplace",StridedSlice="StridedSlice",StringNGrams="StringNGrams",StringSplit="StringSplit",StringToHashBucketFast="StringToHashBucketFast",Sub="Sub",Tan="Tan",Tanh="Tanh",Tile="Tile",TopK="TopK",Transform="Transform",Transpose="Transpose",Unique="Unique",Unpack="Unpack",UnsortedSegmentSum="UnsortedSegmentSum",ZerosLike="ZerosLike",Step="Step",RotateWithOffset="RotateWithOffset",_FusedMatMul="_FusedMatMul",FusedConv2D="FusedConv2D",FusedDepthwiseConv2D="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function warn(...n){env().getBool("IS_TEST")||env().getBool("PROD")||console.warn(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kernelRegistry=getGlobal("kernelRegistry",()=>new Map),gradRegistry=getGlobal("gradRegistry",()=>new Map);function getKernel(n,t){const r=makeKey(n,t);return kernelRegistry.get(r)}function getGradient(n){return gradRegistry.get(n)}function getKernelsForBackend(n){const t=kernelRegistry.entries(),r=[];for(;;){const{done:s,value:i}=t.next();if(s)break;const[o,l]=i,[f]=o.split("_");f===n&&r.push(l)}return r}function registerKernel(n){const{kernelName:t,backendName:r}=n,s=makeKey(t,r);kernelRegistry.has(s)&&warn(`The kernel '${t}' for backend '${r}' is already registered`),kernelRegistry.set(s,n)}function makeKey(n,t){return`${t}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function isTypedArrayBrowser(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getAugmentedNamespace(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var i=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:function(){return n[s]}})}),r}var long=Long$1,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Long$1(n,t,r){this.low=n|0,this.high=t|0,this.unsigned=!!r}Long$1.prototype.__isLong__;Object.defineProperty(Long$1.prototype,"__isLong__",{value:!0});function isLong(n){return(n&&n.__isLong__)===!0}Long$1.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(n,t){var r,s,i;return t?(n>>>=0,(i=0<=n&&n<256)&&(s=UINT_CACHE[n],s)?s:(r=fromBits(n,(n|0)<0?-1:0,!0),i&&(UINT_CACHE[n]=r),r)):(n|=0,(i=-128<=n&&n<128)&&(s=INT_CACHE[n],s)?s:(r=fromBits(n,n<0?-1:0,!1),i&&(INT_CACHE[n]=r),r))}Long$1.fromInt=fromInt;function fromNumber(n,t){if(isNaN(n))return t?UZERO:ZERO;if(t){if(n<0)return UZERO;if(n>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(n<=-TWO_PWR_63_DBL)return MIN_VALUE;if(n+1>=TWO_PWR_63_DBL)return MAX_VALUE}return n<0?fromNumber(-n,t).neg():fromBits(n%TWO_PWR_32_DBL|0,n/TWO_PWR_32_DBL|0,t)}Long$1.fromNumber=fromNumber;function fromBits(n,t,r){return new Long$1(n,t,r)}Long$1.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(n,t,r){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return ZERO;if(typeof t=="number"?(r=t,t=!1):t=!!t,r=r||10,r<2||36<r)throw RangeError("radix");var s;if((s=n.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return fromString(n.substring(1),t,r).neg();for(var i=fromNumber(pow_dbl(r,8)),o=ZERO,l=0;l<n.length;l+=8){var f=Math.min(8,n.length-l),u=parseInt(n.substring(l,l+f),r);if(f<8){var g=fromNumber(pow_dbl(r,f));o=o.mul(g).add(fromNumber(u))}else o=o.mul(i),o=o.add(fromNumber(u))}return o.unsigned=t,o}Long$1.fromString=fromString;function fromValue(n,t){return typeof n=="number"?fromNumber(n,t):typeof n=="string"?fromString(n,t):fromBits(n.low,n.high,typeof t=="boolean"?t:n.unsigned)}Long$1.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long$1.ZERO=ZERO;var UZERO=fromInt(0,!0);Long$1.UZERO=UZERO;var ONE=fromInt(1);Long$1.ONE=ONE;var UONE=fromInt(1,!0);Long$1.UONE=UONE;var NEG_ONE=fromInt(-1);Long$1.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long$1.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long$1.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long$1.MIN_VALUE=MIN_VALUE;var LongPrototype=Long$1.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low};LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)};LongPrototype.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(MIN_VALUE)){var r=fromNumber(t),s=this.div(r),i=s.mul(r).sub(this);return s.toString(t)+i.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var o=fromNumber(pow_dbl(t,6),this.unsigned),l=this,f="";;){var u=l.div(o),g=l.sub(u.mul(o)).toInt()>>>0,y=g.toString(t);if(l=u,l.isZero())return y+f;for(;y.length<6;)y="0"+y;f=""+y+f}};LongPrototype.getHighBits=function(){return this.high};LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0};LongPrototype.getLowBits=function(){return this.low};LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0};LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,r=31;r>0&&!(t&1<<r);r--);return this.high!=0?r+33:r+1};LongPrototype.isZero=function(){return this.high===0&&this.low===0};LongPrototype.eqz=LongPrototype.isZero;LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0};LongPrototype.isPositive=function(){return this.unsigned||this.high>=0};LongPrototype.isOdd=function(){return(this.low&1)===1};LongPrototype.isEven=function(){return(this.low&1)===0};LongPrototype.equals=function(t){return isLong(t)||(t=fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low};LongPrototype.eq=LongPrototype.equals;LongPrototype.notEquals=function(t){return!this.eq(t)};LongPrototype.neq=LongPrototype.notEquals;LongPrototype.ne=LongPrototype.notEquals;LongPrototype.lessThan=function(t){return this.comp(t)<0};LongPrototype.lt=LongPrototype.lessThan;LongPrototype.lessThanOrEqual=function(t){return this.comp(t)<=0};LongPrototype.lte=LongPrototype.lessThanOrEqual;LongPrototype.le=LongPrototype.lessThanOrEqual;LongPrototype.greaterThan=function(t){return this.comp(t)>0};LongPrototype.gt=LongPrototype.greaterThan;LongPrototype.greaterThanOrEqual=function(t){return this.comp(t)>=0};LongPrototype.gte=LongPrototype.greaterThanOrEqual;LongPrototype.ge=LongPrototype.greaterThanOrEqual;LongPrototype.compare=function(t){if(isLong(t)||(t=fromValue(t)),this.eq(t))return 0;var r=this.isNegative(),s=t.isNegative();return r&&!s?-1:!r&&s?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1};LongPrototype.comp=LongPrototype.compare;LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)};LongPrototype.neg=LongPrototype.negate;LongPrototype.add=function(t){isLong(t)||(t=fromValue(t));var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,o=this.low&65535,l=t.high>>>16,f=t.high&65535,u=t.low>>>16,g=t.low&65535,y=0,a=0,m=0,_=0;return _+=o+g,m+=_>>>16,_&=65535,m+=i+u,a+=m>>>16,m&=65535,a+=s+f,y+=a>>>16,a&=65535,y+=r+l,y&=65535,fromBits(m<<16|_,y<<16|a,this.unsigned)};LongPrototype.subtract=function(t){return isLong(t)||(t=fromValue(t)),this.add(t.neg())};LongPrototype.sub=LongPrototype.subtract;LongPrototype.multiply=function(t){if(this.isZero())return ZERO;if(isLong(t)||(t=fromValue(t)),wasm){var r=wasm.mul(this.low,this.high,t.low,t.high);return fromBits(r,wasm.get_high(),this.unsigned)}if(t.isZero())return ZERO;if(this.eq(MIN_VALUE))return t.isOdd()?MIN_VALUE:ZERO;if(t.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(TWO_PWR_24)&&t.lt(TWO_PWR_24))return fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var s=this.high>>>16,i=this.high&65535,o=this.low>>>16,l=this.low&65535,f=t.high>>>16,u=t.high&65535,g=t.low>>>16,y=t.low&65535,a=0,m=0,_=0,b=0;return b+=l*y,_+=b>>>16,b&=65535,_+=o*y,m+=_>>>16,_&=65535,_+=l*g,m+=_>>>16,_&=65535,m+=i*y,a+=m>>>16,m&=65535,m+=o*g,a+=m>>>16,m&=65535,m+=l*u,a+=m>>>16,m&=65535,a+=s*y+i*g+o*u+l*f,a&=65535,fromBits(_<<16|b,a<<16|m,this.unsigned)};LongPrototype.mul=LongPrototype.multiply;LongPrototype.divide=function(t){if(isLong(t)||(t=fromValue(t)),t.isZero())throw Error("division by zero");if(wasm){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var r=(this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,t.low,t.high);return fromBits(r,wasm.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?UZERO:ZERO;var s,i,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return UZERO;if(t.gt(this.shru(1)))return UONE;o=UZERO}else{if(this.eq(MIN_VALUE)){if(t.eq(ONE)||t.eq(NEG_ONE))return MIN_VALUE;if(t.eq(MIN_VALUE))return ONE;var l=this.shr(1);return s=l.div(t).shl(1),s.eq(ZERO)?t.isNegative()?ONE:NEG_ONE:(i=this.sub(t.mul(s)),o=s.add(i.div(t)),o)}else if(t.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=ZERO}for(i=this;i.gte(t);){s=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var f=Math.ceil(Math.log(s)/Math.LN2),u=f<=48?1:pow_dbl(2,f-48),g=fromNumber(s),y=g.mul(t);y.isNegative()||y.gt(i);)s-=u,g=fromNumber(s,this.unsigned),y=g.mul(t);g.isZero()&&(g=ONE),o=o.add(g),i=i.sub(y)}return o};LongPrototype.div=LongPrototype.divide;LongPrototype.modulo=function(t){if(isLong(t)||(t=fromValue(t)),wasm){var r=(this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,t.low,t.high);return fromBits(r,wasm.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))};LongPrototype.mod=LongPrototype.modulo;LongPrototype.rem=LongPrototype.modulo;LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)};LongPrototype.and=function(t){return isLong(t)||(t=fromValue(t)),fromBits(this.low&t.low,this.high&t.high,this.unsigned)};LongPrototype.or=function(t){return isLong(t)||(t=fromValue(t)),fromBits(this.low|t.low,this.high|t.high,this.unsigned)};LongPrototype.xor=function(t){return isLong(t)||(t=fromValue(t)),fromBits(this.low^t.low,this.high^t.high,this.unsigned)};LongPrototype.shiftLeft=function(t){return isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):fromBits(0,this.low<<t-32,this.unsigned)};LongPrototype.shl=LongPrototype.shiftLeft;LongPrototype.shiftRight=function(t){return isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)};LongPrototype.shr=LongPrototype.shiftRight;LongPrototype.shiftRightUnsigned=function(t){if(isLong(t)&&(t=t.toInt()),t&=63,t===0)return this;var r=this.high;if(t<32){var s=this.low;return fromBits(s>>>t|r<<32-t,r>>>t,this.unsigned)}else return t===32?fromBits(r,0,this.unsigned):fromBits(r>>>t-32,0,this.unsigned)};LongPrototype.shru=LongPrototype.shiftRightUnsigned;LongPrototype.shr_u=LongPrototype.shiftRightUnsigned;LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this};LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)};LongPrototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()};LongPrototype.toBytesLE=function(){var t=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]};LongPrototype.toBytesBE=function(){var t=this.high,r=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,r>>>24,r>>>16&255,r>>>8&255,r&255]};Long$1.fromBytes=function(t,r,s){return s?Long$1.fromBytesLE(t,r):Long$1.fromBytesBE(t,r)};Long$1.fromBytesLE=function(t,r){return new Long$1(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)};Long$1.fromBytesBE=function(t,r){return new Long$1(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)};const long$1=getDefaultExportFromCjs(long),LongExports=_mergeNamespaces({__proto__:null,default:long$1},[long]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Long=long$1||LongExports;function hexToLong(n){return Long.fromString(n,!0,16)}const k0=hexToLong("c3a5c85c97cb3127"),k1=hexToLong("b492b66fbe98f273"),k2=hexToLong("9ae16a3b2f90404f");function shiftMix(n){return n.xor(n.shru(47))}function fetch$2(n,t,r){const s=n.slice(t,t+r);return Long.fromBytes(Array.from(s),!0,!0)}function fetch64(n,t){return fetch$2(n,t,8)}function fetch32(n,t){return fetch$2(n,t,4)}function rotate64(n,t){return t===0?n:n.shru(t).or(n.shl(64-t))}function hashLen16(n,t,r=hexToLong("9ddfea08eb382d69")){let s=n.xor(t).mul(r);s=s.xor(s.shru(47));let i=t.xor(s).mul(r);return i=i.xor(i.shru(47)),i=i.mul(r),i}function weakHashLen32WithSeeds(n,t,r,s,i,o){i=i.add(n),o=rotate64(o.add(i).add(s),21);const l=i;return i=i.add(t),i=i.add(r),o=o.add(rotate64(i,44)),[i.add(s),o.add(l)]}function weakHashLen32WithSeedsStr(n,t,r,s){return weakHashLen32WithSeeds(fetch64(n,t),fetch64(n,t+8),fetch64(n,t+16),fetch64(n,t+24),r,s)}function hashLen0to16(n,t=n.length){if(t>=8){const r=k2.add(t*2),s=fetch64(n,0).add(k2),i=fetch64(n,t-8),o=rotate64(i,37).mul(r).add(s),l=rotate64(s,25).add(i).mul(r);return hashLen16(o,l,r)}if(t>=4){const r=k2.add(t*2),s=fetch32(n,0);return hashLen16(s.shl(3).add(t),fetch32(n,t-4),r)}if(t>0){const r=n[0],s=n[t>>1],i=n[t-1],o=r+(s<<8),l=t+(i<<2);return shiftMix(k2.mul(o).xor(k0.mul(l))).mul(k2)}return k2}function hashLen17to32(n,t=n.length){const r=k2.add(t*2),s=fetch64(n,0).mul(k1),i=fetch64(n,8),o=fetch64(n,t-8).mul(r),l=fetch64(n,t-16).mul(k2);return hashLen16(rotate64(s.add(i),43).add(rotate64(o,30)).add(l),s.add(rotate64(i.add(k2),18)).add(o),r)}function hashLen33to64(n,t=n.length){const r=k2.add(t*2),s=fetch64(n,0).mul(k2),i=fetch64(n,8),o=fetch64(n,t-8).mul(r),l=fetch64(n,t-16).mul(k2),f=rotate64(s.add(i),43).add(rotate64(o,30)).add(l),u=hashLen16(f,s.add(rotate64(i.add(k2),18)).add(o),r),g=fetch64(n,16).mul(r),y=fetch64(n,24),a=f.add(fetch64(n,t-32)).mul(r),m=u.add(fetch64(n,t-24)).mul(r);return hashLen16(rotate64(g.add(y),43).add(rotate64(a,30)).add(m),g.add(rotate64(y.add(s),18)).add(a),r)}function fingerPrint64(n,t=n.length){const r=Long.fromNumber(81,!0);if(t<=32)return t<=16?hashLen0to16(n,t):hashLen17to32(n,t);if(t<=64)return hashLen33to64(n,t);let s=r,i=r.mul(k1).add(113),o=shiftMix(i.mul(k2).add(113)).mul(k2),l=[Long.UZERO,Long.UZERO],f=[Long.UZERO,Long.UZERO];s=s.mul(k2).add(fetch64(n,0));let u=0;const g=(t-1>>6)*64,y=g+(t-1&63)-63;do s=rotate64(s.add(i).add(l[0]).add(fetch64(n,u+8)),37).mul(k1),i=rotate64(i.add(l[1]).add(fetch64(n,u+48)),42).mul(k1),s=s.xor(f[1]),i=i.add(l[0]).add(fetch64(n,u+40)),o=rotate64(o.add(f[0]),33).mul(k1),l=weakHashLen32WithSeedsStr(n,u,l[1].mul(k1),s.add(f[0])),f=weakHashLen32WithSeedsStr(n,u+32,o.add(f[1]),i.add(fetch64(n,u+16))),[o,s]=[s,o],u+=64;while(u!==g);const a=k1.add(o.and(255).shl(1));return u=y,f[0]=f[0].add(t-1&63),l[0]=l[0].add(f[0]),f[0]=f[0].add(l[0]),s=rotate64(s.add(i).add(l[0]).add(fetch64(n,u+8)),37).mul(a),i=rotate64(i.add(l[1]).add(fetch64(n,u+48)),42).mul(a),s=s.xor(f[1].mul(9)),i=i.add(l[0].mul(9).add(fetch64(n,u+40))),o=rotate64(o.add(f[0]),33).mul(a),l=weakHashLen32WithSeedsStr(n,u,l[1].mul(a),s.add(f[0])),f=weakHashLen32WithSeedsStr(n,u+32,o.add(f[1]),i.add(fetch64(n,u+16))),[o,s]=[s,o],hashLen16(hashLen16(l[0],f[0],a).add(shiftMix(i).mul(k0)).add(o),hashLen16(l[1],f[1],a).add(s),a)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function createScalarValue(n,t){return t==="string"?encodeString(n):toTypedArray([n],t)}function noConversionNeeded(n,t){return n instanceof Float32Array&&t==="float32"||n instanceof Int32Array&&t==="int32"||n instanceof Uint8Array&&t==="bool"}function toTypedArray(n,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=flatten(n)),env().getBool("DEBUG")&&checkConversionForErrors(n,t),noConversionNeeded(n,t))return n;if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool"){const r=new Uint8Array(n.length);for(let s=0;s<r.length;++s)Math.round(n[s])!==0&&(r[s]=1);return r}else throw new Error(`Unknown data type ${t}`)}function now(){return env().platform.now()}function encodeString(n,t="utf-8"){return t=t||"utf-8",env().platform.encode(n,t)}function decodeString(n,t="utf-8"){return t=t||"utf-8",env().platform.decode(n,t)}function isTypedArray(n){return env().platform.isTypedArray!=null?env().platform.isTypedArray(n):isTypedArrayBrowser(n)}function flatten(n,t=[],r=!1){if(t==null&&(t=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||isPromise(n)||n==null||isTypedArray(n)&&r)t.push(n);else if(Array.isArray(n)||isTypedArray(n))for(let s=0;s<n.length;++s)flatten(n[s],t,r);else{let s=-1;for(const i of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(i)&&(s=Math.max(s,Number(i)));for(let i=0;i<=s;i++)flatten(n[i],t,r)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Profiler{constructor(t,r){this.backendTimer=t,this.logger=r,r==null&&(this.logger=new Logger)}profileKernel(t,r,s){let i;const o=()=>{i=s()};let l;const f=now();if(this.backendTimer.timerAvailable())l=this.backendTimer.time(o);else{o();for(const g of i)g.dataSync();l=Promise.resolve({kernelMs:now()-f})}if(env().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let g=0;g<i.length;g++){const y=i[g];y.data().then(a=>{checkComputationForErrors(a,y.dtype,t)})}return{kernelName:t,outputs:i,inputs:r,timeMs:l.then(g=>g.kernelMs),extraInfo:l.then(g=>g.getExtraProfileInfo!=null?g.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:r,outputs:s,timeMs:i,inputs:o,extraInfo:l}=t;s.forEach(f=>{Promise.all([f.data(),i,l]).then(u=>{this.logger.logKernelProfile(r,f,u[0],u[1],o,u[2])})})}}function checkComputationForErrors(n,t,r){if(t!=="float32")return!1;for(let s=0;s<n.length;s++){const i=n[s];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${r}'`),!0}return!1}class Logger{logKernelProfile(t,r,s,i,o,l){const f=typeof i=="number"?rightPad(`${i}ms`,9):i.error,u=rightPad(t,25),g=r.rank,y=r.size,a=rightPad(r.shape.toString(),14);let m="";for(const _ in o){const b=o[_];if(b!=null){const c=b.shape||r.shape,w=c.length;m+=`${_}: ${w}D ${w>0?c:""} `}}console.log(`%c${u}	%c${f}	%c${g}D ${a}	%c${y}	%c${m}	%c${l}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function getFilteredNodesXToY(n,t,r){const s={},i={};for(let u=0;u<t.length;u++)s[t[u].id]=!0;for(let u=0;u<n.length;u++){const g=n[u],y=g.inputs;for(const a in y){const m=y[a];let _=!1;for(let b=0;b<t.length;b++)if(s[m.id]){g.outputs.forEach(c=>s[c.id]=!0),_=!0,i[g.id]=!0;break}if(_)break}}const o={};o[r.id]=!0;const l={};for(let u=n.length-1;u>=0;u--){const g=n[u],y=g.inputs;for(let a=0;a<g.outputs.length;a++)if(o[g.outputs[a].id]){for(const m in y)o[y[m].id]=!0,l[g.id]=!0;break}}const f=[];for(let u=0;u<n.length;u++){const g=n[u];if(i[g.id]&&l[g.id]){const y={};for(const m in g.inputs){const _=g.inputs[m];s[_.id]&&(y[m]=_)}const a=Object.assign({},g);a.inputs=y,a.outputs=g.outputs,f.push(a)}}return f}function backpropagateGradients(n,t,r,s){for(let i=t.length-1;i>=0;i--){const o=t[i],l=[];if(o.outputs.forEach(u=>{const g=n[u.id];g!=null?l.push(g):l.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const f=o.gradient(l);for(const u in o.inputs){if(!(u in f))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(f)}.`);const g=r(()=>f[u]());if(g.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${g.dtype}'`);const y=o.inputs[u];if(!arraysEqual(g.shape,y.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${u}' has shape '${g.shape}', which does not match the shape of the input '${y.shape}'`);if(n[y.id]==null)n[y.id]=g;else{const a=n[y.id];n[y.id]=s(a,g),a.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FORMAT_LIMIT_NUM_VALS=20,FORMAT_NUM_FIRST_LAST_VALS=3,FORMAT_NUM_SIG_DIGITS=7;function tensorToString(n,t,r,s){const i=computeStrides(t),o=computeMaxSizePerColumn(n,t,r,i),l=t.length,f=subTensorToString(n,t,r,i,o),u=["Tensor"];return s&&(u.push(`  dtype: ${r}`),u.push(`  rank: ${l}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(f.map(g=>"    "+g).join(`
`)),u.join(`
`)}function computeMaxSizePerColumn(n,t,r,s){const i=sizeFromShape(t),o=s[s.length-1],l=new Array(o).fill(0),f=t.length,u=r==="complex64"?createComplexTuples(n):n;if(f>1)for(let g=0;g<i/o;g++){const y=g*o;for(let a=0;a<o;a++)l[a]=Math.max(l[a],valToString(u[y+a],0,r).length)}return l}function valToString(n,t,r){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(FORMAT_NUM_SIG_DIGITS))} + ${parseFloat(n[1].toFixed(FORMAT_NUM_SIG_DIGITS))}j`:isString(n)?s=`'${n}'`:r==="bool"?s=boolNumToString(n):s=parseFloat(n.toFixed(FORMAT_NUM_SIG_DIGITS)).toString(),rightPad(s,t)}function boolNumToString(n){return n===0?"false":"true"}function subTensorToString(n,t,r,s,i,o=!0){const l=r==="complex64"?2:1,f=t[0],u=t.length;if(u===0){if(r==="complex64"){const c=createComplexTuples(n);return[valToString(c[0],0,r)]}return r==="bool"?[boolNumToString(n[0])]:[n[0].toString()]}if(u===1){if(f>FORMAT_LIMIT_NUM_VALS){const w=FORMAT_NUM_FIRST_LAST_VALS*l;let S=Array.from(n.slice(0,w)),E=Array.from(n.slice((f-FORMAT_NUM_FIRST_LAST_VALS)*l,f*l));return r==="complex64"&&(S=createComplexTuples(S),E=createComplexTuples(E)),["["+S.map((I,A)=>valToString(I,i[A],r)).join(", ")+", ..., "+E.map((I,A)=>valToString(I,i[f-FORMAT_NUM_FIRST_LAST_VALS+A],r)).join(", ")+"]"]}return["["+(r==="complex64"?createComplexTuples(n):Array.from(n)).map((w,S)=>valToString(w,i[S],r)).join(", ")+"]"]}const g=t.slice(1),y=s.slice(1),a=s[0]*l,m=[];if(f>FORMAT_LIMIT_NUM_VALS){for(let c=0;c<FORMAT_NUM_FIRST_LAST_VALS;c++){const w=c*a,S=w+a;m.push(...subTensorToString(n.slice(w,S),g,r,y,i,!1))}m.push("...");for(let c=f-FORMAT_NUM_FIRST_LAST_VALS;c<f;c++){const w=c*a,S=w+a;m.push(...subTensorToString(n.slice(w,S),g,r,y,i,c===f-1))}}else for(let c=0;c<f;c++){const w=c*a,S=w+a;m.push(...subTensorToString(n.slice(w,S),g,r,y,i,c===f-1))}const _=u===2?",":"";m[0]="["+(f>0?m[0]+_:"");for(let c=1;c<m.length-1;c++)m[c]=" "+m[c]+_;let b=`,
`;for(let c=2;c<u;c++)b+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(o?"":b),m}function createComplexTuples(n){const t=[];for(let r=0;r<n.length;r+=2)t.push([n[r],n[r+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TensorBuffer{constructor(t,r,s){if(this.dtype=r,this.shape=t.slice(),this.size=sizeFromShape(t),s!=null){const i=s.length;assert(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(r==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||getArrayFromDType(r,this.size),this.strides=computeStrides(t)}set(t,...r){r.length===0&&(r=[0]),assert(r.length===this.rank,()=>`The number of provided coordinates (${r.length}) must match the rank (${this.rank})`);const s=this.locToIndex(r);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let r=0;for(const i of t){if(i<0||i>=this.shape[r]){const o=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(o)}r++}let s=t[t.length-1];for(let i=0;i<t.length-1;++i)s+=this.strides[i]*t[i];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=this.strides[s]*t[s];return r}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const r=new Array(this.shape.length);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/this.strides[s]),t-=r[s]*this.strides[s];return r[r.length-1]=t,r}get rank(){return this.shape.length}toTensor(){return trackerFn().makeTensor(this.values,this.shape,this.dtype)}}let trackerFn=null,opHandler$1=null;function setTensorTracker(n){trackerFn=n}function setOpHandler(n){opHandler$1=n}class Tensor{constructor(t,r,s,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=r||"float32",this.size=sizeFromShape(t),this.strides=computeStrides(t),this.dataId=s,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return opHandler$1.buffer(this.shape,this.dtype,t)}bufferSync(){return opHandler$1.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return toNestedArray(this.shape,t,this.dtype==="complex64")}arraySync(){return toNestedArray(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=trackerFn().read(this.dataId);if(this.dtype==="string"){const r=await t;try{return r.map(s=>decodeString(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),trackerFn().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=trackerFn().readSync(this.dataId);if(this.dtype==="string")try{return t.map(r=>decodeString(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await trackerFn().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),trackerFn().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return opHandler$1.print(this,t)}clone(){return this.throwIfDisposed(),opHandler$1.clone(this)}toString(t=!1){const r=this.dataSync();return tensorToString(r,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),opHandler$1.cast(this,t)}variable(t=!0,r,s){return this.throwIfDisposed(),trackerFn().makeVariable(this,t,r,s)}}Object.defineProperty(Tensor,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function getGlobalTensorClass(){return getGlobal("Tensor",()=>Tensor)}getGlobalTensorClass();class Variable extends Tensor{constructor(t,r,s,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=r,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!arraysEqual(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);trackerFn().disposeTensor(this),this.dataId=t.dataId,trackerFn().incRef(this,null)}dispose(){trackerFn().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Variable,Symbol.hasInstance,{value:n=>n instanceof Tensor&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Rank;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(Rank||(Rank={}));var UpcastInt32AndMap;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(UpcastInt32AndMap||(UpcastInt32AndMap={}));var UpcastBoolAndMap;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(UpcastBoolAndMap||(UpcastBoolAndMap={}));var UpcastFloat32AndMap;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(UpcastFloat32AndMap||(UpcastFloat32AndMap={}));var UpcastComplex64AndMap;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(UpcastComplex64AndMap||(UpcastComplex64AndMap={}));const upcastTypeMap={float32:UpcastFloat32AndMap,int32:UpcastInt32AndMap,bool:UpcastBoolAndMap,complex64:UpcastComplex64AndMap};function upcastType(n,t){if(n==="string"||t==="string"){if(n==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${n} with ${t}`)}return upcastTypeMap[n][t]}function isWebGLData(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function isWebGPUData(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function makeTypesMatch(n,t){if(n.dtype===t.dtype)return[n,t];const r=upcastType(n.dtype,t.dtype);return[n.cast(r),t.cast(r)]}function getTensorsInContainer(n){const t=[];return walkTensorContainer(n,t,new Set),t}function walkTensorContainer(n,t,r){if(n==null)return;if(n instanceof Tensor){t.push(n);return}if(!isIterable(n))return;const s=n;for(const i in s){const o=s[i];r.has(o)||(r.add(o),walkTensorContainer(o,t,r))}}function isIterable(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function isRegisteredKernelInvocation(n){return n.kernelName!=null}class EngineState{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Engine{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new EngineState}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let r=0;r<t.length;r++){const s=t[r];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:r}=this.initializeBackend(t);if(r)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,r,s=1){return t in this.registryFactory?(warn(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:r,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:r,asyncInit:s}=this.initializeBackend(t);if(!(s?await r:r))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Profiler(this.backendInstance),!0}setupRegisteredKernels(){getKernelsForBackend(this.backendName).forEach(r=>{r.setupFunc!=null&&r.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){getKernelsForBackend(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const r=this.registryFactory[t];if(r==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=r.factory();if(s&&!(s instanceof KernelBackend)&&typeof s.then=="function"){const i=++this.pendingBackendInitId,o=s.then(l=>i<this.pendingBackendInitId?!1:(this.registry[t]=l,this.pendingBackendInit=null,!0)).catch(l=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,warn(`Initialization of backend ${t} failed`),warn(l.stack||l.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return warn(`Initialization of backend ${t} failed`),warn(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,r)=>this.registryFactory[r].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let r=0;r<t.length;r++){const s=t[r],{success:i,asyncInit:o}=this.initializeBackend(s);if(o||i)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,r){const s=this.state.tensorInfo.get(r),i=s.backend,o=this.readSync(r),l=i.refCount(r);i.disposeData(r,!0),s.backend=t,t.move(r,o,s.shape,s.dtype,l),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,r){let s=null;if(r==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");r=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let i;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(i),()=>(i=r(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,r,s){t();try{const i=s();return r(),i}catch(i){throw r(),i}}nextTensorId(){return Engine.nextTensorId++}nextVariableId(){return Engine.nextVariableId++}clone(t){const r=ENGINE.runKernel(Identity,{x:t}),s={x:t},i=l=>({x:()=>{const f="float32",u={x:l},g={dtype:f};return ENGINE.runKernel(Cast,u,g)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[r],i,o,{}),r}runKernel(t,r,s){if(this.backendName==null&&this.backend,!(getKernel(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:r,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,r,s){const i=this.backend.numDataIds();let o=0;s.forEach(u=>{o+=u.dtype==="complex64"?3:1});const l=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],f=i-r-o-l;if(f>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${f} data ids) after running '${t}'`)}runKernelFunc(t){let r,s=[];const i=this.isTapeOn(),o=this.state.numBytes,l=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let f;this.backendName==null&&this.backend;let u;const g=isRegisteredKernelInvocation(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(isRegisteredKernelInvocation(t)){const{kernelName:b,inputs:c,attrs:w}=t;this.backendName==null&&this.backend;const S=getKernel(b,this.backendName);assert(S!=null,()=>`Cannot find registered kernel '${b}' for backend '${this.backendName}'`),f=()=>{const E=this.backend.numDataIds();u=S.kernelFunc({inputs:c,attrs:w,backend:this.backend});const I=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(b,E,I);const A=I.map(T=>T.rank!=null?T:this.makeTensorFromTensorInfo(T));if(i){const T=this.getTensorsForGradient(b,c,A);s=this.saveTensorsForBackwardMode(T)}return A}}else{const{forwardFunc:b}=t,c=w=>{i&&(s=w.map(S=>this.keep(this.clone(S))))};f=()=>{const w=this.backend.numDataIds();u=this.tidy(()=>b(this.backend,c));const S=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,w,S),S}}const{inputs:y,attrs:a}=t,m=isRegisteredKernelInvocation(t)?null:t.backwardsFunc;let _;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?r=f():(_=this.profiler.profileKernel(g,y,()=>f()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(_),r=_.outputs)}),i&&this.addTapeNode(g,y,r,m,s,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:g,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(y).map(b=>y[b]!=null?y[b].shape:null),outputShapes:r.map(b=>b.shape),kernelTimeMs:_.timeMs,extraInfo:_.extraInfo}),Array.isArray(u)?r:r[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,r,s){const i=getGradient(t);if(i!=null){const o=i.inputsToSave||[],l=i.outputsToSave||[];let f;i.saveAllInputs?(assert(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),f=Object.keys(r).map(g=>r[g])):f=o.map(g=>r[g]);const u=s.filter((g,y)=>l[y]);return f.concat(u)}return[]}makeTensor(t,r,s,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",i=i||this.backend;let o=t;s==="string"&&isString(t[0])&&(o=t.map(u=>encodeString(u)));const l=i.write(o,r,s),f=new Tensor(r,s,l,this.nextTensorId());if(this.trackTensor(f,i),s==="string"){const u=this.state.tensorInfo.get(l),g=bytesFromStringArray(o);this.state.numBytes+=g-u.bytes,u.bytes=g}return f}makeTensorFromDataId(t,r,s,i){s=s||"float32";const o={dataId:t,shape:r,dtype:s};return this.makeTensorFromTensorInfo(o,i)}makeTensorFromTensorInfo(t,r){const{dataId:s,shape:i,dtype:o}=t,l=new Tensor(i,o,s,this.nextTensorId());return this.trackTensor(l,r),l}makeVariable(t,r=!0,s,i){s=s||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const o=new Variable(t,r,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(t,r){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*bytesPerElement(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:r||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof Variable||this.track(t)}incRef(t,r){this.trackTensor(t,r),this.backend.incRef(t.dataId)}removeDataId(t,r){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===r&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const r=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=r.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*bytesPerElement(t.dtype);this.state.numBytes-=s}r.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,r.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const r=this.state.registeredVariables[t];this.disposeVariable(r)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const r=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,r,s,i,o,l){const f={id:this.state.nextTapeNodeId++,kernelName:t,inputs:r,outputs:s,saved:o},u=getGradient(t);u!=null&&(i=u.gradFunc),i!=null&&(f.gradient=g=>(g=g.map((y,a)=>{if(y==null){const m=s[a],_=makeZerosTypedArray(m.size,m.dtype);return this.makeTensor(_,m.shape,m.dtype)}return y}),i(g.length>1?g:g[0],o,l))),this.state.activeTape.push(f)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(r.name=t),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(t){const r=getTensorsInContainer(t),s=new Set(r.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const l=this.state.activeScope.track[o];!l.kept&&!s.has(l.id)&&l.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(o=>{!o.kept&&o.scopeId===i.id&&this.track(o)})}gradients(t,r,s,i=!1){if(assert(r.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));assert(o instanceof Tensor,()=>"The result y returned by f() must be a tensor.");const l=getFilteredNodesXToY(this.state.activeTape,r,o);if(!i&&l.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const f={};f[o.id]=s??ones(o.shape),backpropagateGradients(f,l,g=>this.tidy(g),add$2);const u=r.map(g=>f[g.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(g=>{for(const y of g.saved)y.dispose()}),this.state.activeTape=null),{value:o,grads:u}})}customGrad(t){return assert(isFunction(t),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{assert(r.every(f=>f instanceof Tensor),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const i={};r.forEach((f,u)=>{i[u]=f});const o=(f,u)=>(s=t(...r,u),assert(s.value instanceof Tensor,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),assert(isFunction(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),l=(f,u)=>{const g=s.gradFunc(f,u),y=Array.isArray(g)?g:[g];assert(y.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),assert(y.every(m=>m instanceof Tensor),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const a={};return y.forEach((m,_)=>{a[_]=()=>m}),a};return this.runKernelFunc({forwardFunc:o,backwardsFunc:l,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,r){return this.state.tensorInfo.get(t).backend.readToGPU(t,r)}async time(t){const r=now(),s=await this.backend.time(t);return s.wallMs=now()-r,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new EngineState;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Engine.nextTensorId=0;Engine.nextVariableId=0;function ones(n){const t=makeOnesTypedArray(sizeFromShape(n),"float32");return ENGINE.makeTensor(t,n,"float32")}function getOrMakeEngine(){const n=getGlobalNamespace();if(n._tfengine==null){const t=new Environment(n);n._tfengine=new Engine(t)}return setEnvironmentGlobal(n._tfengine.ENV),setTensorTracker(()=>n._tfengine),n._tfengine}const ENGINE=getOrMakeEngine();function add$2(n,t){const r={a:n,b:t};return ENGINE.runKernel(Add,r)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function isBrowser(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ENV=env();ENV.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ENV.registerFlag("IS_BROWSER",()=>isBrowser());ENV.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ENV.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ENV.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ENV.registerFlag("PROD",()=>!1);ENV.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ENV.getBool("DEBUG"));ENV.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ENV.registerFlag("IS_TEST",()=>!1);ENV.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ENV.getBool("DEBUG"));ENV.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ENV.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ENV.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function inferShape(n,t){let r=n;if(isTypedArray(n))return t==="string"?[]:[n.length];if(isWebGLData(n)){const i=n.channels||"RGBA";return[n.height,n.width*i.length]}else if(isWebGPUData(n))return[n.buffer.size/(t==null?4:bytesPerElement(t))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(r)||isTypedArray(r)&&t!=="string";)s.push(r.length),r=r[0];return Array.isArray(n)&&env().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&deepAssertShapeConsistency(n,s,[]),s}function deepAssertShapeConsistency(n,t,r){if(r=r||[],!Array.isArray(n)&&!isTypedArray(n)){assert(t.length===0,()=>`Element arr[${r.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}assert(t.length>0,()=>`Element arr[${r.join("][")}] should be a primitive, but is an array of ${n.length} elements`),assert(n.length===t[0],()=>`Element arr[${r.join("][")}] should have ${t[0]} elements, but has ${n.length} elements`);const s=t.slice(1);for(let i=0;i<n.length;++i)deepAssertShapeConsistency(n[i],s,r.concat(i))}function assertDtype(n,t,r,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==t||n==="numeric"&&t==="string")throw new Error(`Argument '${r}' passed to '${s}' must be ${n} tensor, but got ${t} tensor`)}}function convertToTensor(n,t,r,s="numeric"){if(n instanceof getGlobalTensorClass())return assertDtype(s,n.dtype,t,r),n;let i=inferDtype(n);if(i!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(i=s),assertDtype(s,i,t,r),n==null||!isTypedArray(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const u=n==null?"null":n.constructor.name;throw new Error(`Argument '${t}' passed to '${r}' must be a Tensor or TensorLike, but got '${u}'`)}const o=inferShape(n,i);!isTypedArray(n)&&!Array.isArray(n)&&(n=[n]);const f=i!=="string"?toTypedArray(n,i):flatten(n,[],!0);return ENGINE.makeTensor(f,o,i)}function convertToTensorArray(n,t,r,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${t} passed to ${r} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((o,l)=>convertToTensor(o,`${t}[${l}]`,r,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OP_SCOPE_SUFFIX="__op";function op(n){const t=Object.keys(n);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let r=t[0];const s=n[r];r.endsWith("_")&&(r=r.substring(0,r.length-1)),r=r+OP_SCOPE_SUFFIX;const i=(...o)=>{ENGINE.startScope(r);try{const l=s(...o);return isPromise(l)&&console.error("Cannot return a Promise inside of tidy."),ENGINE.endScope(l),l}catch(l){throw ENGINE.endScope(null),l}};return Object.defineProperty(i,"name",{value:r,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function complex_(n,t){const r=convertToTensor(n,"real","complex"),s=convertToTensor(t,"imag","complex");assertShapesMatch(r.shape,s.shape,`real and imag shapes, ${r.shape} and ${s.shape}, must match in call to tf.complex().`);const i={real:r,imag:s};return ENGINE.runKernel(Complex,i)}const complex$1=op({complex_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function makeTensor(n,t,r,s){if(s==null)s=inferDtype(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(isWebGPUData(n)||isWebGLData(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return ENGINE.backend.createTensorFromGPUData(n,t||r,s)}if(!isTypedArray(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){assertNonNegativeIntegerDimensions(t);const i=sizeFromShape(t),o=sizeFromShape(r);assert(i===o,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${o}`);for(let l=0;l<r.length;++l){const f=r[l],u=l===r.length-1?f!==sizeFromShape(t.slice(l)):!0;assert(r[l]===t[l]||!u,()=>`Error creating a new Tensor. Inferred shape (${r}) does not match the provided shape (${t}). `)}}return!isTypedArray(n)&&!Array.isArray(n)&&(n=[n]),t=t||r,n=s!=="string"?toTypedArray(n,s):flatten(n,[],!0),ENGINE.makeTensor(n,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tensor(n,t,r){const s=inferShape(n,r);return makeTensor(n,t,s,r)}class CompositeArrayBuffer{static join(t){return new CompositeArrayBuffer(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(s=>isTypedArray(s)?s.buffer:s),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let r=0;for(let s=0;s<t.length;s++){const i=t[s];s!==t.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=r+i.byteLength;this.shards.push({buffer:i,start:r,end:o}),r=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,r=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,r=isNaN(Number(r))?0:r,t=Math.max(0,t),r=Math.min(this.byteLength,r),r<=t)return new ArrayBuffer(0);const s=this.findShardForByte(t);if(s===-1)throw new Error(`Could not find start shard for byte ${t}`);const i=r-t,o=new ArrayBuffer(i),l=new Uint8Array(o);let f=0;for(let u=s;u<this.shards.length;u++){const g=this.shards[u],a=t+f-g.start,m=f,b=Math.min(r,g.end)-g.start,c=new Uint8Array(g.buffer,a,b-a);if(l.set(c,m),f+=c.length,r<g.end)break}return o}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function r(i){return t<i.start?-1:t>=i.end?1:0}if(r(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=search(this.shards,r);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function search(n,t){let r=0,s=n.length;for(;r<=s;){const i=Math.floor((s-r)/2)+r,o=t(n[i]);if(o===0)return i;o<0?s=i:r=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const useNodeBuffer=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function stringByteLength(n){return useNodeBuffer?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function arrayBufferToBase64String(n){if(useNodeBuffer)return Buffer.from(n).toString("base64");const t=new Uint8Array(n);let r="";for(let s=0,i=t.length;s<i;s++)r+=String.fromCharCode(t[s]);return btoa(r)}function base64StringToArrayBuffer(n){if(useNodeBuffer){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(n),r=new Uint8Array(t.length);for(let s=0;s<t.length;++s)r.set([t.charCodeAt(s)],s);return r.buffer}function getModelArtifactsInfoForJSON(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:stringByteLength(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:stringByteLength(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new CompositeArrayBuffer(n.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IORouterRegistry{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return IORouterRegistry.instance==null&&(IORouterRegistry.instance=new IORouterRegistry),IORouterRegistry.instance}static registerSaveRouter(t){IORouterRegistry.getInstance().saveRouters.push(t)}static registerLoadRouter(t){IORouterRegistry.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return IORouterRegistry.getHandlers(t,"save")}static getLoadHandlers(t,r){return IORouterRegistry.getHandlers(t,"load",r)}static getHandlers(t,r,s){const i=[];return(r==="load"?IORouterRegistry.getInstance().loadRouters:IORouterRegistry.getInstance().saveRouters).forEach(l=>{const f=l(t,s);f!==null&&i.push(f)}),i}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DATABASE_NAME="tensorflowjs",DATABASE_VERSION=1,MODEL_STORE_NAME="models_store",INFO_STORE_NAME="model_info_store";function getIndexedDBFactory(){if(!env().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function setUpDatabase(n){const t=n.result;t.createObjectStore(MODEL_STORE_NAME,{keyPath:"modelPath"}),t.createObjectStore(INFO_STORE_NAME,{keyPath:"modelPath"})}class BrowserIndexedDB{constructor(t){if(this.indexedDB=getIndexedDBFactory(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,r){return new Promise((s,i)=>{const o=this.indexedDB.open(DATABASE_NAME,DATABASE_VERSION);o.onupgradeneeded=()=>setUpDatabase(o),o.onsuccess=()=>{const l=o.result;if(r==null){const f=l.transaction(MODEL_STORE_NAME,"readonly"),g=f.objectStore(MODEL_STORE_NAME).get(this.modelPath);g.onsuccess=()=>{if(g.result==null)return l.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(g.result.modelArtifacts)},g.onerror=y=>(l.close(),i(g.error)),f.oncomplete=()=>l.close()}else{r.weightData=CompositeArrayBuffer.join(r.weightData);const f=getModelArtifactsInfoForJSON(r),u=l.transaction(INFO_STORE_NAME,"readwrite");let g=u.objectStore(INFO_STORE_NAME),y;try{y=g.put({modelPath:this.modelPath,modelArtifactsInfo:f})}catch(m){return i(m)}let a;y.onsuccess=()=>{a=l.transaction(MODEL_STORE_NAME,"readwrite");const m=a.objectStore(MODEL_STORE_NAME);let _;try{_=m.put({modelPath:this.modelPath,modelArtifacts:r,modelArtifactsInfo:f})}catch(b){return i(b)}_.onsuccess=()=>s({modelArtifactsInfo:f}),_.onerror=b=>{g=u.objectStore(INFO_STORE_NAME);const c=g.delete(this.modelPath);c.onsuccess=()=>(l.close(),i(_.error)),c.onerror=w=>(l.close(),i(_.error))}},y.onerror=m=>(l.close(),i(y.error)),u.oncomplete=()=>{a==null?l.close():a.oncomplete=()=>l.close()}}},o.onerror=l=>i(o.error)})}}BrowserIndexedDB.URL_SCHEME="indexeddb://";const indexedDBRouter=n=>env().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(BrowserIndexedDB.URL_SCHEME)?browserIndexedDB(n.slice(BrowserIndexedDB.URL_SCHEME.length)):null;IORouterRegistry.registerSaveRouter(indexedDBRouter);IORouterRegistry.registerLoadRouter(indexedDBRouter);function browserIndexedDB(n){return new BrowserIndexedDB(n)}function maybeStripScheme$1(n){return n.startsWith(BrowserIndexedDB.URL_SCHEME)?n.slice(BrowserIndexedDB.URL_SCHEME.length):n}class BrowserIndexedDBManager{constructor(){this.indexedDB=getIndexedDBFactory()}async listModels(){return new Promise((t,r)=>{const s=this.indexedDB.open(DATABASE_NAME,DATABASE_VERSION);s.onupgradeneeded=()=>setUpDatabase(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(INFO_STORE_NAME,"readonly"),f=o.objectStore(INFO_STORE_NAME).getAll();f.onsuccess=()=>{const u={};for(const g of f.result)u[g.modelPath]=g.modelArtifactsInfo;t(u)},f.onerror=u=>(i.close(),r(f.error)),o.oncomplete=()=>i.close()},s.onerror=i=>r(s.error)})}async removeModel(t){return t=maybeStripScheme$1(t),new Promise((r,s)=>{const i=this.indexedDB.open(DATABASE_NAME,DATABASE_VERSION);i.onupgradeneeded=()=>setUpDatabase(i),i.onsuccess=()=>{const o=i.result,l=o.transaction(INFO_STORE_NAME,"readwrite"),f=l.objectStore(INFO_STORE_NAME),u=f.get(t);let g;u.onsuccess=()=>{if(u.result==null)return o.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const y=f.delete(t),a=()=>{g=o.transaction(MODEL_STORE_NAME,"readwrite");const _=g.objectStore(MODEL_STORE_NAME).delete(t);_.onsuccess=()=>r(u.result.modelArtifactsInfo),_.onerror=b=>s(u.error)};y.onsuccess=a,y.onerror=m=>(a(),o.close(),s(u.error))}},u.onerror=y=>(o.close(),s(u.error)),l.oncomplete=()=>{g==null?o.close():g.oncomplete=()=>o.close()}},i.onerror=o=>s(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PATH_SEPARATOR="/",PATH_PREFIX="tensorflowjs_models",INFO_SUFFIX="info",MODEL_TOPOLOGY_SUFFIX="model_topology",WEIGHT_SPECS_SUFFIX="weight_specs",WEIGHT_DATA_SUFFIX="weight_data",MODEL_METADATA_SUFFIX="model_metadata";function getModelKeys(n){return{info:[PATH_PREFIX,n,INFO_SUFFIX].join(PATH_SEPARATOR),topology:[PATH_PREFIX,n,MODEL_TOPOLOGY_SUFFIX].join(PATH_SEPARATOR),weightSpecs:[PATH_PREFIX,n,WEIGHT_SPECS_SUFFIX].join(PATH_SEPARATOR),weightData:[PATH_PREFIX,n,WEIGHT_DATA_SUFFIX].join(PATH_SEPARATOR),modelMetadata:[PATH_PREFIX,n,MODEL_METADATA_SUFFIX].join(PATH_SEPARATOR)}}function removeItems(n){for(const t of Object.values(n))window.localStorage.removeItem(t)}function getModelPathFromKey(n){const t=n.split(PATH_SEPARATOR);if(t.length<3)throw new Error(`Invalid key format: ${n}`);return t.slice(1,t.length-1).join(PATH_SEPARATOR)}function maybeStripScheme(n){return n.startsWith(BrowserLocalStorage.URL_SCHEME)?n.slice(BrowserLocalStorage.URL_SCHEME.length):n}class BrowserLocalStorage{constructor(t){if(!env().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=getModelKeys(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const r=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),i=getModelArtifactsInfoForJSON(t),o=CompositeArrayBuffer.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,arrayBufferToBase64String(o));const l={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(l)),{modelArtifactsInfo:i}}catch{throw removeItems(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const r={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);r.modelTopology=s;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);r.weightSpecs=i;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const f=JSON.parse(o);r.format=f.format,r.generatedBy=f.generatedBy,r.convertedBy=f.convertedBy,f.signature!=null&&(r.signature=f.signature),f.userDefinedMetadata!=null&&(r.userDefinedMetadata=f.userDefinedMetadata),f.modelInitializer!=null&&(r.modelInitializer=f.modelInitializer),f.initializerSignature!=null&&(r.initializerSignature=f.initializerSignature),f.trainingConfig!=null&&(r.trainingConfig=f.trainingConfig)}const l=this.LS.getItem(this.keys.weightData);if(l==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return r.weightData=base64StringToArrayBuffer(l),r}}BrowserLocalStorage.URL_SCHEME="localstorage://";const localStorageRouter=n=>env().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(BrowserLocalStorage.URL_SCHEME)?browserLocalStorage(n.slice(BrowserLocalStorage.URL_SCHEME.length)):null;IORouterRegistry.registerSaveRouter(localStorageRouter);IORouterRegistry.registerLoadRouter(localStorageRouter);function browserLocalStorage(n){return new BrowserLocalStorage(n)}class BrowserLocalStorageManager{constructor(){assert(env().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),assert(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},r=PATH_PREFIX+PATH_SEPARATOR,s=PATH_SEPARATOR+INFO_SUFFIX;for(let i=0;i<this.LS.length;++i){const o=this.LS.key(i);if(o.startsWith(r)&&o.endsWith(s)){const l=getModelPathFromKey(o);t[l]=JSON.parse(this.LS.getItem(o))}}return t}async removeModel(t){t=maybeStripScheme(t);const r=getModelKeys(t);if(this.LS.getItem(r.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(r.info));return removeItems(r),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const URL_SCHEME_SUFFIX="://";class ModelStoreManagerRegistry{constructor(){this.managers={}}static getInstance(){return ModelStoreManagerRegistry.instance==null&&(ModelStoreManagerRegistry.instance=new ModelStoreManagerRegistry),ModelStoreManagerRegistry.instance}static registerManager(t,r){assert(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(URL_SCHEME_SUFFIX)&&(t=t.slice(0,t.indexOf(URL_SCHEME_SUFFIX))),assert(t.length>0,()=>"scheme must not be an empty string.");const s=ModelStoreManagerRegistry.getInstance();assert(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=r}static getManager(t){const r=ModelStoreManagerRegistry.getInstance().managers[t];if(r==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return r}static getSchemes(){return Object.keys(ModelStoreManagerRegistry.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PlatformBrowser{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,r){return fetch(t,r)}now(){return performance.now()}encode(t,r){if(r!=="utf-8"&&r!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${r}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,r){return new TextDecoder(r).decode(t)}setTimeoutCustom(t,r){if(typeof window>"u"||!env().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,r);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},r),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const i=this.functionRefs[s.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return isTypedArrayBrowser(t)}}if(env().get("IS_BROWSER")){env().setPlatform("browser",new PlatformBrowser);try{ModelStoreManagerRegistry.registerManager(BrowserLocalStorage.URL_SCHEME,new BrowserLocalStorageManager)}catch{}try{ModelStoreManagerRegistry.registerManager(BrowserIndexedDB.URL_SCHEME,new BrowserIndexedDBManager)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const getNodeFetch={importFetch:()=>require("node-fetch")};let systemFetch;class PlatformNode{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,r){return env().global.fetch!=null?env().global.fetch(t,r):(systemFetch==null&&(systemFetch=getNodeFetch.importFetch()),systemFetch(t,r))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,r){if(r!=="utf-8"&&r!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${r}`);return this.textEncoder.encode(t)}decode(t,r){return t.length===0?"":new this.util.TextDecoder(r).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}env().get("IS_NODE")&&!env().get("IS_BROWSER")&&env().setPlatform("node",new PlatformNode);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function buffer(n,t="float32",r){return t=t||"float32",assertNonNegativeIntegerDimensions(n),new TensorBuffer(n,t,r)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cast_(n,t){const r=convertToTensor(n,"x","cast");if(!isValidDtype(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&r.dtype!=="string"||t!=="string"&&r.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:r},i={dtype:t};return ENGINE.runKernel(Cast,s,i)}const cast$1=op({cast_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function clone_(n){const r={x:convertToTensor(n,"x","clone","string_or_numeric")};return ENGINE.runKernel(Identity,r)}const clone=op({clone_});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function print(n,t=!1){console.log(n.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */getOrMakeEngine();const opHandler={buffer,cast:cast$1,clone,print};setOpHandler(opHandler);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function engine(){return ENGINE}function tidy(n,t){return ENGINE.tidy(n,t)}function dispose(n){getTensorsInContainer(n).forEach(r=>r.dispose())}function keep(n){return ENGINE.keep(n)}function registerBackend(n,t,r=1){return ENGINE.registerBackend(n,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function add_(n,t){let r=convertToTensor(n,"a","add"),s=convertToTensor(t,"b","add");[r,s]=makeTypesMatch(r,s);const i={a:r,b:s};return ENGINE.runKernel(Add,i)}const add$1=op({add_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function floorDiv_(n,t){let r=convertToTensor(n,"a","floorDiv"),s=convertToTensor(t,"b","floorDiv");[r,s]=makeTypesMatch(r,s);const i={a:r,b:s};return ENGINE.runKernel(FloorDiv,i)}const floorDiv$1=op({floorDiv_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function div_(n,t){let r=convertToTensor(n,"a","div"),s=convertToTensor(t,"b","div");if([r,s]=makeTypesMatch(r,s),r.dtype==="int32"&&s.dtype==="int32")return floorDiv$1(r,s);const i={a:r,b:s},o={};return ENGINE.runKernel(RealDiv,i,o)}const div$1=op({div_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mul_(n,t){let r=convertToTensor(n,"a","mul"),s=convertToTensor(t,"b","mul");[r,s]=makeTypesMatch(r,s);const i={a:r,b:s};return ENGINE.runKernel(Multiply,i)}const mul=op({mul_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function abs_(n){const t=convertToTensor(n,"x","abs");if(t.dtype==="complex64"){const r={x:t};return ENGINE.runKernel(ComplexAbs,r)}else{const r={x:t};return ENGINE.runKernel(Abs,r)}}const abs$1=op({abs_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function computeDilation2DInfo(n,t,r,s,i="NHWC",o){const l=n[3],f=[...t,l],u=convertConv2DDataFormat(i);return computeConv2DInfo(n,f,r,o,s,null,null,u)}function computePool2DInfo(n,t,r,s,i,o,l="channelsLast"){const[f,u]=parseTupleParam(t);let g;if(l==="channelsLast")g=[f,u,n[3],n[3]];else if(l==="channelsFirst")g=[f,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${l}`);return computeConv2DInfo(n,g,r,s,i,o,!1,l)}function computePool3DInfo(n,t,r,s,i,o,l="NDHWC"){const[f,u,g]=parse3TupleParam(t);let y,a;if(l==="NDHWC")a="channelsLast",y=[f,u,g,n[4],n[4]];else if(l==="NCDHW")a="channelsFirst",y=[f,u,g,n[1],n[1]];else throw new Error(`Unknown dataFormat ${l}`);return computeConv3DInfo(n,y,r,s,i,!1,a,o)}function computeConv2DInfo(n,t,r,s,i,o,l=!1,f="channelsLast"){let[u,g,y,a]=[-1,-1,-1,-1];if(f==="channelsLast")[u,g,y,a]=n;else if(f==="channelsFirst")[u,a,g,y]=n;else throw new Error(`Unknown dataFormat ${f}`);const[m,_,,b]=t,[c,w]=parseTupleParam(r),[S,E]=parseTupleParam(s),I=getEffectiveFilterSize(m,S),A=getEffectiveFilterSize(_,E),{padInfo:T,outHeight:O,outWidth:C}=getPadAndOutInfo(i,g,y,c,w,I,A,o,f),k=l?b*a:b;let P;return f==="channelsFirst"?P=[u,k,O,C]:f==="channelsLast"&&(P=[u,O,C,k]),{batchSize:u,dataFormat:f,inHeight:g,inWidth:y,inChannels:a,outHeight:O,outWidth:C,outChannels:k,padInfo:T,strideHeight:c,strideWidth:w,filterHeight:m,filterWidth:_,effectiveFilterHeight:I,effectiveFilterWidth:A,dilationHeight:S,dilationWidth:E,inShape:n,outShape:P,filterShape:t}}function computeConv3DInfo(n,t,r,s,i,o=!1,l="channelsLast",f){let[u,g,y,a,m]=[-1,-1,-1,-1,-1];if(l==="channelsLast")[u,g,y,a,m]=n;else if(l==="channelsFirst")[u,m,g,y,a]=n;else throw new Error(`Unknown dataFormat ${l}`);const[_,b,c,,w]=t,[S,E,I]=parse3TupleParam(r),[A,T,O]=parse3TupleParam(s),C=getEffectiveFilterSize(_,A),k=getEffectiveFilterSize(b,T),P=getEffectiveFilterSize(c,O),{padInfo:N,outDepth:L,outHeight:F,outWidth:V}=get3DPadAndOutInfo(i,g,y,a,S,E,I,C,k,P,f),j=o?w*m:w;let K;return l==="channelsFirst"?K=[u,j,L,F,V]:l==="channelsLast"&&(K=[u,L,F,V,j]),{batchSize:u,dataFormat:l,inDepth:g,inHeight:y,inWidth:a,inChannels:m,outDepth:L,outHeight:F,outWidth:V,outChannels:j,padInfo:N,strideDepth:S,strideHeight:E,strideWidth:I,filterDepth:_,filterHeight:b,filterWidth:c,effectiveFilterDepth:C,effectiveFilterHeight:k,effectiveFilterWidth:P,dilationDepth:A,dilationHeight:T,dilationWidth:O,inShape:n,outShape:K,filterShape:t}}function computeOutputShape2D(n,t,r,s,i){s==null&&(s=computeDefaultPad(n,t,r));const o=n[0],l=n[1],f=round$1((o-t+2*s)/r+1,i),u=round$1((l-t+2*s)/r+1,i);return[f,u]}function computeOutputShape4D(n,t,r,s,i,o){i==null&&(i=computeDefaultPad(n,t[0],s[0]));const l=[0,0,0,r];for(let f=0;f<3;f++)n[f]+2*i>=t[f]&&(l[f]=round$1((n[f]-t[f]+2*i)/s[f]+1,o));return l}function computeDefaultPad(n,t,r,s=1){const i=getEffectiveFilterSize(t,s);return Math.floor((n[0]*(r-1)-r+i)/2)}function parseTupleParam(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function parse3TupleParam(n){return typeof n=="number"?[n,n,n]:n}function getEffectiveFilterSize(n,t){return t<=1?n:n+(n-1)*(t-1)}function getPadAndOutInfo(n,t,r,s,i,o,l,f,u){let g,y,a;if(typeof n=="number"){g={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const _=computeOutputShape2D([t,r],o,s,n,f);y=_[0],a=_[1]}else if(n==="same"){y=Math.ceil(t/s),a=Math.ceil(r/i);const m=Math.max(0,(y-1)*s+o-t),_=Math.max(0,(a-1)*i+l-r),b=Math.floor(m/2),c=m-b,w=Math.floor(_/2),S=_-w;g={top:b,bottom:c,left:w,right:S,type:"SAME"}}else if(n==="valid")g={top:0,bottom:0,left:0,right:0,type:"VALID"},y=Math.ceil((t-o+1)/s),a=Math.ceil((r-l+1)/i);else if(typeof n=="object"){const m=u==="channelsLast"?n[1][0]:n[2][0],_=u==="channelsLast"?n[1][1]:n[2][1],b=u==="channelsLast"?n[2][0]:n[3][0],c=u==="channelsLast"?n[2][1]:n[3][1];g={top:m,bottom:_,left:b,right:c,type:m===0&&_===0&&b===0&&c===0?"VALID":"EXPLICIT"},y=round$1((t-o+m+_)/s+1,f),a=round$1((r-l+b+c)/i+1,f)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:g,outHeight:y,outWidth:a}}function get3DPadAndOutInfo(n,t,r,s,i,o,l,f,u,g,y){let a,m,_,b;if(n==="valid"&&(n=0),typeof n=="number"){a={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const w=computeOutputShape4D([t,r,s,1],[f,u,g],1,[i,o,l],n,y);m=w[0],_=w[1],b=w[2]}else if(n==="same"){m=Math.ceil(t/i),_=Math.ceil(r/o),b=Math.ceil(s/l);const c=(m-1)*i+f-t,w=(_-1)*o+u-r,S=(b-1)*l+g-s,E=Math.floor(c/2),I=c-E,A=Math.floor(w/2),T=w-A,O=Math.floor(S/2),C=S-O;a={top:A,bottom:T,left:O,right:C,front:E,back:I,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:a,outDepth:m,outHeight:_,outWidth:b}}function round$1(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function tupleValuesAreOne(n){const[t,r,s]=parseTupleParam(n);return t===1&&r===1&&s===1}function eitherStridesOrDilationsAreOne(n,t){return tupleValuesAreOne(n)||tupleValuesAreOne(t)}function convertConv2DDataFormat(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function reshape_(n,t){const s={x:convertToTensor(n,"x","reshape","string_or_numeric")},i={shape:t};return ENGINE.runKernel(Reshape,s,i)}const reshape$1=op({reshape_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function concat_(n,t=0){assert(n.length>=1,()=>"Pass at least one tensor to concat");const r=convertToTensorArray(n,"tensors","concat","string_or_numeric");if(r[0].dtype==="complex64"&&r.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),r.length===1)return clone(r[0]);const s=r,i={axis:t};return ENGINE.runKernel(Concat,s,i)}const concat$1=op({concat_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function slice_(n,t,r){const s=convertToTensor(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const i={x:s},o={begin:t,size:r};return ENGINE.runKernel(Slice,i,o)}const slice$1=op({slice_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function broadcastTo_(n,t){let r=convertToTensor(n,"broadcastTo","x");const s=r.shape;if(assertNonNegativeIntegerDimensions(t),t.length<r.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${r.rank}.`);if(t.length>r.rank){const g=r.shape.slice();for(;g.length<t.length;)g.unshift(1);r=reshape$1(r,g)}const i=r.shape,o=Array.from(t);for(let g=t.length-1;g>=0;g--)if(i[g]===t[g])o[g]=1;else if(r.shape[g]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(o.map((g,y)=>g>1?y:-1).filter(g=>g>=0).length===0)return clone(r);const f={x:r},u={reps:o};return ENGINE.runKernel(Tile,f,u)}const broadcastTo=op({broadcastTo_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fill$1(n,t,r){assertNonNegativeIntegerDimensions(n),r=r||inferDtype(t);const s={shape:n,value:t,dtype:r};return ENGINE.runKernel(Fill,{},s)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function getBroadcastDims(n,t){const r=n.length,s=[];for(let i=0;i<r;i++){const o=r-1-i,l=n[o]||1;(t[t.length-1-i]||1)>1&&l===1&&s.unshift(o)}return s}function assertAndGetBroadcastShape(n,t){const r=Math.max(n.length,t.length),s=new Array(r);for(let i=0;i<r;i++){let o=n[n.length-i-1];o==null&&(o=1);let l=t[t.length-i-1];if(l==null&&(l=1),o===1)s[r-i-1]=l;else if(l===1)s[r-i-1]=o;else if(o!==l){const f=`Operands could not be broadcast together with shapes ${n} and ${t}.`;throw Error(f)}else s[r-i-1]=o}return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zerosLike_(n){const r={x:convertToTensor(n,"x","zerosLike")};return ENGINE.runKernel(ZerosLike,r)}const zerosLike$1=op({zerosLike_});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function axesAreInnerMostDims(n,t){for(let r=0;r<n.length;++r)if(n[n.length-r-1]!==t-1-r)return!1;return!0}function combineLocations(n,t,r){const s=n.length+t.length,i=[];let o=0,l=0;for(let f=0;f<s;f++)r.indexOf(f)===-1?i.push(n[o++]):i.push(t[l++]);return i}function computeOutAndReduceShapes(n,t){const r=[],s=n.length;for(let o=0;o<s;o++)t.indexOf(o)===-1&&r.push(n[o]);const i=t.map(o=>n[o]);return[r,i]}function expandShapeToKeepDim(n,t){const r=t.map(s=>1);return combineLocations(n,r,t)}function assertAxesAreInnerMostDims(n,t,r){assert(axesAreInnerMostDims(t,r),()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${r} input.`)}function getAxesPermutation(n,t){if(axesAreInnerMostDims(n,t))return null;const r=[];for(let s=0;s<t;++s)n.indexOf(s)===-1&&r.push(s);return n.forEach(s=>r.push(s)),r}function getUndoAxesPermutation(n){return n.map((t,r)=>[r,t]).sort((t,r)=>t[1]-r[1]).map(t=>t[0])}function getInnerMostAxes(n,t){const r=[];for(let s=t-n;s<t;++s)r.push(s);return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pow_(n,t){let r=convertToTensor(n,"base","pow"),s=convertToTensor(t,"exp","pow");[r,s]=makeTypesMatch(r,s);const i={a:r,b:s};return ENGINE.runKernel(Pow,i)}const pow$1=op({pow_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function scalar(n,t){if((isTypedArray(n)&&t!=="string"||Array.isArray(n))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&isTypedArray(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return makeTensor(n,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sqrt_(n){const r={x:convertToTensor(n,"x","sqrt","float32")};return ENGINE.runKernel(Sqrt,r)}const sqrt$1=op({sqrt_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function square_(n){const t=convertToTensor(n,"x","square"),r={};return ENGINE.runKernel("Square",{x:t},r)}const square=op({square_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function imag_(n){const r={input:convertToTensor(n,"input","imag")};return ENGINE.runKernel(Imag,r)}const imag$1=op({imag_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function variableGrads(n,t){assert(isFunction(n),()=>"The f passed in variableGrads(f) must be a function"),assert(t==null||Array.isArray(t)&&t.every(g=>g instanceof Variable),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const r=t!=null;if(!r){t=[];for(const g in ENGINE.registeredVariables)t.push(ENGINE.registeredVariables[g])}const s=r?t.filter(g=>!g.trainable):null,i=t.length;t=t.filter(g=>g.trainable),assert(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const o=!0,{value:l,grads:f}=ENGINE.gradients(n,t,null,o);assert(f.some(g=>g!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),assert(l.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${l.rank} tensor`);const u={};return t.forEach((g,y)=>{f[y]!=null&&(u[g.name]=f[y])}),s!=null&&s.forEach(g=>u[g.name]=null),{value:l,grads:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function neg_(n){const r={x:convertToTensor(n,"x","neg")};return ENGINE.runKernel(Neg,r)}const neg$1=op({neg_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sub_(n,t){let r=convertToTensor(n,"a","sub"),s=convertToTensor(t,"b","sub");[r,s]=makeTypesMatch(r,s);const i={a:r,b:s};return ENGINE.runKernel(Sub,i)}const sub$1=op({sub_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function maximum_(n,t){let r=convertToTensor(n,"a","maximum"),s=convertToTensor(t,"b","maximum");[r,s]=makeTypesMatch(r,s),r.dtype==="bool"&&(r=cast$1(r,"int32"),s=cast$1(s,"int32")),assertAndGetBroadcastShape(r.shape,s.shape);const i={a:r,b:s};return ENGINE.runKernel(Maximum,i)}const maximum$1=op({maximum_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pad_(n,t,r=0){const s=convertToTensor(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:r},o={x:s};return ENGINE.runKernel(PadV2,o,i)}const pad=op({pad_});var alea$1={exports:{}};alea$1.exports;(function(n){(function(t,r,s){function i(u){var g=this,y=f();g.next=function(){var a=2091639*g.s0+g.c*23283064365386963e-26;return g.s0=g.s1,g.s1=g.s2,g.s2=a-(g.c=a|0)},g.c=1,g.s0=y(" "),g.s1=y(" "),g.s2=y(" "),g.s0-=y(u),g.s0<0&&(g.s0+=1),g.s1-=y(u),g.s1<0&&(g.s1+=1),g.s2-=y(u),g.s2<0&&(g.s2+=1),y=null}function o(u,g){return g.c=u.c,g.s0=u.s0,g.s1=u.s1,g.s2=u.s2,g}function l(u,g){var y=new i(u),a=g&&g.state,m=y.next;return m.int32=function(){return y.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,a&&(typeof a=="object"&&o(a,y),m.state=function(){return o(y,{})}),m}function f(){var u=4022871197,g=function(y){y=String(y);for(var a=0;a<y.length;a++){u+=y.charCodeAt(a);var m=.02519603282416938*u;u=m>>>0,m-=u,m*=u,u=m>>>0,m-=u,u+=m*4294967296}return(u>>>0)*23283064365386963e-26};return g}r&&r.exports?r.exports=l:s&&s.amd?s(function(){return l}):this.alea=l})(commonjsGlobal,n,!1)})(alea$1);var aleaExports=alea$1.exports,xor128$1={exports:{}};xor128$1.exports;(function(n){(function(t,r,s){function i(f){var u=this,g="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var a=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^a^a>>>8},f===(f|0)?u.x=f:g+=f;for(var y=0;y<g.length+64;y++)u.x^=g.charCodeAt(y)|0,u.next()}function o(f,u){return u.x=f.x,u.y=f.y,u.z=f.z,u.w=f.w,u}function l(f,u){var g=new i(f),y=u&&u.state,a=function(){return(g.next()>>>0)/4294967296};return a.double=function(){do var m=g.next()>>>11,_=(g.next()>>>0)/4294967296,b=(m+_)/(1<<21);while(b===0);return b},a.int32=g.next,a.quick=a,y&&(typeof y=="object"&&o(y,g),a.state=function(){return o(g,{})}),a}r&&r.exports?r.exports=l:s&&s.amd?s(function(){return l}):this.xor128=l})(commonjsGlobal,n,!1)})(xor128$1);var xor128Exports=xor128$1.exports,xorwow$1={exports:{}};xorwow$1.exports;(function(n){(function(t,r,s){function i(f){var u=this,g="";u.next=function(){var a=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(a^a<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,f===(f|0)?u.x=f:g+=f;for(var y=0;y<g.length+64;y++)u.x^=g.charCodeAt(y)|0,y==g.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(f,u){return u.x=f.x,u.y=f.y,u.z=f.z,u.w=f.w,u.v=f.v,u.d=f.d,u}function l(f,u){var g=new i(f),y=u&&u.state,a=function(){return(g.next()>>>0)/4294967296};return a.double=function(){do var m=g.next()>>>11,_=(g.next()>>>0)/4294967296,b=(m+_)/(1<<21);while(b===0);return b},a.int32=g.next,a.quick=a,y&&(typeof y=="object"&&o(y,g),a.state=function(){return o(g,{})}),a}r&&r.exports?r.exports=l:s&&s.amd?s(function(){return l}):this.xorwow=l})(commonjsGlobal,n,!1)})(xorwow$1);var xorwowExports=xorwow$1.exports,xorshift7$1={exports:{}};xorshift7$1.exports;(function(n){(function(t,r,s){function i(f){var u=this;u.next=function(){var y=u.x,a=u.i,m,_;return m=y[a],m^=m>>>7,_=m^m<<24,m=y[a+1&7],_^=m^m>>>10,m=y[a+3&7],_^=m^m>>>3,m=y[a+4&7],_^=m^m<<7,m=y[a+7&7],m=m^m<<13,_^=m^m<<9,y[a]=_,u.i=a+1&7,_};function g(y,a){var m,_=[];if(a===(a|0))_[0]=a;else for(a=""+a,m=0;m<a.length;++m)_[m&7]=_[m&7]<<15^a.charCodeAt(m)+_[m+1&7]<<13;for(;_.length<8;)_.push(0);for(m=0;m<8&&_[m]===0;++m);for(m==8?_[7]=-1:_[m],y.x=_,y.i=0,m=256;m>0;--m)y.next()}g(u,f)}function o(f,u){return u.x=f.x.slice(),u.i=f.i,u}function l(f,u){f==null&&(f=+new Date);var g=new i(f),y=u&&u.state,a=function(){return(g.next()>>>0)/4294967296};return a.double=function(){do var m=g.next()>>>11,_=(g.next()>>>0)/4294967296,b=(m+_)/(1<<21);while(b===0);return b},a.int32=g.next,a.quick=a,y&&(y.x&&o(y,g),a.state=function(){return o(g,{})}),a}r&&r.exports?r.exports=l:s&&s.amd?s(function(){return l}):this.xorshift7=l})(commonjsGlobal,n,!1)})(xorshift7$1);var xorshift7Exports=xorshift7$1.exports,xor4096$1={exports:{}};xor4096$1.exports;(function(n){(function(t,r,s){function i(f){var u=this;u.next=function(){var y=u.w,a=u.X,m=u.i,_,b;return u.w=y=y+1640531527|0,b=a[m+34&127],_=a[m=m+1&127],b^=b<<13,_^=_<<17,b^=b>>>15,_^=_>>>12,b=a[m]=b^_,u.i=m,b+(y^y>>>16)|0};function g(y,a){var m,_,b,c,w,S=[],E=128;for(a===(a|0)?(_=a,a=null):(a=a+"\0",_=0,E=Math.max(E,a.length)),b=0,c=-32;c<E;++c)a&&(_^=a.charCodeAt((c+32)%a.length)),c===0&&(w=_),_^=_<<10,_^=_>>>15,_^=_<<4,_^=_>>>13,c>=0&&(w=w+1640531527|0,m=S[c&127]^=_+w,b=m==0?b+1:0);for(b>=128&&(S[(a&&a.length||0)&127]=-1),b=127,c=4*128;c>0;--c)_=S[b+34&127],m=S[b=b+1&127],_^=_<<13,m^=m<<17,_^=_>>>15,m^=m>>>12,S[b]=_^m;y.w=w,y.X=S,y.i=b}g(u,f)}function o(f,u){return u.i=f.i,u.w=f.w,u.X=f.X.slice(),u}function l(f,u){f==null&&(f=+new Date);var g=new i(f),y=u&&u.state,a=function(){return(g.next()>>>0)/4294967296};return a.double=function(){do var m=g.next()>>>11,_=(g.next()>>>0)/4294967296,b=(m+_)/(1<<21);while(b===0);return b},a.int32=g.next,a.quick=a,y&&(y.X&&o(y,g),a.state=function(){return o(g,{})}),a}r&&r.exports?r.exports=l:s&&s.amd?s(function(){return l}):this.xor4096=l})(commonjsGlobal,n,!1)})(xor4096$1);var xor4096Exports=xor4096$1.exports,tychei$1={exports:{}};tychei$1.exports;(function(n){(function(t,r,s){function i(f){var u=this,g="";u.next=function(){var a=u.b,m=u.c,_=u.d,b=u.a;return a=a<<25^a>>>7^m,m=m-_|0,_=_<<24^_>>>8^b,b=b-a|0,u.b=a=a<<20^a>>>12^m,u.c=m=m-_|0,u.d=_<<16^m>>>16^b,u.a=b-a|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,f===Math.floor(f)?(u.a=f/4294967296|0,u.b=f|0):g+=f;for(var y=0;y<g.length+20;y++)u.b^=g.charCodeAt(y)|0,u.next()}function o(f,u){return u.a=f.a,u.b=f.b,u.c=f.c,u.d=f.d,u}function l(f,u){var g=new i(f),y=u&&u.state,a=function(){return(g.next()>>>0)/4294967296};return a.double=function(){do var m=g.next()>>>11,_=(g.next()>>>0)/4294967296,b=(m+_)/(1<<21);while(b===0);return b},a.int32=g.next,a.quick=a,y&&(typeof y=="object"&&o(y,g),a.state=function(){return o(g,{})}),a}r&&r.exports?r.exports=l:s&&s.amd?s(function(){return l}):this.tychei=l})(commonjsGlobal,n,!1)})(tychei$1);var tycheiExports=tychei$1.exports,seedrandom$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);(function(n){(function(t,r,s){var i=256,o=6,l=52,f="random",u=s.pow(i,o),g=s.pow(2,l),y=g*2,a=i-1,m;function _(A,T,O){var C=[];T=T==!0?{entropy:!0}:T||{};var k=S(w(T.entropy?[A,I(r)]:A??E(),3),C),P=new b(C),N=function(){for(var L=P.g(o),F=u,V=0;L<g;)L=(L+V)*i,F*=i,V=P.g(1);for(;L>=y;)L/=2,F/=2,V>>>=1;return(L+V)/F};return N.int32=function(){return P.g(4)|0},N.quick=function(){return P.g(4)/4294967296},N.double=N,S(I(P.S),r),(T.pass||O||function(L,F,V,j){return j&&(j.S&&c(j,P),L.state=function(){return c(P,{})}),V?(s[f]=L,F):L})(N,k,"global"in T?T.global:this==s,T.state)}function b(A){var T,O=A.length,C=this,k=0,P=C.i=C.j=0,N=C.S=[];for(O||(A=[O++]);k<i;)N[k]=k++;for(k=0;k<i;k++)N[k]=N[P=a&P+A[k%O]+(T=N[k])],N[P]=T;(C.g=function(L){for(var F,V=0,j=C.i,K=C.j,U=C.S;L--;)F=U[j=a&j+1],V=V*i+U[a&(U[j]=U[K=a&K+F])+(U[K]=F)];return C.i=j,C.j=K,V})(i)}function c(A,T){return T.i=A.i,T.j=A.j,T.S=A.S.slice(),T}function w(A,T){var O=[],C=typeof A,k;if(T&&C=="object")for(k in A)try{O.push(w(A[k],T-1))}catch{}return O.length?O:C=="string"?A:A+"\0"}function S(A,T){for(var O=A+"",C,k=0;k<O.length;)T[a&k]=a&(C^=T[a&k]*19)+O.charCodeAt(k++);return I(T)}function E(){try{var A;return m&&(A=m.randomBytes)?A=A(i):(A=new Uint8Array(i),(t.crypto||t.msCrypto).getRandomValues(A)),I(A)}catch{var T=t.navigator,O=T&&T.plugins;return[+new Date,t,O,t.screen,I(r)]}}function I(A){return String.fromCharCode.apply(0,A)}if(S(s.random(),r),n.exports){n.exports=_;try{m=require$$0}catch{}}else s["seed"+f]=_})(typeof self<"u"?self:commonjsGlobal,[],Math)})(seedrandom$1);var seedrandomExports=seedrandom$1.exports,alea=aleaExports,xor128=xor128Exports,xorwow=xorwowExports,xorshift7=xorshift7Exports,xor4096=xor4096Exports,tychei=tycheiExports,sr=seedrandomExports;sr.alea=alea;sr.xor128=xor128;sr.xorwow=xorwow;sr.xorshift7=xorshift7;sr.xor4096=xor4096;sr.tychei=tychei;var seedrandom=sr;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function real_(n){const r={input:convertToTensor(n,"input","real")};return ENGINE.runKernel(Real,r)}const real$1=op({real_});function calculateShapes(n,t,r){const s=t.shape.length,i=s>1?t.shape[s-1]:1,o=r.length;let l=1;for(let a=i;a<o;++a)l*=r[a];const f=i<1?1:i,u=sizeFromShape(t.shape)/f,g=[...computeStrides(r.slice(0,i)),1],y=sizeFromShape(r);return{sliceRank:i,numUpdates:u,sliceSize:l,strides:g,outputSize:y}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whereImpl$1(n,t){const r=[];for(let o=0;o<t.length;o++)t[o]&&r.push(o);const s=buffer(n,"int32"),i=buffer([r.length,n.length],"int32");for(let o=0;o<r.length;o++){const l=s.indexToLoc(r[o]),f=o*n.length;i.values.set(l,f)}return i.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function transpose_(n,t,r){const s=convertToTensor(n,"x","transpose");if(t==null&&(t=s.shape.map((l,f)=>f).reverse()),assert(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(l=>{assert(l>=0&&l<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const i={x:s},o={perm:t};return s.dtype==="complex64"?tidy(()=>{let l=real$1(s),f=imag$1(s);return l=ENGINE.runKernel(Transpose,{x:l},o),f=ENGINE.runKernel(Transpose,{x:f},o),r&&(f=neg$1(f)),complex$1(l,f)}):ENGINE.runKernel(Transpose,i,o)}const transpose$1=op({transpose_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function binaryInsert(n,t,r){const s=binarySearch(n,t,r),i=s<0?-(s+1):s;n.splice(i,0,t)}function binarySearch(n,t,r){return binarySearch_(n,t,r||defaultComparator)}function defaultComparator(n,t){return n>t?1:n<t?-1:0}function binarySearch_(n,t,r){let s=0,i=n.length,o=0,l=!1;for(;s<i;){o=s+(i-s>>>1);const f=r(t,n[o]);f>0?s=o+1:(i=o,l=!f)}return l?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nonMaxSuppressionV3Impl$1(n,t,r,s,i){return nonMaxSuppressionImpl_(n,t,r,s,i,0)}function nonMaxSuppressionV4Impl$1(n,t,r,s,i,o){return nonMaxSuppressionImpl_(n,t,r,s,i,0,!1,o,!0)}function nonMaxSuppressionV5Impl$1(n,t,r,s,i,o){return nonMaxSuppressionImpl_(n,t,r,s,i,o,!0)}function nonMaxSuppressionImpl_(n,t,r,s,i,o,l=!1,f=!1,u=!1){const g=[];for(let w=0;w<t.length;w++)t[w]>i&&g.push({score:t[w],boxIndex:w,suppressBeginIndex:0});g.sort(ascendingComparator);const y=o>0?-.5/o:0,a=[],m=[];for(;a.length<r&&g.length>0;){const w=g.pop(),{score:S,boxIndex:E,suppressBeginIndex:I}=w;if(S<i)break;let A=!1;for(let T=a.length-1;T>=I;--T){const O=intersectionOverUnion(n,E,a[T]);if(O>=s){A=!0;break}if(w.score=w.score*suppressWeight(s,y,O),w.score<=i)break}w.suppressBeginIndex=a.length,A||(w.score===S?(a.push(E),m.push(w.score)):w.score>i&&binaryInsert(g,w,ascendingComparator))}const _=a.length,b=r-_;f&&b>0&&(a.push(...new Array(b).fill(0)),m.push(...new Array(b).fill(0)));const c={selectedIndices:a};return l&&(c.selectedScores=m),u&&(c.validOutputs=_),c}function intersectionOverUnion(n,t,r){const s=n.subarray(t*4,t*4+4),i=n.subarray(r*4,r*4+4),o=Math.min(s[0],s[2]),l=Math.min(s[1],s[3]),f=Math.max(s[0],s[2]),u=Math.max(s[1],s[3]),g=Math.min(i[0],i[2]),y=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),m=Math.max(i[1],i[3]),_=(f-o)*(u-l),b=(a-g)*(m-y);if(_<=0||b<=0)return 0;const c=Math.max(o,g),w=Math.max(l,y),S=Math.min(f,a),E=Math.min(u,m),I=Math.max(S-c,0)*Math.max(E-w,0);return I/(_+b-I)}function suppressWeight(n,t,r){const s=Math.exp(t*r*r);return r<=n?s:0}function ascendingComparator(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GLOBAL_CUSTOM_OBJECT=new Map,GLOBAL_CUSTOM_NAMES=new Map;class Serializable{getClassName(){return this.constructor.className}static fromConfig(t,r){return new t(r)}}class SerializationMap{constructor(){this.classNameMap={}}static getMap(){return SerializationMap.instance==null&&(SerializationMap.instance=new SerializationMap),SerializationMap.instance}static register(t){SerializationMap.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function registerClass(n,t,r){assert(n.className!=null,()=>"Class being registered does not have the static className property defined."),assert(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),assert(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof r>"u"&&(r=n.className);const s=r,i=t+">"+s;return SerializationMap.register(n),GLOBAL_CUSTOM_OBJECT.set(i,n),GLOBAL_CUSTOM_NAMES.set(n,i),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Optimizer extends Serializable{minimize(t,r=!1,s){const{value:i,grads:o}=this.computeGradients(t,s);if(s!=null){const l=s.map(f=>({name:f.name,tensor:o[f.name]}));this.applyGradients(l)}else this.applyGradients(o);return dispose(o),r?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,r){return variableGrads(t,r)}dispose(){this.iterations_!=null&&dispose(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:scalar(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Optimizer,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AdadeltaOptimizer extends Optimizer{static get className(){return"Adadelta"}constructor(t,r,s=null){super(),this.learningRate=t,this.rho=r,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=ENGINE.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const o=ENGINE.registeredVariables[s],l=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${s}/accum_grad`,variable:tidy(()=>zerosLike$1(o).variable(l))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${s}/accum_var`,variable:tidy(()=>zerosLike$1(o).variable(l))});const f=Array.isArray(t)?t[i].tensor:t[s];if(f==null)return;const u=this.accumulatedGrads[i].variable,g=this.accumulatedUpdates[i].variable;tidy(()=>{const y=add$1(mul(u,this.rho),mul(square(f),1-this.rho)),a=mul(div$1(sqrt$1(add$1(g,this.epsilon)),sqrt$1(add$1(u,this.epsilon))),f),m=add$1(mul(g,this.rho),mul(square(a),1-this.rho));u.assign(y),g.assign(m);const _=add$1(mul(a,-this.learningRate),o);o.assign(_)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(dispose(this.accumulatedGrads.map(t=>t.variable)),dispose(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(r=>({name:r.originalName,tensor:r.variable})))}async setWeights(t){t=await this.extractIterations(t);const r=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,r).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedUpdates=t.slice(r,r*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,r){return new t(r.learningRate,r.rho,r.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AdagradOptimizer extends Optimizer{static get className(){return"Adagrad"}constructor(t,r=.1){super(),this.learningRate=t,this.initialAccumulatorValue=r,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const o=ENGINE.registeredVariables[s];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${s}/accumulator`,variable:tidy(()=>fill$1(o.shape,this.initialAccumulatorValue).variable(!1))});const l=Array.isArray(t)?t[i].tensor:t[s];if(l==null)return;const f=this.accumulatedGrads[i].variable;tidy(()=>{const u=add$1(f,square(l));f.assign(u);const g=add$1(mul(div$1(l,sqrt$1(add$1(u,ENGINE.backend.epsilon()))),-this.learningRate),o);o.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&dispose(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const r=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,r){return new t(r.learningRate,r.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AdamOptimizer extends Optimizer{static get className(){return"Adam"}constructor(t,r,s,i=null){super(),this.learningRate=t,this.beta1=r,this.beta2=s,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],tidy(()=>{this.accBeta1=scalar(r).variable(),this.accBeta2=scalar(s).variable()}),i==null&&(this.epsilon=ENGINE.backend.epsilon())}applyGradients(t){const r=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);tidy(()=>{const s=sub$1(1,this.accBeta1),i=sub$1(1,this.accBeta2);r.forEach((o,l)=>{const f=ENGINE.registeredVariables[o],u=!1;this.accumulatedFirstMoment[l]==null&&(this.accumulatedFirstMoment[l]={originalName:`${o}/m`,variable:tidy(()=>zerosLike$1(f).variable(u))}),this.accumulatedSecondMoment[l]==null&&(this.accumulatedSecondMoment[l]={originalName:`${o}/v`,variable:tidy(()=>zerosLike$1(f).variable(u))});const g=Array.isArray(t)?t[l].tensor:t[o];if(g==null)return;const y=this.accumulatedFirstMoment[l].variable,a=this.accumulatedSecondMoment[l].variable,m=add$1(mul(y,this.beta1),mul(g,1-this.beta1)),_=add$1(mul(a,this.beta2),mul(square(g),1-this.beta2)),b=div$1(m,s),c=div$1(_,i);y.assign(m),a.assign(_);const w=add$1(mul(div$1(b,add$1(sqrt$1(c),this.epsilon)),-this.learningRate),f);f.assign(w)}),this.accBeta1.assign(mul(this.accBeta1,this.beta1)),this.accBeta2.assign(mul(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&dispose(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&dispose(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(r=>({name:r.originalName,tensor:r.variable})))}async setWeights(t){t=await this.extractIterations(t),tidy(()=>{this.accBeta1.assign(pow$1(this.beta1,this.iterations_+1)),this.accBeta2.assign(pow$1(this.beta2,this.iterations_+1))});const r=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,r).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(r,r*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AdamaxOptimizer extends Optimizer{static get className(){return"Adamax"}constructor(t,r,s,i=null,o=0){super(),this.learningRate=t,this.beta1=r,this.beta2=s,this.epsilon=i,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],tidy(()=>{this.iteration=scalar(0).variable(),this.accBeta1=scalar(r).variable()}),i==null&&(this.epsilon=ENGINE.backend.epsilon())}applyGradients(t){const r=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);tidy(()=>{const s=sub$1(1,this.accBeta1),i=div$1(-this.learningRate,add$1(mul(this.iteration,this.decay),1));r.forEach((o,l)=>{const f=ENGINE.registeredVariables[o],u=!1;this.accumulatedFirstMoment[l]==null&&(this.accumulatedFirstMoment[l]={originalName:`${o}/m`,variable:zerosLike$1(f).variable(u)}),this.accumulatedWeightedInfNorm[l]==null&&(this.accumulatedWeightedInfNorm[l]={originalName:`${o}/v`,variable:zerosLike$1(f).variable(u)});const g=Array.isArray(t)?t[l].tensor:t[o];if(g==null)return;const y=this.accumulatedFirstMoment[l].variable,a=this.accumulatedWeightedInfNorm[l].variable,m=add$1(mul(y,this.beta1),mul(g,1-this.beta1)),_=mul(a,this.beta2),b=abs$1(g),c=maximum$1(_,b);y.assign(m),a.assign(c);const w=add$1(mul(div$1(i,s),div$1(m,add$1(c,this.epsilon))),f);f.assign(w)}),this.iteration.assign(add$1(this.iteration,1)),this.accBeta1.assign(mul(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&dispose(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&dispose(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,r){return new t(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SGDOptimizer extends Optimizer{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const o=Array.isArray(t)?t[i].tensor:t[s];if(o==null)return;const l=ENGINE.registeredVariables[s];tidy(()=>{const f=add$1(mul(this.c,o),l);l.assign(f)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=keep(scalar(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,r){return new t(r.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MomentumOptimizer extends SGDOptimizer{static get className(){return"Momentum"}constructor(t,r,s=!1){super(t),this.learningRate=t,this.momentum=r,this.useNesterov=s,this.accumulations=[],this.m=scalar(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const o=ENGINE.registeredVariables[s];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${s}/momentum`,variable:tidy(()=>zerosLike$1(o).variable(!1))});const l=this.accumulations[i].variable,f=Array.isArray(t)?t[i].tensor:t[s];f!=null&&tidy(()=>{let u;const g=add$1(mul(this.m,l),f);this.useNesterov?u=add$1(mul(this.c,add$1(f,mul(g,this.m))),o):u=add$1(mul(this.c,g),o),l.assign(g),o.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&dispose(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const r=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,r){return new t(r.learningRate,r.momentum,r.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RMSPropOptimizer extends Optimizer{static get className(){return"RMSProp"}constructor(t,r=.9,s=0,i=null,o=!1){if(super(),this.learningRate=t,this.decay=r,this.momentum=s,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,i==null&&(this.epsilon=ENGINE.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const o=ENGINE.registeredVariables[s],l=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${s}/rms`,variable:tidy(()=>zerosLike$1(o).variable(l))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${s}/momentum`,variable:tidy(()=>zerosLike$1(o).variable(l))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${s}/mg`,variable:tidy(()=>zerosLike$1(o).variable(l))});const f=Array.isArray(t)?t[i].tensor:t[s];if(f==null)return;const u=this.accumulatedMeanSquares[i].variable,g=this.accumulatedMoments[i].variable;tidy(()=>{const y=add$1(mul(u,this.decay),mul(square(f),1-this.decay));if(this.centered){const a=this.accumulatedMeanGrads[i].variable,m=add$1(mul(a,this.decay),mul(f,1-this.decay)),_=div$1(mul(f,this.learningRate),sqrt$1(sub$1(y,add$1(square(m),this.epsilon)))),b=add$1(mul(g,this.momentum),_);u.assign(y),a.assign(m),g.assign(b);const c=sub$1(o,b);o.assign(c)}else{const a=add$1(mul(u,this.decay),mul(square(f),1-this.decay)),m=add$1(mul(g,this.momentum),div$1(mul(f,this.learningRate),sqrt$1(add$1(a,this.epsilon))));u.assign(a),g.assign(m);const _=sub$1(o,m);o.assign(_)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&dispose(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&dispose(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&dispose(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(r=>({name:r.originalName,tensor:r.variable})))}async setWeights(t){t=await this.extractIterations(t);const r=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,r).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedMoments=t.slice(r,r*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(r*2,r*3).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,r){return new t(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OPTIMIZERS=[AdadeltaOptimizer,AdagradOptimizer,AdamOptimizer,AdamaxOptimizer,MomentumOptimizer,RMSPropOptimizer,SGDOptimizer];function registerOptimizers(){for(const n of OPTIMIZERS)registerClass(n)}function prepareAndValidate(n,t){const r=n.shape.length,s=t.shape.length;if(r<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${r}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>r)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${r}`);if(sizeFromShape(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const i=t.shape,o=i[i.length-1];let l=1;for(let a=0;a<i.length-1;++a)l*=i[a];const f=n.shape,u=i.slice();u.pop();let g=1;for(let a=o;a<r;++a)g*=f[a],u.push(f[a]);const y=[...computeStrides(n.shape).map(a=>a/g),1].slice(0,o);return[u,l,g,y]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NEW_AXIS=-2,SHRINK_AXIS=-1;function assertParamsValid(n,t,r){const s=n.shape.length;assert(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),assert(s===r.length,()=>`Error in slice${s}D: Length of size ${r} must match the rank of the array (${s}).`);for(let i=0;i<s;++i)assert(t[i]+r[i]<=n.shape[i],()=>`Error in slice${s}D: begin[${i}] + size[${i}] (${t[i]+r[i]}) would overflow input.shape[${i}] (${n.shape[i]})`)}function computeOutShape$1(n,t,r){const s=[];for(let i=0;i<n.length;i++)s[i]=Math.ceil((t[i]-n[i])/r[i]);return s}function isSliceContinous(n,t,r){let s=r.length;for(let i=0;i<r.length;i++)if(r[i]>1){s=i;break}for(let i=s+1;i<r.length;i++)if(t[i]>0||r[i]!==n[i])return!1;return!0}function computeFlatOffset(n,t){let r=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)r+=n[s]*t[s];return r}function parseSliceParams(n,t,r){let s;const i=n.shape.length;typeof t=="number"?s=[t,...new Array(i-1).fill(0)]:t.length<i?s=t.concat(new Array(i-t.length).fill(0)):s=t.slice(),s.forEach(l=>{assert(l!==-1,()=>"slice() does not support negative begin indexing.")});let o;return r==null?o=new Array(i).fill(-1):typeof r=="number"?o=[r,...new Array(i-1).fill(-1)]:r.length<i?o=r.concat(new Array(i-r.length).fill(-1)):o=r,o=o.map((l,f)=>l>=0?l:(assert(l===-1,()=>`Negative size values should be exactly -1 but got ${l} for the slice() size at index ${f}.`),n.shape[f]-s[f])),[s,o]}function sliceInfo(n,t,r,s,i,o,l,f,u){let g;if(s==null?(g=new Array(t.length),g.fill(1)):g=s,l!=null&&l&l-1)throw new Error("Multiple ellipses in slice is not allowed.");let y=!1;const a={dims:g.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:r.slice(),strides:g.slice(),beginMask:i,endMask:o,ellipsisMask:l,newAxisMask:f,shrinkAxisMask:u};for(let I=0;I<a.dims;I++)y&&1<<I&f&&a.numAddAxisAfterEllipsis++,1<<I&l&&(y=!0);y||(a.ellipsisMask|=1<<a.dims,a.dims++);const m={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};buildDenseSpec(a,m);let _=!0,b=!0,c=!0;const w=[],S=[];for(let I=0;I<n.length;++I){if(m.strides[I]===0)throw Error(`strides[${I}] must be non-zero`);const A=!!(m.shrinkAxisMask&1<<I),T=n[I];if(T===-1){w.push(A?1:-1);continue}const O=[m.beginMask&1<<I,m.endMask&1<<I],C=[m.strides[I]>0?0:-1,m.strides[I]>0?T:T-1];if(A&&m.strides[I]<=0)throw Error("only stride 1 allowed on non-range indexing.");c=c&&m.strides[I]===1;const k=!!(m.beginMask&1<<I&&m.endMask&1<<I);if(m.beginValid&&m.endValid){if(A){const F=m.begin[I]<0?T+m.begin[I]:m.begin[I];if(m.begin[I]=F,m.end[I]=m.begin[I]+1,F<0||F>=T)throw Error(`slice index ${m.begin[I]} of dimension ${I} out of bounds.`)}else m.begin[I]=canonical(m.begin[I],0,m.strides[I],T,O,C),m.end[I]=canonical(m.end[I],1,m.strides[I],T,O,C);const L=m.strides[I]===1&&m.begin[I]===0&&m.end[I]===T;_=_&&L,b=b&&(I===0&&m.strides[I]===1||L)}else _=_&&m.strides[I]===1&&k,b=b&&(I===0&&m.strides[I]===1||k);let P,N=!1;if(m.beginValid&&m.endValid?(P=m.end[I]-m.begin[I],N=!0):A?(P=1,N=!0):k&&T>=0&&(m.strides[I]<0?P=-T:P=T,N=!0),N){let L;P===0||P<0!=m.strides[I]<0?L=0:L=Math.trunc(P/m.strides[I])+(P%m.strides[I]!==0?1:0),w.push(L)}else w.push(-1)}for(let I=0;I<m.finalShapeGatherIndices.length;++I){const A=m.finalShapeGatherIndices[I];A>=0?S.push(w[A]):A===NEW_AXIS&&S.push(1)}return{finalShapeSparse:S.filter((I,A)=>m.finalShapeGatherIndices[A]!==NEW_AXIS),finalShape:S,isIdentity:_,sliceDim0:b,isSimpleSlice:c,begin:m.begin,end:m.end,strides:m.strides}}function buildDenseSpec(n,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let r=0;t.beginValid=n.begin!=null,t.endValid=n.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const i=Math.min(t.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,t.dims);for(;r<i;r++)t.begin[r]=0,t.end[r]=0,t.strides[r]=1,t.beginMask|=1<<r,t.endMask|=1<<r,t.finalShapeGatherIndices.push(r),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[r]=s}else if(1<<s&n.newAxisMask)t.finalShapeGatherIndices.push(NEW_AXIS),t.finalShapeGatherIndicesSparse.push(-1);else{if(r===t.begin.length)throw Error(`Index out of range using input dim ${r}; input has only ${t.dims} dims, ${t.begin.length}.`);n.begin!=null&&(t.begin[r]=n.begin[s]),n.end!=null&&(t.end[r]=n.end[s]),t.strides[r]=n.strides[s],n.beginMask&1<<s&&(t.beginMask|=1<<r),n.endMask&1<<s&&(t.endMask|=1<<r),n.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(SHRINK_AXIS),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<r):(t.finalShapeGatherIndices.push(r),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[r]=s,r++}}function canonical(n,t,r,s,i,o){if(i[t])return r>0?o[t]:o[t+1&1];{const l=n<0?s+n:n;return l<o[0]?o[0]:l>o[1]?o[1]:l}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function assertParamsConsistent(n,t){const r=n[0].length;n.forEach((i,o)=>{assert(i.length===r,()=>`Error in concat${r}D: rank of tensors[${o}] must be the same as the rank of the rest (${r})`)}),assert(t>=0&&t<r,()=>`Error in concat${r}D: axis must be between 0 and ${r-1}.`);const s=n[0];n.forEach((i,o)=>{for(let l=0;l<r;l++)assert(l===t||i[l]===s[l],()=>`Error in concat${r}D: Shape of tensors[${o}] (${i}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function computeOutShape(n,t){const r=n[0].slice();for(let s=1;s<n.length;s++)r[t]+=n[s][t];return r}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var RowPartitionType$1;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(RowPartitionType$1||(RowPartitionType$1={}));function combineRaggedTensorToTensorShapes(n,t,r){let s=new Array;if(r==null&&t==null)return s;if(t==null)for(;s.length<n+r.length;)s.push(-1);else s=t.slice();if(r==null)return s;if(n+r.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${n+r.length}, but shape.rank = ${s.length}`);for(let i=1;i<r.length;++i){const o=r[i],l=s[s.length-r.length+i],f=s[l];if(o>=0)if(f>=0){if(f!==o)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+n}] = ${o} but shape[${i+n}] = ${f}`)}else s[l]=o}return s}function getRowPartitionTypesHelper(n){const t={FIRST_DIM_SIZE:RowPartitionType$1.FIRST_DIM_SIZE,VALUE_ROWIDS:RowPartitionType$1.VALUE_ROWIDS,ROW_LENGTHS:RowPartitionType$1.ROW_LENGTHS,ROW_SPLITS:RowPartitionType$1.ROW_SPLITS,ROW_LIMITS:RowPartitionType$1.ROW_LIMITS,ROW_STARTS:RowPartitionType$1.ROW_STARTS},r=[];for(const s of n)if(s in t)r.push(t[s]);else break;return r}function getRaggedRank(n){return n.length===0?0:n[0]===RowPartitionType$1.FIRST_DIM_SIZE?n.length-1:n.length}function validateDefaultValueShape(n,t){if(n==null||t==null)return;const r=n.length,s=t.length;if(r>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${r} must be less than ragged tensor input flatValues.rank = ${s})`);for(let i=0;i<Math.min(r,s-1);++i){const o=n[i],l=t[i+1];if(o>=0&&l>=0&&o!==1&&o!==l)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-n.length}] = ${o} but ragged tensor input.flatValues.shape[${i-n.length}] = ${l}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function getImageCenter(n,t,r){const s=r*(typeof n=="number"?n:n[0]),i=t*(typeof n=="number"?n:n[1]);return[s,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function getReshaped(n,t,r,s=!0){let i=[];if(s)i=i.concat(t.slice(0)),i.push(n[0]/r),i=i.concat(n.slice(1));else{i=i.concat(n[0]);const o=t.length;for(let l=0;l<o;++l)i=i.concat([n[l+1]/t[l],t[l]]);i=i.concat(n.slice(o+1))}return i}function getPermuted(n,t,r=!0){const s=[];if(r){s.push(t);for(let i=t+1;i<n;++i)i<=2*t?(s.push(i),s.push(i-(t+1))):s.push(i)}else{const i=[],o=[];for(let l=1;l<n;++l)l>=t*2+1||l%2===1?o.push(l):i.push(l);s.push(...i),s.push(0),s.push(...o)}return s}function getReshapedPermuted(n,t,r,s=!0){const i=[];s?i.push(n[0]/r):i.push(n[0]*r);for(let o=1;o<n.length;++o)o<=t.length?s?i.push(t[o-1]*n[o]):i.push(n[o]/t[o-1]):i.push(n[o]);return i}function getSliceBeginCoords(n,t){const r=[0];for(let s=0;s<t;++s)r.push(n[s][0]);return r}function getSliceSize(n,t,r){const s=n.slice(0,1);for(let i=0;i<r;++i)s.push(n[i+1]-t[i][0]-t[i][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SELU_SCALEALPHA=1.7580993408473768,SELU_SCALE=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ERF_P=.3275911,ERF_A1=.254829592,ERF_A2=-.284496736,ERF_A3=1.421413741,ERF_A4=-1.453152027,ERF_A5=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mergeRealAndImagArrays(n,t){if(n.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${t.length}.`);const r=new Float32Array(n.length*2);for(let s=0;s<r.length;s+=2)r[s]=n[s/2],r[s+1]=t[s/2];return r}function splitRealAndImagArrays(n){const t=new Float32Array(n.length/2),r=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)t[s/2]=n[s],r[s/2]=n[s+1];return{real:t,imag:r}}function complexWithEvenIndex(n){const t=Math.ceil(n.length/4),r=new Float32Array(t),s=new Float32Array(t);for(let i=0;i<n.length;i+=4)r[Math.floor(i/4)]=n[i],s[Math.floor(i/4)]=n[i+1];return{real:r,imag:s}}function complexWithOddIndex(n){const t=Math.floor(n.length/4),r=new Float32Array(t),s=new Float32Array(t);for(let i=2;i<n.length;i+=4)r[Math.floor(i/4)]=n[i],s[Math.floor(i/4)]=n[i+1];return{real:r,imag:s}}function getComplexWithIndex(n,t){const r=n[t*2],s=n[t*2+1];return{real:r,imag:s}}function assignToTypedArray(n,t,r,s){n[s*2]=t,n[s*2+1]=r}function exponents(n,t){const r=new Float32Array(n/2),s=new Float32Array(n/2);for(let i=0;i<Math.ceil(n/2);i++){const o=(t?2:-2)*Math.PI*(i/n);r[i]=Math.cos(o),s[i]=Math.sin(o)}return{real:r,imag:s}}function exponent(n,t,r){const s=(r?2:-2)*Math.PI*(n/t),i=Math.cos(s),o=Math.sin(s);return{real:i,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ARROW="->",ARROW_REGEX=/->/g,COMMA=",",ELLIPSIS="...";function decodeEinsumEquation(n,t){n=n.replace(/\s/g,"");const r=(n.length-n.replace(ARROW_REGEX,"").length)/ARROW.length;if(r<1)throw new Error("Equations without an arrow are not supported.");if(r>1)throw new Error(`Equation must contain exactly one arrow ("${ARROW}").`);const[s,i]=n.split(ARROW);assert(s.indexOf(ELLIPSIS)===-1,()=>`The ellipsis notation ("${ELLIPSIS}") is not supported yet.`);const o=s.split(COMMA),l=o.length;if(t!==l)throw new Error(`Expected ${l} input tensors, received ${t}`);if(l>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const f=[];for(let m=0;m<i.length;++m){const _=i[m];if(!o.some(b=>b.indexOf(_)!==-1))throw new Error(`Output subscripts contain the label ${_} not present in the input subscripts.`);f.indexOf(_)===-1&&f.push(_)}for(let m=0;m<s.length;++m){const _=s[m];f.indexOf(_)===-1&&_!==COMMA&&f.push(_)}const u=new Array(o.length);for(let m=0;m<l;++m){if(new Set(o[m].split("")).size!==o[m].length)throw new Error(`Found duplicate axes in input component ${o[m]}. Support for duplicate axes in input is not implemented yet.`);u[m]=[];for(let _=0;_<o[m].length;++_)u[m].push(f.indexOf(o[m][_]))}const g=f.length,y=i.length,a=[];for(let m=y;m<g;++m)a.push(m);return{allDims:f,summedDims:a,idDims:u}}function getEinsumPermutation(n,t){let r=new Array(n);r.fill(-1);for(let i=0;i<t.length;++i)r[t[i]]=i;const s=[];for(let i=0;i<n;++i)r[i]===-1&&s.push(i);return r=r.filter(i=>i!==-1),{permutationIndices:r,expandDims:s}}function checkEinsumDimSizes(n,t,r){const s=new Array(n);for(let i=0;i<r.length;++i){const o=r[i].shape;for(let l=0;l<t[i].length;++l)s[t[i][l]]===void 0?s[t[i][l]]=o[l]:assert(s[t[i][l]]===o[l],()=>`Expected dimension ${s[t[i][l]]} at axis ${l} of input shaped ${JSON.stringify(o)}, but got dimension ${o[l]}`)}}function getEinsumComputePath(n,t){const r=n,s=[];let i=0;n.length===0&&r.push(-1),i=n.length+1;for(let l=0;l<i;++l)s.push([]);const o=[];for(let l=0;l<r.length;++l){const f=r[l],u=findTermsWithDim(t,f);for(const g of u)o.indexOf(g)===-1&&(s[l].push(g),o.push(g))}return{path:r,steps:s}}function isIdentityPermutation(n){return n.every((t,r)=>t===r)}function findTermsWithDim(n,t){const r=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(t)!==-1||t===-1)&&r.push(s);return r}function prepareSplitSize(n,t,r=0){let s=[];if(typeof t=="number")assert(n.shape[r]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(n.shape[r]/t);else{const i=t.reduce((l,f)=>(f===-1&&(l+=1),l),0);assert(i<=1,()=>"There should be only one negative value in split array.");const o=t.indexOf(-1);if(o!==-1){const l=t.reduce((f,u)=>u>0?f+u:f);t[o]=n.shape[r]-l}assert(n.shape[r]===t.reduce((l,f)=>l+f),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function getSparseFillEmptyRowsIndicesDenseShapeMismatch(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function getSparseFillEmptyRowsNegativeIndexErrorMessage(n,t){return`indices(${n}, 0) is invalid: ${t} < 0`}function getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(n,t,r){return`indices(${n}, 0) is invalid: ${t} >= ${r}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(n,t){return`only one output dimension may be -1, not both ${n} and ${t}`}function getSparseReshapeNegativeOutputDimErrorMessage(n,t){return`size ${n} must be non-negative, not ${t}`}function getSparseReshapeEmptyTensorZeroOutputDimErrorMessage(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function getSparseReshapeInputOutputMultipleErrorMessage(n,t){const r=sizeFromShape(n),s=sizeFromShape(t);return`Input to reshape is a SparseTensor with ${r}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${t}`}function getSparseReshapeInputOutputMismatchErrorMessage(n,t){const r=sizeFromShape(n),s=sizeFromShape(t);return`Input to reshape is a tensor with ${r} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function getSparseSegmentReductionNegativeSegmentIdsErrorMessage(){return"segment ids must be >= 0"}function getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage(){return"segment ids are not increasing"}function getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(n,t){return`Segment id ${n} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function getSparseSegmentReductionIndicesOutOfRangeErrorMessage(n,t,r){return`Bad: indices[${n}] == ${t} out of range [0, ${r})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function collectGatherOpShapeInfo(n,t,r,s){const i=t.shape.length,o=n.shape.length;if(s!==0&&(s<-i||s>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${s}`);if(s<0&&(s+=i),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(r<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${r}).`);for(let a=0;a<s;++a)if(n.shape[a]!==t.shape[a])throw new Error(`x.shape[${a}]: ${n.shape[a]} should be equal to indices.shape[${a}]: ${t.shape[a]}.`);const l=n.shape[r],f=[];let u=1,g=1,y=1;for(let a=0;a<s;++a)f.push(n.shape[a]),u*=n.shape[a];for(let a=s;a<r;a++)f.push(n.shape[a]),g*=n.shape[a];for(let a=s;a<i;a++)f.push(t.shape[a]);for(let a=r+1;a<o;a++)f.push(n.shape[a]),y*=n.shape[a];return{batchSize:u,sliceSize:y,outerSize:g,dimSize:l,outputShape:f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fromUint8ToStringArray(n){try{return n.map(t=>decodeString(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function fromStringArrayToUint8(n){return n.map(t=>encodeString(t))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */registerOptimizers();/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function assertNotComplex(n,t){Array.isArray(n)||(n=[n]),n.forEach(r=>{r!=null&&assert(r.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whereImpl=whereImpl$1;class MathBackendCPU extends KernelBackend{nextDataId(){return MathBackendCPU.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new DataStorage(this,engine())}write(t,r,s){this.firstUse&&(this.firstUse=!1,env().get("IS_NODE")&&warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:s,refCount:1}),i}makeTensorInfo(t,r,s){let i;if(r==="string"&&s!=null&&s.length>0&&isString(s[0])){const o=s.map(l=>encodeString(l));i=this.write(o,t,r)}else i=this.write(s,t,r);return{dataId:i,shape:t,dtype:r}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const r=this.data.get(t);r.refCount++}decRef(t){if(this.data.has(t)){const r=this.data.get(t);r.refCount--}}move(t,r,s,i,o){this.data.set(t,{values:r,dtype:i,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:r,complexTensorInfos:s}=this.data.get(t);if(r==="complex64"){const i=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return mergeRealAndImagArrays(i,o)}return convertBackendValuesAndArrayBuffer(this.data.get(t).values,r)}bufferSync(t){const r=this.readSync(t.dataId);if(t.dtype==="string")try{const s=r.map(i=>decodeString(i));return buffer(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return buffer(t.shape,t.dtype,r)}makeOutput(t,r,s){return engine().makeTensorFromTensorInfo(this.makeTensorInfo(r,s,t),this)}disposeData(t,r=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!r&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const r=now();return t(),{kernelMs:now()-r}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){assertNotComplex([t],"where");const r=this.readSync(t.dataId);return whereImpl(t.shape,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}MathBackendCPU.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function simpleAbsImpl(n){const t=new Float32Array(n.length);for(let r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return t}const abs=n=>{const{x:t}=n.inputs,r=n.backend;assertNotComplex(t,"abs");let s=new Float32Array(sizeFromShape(t.shape));const i=r.data.get(t.dataId).values;return s=simpleAbsImpl(i),r.makeOutput(s,t.shape,t.dtype)},absConfig={kernelName:Abs,backendName:"cpu",kernelFunc:abs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function createSimpleBinaryKernelImpl(n){return(t,r,s,i,o)=>{const l=assertAndGetBroadcastShape(t,r),f=l.length,u=computeStrides(l),g=sizeFromShape(l),y=getTypedArrayFromDType(o,g),a=t.length,m=r.length,_=computeStrides(t),b=computeStrides(r),c=getBroadcastDims(t,l),w=getBroadcastDims(r,l);if(c.length+w.length===0)for(let S=0;S<y.length;++S)y[S]=n(s[S%s.length],i[S%i.length]);else for(let S=0;S<y.length;++S){const E=indexToLoc(S,f,u),I=E.slice(-a);c.forEach(C=>I[C]=0);const A=locToIndex(I,a,_),T=E.slice(-m);w.forEach(C=>T[C]=0);const O=locToIndex(T,m,b);y[S]=n(s[A],i[O])}return[y,l]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function complex(n){const{inputs:t,backend:r}=n,{real:s,imag:i}=t,o=r.data.get(s.dataId).values,l=r.data.get(i.dataId).values,f=r.makeTensorInfo(s.shape,"complex64"),u=r.data.get(f.dataId);return u.complexTensorInfos={real:r.makeTensorInfo(s.shape,"float32",o),imag:r.makeTensorInfo(i.shape,"float32",l)},f}const complexConfig={kernelName:Complex,backendName:"cpu",kernelFunc:complex};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zeros(n,t,r="float32"){if(r==="complex64"){const i=zeros(n,t,"float32"),o=zeros(n,t,"float32");return complex({inputs:{real:i,imag:o},backend:n})}const s=makeZerosTypedArray(sizeFromShape(t),r);return n.makeTensorInfo(t,r,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function identity(n){const{inputs:t,backend:r}=n,{x:s}=t;return r.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const identityConfig={kernelName:Identity,backendName:"cpu",kernelFunc:identity};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function real(n){const{inputs:t,backend:r}=n,{input:s}=t,i=r.data.get(s.dataId).complexTensorInfos.real,o=r.data.get(i.dataId).values;return r.makeTensorInfo(i.shape,i.dtype,o)}const realConfig={kernelName:Real,backendName:"cpu",kernelFunc:real};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function castImpl(n,t,r,s){if(s==="int32"){const i=Int32Array.from(n);return[t,"int32",i]}if(s==="bool"){const i=toTypedArray([0],r),[o,l]=createSimpleBinaryKernelImpl((f,u)=>f!==u?1:0)(t,[],n,i,"bool");return[l,"bool",o]}throw new Error(`Error in Cast: failed to cast ${r} to ${s}`)}function cast(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{dtype:o}=s;if(o==="complex64"){if(i.dtype==="complex64")return identity({inputs:{x:i},backend:r});const y=zeros(r,i.shape,i.dtype),a=cast({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),m=complex({inputs:{real:a,imag:y},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(a),m}if(i.dtype==="complex64"){const y=real({inputs:{input:i},backend:r}),a=cast({inputs:{x:y},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(y),a}if(!hasEncodingLoss(i.dtype,o)){const y=identity({inputs:{x:i},backend:r});return{dataId:y.dataId,shape:y.shape,dtype:o}}const l=r.data.get(i.dataId).values,[f,u,g]=castImpl(l,i.shape,i.dtype,o);return r.makeTensorInfo(f,u,g)}const castConfig={kernelName:Cast,backendName:"cpu",kernelFunc:cast};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function binaryKernelFunc(n,t,r,s){return r==null?({inputs:i,backend:o})=>{const{a:l,b:f}=i,u=o;assertNotComplex([l,f],n);const g=u.data.get(l.dataId).values,y=u.data.get(f.dataId).values,a=l.dtype==="string"?fromUint8ToStringArray(g):g,m=l.dtype==="string"?fromUint8ToStringArray(y):y,_=s||l.dtype,[b,c]=t(l.shape,f.shape,a,m,_);return u.makeTensorInfo(c,_,b)}:({inputs:i,backend:o})=>{const{a:l,b:f}=i,u=o;if(l.dtype==="complex64"||f.dtype==="complex64"){const g=cast({inputs:{x:l},backend:u,attrs:{dtype:"complex64"}}),y=u.data.get(g.dataId),a=y.complexTensorInfos.real,m=y.complexTensorInfos.imag,_=u.data.get(a.dataId).values,b=u.data.get(m.dataId).values,c=cast({inputs:{x:f},backend:u,attrs:{dtype:"complex64"}}),w=u.data.get(c.dataId),S=w.complexTensorInfos.real,E=w.complexTensorInfos.imag,I=u.data.get(S.dataId).values,A=u.data.get(E.dataId).values,[T,O,C]=r(l.shape,f.shape,_,b,I,A),k=u.makeTensorInfo(C,"float32",T),P=u.makeTensorInfo(C,"float32",O),N=complex({inputs:{real:k,imag:P},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(k),u.disposeIntermediateTensorInfo(P),N}else{const g=u.data.get(l.dataId).values,y=u.data.get(f.dataId).values,a=s||l.dtype,[m,_]=t(l.shape,f.shape,g,y,a);return u.makeTensorInfo(_,a,m)}}}function createComplexBinaryKernelImpl(n){return(t,r,s,i,o,l)=>{const f=assertAndGetBroadcastShape(t,r),u=sizeFromShape(f),g=f.length,y=computeStrides(f),a=getTypedArrayFromDType("float32",u),m=getTypedArrayFromDType("float32",u),_=getBroadcastDims(t,f),b=getBroadcastDims(r,f),c=mergeRealAndImagArrays(s,i),w=mergeRealAndImagArrays(o,l),S=t.length,E=computeStrides(t),I=r.length,A=computeStrides(r);if(_.length+b.length===0)for(let T=0;T<a.length;T++){const O=T%c.length,C=T%w.length,k=n(c[O*2],c[O*2+1],w[C*2],w[C*2+1]);a[T]=k.real,m[T]=k.imag}else for(let T=0;T<a.length;T++){const O=indexToLoc(T,g,y),C=O.slice(-S);_.forEach(F=>C[F]=0);const k=locToIndex(C,S,E),P=O.slice(-I);b.forEach(F=>P[F]=0);const N=locToIndex(P,I,A),L=n(c[k*2],c[k*2+1],w[N*2],w[N*2+1]);a[T]=L.real,m[T]=L.imag}return[a,m,f]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const addImpl=createSimpleBinaryKernelImpl((n,t)=>n+t),addComplexImpl=createComplexBinaryKernelImpl((n,t,r,s)=>({real:n+r,imag:t+s})),add=binaryKernelFunc(Add,addImpl,addComplexImpl),addConfig={kernelName:Add,backendName:"cpu",kernelFunc:add};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bincountImpl(n,t,r,s,i){const o=sizeFromShape(s),l=makeZerosTypedArray(i,r);for(let f=0;f<n.length;f++){const u=n[f];if(u<0)throw new Error("Input x must be non-negative!");u>=i||(o>0?l[u]+=t[f]:l[u]+=1)}return l}function bincountReduceImpl(n,t,r,s=!1){const i=n.shape[0],o=n.shape[1],l=buffer([i,r],t.dtype);for(let f=0;f<i;f++)for(let u=0;u<o;u++){const g=n.get(f,u);if(g<0)throw new Error("Input x must be non-negative!");g>=r||(s?l.set(1,f,g):t.size>0?l.set(l.get(f,g)+t.get(f,u),f,g):l.set(l.get(f,g)+1,f,g))}return l}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bitwiseAndImpl=createSimpleBinaryKernelImpl((n,t)=>n&t),bitwiseAnd=binaryKernelFunc(BitwiseAnd,bitwiseAndImpl),bitwiseAndConfig={kernelName:BitwiseAnd,backendName:"cpu",kernelFunc:bitwiseAnd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function createSimpleUnaryImpl(n){return(t,r,s)=>{const i=getArrayFromDType(r,t.length);for(let o=0;o<t.length;++o)i[o]=n(t[o],s);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function unaryKernelFunc(n,t,r){const s=createSimpleUnaryImpl(t);return unaryKernelFuncFromImpl(n,s,r)}function unaryKernelFuncFromImpl(n,t,r){return({inputs:s,attrs:i,backend:o})=>{const{x:l}=s;assertNotComplex(l,n);const f=o,u=f.data.get(l.dataId).values;let g;if(l.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");g=fromUint8ToStringArray(u)}else g=u;const y=r||l.dtype,a=t(g,y,i);return f.makeTensorInfo(l.shape,y,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ceilImpl=createSimpleUnaryImpl(n=>Math.ceil(n)),ceil=unaryKernelFuncFromImpl(Ceil,ceilImpl),ceilConfig={kernelName:Ceil,backendName:"cpu",kernelFunc:ceil};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function concatImpl(n,t,r,s){const i=getArrayFromDType(r,sizeFromShape(t));if(s&&r!=="string"){let o=0;n.forEach(l=>{const f=sizeFromShape(l.shape);i.set(l.vals,o),o+=f})}else{let o=0;n.forEach(l=>{const f=r==="string"?fromUint8ToStringArray(l.vals):l.vals;let u=0;for(let g=0;g<l.shape[0];++g){const y=g*t[1]+o;for(let a=0;a<l.shape[1];++a)i[y+a]=f[u++]}o+=l.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const equalImpl=createSimpleBinaryKernelImpl((n,t)=>n===t?1:0),equal=binaryKernelFunc(Equal,equalImpl,null,"bool"),equalConfig={kernelName:Equal,backendName:"cpu",kernelFunc:equal};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const expImpl=createSimpleUnaryImpl(n=>Math.exp(n)),exp=unaryKernelFuncFromImpl(Exp,expImpl,"float32"),expConfig={kernelName:Exp,backendName:"cpu",kernelFunc:exp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const expm1Impl=createSimpleUnaryImpl(n=>Math.expm1(n)),expm1=unaryKernelFuncFromImpl(Expm1,expm1Impl),expm1Config={kernelName:Expm1,backendName:"cpu",kernelFunc:expm1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const floorImpl=createSimpleUnaryImpl(n=>Math.floor(n)),floor=unaryKernelFuncFromImpl(Floor,floorImpl),floorConfig={kernelName:Floor,backendName:"cpu",kernelFunc:floor};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const floorDivImpl=createSimpleBinaryKernelImpl((n,t)=>Math.floor(n/t)),floorDiv=binaryKernelFunc(FloorDiv,floorDivImpl,null,"int32"),floorDivConfig={kernelName:FloorDiv,backendName:"cpu",kernelFunc:floorDiv};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gatherNdImpl(n,t,r,s,i,o,l,f,u){const g=buffer([s,o],r);for(let y=0;y<s;y++){const a=[];let m=0;for(let _=0;_<i;_++){const b=n[y*i+_];m+=b*l[_],a.push(b)}if(m<0||m>=u/o)throw new Error(`Invalid indices: ${a} does not index into ${f}`);for(let _=0;_<o;_++)g.values[y*o+_]=t.get(...t.indexToLoc(m*o+_))}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gatherV2Impl(n,t,r){const s=buffer(r,n.dtype);for(let i=0;i<s.size;++i){const l=s.indexToLoc(i).slice(),f=l[0],u=l[2],g=t.locToIndex([f,u]);l[2]=t.values[g];const y=n.locToIndex(l);0<=y&&y<n.values.length&&(s.values[i]=n.values[y])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const greaterImpl=createSimpleBinaryKernelImpl((n,t)=>n>t?1:0),greater=binaryKernelFunc(Greater,greaterImpl,null,"bool"),greaterConfig={kernelName:Greater,backendName:"cpu",kernelFunc:greater};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const greaterEqualImpl=createSimpleBinaryKernelImpl((n,t)=>n>=t?1:0),greaterEqual=binaryKernelFunc(GreaterEqual,greaterEqualImpl,null,"bool"),greaterEqualConfig={kernelName:GreaterEqual,backendName:"cpu",kernelFunc:greaterEqual};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lessImpl=createSimpleBinaryKernelImpl((n,t)=>n<t?1:0),less=binaryKernelFunc(Less,lessImpl,null,"bool"),lessConfig={kernelName:Less,backendName:"cpu",kernelFunc:less};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lessEqualImpl=createSimpleBinaryKernelImpl((n,t)=>n<=t?1:0),lessEqual=binaryKernelFunc(LessEqual,lessEqualImpl,null,"bool"),lessEqualConfig={kernelName:LessEqual,backendName:"cpu",kernelFunc:lessEqual};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function linSpaceImpl(n,t,r){const s=(t-n)/(r-1),i=makeZerosTypedArray(r,"float32");i[0]=n;for(let o=1;o<i.length;o++)i[o]=i[o-1]+s;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const logImpl=createSimpleUnaryImpl(n=>Math.log(n)),log=unaryKernelFuncFromImpl(Log,logImpl),logConfig={kernelName:Log,backendName:"cpu",kernelFunc:log};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function maxImpl(n,t,r,s){const i=getTypedArrayFromDType(s,sizeFromShape(r));for(let o=0;o<i.length;++o){const l=o*t;let f=n[l];for(let u=0;u<t;++u){const g=n[l+u];(Number.isNaN(g)||g>f)&&(f=g)}i[o]=f}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const maximumImpl=createSimpleBinaryKernelImpl((n,t)=>Math.max(n,t)),maximum=binaryKernelFunc(Maximum,maximumImpl),maximumConfig={kernelName:Maximum,backendName:"cpu",kernelFunc:maximum};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const minimumImpl=createSimpleBinaryKernelImpl((n,t)=>Math.min(n,t)),minimum=binaryKernelFunc(Minimum,minimumImpl),minimumConfig={kernelName:Minimum,backendName:"cpu",kernelFunc:minimum};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const multiplyImpl=createSimpleBinaryKernelImpl((n,t)=>n*t),multiplyComplexImpl=createComplexBinaryKernelImpl((n,t,r,s)=>({real:n*r-t*s,imag:n*s+t*r})),multiply=binaryKernelFunc(Multiply,multiplyImpl,multiplyComplexImpl),multiplyConfig={kernelName:Multiply,backendName:"cpu",kernelFunc:multiply};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function negImpl(n,t,r){const s=createScalarValue(-1,r);return multiplyImpl([],t,s,n,r)}function neg(n){const{inputs:t,backend:r}=n,{x:s}=t;assertNotComplex(s,"neg");const i=r.data.get(s.dataId).values,[o,l]=negImpl(i,s.shape,s.dtype);return r.makeTensorInfo(l,s.dtype,o)}const negConfig={kernelName:Neg,backendName:"cpu",kernelFunc:neg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const notEqualImpl=createSimpleBinaryKernelImpl((n,t)=>n!==t?1:0),notEqual=binaryKernelFunc(NotEqual,notEqualImpl,null,"bool"),notEqualConfig={kernelName:NotEqual,backendName:"cpu",kernelFunc:notEqual};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function transposeImpl(n,t,r,s,i){const o=t.length,l=sizeFromShape(t),f=computeStrides(t),u=computeStrides(i),g=getTypedArrayFromDType(r,sizeFromShape(i));for(let y=0;y<l;++y){const a=indexToLoc(y,o,f),m=new Array(a.length);for(let b=0;b<m.length;b++)m[b]=a[s[b]];const _=locToIndex(m,o,u);g[_]=n[y]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function transpose(n){const{inputs:t,attrs:r,backend:s}=n,{x:i}=t,{perm:o}=r;assertNotComplex(i,"transpose");const l=i.shape.length,f=new Array(l);for(let a=0;a<f.length;a++)f[a]=i.shape[o[a]];const u=s.data.get(i.dataId).values,g=transposeImpl(u,i.shape,i.dtype,o,f);return{dataId:s.write(g,f,i.dtype),shape:f,dtype:i.dtype}}const transposeConfig={kernelName:Transpose,backendName:"cpu",kernelFunc:transpose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function prodImpl(n,t,r,s){const[i,o]=computeOutAndReduceShapes(n,s),l=upcastType(t,"int32"),f=makeZerosTypedArray(sizeFromShape(i),l),u=sizeFromShape(o);for(let g=0;g<f.length;++g){const y=g*u;let a=1;for(let m=0;m<u;++m)a*=r[y+m];f[g]=a}return{outVals:f,outShape:i,outDtype:l}}function prod(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,keepDims:l}=s;assertNotComplex(i,"prod");const f=i.shape.length,u=parseAxisParam(o,i.shape),g=getAxesPermutation(u,f);let y=u,a=i;const m=[];g!=null&&(a=transpose({inputs:{x:i},backend:r,attrs:{perm:g}}),m.push(a),y=getInnerMostAxes(y.length,f));const _=r.data.get(a.dataId).values,{outVals:b,outShape:c,outDtype:w}=prodImpl(a.shape,a.dtype,_,y);let S=c;return l&&(S=expandShapeToKeepDim(c,u)),m.forEach(E=>r.disposeIntermediateTensorInfo(E)),r.makeTensorInfo(S,w,b)}const prodConfig={kernelName:Prod,backendName:"cpu",kernelFunc:prod};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function validateIndices(n,t,r){n.forEach((s,i)=>{if(s<0||s>=r){const o=indexToLoc(i,t.length,computeStrides(t)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${r})`)}})}function validateSplits(n,t){for(let r=0;r<n.length;++r){const s=n[r],i=r===n.length-1?t:n[r+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>i)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function makeSplits(n,t,r,s){const i=[];let o=0;const l=t.length-1+r.length,f=new Array(l).fill(null).map(()=>[0]);validateSplits(r,s);let u=1;for(let g=0;g<t.length-1;++g){u*=t[g];const y=t[g+1];for(let a=1;a<u+1;++a)f[g].push(a*y)}for(let g=0;g<n.length;++g){let y=n[g],a=n[g]+1;for(let m=0;m<r.length;++m){const _=r[m],b=m+t.length-1;if(b>=0){const c=f[b],w=c[c.length-1]-_[y];for(let S=y;S<a;++S)f[b].push(_[S+1]+w)}y=_[y],a=_[a]}a!==y&&(i.push([y,a]),o+=a-y)}return{outSplits:f,valueSlices:i,numValues:o}}function getSplits(n){const t=[];for(let r=0;r<n.length;++r){const s=n[r].length,i=getArrayFromDType("int32",s);t.push(i),n[r].forEach((o,l)=>i[l]=o)}return t}function computeFlatOuterDims(n,t){const r=n.slice(0,t);for(;r.length<t;)r.push(1);for(let s=t;s<n.length;s++)r[t-1]*=n[s];return r}function writeValueSlices(n,t,r,s,i,o){const l=computeFlatOuterDims(t,2)[1],f=computeFlatOuterDims(o,2)[1];let u=0;for(const g of r)for(let y=g[0];y<g[1];++y){for(let a=0;a<s;++a)i[u*f+a]=n[y*l+a];++u}}function getValues(n,t,r,s,i){const o=t.slice();o[0]=i;const l=getArrayFromDType(r,sizeFromShape(o)),f=n.length,u=f===0?0:f/t[0];return writeValueSlices(n,t,s,u,l,o),[l,o]}function raggedGatherImpl(n,t,r,s,i,o,l,f){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const u=t[0][0]-1;if(validateIndices(o,l,u),s.length===0)throw new Error("params.rank must be nonzero");const g=s[0],{outSplits:y,valueSlices:a,numValues:m}=makeSplits(o,l,n,g),_=getSplits(y),b=getValues(r,s,i,a,m);return[_,b[0],b[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const INT32_MAX=2147483647;function raggedRangeImpl(n,t,r,s,i,o,l){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(l.length>1)throw new Error("deltas must be a scalar or vector");const f=t.length===0,u=i.length===0,g=l.length===0,y=[];f||y.push(t[0]),u||y.push(i[0]),g||y.push(l[0]);for(let w=1;w<y.length;++w)if(y[w]!==y[w-1])throw new Error("starts, limits, and deltas must have the same shape");const a=y.length===0?1:y[0],m=getArrayFromDType("int32",a+1);m[0]=0;for(let w=0;w<a;++w){const S=f?n[0]:n[w],E=u?s[0]:s[w],I=g?o[0]:o[w];if(I===0)throw new Error("Requires delta != 0");let A;if(I>0&&E<S||I<0&&E>S)A=0;else if(A=Math.ceil(Math.abs((E-S)/I)),A>INT32_MAX)throw new Error(`Requires ((limit - start) / delta) <= ${INT32_MAX}`);m[w+1]=m[w]+A}const _=m[a],b=getArrayFromDType(r,_);let c=0;for(let w=0;w<a;++w){const S=m[w+1]-m[w];let E=f?n[0]:n[w];const I=g?o[0]:o[w];for(let A=0;A<S;++A)b[c++]=E,E+=I}return[m,b]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var RowPartitionType=RowPartitionType$1;class RaggedTensorToTensorOp{constructor(t,r,s,i,o,l,f,u,g,y){this.shape=t,this.shapeShape=r,this.values=s,this.valuesShape=i,this.valuesDType=o,this.defaultValue=l,this.defaultValueShape=f,this.rowPartitionValues=u,this.rowPartitionValuesShapes=g,this.rowPartitionTypes=getRowPartitionTypesHelper(y),this.raggedRank=getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===RowPartitionType.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===RowPartitionType.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const r=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case RowPartitionType.VALUE_ROWIDS:return RaggedTensorToTensorOp.getMaxWidthValueRowID(r);case RowPartitionType.ROW_SPLITS:return RaggedTensorToTensorOp.getMaxWidthRowSplit(r);default:throw new Error(`Cannot handle partition type ${RowPartitionType[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const r=t.length;if(r===0||r===1)return 0;let s=0;for(let i=0;i<r-1;++i){const o=t[i+1]-t[i];o>s&&(s=o)}return s}static getMaxWidthValueRowID(t){const r=t.length;if(r===0)return 0;let s=0,i=t[0],o=0;for(let l=1;l<r;++l){const f=t[l];f!==i&&(i=f,o=Math.max(l-s,o),s=l)}return Math.max(r-s,o)}tensorShapeFromTensor(t,r,s=!0){if(r.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return makeShape(t,s)}calculateOutputSize(t){const r=this.valuesShape,s=this.defaultValueShape;validateDefaultValueShape(s,r);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),l=combineRaggedTensorToTensorShapes(this.raggedRank,i,r);l[0]<0&&(l[0]=t);for(let f=1;f<=this.raggedRank;++f)l[f]<0&&(l[f]=this.getMaxWidth(f));return l}calculateFirstParentOutputIndex(t,r,s){const i=Math.min(t,s),o=[];let l=0;for(let f=0;f<i;++f,l+=r)o.push(l);for(let f=i;f<t;++f)o.push(-1);return assert(o.length===t,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(t,r,s,i){const o=t.length,l=[];for(let f=0;f<o-1;++f){const u=t[f+1]-t[f];let g=Math.min(i,u),y=r[f];y===-1&&(g=0);for(let a=0;a<g;++a)l.push(y),y+=s;for(let a=0;a<u-g;++a)l.push(-1)}if(o>0&&l.length!==t[o-1])throw new Error("Invalid row split size.");return l}calculateOutputIndexValueRowID(t,r,s,i){const o=t.length,l=[];if(o===0)return[];let f=0,u=t[0];if(u>=r.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${r.length}`);let g=r[u];l.push(g);for(let y=1;y<o;++y){const a=t[y];if(a===u)g>=0&&(++f,f<i?g+=s:g=-1);else{if(f=0,u=a,a>=r.length)throw new Error(`Got nextValueRowId=${a} which is not less than ${r.length}`);g=r[a]}l.push(g)}if(l.length!==t.length)throw new Error("Invalid row ids.");return l}calculateOutputIndex(t,r,s,i){const o=this.getRowPartitionTensor(t),l=this.getRowPartitionTypeByDimension(t);switch(l){case RowPartitionType.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,r,s,i);case RowPartitionType.ROW_SPLITS:if(o.length-1>r.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${r.length}`);return this.calculateOutputIndexRowSplit(o,r,s,i);default:throw new Error(`Unsupported partition type: ${RowPartitionType[l]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const r=this.rowPartitionTypes[0];switch(r){case RowPartitionType.FIRST_DIM_SIZE:return t[0];case RowPartitionType.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case RowPartitionType.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${RowPartitionType[r]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const r=this.getFirstDimensionSize(),s=this.calculateOutputSize(r),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let u=i.length-2;u>=0;--u)i[u]=i[u+1]*s[u+1];const o=makeShape(s,!1),l=getArrayFromDType(this.valuesDType,sizeFromShape(o));if(i[0]*s[0]>0){let u=this.calculateFirstParentOutputIndex(r,i[0],s[0]);for(let g=1;g<=this.raggedRank;++g)u=this.calculateOutputIndex(g-1,u,i[g],s[g]);this.setOutput(this.raggedRank,u,l,o)}return[o,l]}setOutput(t,r,s,i){if(s.length===0)return;const o=this.values,l=s;let f=i.slice();f=f.slice(t+1);const u=sizeFromShape(f),g=r.length;let y=this.defaultValue;if(y.length!==u&&y.length!==1){const b=this.defaultValueShape;tidy(()=>{const c=reshape$1(y,b);y=broadcastTo(c,f).dataSync()})}let a=0,m=0,_=0;for(let b=0;b<=g;++b){let c=b<g?r[b]:-1;if(c===_){++_;continue}if(m<_){const w=o.subarray(a*u),S=l.subarray(m*u),E=(_-m)*u;copyArray(S,w,E)}if(b>=g){const w=s.length;c=Math.floor(w/u)}if(c>_)if(this.defaultValue.length===1)l.subarray(_*u,c*u).fill(this.defaultValue[0]),_=c;else for(;c>_;){const w=l.slice(_*u);copyArray(w,y,u),++_}c<0?(a=b+1,m=_):(a=b,m=_,_=m+1)}}}function copyArray(n,t,r){for(let s=0;s<r;s++)n[s]=t[s]}function makeShape(n,t){const r=[];for(let s of n){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}r.push(s)}return r}function raggedTensorToTensorImpl(n,t,r,s,i,o,l,f,u,g){return new RaggedTensorToTensorOp(n,t,r,s,i,o,l,f,u,g).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rangeImpl(n,t,r,s){const i=n===t,o=n<t&&r<0,l=t<n&&r>1;if(i||o||l)return makeZerosTypedArray(0,s);const f=Math.abs(Math.ceil((t-n)/r)),u=makeZerosTypedArray(f,s);t<n&&r===1&&(r=-1),u[0]=n;for(let g=1;g<u.length;g++)u[g]=u[g-1]+r;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rsqrtImpl=createSimpleUnaryImpl(n=>1/Math.sqrt(n)),rsqrt=unaryKernelFuncFromImpl(Rsqrt,rsqrtImpl),rsqrtConfig={kernelName:Rsqrt,backendName:"cpu",kernelFunc:rsqrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function scatterImpl(n,t,r,s,i,o,l,f,u,g){const y=[s/i,i],a=n.values,m=t.values;if(s===0)return buffer(r,t.dtype);const _=u instanceof TensorBuffer?u:buffer(y,t.dtype);typeof u=="string"||typeof u=="number"?_.values.fill(u):typeof u=="boolean"&&_.values.fill(+u);for(let b=0;b<o;b++){const c=[];let w=0;for(let S=0;S<l;S++){const E=a[b*l+S];c.push(E),w+=E*f[S]}if(w<0||w>=s/i)throw new Error(`Invalid indices: ${c} does not index into ${r}`);for(let S=0;S<i;S++)g?_.values[w*i+S]+=m[b*i+S]:_.values[w*i+S]=t.rank===0?m[0]:m[b*i+S]}return _}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sigmoid=unaryKernelFunc(Sigmoid,n=>1/(1+Math.exp(-n))),sigmoidConfig={kernelName:Sigmoid,backendName:"cpu",kernelFunc:sigmoid};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sliceImpl(n,t,r,s,i){const o=isSliceContinous(s,t,r),l=sizeFromShape(r),f=computeStrides(s);if(o){const a=computeFlatOffset(t,f);return i==="string"?n.slice(a,a+l):n.subarray(a,a+l)}const u=i==="string"?fromUint8ToStringArray(n):n,g=buffer(s,i,u),y=buffer(r,i);for(let a=0;a<y.size;++a){const m=y.indexToLoc(a),_=m.map((b,c)=>b+t[c]);y.set(g.get(..._),...m)}return i==="string"?fromStringArrayToUint8(y.values):y.values}function slice(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{begin:o,size:l}=s;assertNotComplex(i,"slice");const[f,u]=parseSliceParams(i,o,l);assertParamsValid(i,f,u);const g=r.data.get(i.dataId).values,y=sliceImpl(g,f,u,i.shape,i.dtype);return r.makeTensorInfo(u,i.dtype,y)}const sliceConfig={kernelName:Slice,backendName:"cpu",kernelFunc:slice};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseFillEmptyRowsImpl(n,t,r,s,i,o,l){const f=t[0],u=o[0],g=new Array(u),y=new Array(f),a=t[1];if(u===0){if(f!==0)throw new Error(getSparseFillEmptyRowsIndicesDenseShapeMismatch(f));const w=getArrayFromDType(r,0),S=getArrayFromDType(i,0);return[w,[0,a],S,g,y]}let m=!0,_=0;const b=new Array(u).fill(0);for(let w=0;w<f;++w){const S=n[w*a];if(S<0)throw new Error(getSparseFillEmptyRowsNegativeIndexErrorMessage(w,S));if(S>=u)throw new Error(getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(w,S,u));++b[S],m=m&&S>=_,_=S}let c=!0;for(let w=0;w<u;++w){const S=b[w]===0;g[w]=S,c=c&&!S,b[w]=Math.max(b[w],1),w>0&&(b[w]+=b[w-1])}if(c&&m){const w=n,S=s;for(let E=0;E<f;++E)y[E]=E;return[w,[f,a],S,g,y]}else{const w=b[u-1],S=getArrayFromDType(r,w*a),E=getArrayFromDType(i,w),I=new Array(u).fill(0);for(let A=0;A<f;++A){const T=n[A*a],O=I[T],C=(T===0?0:b[T-1])+O;I[T]++;for(let k=0;k<a;++k)S[C*a+k]=n[A*a+k];E[C]=s[A],y[A]=C}for(let A=0;A<u;++A)if(I[A]===0){const O=A===0?0:b[A-1];S[O*a+0]=A;for(let C=1;C<a;++C)S[O*a+C]=0;E[O]=l}return[S,[w,a],E,g,y]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseReshapeImpl(n,t,r,s,i){const o=sizeFromShape(s),l=t[0],f=i.length,u=[];let g=1,y=-1;for(let w=0;w<f;++w){const S=i[w];if(S===-1){if(y!==-1)throw new Error(getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(y,w));y=w,u.push(1)}else{if(S<0)throw new Error(getSparseReshapeNegativeOutputDimErrorMessage(w,S));g*=S,u.push(S)}}if(y!==-1){if(g<=0)throw new Error(getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());const w=Math.trunc(o/g);if(g*w!==o)throw new Error(getSparseReshapeInputOutputMultipleErrorMessage(s,u));u[y]=w}if(sizeFromShape(u)!==o)throw new Error(getSparseReshapeInputOutputMismatchErrorMessage(s,u));const m=s.length,_=[];if(m>0){_[m-1]=1;for(let w=m-2;w>=0;--w)_[w]=_[w+1]*s[w+1]}const b=[];if(f>0){b[f-1]=1;for(let w=f-2;w>=0;--w)b[w]=b[w+1]*u[w+1]}const c=getArrayFromDType(r,l*f);for(let w=0;w<l;++w){let S=0;for(let E=0;E<m;++E)S+=n[w*m+E]*_[E];for(let E=0;E<f;++E)c[w*f+E]=Math.trunc(S/b[E]),S%=b[E]}return[c,[l,f],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseSegmentReductionImpl(n,t,r,s,i,o=!1,l=0){const f=s.length,u=[t[0],n.length/t[0]],g=u[1],a=f>0?i[f-1]+1:0;if(a<0)throw new Error(getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const m=t.slice();m[0]=a;const _=m.reduce((I,A)=>I*A,1),b=getArrayFromDType(r,_);if(f===0)return a>0&&b.fill(l),[b,m];if(a<=0)throw new Error(getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let c=0,w=1,S=0,E=i[c];for(;;){let I=0;if(w<f){if(I=i[w],E===I){++w;continue}if(E>=I)throw new Error(getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(E<0||E>=a)throw new Error(getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(E,a));E>S&&b.fill(l,S*g,E*g);for(let A=c;A<w;++A){const T=s[A];if(T<0||T>=u[0])throw new Error(getSparseSegmentReductionIndicesOutOfRangeErrorMessage(A,s[A],u[0]));for(let O=0;O<g;O++)b[E*g+O]+=n[T*g+O]}if(o)for(let A=0;A<g;A++)b[E*g+A]/=w-c;if(c=w,++w,S=E+1,E=I,w>f)break}return S<a&&b.fill(l,S*g,a*g),[b,m]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sqrt=unaryKernelFunc(Sqrt,n=>Math.sqrt(n)),sqrtConfig={kernelName:Sqrt,backendName:"cpu",kernelFunc:sqrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const squaredDifferenceImpl=createSimpleBinaryKernelImpl((n,t)=>{const r=n-t;return r*r}),squaredDifference=binaryKernelFunc(SquaredDifference,squaredDifferenceImpl),squaredDifferenceConfig={kernelName:SquaredDifference,backendName:"cpu",kernelFunc:squaredDifference};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const staticRegexReplaceImpl=createSimpleUnaryImpl((n,t)=>{const{pattern:r,replaceGlobal:s,rewrite:i}=t;return n.replace(new RegExp(r,s?"g":""),i)}),staticRegexReplace=unaryKernelFuncFromImpl(StaticRegexReplace,staticRegexReplaceImpl),staticRegexReplaceConfig={kernelName:StaticRegexReplace,backendName:"cpu",kernelFunc:staticRegexReplace};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function stridedSliceImpl(n,t,r,s){const i=buffer(n,t.dtype);for(let o=0;o<i.size;o++){const l=i.indexToLoc(o),f=new Array(l.length);for(let u=0;u<f.length;u++)f[u]=l[u]*r[u]+s[u];i.set(t.get(...f),...l)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class StringNGramsOp{constructor(t,r,s,i,o,l){this.separator=encodeString(t),this.nGramWidths=r,this.leftPad=encodeString(s),this.rightPad=encodeString(i),this.padWidth=o,this.preserveShort=l}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,r){const s=this.getPadWidth(r);return Math.max(0,t+2*s-r+1)}createNGrams(t,r,s,i,o,l){for(let f=0;f<o;++f){const u=this.getPadWidth(l),g=Math.max(0,u-f),y=Math.max(0,u-(o-(f+1))),a=l-(g+y),m=r+(g>0?0:f-u);let _=0;_+=g*this.leftPad.length;for(let E=0;E<a;++E)_+=t[m+E].length;_+=y*this.rightPad.length;const b=g+y+a-1;_+=b*this.separator.length,s[i+f]=new Uint8Array(_);const c=s[i+f];let w=0;const S=E=>E.forEach(I=>c[w++]=I);for(let E=0;E<g;++E)S(this.leftPad),S(this.separator);for(let E=0;E<a-1;++E)S(t[m+E]),S(this.separator);if(a>0){S(t[m+a-1]);for(let E=0;E<y;++E)S(this.separator),S(this.rightPad)}else{for(let E=0;E<y-1;++E)S(this.rightPad),S(this.separator);S(this.rightPad)}}}compute(t,r){const s=t.length,i=r.length;if(i>0){let u=r[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let g=1;g<i;++g){let y=r[g]>=u;if(y=y&&r[g]<=s,!y)throw new Error(`Invalid split value ${r[g]}, must be in [${u}, ${s}]`);u=r[g]}if(u!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${u}`)}const o=i-1,l=getArrayFromDType("int32",i);if(s===0||i===0){const u=new Array(s);for(let g=0;g<=o;++g)l[g]=0;return[u,l]}l[0]=0;for(let u=1;u<=o;++u){const g=r[u]-r[u-1];let y=0;this.nGramWidths.forEach(a=>{y+=this.getNumNGrams(g,a)}),this.preserveShort&&g>0&&y===0&&(y=1),l[u]=l[u-1]+y}const f=new Array(l[o]);for(let u=0;u<o;++u){const g=r[u];let y=l[u];if(this.nGramWidths.forEach(a=>{const m=r[u+1]-r[u],_=this.getNumNGrams(m,a);this.createNGrams(t,g,f,y,_,a),y+=_}),this.preserveShort&&y===l[u]){const a=r[u+1]-r[u];if(a===0)continue;const m=a+2*this.padWidth,_=1;this.createNGrams(t,g,f,y,_,m)}}return[f,l]}}function stringNGramsImpl(n,t,r,s,i,o,l,f){return new StringNGramsOp(r,s,i,o,l,f).compute(n,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function split(n,t,r,s){if(!n.length)return;if(t.length===0){for(let o=0;o<n.length;++o)s.push(n.subarray(o,o+1));return}if(t.length===1){const o=t[0];let l=n.indexOf(o);for(;l!==-1;){const f=n.subarray(0,l);(!r||f.length!==0)&&s.push(f),n=n.subarray(l+1),l=n.indexOf(o)}(!r||n.length!==0)&&s.push(n);return}let i=0;for(let o=0;o<n.length+1;o++)if(o===n.length||t.indexOf(n[o])!==-1){const l=n.subarray(i,o);(!r||l.length!==0)&&s.push(l),i=o+1}}function stringSplitImpl(n,t,r){const s=n.length,i=[];let o=0,l=0;const f=new Array(s);for(let m=0;m<s;++m){const _=i.length;split(n[m],t,r,i);const b=i.length-_;f[m]=b,o+=b,l=Math.max(l,b)}const u=getArrayFromDType("int32",o*2),g=new Array(o),y=[s,l];let a=0;for(let m=0;m<s;++m)for(let _=0;_<f[m];++_)u[a*2]=m,u[a*2+1]=_,g[a]=i[a],++a;return[u,g,y]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function stringToHashBucketFastImpl(n,t){const r=getArrayFromDType("int32",n.length);for(let s=0;s<n.length;++s)r[s]=fingerPrint64(n[s]).modulo(t).getLowBitsUnsigned();return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const subImpl=createSimpleBinaryKernelImpl((n,t)=>n-t),subComplexImpl=createComplexBinaryKernelImpl((n,t,r,s)=>({real:n-r,imag:t-s})),sub=binaryKernelFunc(Sub,subImpl,subComplexImpl),subConfig={kernelName:Sub,backendName:"cpu",kernelFunc:sub};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tileImpl(n,t){const r=new Array(n.rank);for(let i=0;i<r.length;i++)r[i]=n.shape[i]*t[i];const s=buffer(r,n.dtype);for(let i=0;i<s.values.length;++i){const o=s.indexToLoc(i),l=new Array(n.rank);for(let u=0;u<l.length;u++)l[u]=o[u]%n.shape[u];const f=n.locToIndex(l);s.values[i]=n.values[f]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const comparePair=(n,t)=>{const r=t.value-n.value;return r===0?n.index-t.index:r};function select$1(n,t,r=0,s=n.length-1){for(;s>r;){if(s-r>600){const f=s-r+1,u=t-r+1,g=Math.log(f),y=.5*Math.exp(2*g/3),a=.5*Math.sqrt(g*y*(f-y)/f)*Math.sign(u-f/2),m=Math.max(r,Math.floor(t-u*y/f+a)),_=Math.min(s,Math.floor(t+(f-u)*y/f+a));select$1(n,t,m,_)}const i=n[t];let o=r,l=s;for(swap(n,r,t),comparePair(n[s],i)>0&&swap(n,r,s);o<l;){for(swap(n,o,l),o++,l--;comparePair(n[o],i)<0;)o=o+1;for(;comparePair(n[l],i)>0;)l=l-1}comparePair(n[r],i)===0?swap(n,r,l):(l=l+1,swap(n,l,s)),l<=t&&(r=l+1),t<=l&&(s=l-1)}}function topKImpl(n,t,r,s,i){const o=t[t.length-1],[l,f]=[n.length/o,o],u=getTypedArrayFromDType(r,l*s),g=getTypedArrayFromDType("int32",l*s);for(let a=0;a<l;a++){const m=a*f,_=n.subarray(m,m+f);let b=new Array(_.length);_.forEach((E,I)=>b[I]={value:E,index:I}),s<b.length&&(select$1(b,s),b=b.slice(0,s)),i&&b.sort(comparePair);const c=a*s,w=u.subarray(c,c+s),S=g.subarray(c,c+s);for(let E=0;E<s;E++)w[E]=b[E].value,S[E]=b[E].index}const y=t.slice();return y[y.length-1]=s,[buffer(y,r,u),buffer(y,"int32",g)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uniqueImpl(n,t,r,s){const i=parseAxisParam(t,r)[0],o=[1,r[0],1];for(let b=0;b<i;b++)o[0]*=r[b];o[1]=r[i];for(let b=i+1;b<r.length;b++)o[2]*=r[b];const l=new Map,f=new Int32Array(r[i]),u=new TensorBuffer(o,s,n),g=[],y=o[0]===1&&o[2]===1;for(let b=0;b<r[i];b++){let c;if(y)c=n[b].toString();else{const S=[];for(let E=0;E<o[0];E++)for(let I=0;I<o[2];I++)S.push(u.get(E,b,I));c=S.join(",")}const w=l.get(c);if(w!=null)f[b]=w;else{const S=l.size;l.set(c,S),f[b]=S,g.push(b)}}const a=o.slice();a[1]=l.size;const m=new TensorBuffer(a,s);g.forEach((b,c)=>{for(let w=0;w<o[0];w++)for(let S=0;S<o[2];S++)m.set(u.get(w,b,S),w,c,S)});const _=r.slice();return _[i]=a[1],{outputValues:m.values,outputShape:_,indices:f}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */registerBackend("cpu",()=>new MathBackendCPU,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const elu=unaryKernelFunc(Elu,n=>n>=0?n:Math.exp(n)-1),eluConfig={kernelName:Elu,backendName:"cpu",kernelFunc:elu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function leakyRelu(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{alpha:o}=s;assertNotComplex([i],"leakyRelu");const l=sizeFromShape(i.shape),f=r.data.get(i.dataId).values,u=getTypedArrayFromDType("float32",l);for(let g=0;g<f.length;g++)u[g]=f[g]<0?o*f[g]:f[g];return r.makeTensorInfo(i.shape,"float32",u)}const leakyReluConfig={kernelName:LeakyRelu,backendName:"cpu",kernelFunc:leakyRelu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const preluImpl=createSimpleBinaryKernelImpl((n,t)=>n<0?t*n:n);function prelu(n){const{inputs:t,backend:r}=n,{x:s,alpha:i}=t;assertNotComplex([s,i],"prelu");const o=r.data.get(s.dataId).values,l=r.data.get(i.dataId).values,[f,u]=preluImpl(s.shape,i.shape,o,l,"float32");return r.makeTensorInfo(u,"float32",f)}const preluConfig={kernelName:Prelu,backendName:"cpu",kernelFunc:prelu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const relu=unaryKernelFunc(Relu,n=>Math.max(0,n)),reluConfig={kernelName:Relu,backendName:"cpu",kernelFunc:relu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const relu6=unaryKernelFunc(Relu6,n=>Math.min(Math.max(0,n),6)),relu6Config={kernelName:Relu6,backendName:"cpu",kernelFunc:relu6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function applyActivation(n,t,r,s,i){if(r==="linear")return identity({inputs:{x:t},backend:n});if(r==="relu")return relu({inputs:{x:t},backend:n});if(r==="elu")return elu({inputs:{x:t},backend:n});if(r==="relu6")return relu6({inputs:{x:t},backend:n});if(r==="prelu")return prelu({inputs:{x:t,alpha:s},backend:n});if(r==="leakyrelu")return leakyRelu({inputs:{x:t},backend:n,attrs:{alpha:i}});if(r==="sigmoid")return sigmoid({inputs:{x:t},backend:n});throw new Error(`Activation ${r} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function reshape(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{shape:o}=s,l=sizeFromShape(i.shape),f=inferFromImplicitShape(o,l),u=sizeFromShape(f);assert(l===u,()=>`The new shape (${f}) has ${u} elements and the old shape (${i.shape}) has ${l} elements. The new shape and old shape must have the same number of elements.`),r.incRef(i.dataId);const g=r.data.get(i.dataId);if(g.complexTensorInfos!=null){const y=g.complexTensorInfos.real,a=g.complexTensorInfos.imag;y.shape=f,a.shape=f}return{dataId:i.dataId,shape:f,dtype:i.dtype}}const reshapeConfig={kernelName:Reshape,backendName:"cpu",kernelFunc:reshape};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function batchMatMul(n){const{inputs:t,backend:r,attrs:s}=n,{a:i,b:o}=t,{transposeA:l,transposeB:f}=s;assertNotComplex([i,o],"matMul");const u=i.shape.length,g=o.shape.length,y=l?i.shape[u-2]:i.shape[u-1],a=f?o.shape[g-1]:o.shape[g-2],m=l?i.shape[u-1]:i.shape[u-2],_=f?o.shape[g-2]:o.shape[g-1],b=i.shape.slice(0,-2),c=o.shape.slice(0,-2),w=sizeFromShape(b),S=sizeFromShape(c),I=assertAndGetBroadcastShape(i.shape.slice(0,-2),o.shape.slice(0,-2)).concat([m,_]);assert(y===a,()=>`Error in matMul: inner shapes (${y}) and (${a}) of Tensors with shapes ${i.shape} and ${o.shape} and transposeA=${l} and transposeB=${f} must match.`);const A=l?[w,y,m]:[w,m,y],T=f?[S,_,a]:[S,a,_],O=reshape({inputs:{x:i},backend:r,attrs:{shape:A}}),C=reshape({inputs:{x:o},backend:r,attrs:{shape:T}}),k=l?O.shape[1]:O.shape[2],P=l?O.shape[2]:O.shape[1],N=f?C.shape[1]:C.shape[2],L=Math.max(w,S),F=r.data.get(O.dataId).values,V=r.data.get(C.dataId).values,j=computeStrides(O.shape),K=computeStrides(C.shape),[U,X,J]=l?[j[0],1,j[1]]:[j[0],j[1],1],[Y,te,se]=f?[1,K[1],K[0]]:[K[1],1,K[0]],de=P*N,Se=buffer([L,P,N],O.dtype),we=Se.values,ge=r.blockSize;for(let Ie=0;Ie<L;Ie++){const Te=Ie%w,Ce=Ie%S;for(let Ae=0;Ae<P;Ae+=ge){const Me=Math.min(Ae+ge,P);for(let Re=0;Re<N;Re+=ge){const G=Math.min(Re+ge,N);for(let Q=0;Q<k;Q+=ge){const ie=Math.min(Q+ge,k);for(let le=Ae;le<Me;le++)for(let ue=Re;ue<G;ue++){let he=0;for(let ve=Q;ve<ie;ve++){const be=F[Te*U+le*X+ve*J],ye=V[ve*Y+ue*te+Ce*se];he+=be*ye}we[Ie*de+(le*N+ue)]+=he}}}}}return r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(C),r.makeTensorInfo(I,Se.dtype,Se.values)}const batchMatMulConfig={kernelName:BatchMatMul,backendName:"cpu",kernelFunc:batchMatMul};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _fusedMatMul(n){const{inputs:t,backend:r,attrs:s}=n,{a:i,b:o,bias:l,preluActivationWeights:f}=t,{transposeA:u,transposeB:g,activation:y,leakyreluAlpha:a}=s;let m,_,b;const c=[];m=batchMatMul({inputs:{a:i,b:o},attrs:{transposeA:u,transposeB:g},backend:r}),l&&(_=add({inputs:{a:m,b:l},backend:r}),c.push(m),m=_),y&&(b=applyActivation(r,m,y,f,a),c.push(m),m=b);for(const S of c)r.disposeIntermediateTensorInfo(S);return m}const _fusedMatMulConfig={kernelName:_FusedMatMul,backendName:"cpu",kernelFunc:_fusedMatMul};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const acos=unaryKernelFunc(Acos,n=>Math.acos(n)),acosConfig={kernelName:Acos,backendName:"cpu",kernelFunc:acos};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const acosh=unaryKernelFunc(Acosh,n=>Math.acosh(n)),acoshConfig={kernelName:Acosh,backendName:"cpu",kernelFunc:acosh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function addN(n){const{inputs:t,backend:r}=n,s=t;assertNotComplex(t,"addN");const i=s.map(f=>r.data.get(f.dataId).values),o=buffer(s[0].shape,s[0].dtype),l=o.values;for(let f=0;f<s.length;f++){const u=i[f];for(let g=0;g<l.length;g++)l[g]+=u[g]}return r.makeTensorInfo(o.shape,o.dtype,o.values)}const addNConfig={kernelName:AddN,backendName:"cpu",kernelFunc:addN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function all(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,keepDims:l}=s;assertNotComplex(i,"all");const f=parseAxisParam(o,i.shape);let u=f;const g=getAxesPermutation(u,i.shape.length);let y=i;g!=null&&(y=transpose({inputs:{x:i},backend:r,attrs:{perm:g}}),u=getInnerMostAxes(u.length,i.shape.length)),assertAxesAreInnerMostDims("all",u,y.shape.length);const[a,m]=computeOutAndReduceShapes(y.shape,u),_=sizeFromShape(m),b=makeZerosTypedArray(sizeFromShape(a),y.dtype),c=r.data.get(y.dataId).values;for(let S=0;S<b.length;++S){const E=S*_;let I=c[E];for(let A=0;A<_;++A){const T=c[E+A];I=I&&T}b[S]=I}g!=null&&r.disposeIntermediateTensorInfo(y);const w=r.makeTensorInfo(a,y.dtype,b);if(l){const S=expandShapeToKeepDim(a,f),E=reshape({inputs:{x:w},backend:r,attrs:{shape:S}});return r.disposeIntermediateTensorInfo(w),E}return w}const allConfig={kernelName:All,backendName:"cpu",kernelFunc:all};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function any(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,keepDims:l}=s;assertNotComplex(i,"any");const f=parseAxisParam(o,i.shape);let u=f;const g=getAxesPermutation(u,i.shape.length);let y=i;g!=null&&(y=transpose({inputs:{x:i},backend:r,attrs:{perm:g}}),u=getInnerMostAxes(u.length,i.shape.length)),assertAxesAreInnerMostDims("any",u,y.shape.length);const[a,m]=computeOutAndReduceShapes(y.shape,u),_=sizeFromShape(m),b=makeZerosTypedArray(sizeFromShape(a),y.dtype),c=r.data.get(y.dataId).values;for(let S=0;S<b.length;++S){const E=S*_;let I=c[E];for(let A=0;A<_;++A){const T=c[E+A];I=I||T}b[S]=I}g!=null&&r.disposeIntermediateTensorInfo(y);const w=r.makeTensorInfo(a,y.dtype,b);if(l){const S=expandShapeToKeepDim(a,f),E=reshape({inputs:{x:w},backend:r,attrs:{shape:S}});return r.disposeIntermediateTensorInfo(w),E}return w}const anyConfig={kernelName:Any,backendName:"cpu",kernelFunc:any};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function argMax(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o}=s;assertNotComplex(i,"argMax");let l=parseAxisParam(o,i.shape);const f=getAxesPermutation(l,i.shape.length);let u=i;const g=[];f!=null&&(u=transpose({inputs:{x:i},backend:r,attrs:{perm:f}}),g.push(u),l=getInnerMostAxes(l.length,u.shape.length)),l=[l[0]],assertAxesAreInnerMostDims("argMax",l,u.shape.length);const[y,a]=computeOutAndReduceShapes(u.shape,l),m=sizeFromShape(y),_=makeZerosTypedArray(m,"int32"),b=sizeFromShape(a),c=r.data.get(u.dataId).values;for(let w=0;w<_.length;++w){const S=w*b;let E=c[S],I=0;for(let A=0;A<b;++A){const T=c[S+A];T>E&&(E=T,I=A)}_[w]=I}return g.forEach(w=>r.disposeIntermediateTensorInfo(w)),r.makeTensorInfo(y,"int32",_)}const argMaxConfig={kernelName:ArgMax,backendName:"cpu",kernelFunc:argMax};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function argMin(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o}=s;assertNotComplex(i,"argMin");let l=parseAxisParam(o,i.shape);const f=getAxesPermutation(l,i.shape.length);let u=i;const g=[];f!=null&&(u=transpose({inputs:{x:i},backend:r,attrs:{perm:f}}),g.push(u),l=getInnerMostAxes(l.length,u.shape.length)),l=[l[0]],assertAxesAreInnerMostDims("argMin",l,u.shape.length);const[y,a]=computeOutAndReduceShapes(u.shape,l),m=sizeFromShape(y),_=makeZerosTypedArray(m,"int32"),b=sizeFromShape(a),c=r.data.get(u.dataId).values;for(let w=0;w<_.length;++w){const S=w*b;let E=c[S],I=0;for(let A=0;A<b;++A){const T=c[S+A];T<E&&(E=T,I=A)}_[w]=I}return g.forEach(w=>r.disposeIntermediateTensorInfo(w)),r.makeTensorInfo(y,"int32",_)}const argMinConfig={kernelName:ArgMin,backendName:"cpu",kernelFunc:argMin};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const asin=unaryKernelFunc(Asin,n=>Math.asin(n)),asinConfig={kernelName:Asin,backendName:"cpu",kernelFunc:asin};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const asinh=unaryKernelFunc(Asinh,n=>Math.asinh(n)),asinhConfig={kernelName:Asinh,backendName:"cpu",kernelFunc:asinh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const atan=unaryKernelFunc(Atan,n=>Math.atan(n)),atanConfig={kernelName:Atan,backendName:"cpu",kernelFunc:atan};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const atan2Impl=createSimpleBinaryKernelImpl((n,t)=>Math.atan2(n,t)),atan2=binaryKernelFunc(Atan2,atan2Impl),atan2Config={kernelName:Atan2,backendName:"cpu",kernelFunc:atan2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const atanh=unaryKernelFunc(Atanh,n=>Math.atanh(n)),atanhConfig={kernelName:Atanh,backendName:"cpu",kernelFunc:atanh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pool(n,t,r,s,i,o){const l=i.strideHeight,f=i.strideWidth,u=i.dilationHeight,g=i.dilationWidth,y=i.effectiveFilterHeight,a=i.effectiveFilterWidth,m=i.padInfo.top,_=i.padInfo.left,b=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,c=buffer(i.outShape,r),w=c.values,S=i.outShape[1]*i.outShape[2]*i.outShape[3],E=i.outShape[2]*i.outShape[3],I=i.outShape[3];for(let A=0;A<i.batchSize;++A){const T=A*S,O=A*s[0];for(let C=0;C<i.inChannels;++C)for(let k=0;k<i.outHeight;++k){const P=k*l-m,N=Math.max(0,P),L=Math.min(i.inHeight,y+P),F=T+k*E;for(let V=0;V<i.outWidth;++V){const j=V*f-_,K=Math.max(0,j),U=Math.min(i.inWidth,a+j);let X=b,J=0,Y=0;for(let se=N;se<L;se+=u){const de=O+se*s[1];for(let Se=K;Se<U;Se+=g){const we=de+Se*s[2],ge=n[we+C];o==="max"&&ge>X?X=ge:o==="avg"&&(J+=ge,Y++)}if(isNaN(X))break}const te=F+V*I+C;w[te]=o==="avg"?J/Y:X}}}return c}function maxPoolPositions(n,t,r,s,i=!1,o=!1){const l=buffer(s.outShape,"int32"),f=s.strideHeight,u=s.strideWidth,g=s.dilationHeight,y=s.dilationWidth,a=s.effectiveFilterHeight,m=s.effectiveFilterWidth,_=s.padInfo.top,b=s.padInfo.left,c=buffer(t,r,n);for(let w=0;w<s.batchSize;++w)for(let S=0;S<s.inChannels;++S)for(let E=0;E<s.outHeight;++E){const I=E*f-_;let A=I;for(;A<0;)A+=g;const T=Math.min(s.inHeight,a+I);for(let O=0;O<s.outWidth;++O){const C=O*u-b;let k=C;for(;k<0;)k+=y;const P=Math.min(s.inWidth,m+C);let N=Number.NEGATIVE_INFINITY,L=-1;for(let F=A;F<T;F+=g){const V=F-I;for(let j=k;j<P;j+=y){const K=j-C,U=c.get(w,F,j,S);U>N&&(N=U,i?L=o?((w*s.inHeight+F)*s.inWidth+j)*s.inChannels+S:(F*s.inWidth+j)*s.inChannels+S:L=V*m+K)}}l.set(L,w,E,O,S)}}return l}function pool3d(n,t,r,s,i,o){const l=i.strideDepth,f=i.strideHeight,u=i.strideWidth,g=i.dilationDepth,y=i.dilationHeight,a=i.dilationWidth,m=i.effectiveFilterDepth,_=i.effectiveFilterHeight,b=i.effectiveFilterWidth,c=i.padInfo.front,w=i.padInfo.top,S=i.padInfo.left,E=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,I=buffer(i.outShape,r),A=I.values,T=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],O=i.outShape[2]*i.outShape[3]*i.outShape[4],C=i.outShape[3]*i.outShape[4],k=i.outShape[4];for(let P=0;P<i.batchSize;++P){const N=P*T,L=P*s[0];for(let F=0;F<i.inChannels;++F)for(let V=0;V<i.outDepth;++V){const j=V*l-c;let K=j;for(;K<0;)K+=g;const U=Math.min(i.inDepth,m+j),X=N+V*O;for(let J=0;J<i.outHeight;++J){const Y=J*f-w;let te=Y;for(;te<0;)te+=y;const se=Math.min(i.inHeight,_+Y),de=X+J*C;for(let Se=0;Se<i.outWidth;++Se){const we=Se*u-S;let ge=we;for(;ge<0;)ge+=a;const Ie=Math.min(i.inWidth,b+we),Te=de+Se*k;let Ce=E,Ae=0,Me=0;for(let G=K;G<U;G+=g){const Q=L+G*s[1];for(let ie=te;ie<se;ie+=y){const le=Q+ie*s[2];for(let ue=ge;ue<Ie;ue+=a){const he=le+ue*s[3],ve=n[he+F];if(o==="max"&&ve>Ce?Ce=ve:o==="avg"&&(Ae+=ve,Me++),isNaN(Ce))break}if(isNaN(Ce))break}if(isNaN(Ce))break}const Re=Te+F;A[Re]=o==="avg"?Ae/Math.max(Me,1):Ce}}}}return I}function maxPool3dPositions(n,t){const r=buffer(t.outShape,"int32"),s=t.strideDepth,i=t.strideHeight,o=t.strideWidth,l=t.dilationDepth,f=t.dilationHeight,u=t.dilationWidth,g=t.effectiveFilterDepth,y=t.effectiveFilterHeight,a=t.effectiveFilterWidth,m=t.padInfo.front,_=t.padInfo.top,b=t.padInfo.left;for(let c=0;c<t.batchSize;++c)for(let w=0;w<t.inChannels;++w)for(let S=0;S<t.outDepth;++S){const E=S*s-m;let I=E;for(;I<0;)I+=l;const A=Math.min(t.inDepth,g+E);for(let T=0;T<t.outHeight;++T){const O=T*i-_;let C=O;for(;C<0;)C+=f;const k=Math.min(t.inHeight,y+O);for(let P=0;P<t.outWidth;++P){const N=P*o-b;let L=N;for(;L<0;)L+=u;const F=Math.min(t.inWidth,a+N);let V=Number.NEGATIVE_INFINITY,j=-1;for(let K=I;K<A;K+=l){const U=K-E;for(let X=C;X<k;X+=f){const J=X-O;for(let Y=L;Y<F;Y+=u){const te=Y-N,se=n.get(c,K,X,Y,w);se>=V&&(V=se,j=U*y*a+J*y+te)}}}r.set(j,c,S,T,P,w)}}}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function avgPool(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t;assertNotComplex(i,"avgPool");const{filterSize:o,strides:l,pad:f,dimRoundingMode:u}=s,g=1;assert(eitherStridesOrDilationsAreOne(l,g),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=computePool2DInfo(i.shape,o,l,g,f,u);let a;if(y.filterWidth===1&&y.filterHeight===1&&arraysEqual(y.inShape,y.outShape))a=identity({inputs:{x:i},backend:r});else{const m=r.data.get(i.dataId).values,_=computeStrides(i.shape),b=pool(m,i.shape,i.dtype,_,y,"avg");a=r.makeTensorInfo(y.outShape,i.dtype,b.values)}return a}const avgPoolConfig={kernelName:AvgPool,backendName:"cpu",kernelFunc:avgPool};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function avgPool3D(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{filterSize:o,strides:l,pad:f,dimRoundingMode:u,dataFormat:g}=s;assertNotComplex(i,"avgPool3d");const y=computePool3DInfo(i.shape,o,l,1,f,u,g),a=r.data.get(i.dataId).values,m=pool3d(a,i.shape,i.dtype,computeStrides(i.shape),y,"avg");return r.makeTensorInfo(m.shape,"float32",m.values)}const avgPool3DConfig={kernelName:AvgPool3D,backendName:"cpu",kernelFunc:avgPool3D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function avgPool3DGrad(n){const{inputs:t,backend:r,attrs:s}=n,{dy:i,input:o}=t,{filterSize:l,strides:f,pad:u,dimRoundingMode:g}=s;assertNotComplex([i,o],"avgPool3DGrad");const y=computePool3DInfo(o.shape,l,f,1,u,g),a=y.strideDepth,m=y.strideHeight,_=y.strideWidth,b=y.filterDepth,c=y.filterHeight,w=y.filterWidth,S=y.dilationDepth,E=y.dilationHeight,I=y.dilationWidth,A=y.effectiveFilterDepth,T=y.effectiveFilterHeight,O=y.effectiveFilterWidth,C=A-1-y.padInfo.front,k=O-1-y.padInfo.left,P=T-1-y.padInfo.top,N=buffer(o.shape,"float32"),L=1/(b*c*w),F=r.bufferSync(i);for(let V=0;V<y.batchSize;++V)for(let j=0;j<y.inChannels;++j)for(let K=0;K<y.inDepth;++K)for(let U=0;U<y.inHeight;++U)for(let X=0;X<y.inWidth;++X){const J=K-C,Y=U-P,te=X-k;let se=0;for(let de=0;de<A;de+=S){const Se=(J+de)/a;if(!(Se<0||Se>=y.outDepth||Math.floor(Se)!==Se))for(let we=0;we<T;we+=E){const ge=(Y+we)/m;if(!(ge<0||ge>=y.outHeight||Math.floor(ge)!==ge))for(let Ie=0;Ie<O;Ie+=I){const Te=(te+Ie)/_;if(Te<0||Te>=y.outWidth||Math.floor(Te)!==Te)continue;const Ce=F.get(V,Se,ge,Te,j);se+=Ce}}}N.set(se*L,V,K,U,X,j)}return r.makeTensorInfo(N.shape,N.dtype,N.values)}const avgPool3DGradConfig={kernelName:AvgPool3DGrad,backendName:"cpu",kernelFunc:avgPool3DGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function avgPoolGrad(n){const{inputs:t,backend:r,attrs:s}=n,{dy:i,input:o}=t,l=o;assertNotComplex([i,o],"avgPoolGrad");const{filterSize:f,strides:u,pad:g}=s,y=computePool2DInfo(l.shape,f,u,1,g),a=y.strideHeight,m=y.strideWidth,_=y.filterHeight,b=y.filterWidth,c=y.dilationHeight,w=y.dilationWidth,S=y.effectiveFilterHeight,E=y.effectiveFilterWidth,I=E-1-y.padInfo.left,A=S-1-y.padInfo.top,T=buffer(l.shape,"float32"),O=1/(_*b),C=r.data.get(i.dataId).values,k=buffer(i.shape,"float32",C);for(let P=0;P<y.batchSize;++P)for(let N=0;N<y.inChannels;++N)for(let L=0;L<y.inHeight;++L)for(let F=0;F<y.inWidth;++F){const V=L-A,j=F-I;let K=0;for(let U=0;U<S;U+=c){const X=(V+U)/a;if(!(X<0||X>=y.outHeight||Math.floor(X)!==X))for(let J=0;J<E;J+=w){const Y=(j+J)/m;if(Y<0||Y>=y.outWidth||Math.floor(Y)!==Y)continue;const te=k.get(P,X,Y,N);K+=te}}T.set(K*O,P,L,F,N)}return r.makeTensorInfo(T.shape,T.dtype,T.values)}const avgPoolGradConfig={kernelName:AvgPoolGrad,backendName:"cpu",kernelFunc:avgPoolGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function batchNorm(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,scale:o,offset:l,mean:f,variance:u}=t;assert(f.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),assert(l==null||f.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),assert(o==null||f.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),assertNotComplex([i,f,u,o,l],"batchNorm");let{varianceEpsilon:g}=s;g==null&&(g=.001);const y=r.data.get(i.dataId).values,a=r.data.get(f.dataId).values,m=r.data.get(u.dataId).values,_=o?r.data.get(o.dataId).values:new Float32Array([1]),b=l?r.data.get(l.dataId).values:new Float32Array([0]),c=new Float32Array(y.length),w=b.length,S=_.length,E=m.length,I=a.length;let A=0,T=0,O=0,C=0;for(let k=0;k<y.length;++k)c[k]=b[A++]+(y[k]-a[T++])*_[O++]/Math.sqrt(m[C++]+g),A>=w&&(A=0),T>=I&&(T=0),O>=S&&(O=0),C>=E&&(C=0);return r.makeTensorInfo(i.shape,i.dtype,c)}const batchNormConfig={kernelName:FusedBatchNorm,backendName:"cpu",kernelFunc:batchNorm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function batchToSpaceND(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{blockShape:o,crops:l}=s;assertNotComplex([i],"batchToSpaceND");const f=o.reduce((S,E)=>S*E),u=getReshaped(i.shape,o,f),g=getPermuted(u.length,o.length),y=getReshapedPermuted(i.shape,o,f),a=getSliceBeginCoords(l,o.length),m=getSliceSize(y,l,o.length),_=reshape({inputs:{x:i},backend:r,attrs:{shape:u}}),b=transpose({inputs:{x:_},backend:r,attrs:{perm:g}}),c=reshape({inputs:{x:b},backend:r,attrs:{shape:y}}),w=slice({inputs:{x:c},backend:r,attrs:{begin:a,size:m}});return r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(c),w}const batchToSpaceNDConfig={kernelName:BatchToSpaceND,backendName:"cpu",kernelFunc:batchToSpaceND};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bincount(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,weights:o}=t,{size:l}=s,f=r.data.get(i.dataId).values,u=r.data.get(o.dataId).values,g=bincountImpl(f,u,o.dtype,o.shape,l);return r.makeTensorInfo([l],o.dtype,g)}const bincountConfig={kernelName:Bincount,backendName:"cpu",kernelFunc:bincount};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function broadcastArgs(n){const{inputs:t,backend:r}=n,{s0:s,s1:i}=t,o=r.data.get(s.dataId).values,l=r.data.get(i.dataId).values,f=assertAndGetBroadcastShape(Array.from(o),Array.from(l));return r.makeTensorInfo([f.length],"int32",Int32Array.from(f))}const broadcastArgsConfig={kernelName:BroadcastArgs,backendName:"cpu",kernelFunc:broadcastArgs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const clipByValue=unaryKernelFunc(ClipByValue,(n,t)=>{const r=t;return n>r.clipValueMax?r.clipValueMax:n<r.clipValueMin?r.clipValueMin:n}),clipByValueConfig={kernelName:ClipByValue,backendName:"cpu",kernelFunc:clipByValue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const complexAbs=n=>{const{x:t}=n.inputs,r=n.backend,s=new Float32Array(sizeFromShape(t.shape)),i=r.data.get(t.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,f=r.data.get(o.dataId).values,u=r.data.get(l.dataId).values;for(let g=0;g<f.length;g++){const y=f[g],a=u[g];s[g]=Math.hypot(y,a)}return r.makeOutput(s,t.shape,"float32")},complexAbsConfig={kernelName:ComplexAbs,backendName:"cpu",kernelFunc:complexAbs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function imag(n){const{inputs:t,backend:r}=n,{input:s}=t,i=r.data.get(s.dataId).complexTensorInfos.imag,o=r.data.get(i.dataId).values;return r.makeTensorInfo(i.shape,i.dtype,o)}const imagConfig={kernelName:Imag,backendName:"cpu",kernelFunc:imag};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function concat(n){const{inputs:t,backend:r,attrs:s}=n,{axis:i}=s,o=parseAxisParam(i,t[0].shape)[0],l=t.map(c=>c.shape);assertParamsConsistent(l,o);let f=computeOutShape(t.map(c=>c.shape),o);if(sizeFromShape(f)===0)return r.makeTensorInfo(f,t[0].dtype,[]);const u=t.filter(c=>sizeFromShape(c.shape)>0);if(u.length===1)return identity({inputs:{x:u[0]},backend:r});if(u[0].dtype==="complex64"){const c=u.map(A=>real({inputs:{input:A},backend:r})),w=u.map(A=>imag({inputs:{input:A},backend:r})),S=concat({inputs:c,backend:r,attrs:{axis:o}}),E=concat({inputs:w,backend:r,attrs:{axis:o}}),I=complex({inputs:{real:S,imag:E},backend:r});return c.forEach(A=>r.disposeIntermediateTensorInfo(A)),w.forEach(A=>r.disposeIntermediateTensorInfo(A)),r.disposeIntermediateTensorInfo(S),r.disposeIntermediateTensorInfo(E),I}const g=u.map(c=>{const S=[-1,sizeFromShape(c.shape.slice(o))];return reshape({inputs:{x:c},backend:r,attrs:{shape:S}})}),y=g.map(c=>({vals:r.data.get(c.dataId).values,shape:c.shape}));f=computeOutShape(g.map(c=>c.shape),1);const a=g[0].shape[0]===1,m=concatImpl(y,f,t[0].dtype,a),_=computeOutShape(u.map(c=>c.shape),o),b=r.makeTensorInfo(_,t[0].dtype,m);return g.forEach(c=>r.disposeIntermediateTensorInfo(c)),b}const concatConfig={kernelName:Concat,backendName:"cpu",kernelFunc:concat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function conv2D(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,filter:o}=t,{strides:l,pad:f,dataFormat:u,dilations:g,dimRoundingMode:y}=s;assertNotComplex([i,o],"conv2d");const a=convertConv2DDataFormat(u),m=computeConv2DInfo(i.shape,o.shape,l,g,f,y,!1,a),_=m.filterHeight,b=m.filterWidth,c=m.dilationHeight,w=m.dilationWidth,S=m.padInfo.left,E=m.padInfo.top,I=m.dataFormat==="channelsLast",A=new TensorBuffer(m.outShape,i.dtype),T=computeStrides(i.shape),O=computeStrides(o.shape),C=T[0],k=I?T[1]:T[2],P=I?T[2]:1,N=I?1:T[1],L=A.strides[0],F=I?A.strides[1]:A.strides[2],V=I?A.strides[2]:1,j=I?1:A.strides[1],K=r.data.get(i.dataId).values,U=r.data.get(o.dataId).values,X=A.values;for(let J=0;J<m.batchSize;++J){const Y=J*C,te=J*L;for(let se=0;se<m.outHeight;++se){const de=te+se*F,Se=se*m.strideHeight-E;for(let we=0;we<_;++we){const ge=Se+we*c;if(ge<0||ge>=m.inHeight)continue;const Ie=we*O[0],Te=Y+ge*k;for(let Ce=0;Ce<m.outWidth;++Ce){const Ae=de+Ce*V,Me=Ce*m.strideWidth-S;for(let Re=0;Re<b;++Re){const G=Me+Re*w;if(G<0||G>=m.inWidth)continue;const Q=Ie+Re*O[1],ie=Te+G*P;let le=Q;for(let ue=0;ue<m.inChannels;++ue){const he=K[ie+ue*N];for(let ve=0;ve<m.outChannels;++ve)X[Ae+ve*j]+=he*U[le+ve];le+=m.outChannels}}}}}}return r.makeTensorInfo(A.shape,A.dtype,X)}const conv2DConfig={kernelName:Conv2D,backendName:"cpu",kernelFunc:conv2D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function conv2DBackpropFilter(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,dy:o}=t,{strides:l,pad:f,dataFormat:u,dimRoundingMode:g,filterShape:y}=s;assertNotComplex([i,o],"conv2dBackpropFilter");const a=convertConv2DDataFormat(u),m=computeConv2DInfo(i.shape,y,l,1,f,g,!1,a),{strideHeight:_,strideWidth:b,filterHeight:c,filterWidth:w}=m,S=m.dataFormat==="channelsLast",E=new TensorBuffer(m.filterShape,"float32"),I=m.padInfo.left,A=m.padInfo.top,T=r.data.get(i.dataId).values,O=r.data.get(o.dataId).values,C=new TensorBuffer(i.shape,i.dtype,T),k=new TensorBuffer(o.shape,o.dtype,O);for(let P=0;P<c;++P){const N=Math.max(0,Math.ceil((A-P)/_)),L=Math.min(m.outHeight,(m.inHeight+A-P)/_);for(let F=0;F<w;++F){const V=Math.max(0,Math.ceil((I-F)/b)),j=Math.min(m.outWidth,(m.inWidth+I-F)/b);for(let K=0;K<m.inChannels;++K)for(let U=0;U<m.outChannels;++U){let X=0;for(let J=0;J<m.batchSize;++J)for(let Y=N;Y<L;++Y){const te=P+Y*_-A;for(let se=V;se<j;++se){const de=F+se*b-I;S?X+=C.get(J,te,de,K)*k.get(J,Y,se,U):X+=C.get(J,K,te,de)*k.get(J,U,Y,se)}}E.set(X,P,F,K,U)}}}return r.makeTensorInfo(E.shape,E.dtype,E.values)}const conv2DBackpropFilterConfig={kernelName:Conv2DBackpropFilter,backendName:"cpu",kernelFunc:conv2DBackpropFilter};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function conv2DBackpropInput(n){const{inputs:t,backend:r,attrs:s}=n,{dy:i,filter:o}=t,{inputShape:l,strides:f,pad:u,dataFormat:g,dimRoundingMode:y}=s;assertNotComplex([i,o],"conv2dBackpropInput");const a=computeStrides(o.shape),m=computeStrides(i.shape);let _=convertConv2DDataFormat(g);const b=computeConv2DInfo(l,o.shape,f,1,u,y,!1,_),c=new TensorBuffer(b.inShape,"float32"),w=c.values,S=r.data.get(i.dataId).values,E=r.data.get(o.dataId).values,[I,A,T]=a,{batchSize:O,filterHeight:C,filterWidth:k,inChannels:P,inHeight:N,inWidth:L,outChannels:F,outHeight:V,outWidth:j,strideHeight:K,strideWidth:U}=b;_=b.dataFormat;const X=C-1-b.padInfo.top,J=k-1-b.padInfo.left,Y=_==="channelsLast",te=c.strides[0],se=Y?c.strides[1]:c.strides[2],de=Y?c.strides[2]:1,Se=Y?1:c.strides[1],we=m[0],ge=Y?m[1]:m[2],Ie=Y?m[2]:1,Te=Y?1:m[1];for(let Ce=0;Ce<O;++Ce)for(let Ae=0;Ae<P;++Ae)for(let Me=0;Me<N;++Me){const Re=Me-X,G=Math.max(0,Math.ceil(Re/K)),Q=Math.min(V,(C+Re)/K);for(let ie=0;ie<L;++ie){const le=ie-J,ue=Math.max(0,Math.ceil(le/U)),he=Math.min(j,(k+le)/U);let ve=0;for(let ye=G;ye<Q;++ye){const B=ye*K-Re;for(let M=ue;M<he;++M){const D=M*U-le,z=we*Ce+ge*ye+Ie*M,Z=I*(C-1-B)+A*(k-1-D)+T*Ae;for(let oe=0;oe<F;++oe){const ae=S[z+Te*oe],Ee=E[Z+oe];ve+=ae*Ee}}}const be=te*Ce+se*Me+de*ie+Se*Ae;w[be]=ve}}return r.makeTensorInfo(c.shape,c.dtype,c.values)}const conv2DBackpropInputConfig={kernelName:Conv2DBackpropInput,backendName:"cpu",kernelFunc:conv2DBackpropInput};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function conv3D(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,filter:o}=t,{strides:l,pad:f,dilations:u}=s;assertNotComplex([i,o],"conv3d");const g=computeConv3DInfo(i.shape,o.shape,l,u,f),{filterDepth:y,filterHeight:a,filterWidth:m,dilationDepth:_,dilationHeight:b,dilationWidth:c,padInfo:w}=g,S=w.front,E=w.left,I=w.top,A=new TensorBuffer(g.outShape,i.dtype),T=r.data.get(i.dataId).values,O=r.data.get(o.dataId).values,C=A.values,k=computeStrides(i.shape),P=computeStrides(o.shape);for(let N=0;N<g.batchSize;++N){const L=N*k[0],F=N*A.strides[0];for(let V=0;V<g.outDepth;++V){const j=F+V*A.strides[1],K=V*g.strideDepth-S;for(let U=0;U<y;++U){const X=K+U*_;if(X<0||X>=g.inDepth)continue;const J=U*P[0],Y=L+X*k[1];for(let te=0;te<g.outHeight;++te){const se=j+te*A.strides[2],de=te*g.strideHeight-I;for(let Se=0;Se<a;++Se){const we=de+Se*b;if(we<0||we>=g.inHeight)continue;const ge=J+Se*P[1],Ie=Y+we*k[2];for(let Te=0;Te<g.outWidth;++Te){const Ce=se+Te*g.outChannels,Ae=Te*g.strideWidth-E;for(let Me=0;Me<m;++Me){const Re=Ae+Me*c;if(Re<0||Re>=g.inWidth)continue;const G=ge+Me*P[2],Q=Ie+Re*g.inChannels;let ie=G;for(let le=0;le<g.inChannels;++le){const ue=T[Q+le];for(let he=0;he<g.outChannels;++he)C[Ce+he]+=ue*O[ie+he];ie+=g.outChannels}}}}}}}}return r.makeTensorInfo(A.shape,A.dtype,A.values)}const conv3DConfig={kernelName:Conv3D,backendName:"cpu",kernelFunc:conv3D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function conv3DBackpropFilterV2(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,dy:o}=t,{strides:l,pad:f,filterShape:u}=s;assertNotComplex([i,o],"conv3dBackpropFilterV2");const g=computeStrides(i.shape),y=computeStrides(o.shape),a=computeConv3DInfo(i.shape,u,l,1,f),m=a.strideDepth,_=a.strideHeight,b=a.strideWidth,c=a.filterDepth,w=a.filterHeight,S=a.filterWidth,E=new TensorBuffer(a.filterShape,"float32"),I=E.values,[A,T,O,C]=E.strides,k=r.data.get(o.dataId).values,[P,N,L,F]=y,V=r.data.get(i.dataId).values,[j,K,U,X]=g,J=a.padInfo.front,Y=a.padInfo.left,te=a.padInfo.top;for(let se=0;se<c;++se){const de=Math.max(0,Math.ceil((J-se)/m)),Se=Math.min(a.outDepth,(a.inDepth+J-se)/m),we=se*A;for(let ge=0;ge<w;++ge){const Ie=Math.max(0,Math.ceil((te-ge)/_)),Te=Math.min(a.outHeight,(a.inHeight+te-ge)/_),Ce=ge*T+we;for(let Ae=0;Ae<S;++Ae){const Me=Math.max(0,Math.ceil((Y-Ae)/b)),Re=Math.min(a.outWidth,(a.inWidth+Y-Ae)/b),G=Ae*O+Ce;for(let Q=0;Q<a.inChannels;++Q){const ie=Q*C+G;for(let le=0;le<a.outChannels;++le){let ue=0;for(let he=0;he<a.batchSize;++he){const ve=he*j,be=he*P;for(let ye=de;ye<Se;++ye){const M=(se+ye*m-J)*K+ve,D=ye*N+be;for(let z=Ie;z<Te;++z){const oe=(ge+z*_-te)*U+M,ae=z*L+D;for(let Ee=Me;Ee<Re;++Ee){const $e=(Ae+Ee*b-Y)*X+oe,Ke=Ee*F+ae;ue+=V[$e+Q]*k[Ke+le]}}}}I[ie+le]=ue}}}}}return r.makeTensorInfo(E.shape,E.dtype,E.values)}const conv3DBackpropFilterV2Config={kernelName:Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:conv3DBackpropFilterV2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function conv3DBackpropInputV2(n){const{inputs:t,backend:r,attrs:s}=n,{dy:i,filter:o}=t,{pad:l,strides:f,inputShape:u}=s;assertNotComplex([i],"conv3dBackpropInputV2");const g=computeStrides(i.shape),y=computeStrides(o.shape),a=computeConv3DInfo(u,o.shape,f,1,l),m=new TensorBuffer(a.inShape,"float32"),_=m.values,[b,c,w,S]=m.strides,E=r.data.get(i.dataId).values,[I,A,T,O]=g,C=r.data.get(o.dataId).values,[k,P,N,L]=y,{batchSize:F,filterDepth:V,filterHeight:j,filterWidth:K,inChannels:U,inDepth:X,inHeight:J,inWidth:Y,outChannels:te,outDepth:se,outHeight:de,outWidth:Se,strideDepth:we,strideHeight:ge,strideWidth:Ie}=a,Te=V-1-a.padInfo.front,Ce=j-1-a.padInfo.top,Ae=K-1-a.padInfo.left;for(let Me=0;Me<F;++Me)for(let Re=0;Re<U;++Re)for(let G=0;G<X;++G){const Q=G-Te,ie=Math.max(0,Math.ceil(Q/we)),le=Math.min(se,(V+Q)/we);for(let ue=0;ue<J;++ue){const he=ue-Ce,ve=Math.max(0,Math.ceil(he/ge)),be=Math.min(de,(j+he)/ge);for(let ye=0;ye<Y;++ye){const B=ye-Ae,M=Math.max(0,Math.ceil(B/Ie)),D=Math.min(Se,(K+B)/Ie);let z=0;for(let Z=ie;Z<le;++Z){const oe=Z*we-Q;for(let ae=ve;ae<be;++ae){const Ee=ae*ge-he;for(let Pe=M;Pe<D;++Pe){const $e=Pe*Ie-B,Ke=I*Me+A*Z+T*ae+O*Pe,Ge=k*(V-1-oe)+P*(j-1-Ee)+N*(K-1-$e)+L*Re;for(let ot=0;ot<te;++ot){const Nt=E[Ke+ot],nt=C[Ge+ot];z+=Nt*nt}}}}_[b*Me+c*G+w*ue+S*ye+Re]=z}}}return r.makeTensorInfo(m.shape,m.dtype,m.values)}const conv3DBackpropInputV2Config={kernelName:Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:conv3DBackpropInputV2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cos=unaryKernelFunc(Cos,n=>Math.cos(n)),cosConfig={kernelName:Cos,backendName:"cpu",kernelFunc:cos};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cosh=unaryKernelFunc(Cosh,n=>Math.cosh(n)),coshConfig={kernelName:Cosh,backendName:"cpu",kernelFunc:cosh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cropAndResize(n){const{inputs:t,backend:r,attrs:s}=n,{image:i,boxes:o,boxInd:l}=t,{cropSize:f,method:u,extrapolationValue:g}=s,[y,a,m,_]=i.shape,b=o.shape[0],[c,w]=f,S=buffer([b,c,w,_],"float32"),E=r.data.get(o.dataId).values,I=r.data.get(l.dataId).values,A=r.data.get(i.dataId).values,T=computeStrides(i.shape),O=computeStrides(S.shape);for(let C=0;C<b;C++){const k=C*4,P=E[k],N=E[k+1],L=E[k+2],F=E[k+3],V=I[C];if(V>=y)continue;const j=c>1?(L-P)*(a-1)/(c-1):0,K=w>1?(F-N)*(m-1)/(w-1):0;for(let U=0;U<c;U++){const X=c>1?P*(a-1)+U*j:.5*(P+L)*(a-1);if(X<0||X>a-1){for(let J=0;J<w;J++)for(let Y=0;Y<_;Y++){const te=Y+J*O[2]+U*O[1]+C*O[0];S.values[te]=g}continue}if(u==="bilinear"){const J=Math.floor(X),Y=Math.ceil(X),te=X-J;for(let se=0;se<w;se++){const de=w>1?N*(m-1)+se*K:.5*(N+F)*(m-1);if(de<0||de>m-1){for(let Ie=0;Ie<_;Ie++){const Te=Ie+se*O[2]+U*O[1]+C*O[0];S.values[Te]=g}continue}const Se=Math.floor(de),we=Math.ceil(de),ge=de-Se;for(let Ie=0;Ie<_;Ie++){let Te=Ie+Se*T[2]+J*T[1]+V*T[0];const Ce=A[Te];Te=Ie+we*T[2]+J*T[1]+V*T[0];const Ae=A[Te];Te=Ie+Se*T[2]+Y*T[1]+V*T[0];const Me=A[Te];Te=Ie+we*T[2]+Y*T[1]+V*T[0];const Re=A[Te],G=Ce+(Ae-Ce)*ge,Q=Me+(Re-Me)*ge;Te=Ie+se*O[2]+U*O[1]+C*O[0],S.values[Te]=G+(Q-G)*te}}}else for(let J=0;J<w;++J){const Y=w>1?N*(m-1)+J*K:.5*(N+F)*(m-1);if(Y<0||Y>m-1){for(let de=0;de<_;de++){const Se=de+J*O[2]+U*O[1]+C*O[0];S.values[Se]=g}continue}const te=Math.round(Y),se=Math.round(X);for(let de=0;de<_;de++){const Se=de+te*T[2]+se*T[1]+V*T[0],we=de+J*O[2]+U*O[1]+C*O[0];S.values[we]=A[Se]}}}}return r.makeTensorInfo(S.shape,S.dtype,S.values)}const cropAndResizeConfig={kernelName:CropAndResize,backendName:"cpu",kernelFunc:cropAndResize};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cumprod(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,exclusive:l,reverse:f}=s;assertNotComplex(i,"cumprod");const u=getAxesPermutation([o],i.shape.length);let g=i;u!=null&&(g=transpose({inputs:{x:i},backend:r,attrs:{perm:u}}));const y=getInnerMostAxes(1,i.shape.length)[0];if(y!==g.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${g.shape.length-1} but got axis=${y}`);const a=upcastType(g.dtype,"int32"),m=makeOnesTypedArray(sizeFromShape(g.shape),a),_=r.data.get(g.dataId).values,b=g.shape[g.shape.length-1],c=f?(S,E)=>S+b-E-1:(S,E)=>S+E;for(let S=0;S<_.length;S+=b)for(let E=0;E<b;E++){const I=c(S,E);if(E===0)m[I]=l?1:_[I];else{const A=c(S,E-1);m[I]=l?_[A]*m[A]:_[I]*m[A]}}const w=r.makeTensorInfo(g.shape,a,m);if(u!=null){const S=getUndoAxesPermutation(u),E=transpose({inputs:{x:w},backend:r,attrs:{perm:S}});return r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(g),E}return w}const cumprodConfig={kernelName:Cumprod,backendName:"cpu",kernelFunc:cumprod};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cumsum(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,exclusive:l,reverse:f}=s;assertNotComplex(i,"cumsum");const u=getAxesPermutation([o],i.shape.length);let g=i;u!=null&&(g=transpose({inputs:{x:i},backend:r,attrs:{perm:u}}));const y=getInnerMostAxes(1,i.shape.length)[0];if(y!==g.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${g.shape.length-1} but got axis=${y}`);const a=upcastType(g.dtype,"int32"),m=makeZerosTypedArray(sizeFromShape(g.shape),a),_=r.data.get(g.dataId).values,b=g.shape[g.shape.length-1],c=f?(S,E)=>S+b-E-1:(S,E)=>S+E;for(let S=0;S<_.length;S+=b)for(let E=0;E<b;E++){const I=c(S,E);if(E===0)m[I]=l?0:_[I];else{const A=c(S,E-1);m[I]=l?_[A]+m[A]:_[I]+m[A]}}const w=r.makeTensorInfo(g.shape,a,m);if(u!=null){const S=getUndoAxesPermutation(u),E=transpose({inputs:{x:w},backend:r,attrs:{perm:S}});return r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(g),E}return w}const cumsumConfig={kernelName:Cumsum,backendName:"cpu",kernelFunc:cumsum};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function denseBincount(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,weights:o}=t,{size:l,binaryOutput:f}=s;if(i.shape.length===1){const u=r.data.get(i.dataId).values,g=r.data.get(o.dataId).values,y=bincountImpl(u,g,o.dtype,o.shape,l);return r.makeTensorInfo([l],o.dtype,y)}else if(i.shape.length===2){const u=r.bufferSync(i),g=r.bufferSync(o),y=bincountReduceImpl(u,g,l,f);return r.makeTensorInfo(y.shape,o.dtype,y.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const denseBincountConfig={kernelName:DenseBincount,backendName:"cpu",kernelFunc:denseBincount};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function depthToSpace(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{blockSize:o,dataFormat:l}=s;assert(l==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${l}`);const f=i.shape[0],u=i.shape[1],g=i.shape[2],y=i.shape[3],a=u*o,m=g*o,_=y/(o*o),b=r.data.get(i.dataId).values,c=new Float32Array(f*a*m*_);let w=0;for(let S=0;S<f;++S)for(let E=0;E<a;++E){const I=Math.floor(E/o),A=E%o;for(let T=0;T<m;++T){const O=Math.floor(T/o),C=T%o,k=(A*o+C)*_;for(let P=0;P<_;++P){const L=P+k+y*(O+g*(I+u*S));c[w++]=b[L]}}}return r.makeTensorInfo([f,a,m,_],i.dtype,c)}const depthToSpaceConfig={kernelName:DepthToSpace,backendName:"cpu",kernelFunc:depthToSpace};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function depthwiseConv2dNative(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,filter:o}=t,{strides:l,pad:f,dilations:u,dimRoundingMode:g}=s;assertNotComplex([i,o],"depthwiseConv2DNative");const y=computeStrides(i.shape),a=computeStrides(o.shape);let m=u;m==null&&(m=[1,1]),assert(eitherStridesOrDilationsAreOne(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const _=computeConv2DInfo(i.shape,o.shape,l,m,f,g,!0),{filterHeight:b,filterWidth:c,dilationHeight:w,dilationWidth:S,padInfo:E}=_,I=E.left,A=E.top,T=_.outChannels/_.inChannels,O=new TensorBuffer(_.outShape,i.dtype),C=r.data.get(i.dataId).values,k=r.data.get(o.dataId).values,P=O.values;for(let N=0;N<_.batchSize;++N){const L=N*y[0],F=N*O.strides[0];for(let V=0;V<_.outHeight;++V){const j=F+V*O.strides[1],K=V*_.strideHeight-A;for(let U=0;U<b;++U){const X=K+U*w;if(X<0||X>=_.inHeight)continue;const J=U*a[0],Y=L+X*y[1];for(let te=0;te<_.outWidth;++te){const se=j+te*O.strides[2],de=te*_.strideWidth-I;for(let Se=0;Se<c;++Se){const we=de+Se*S;if(we<0||we>=_.inWidth)continue;const ge=J+Se*a[1],Ie=Y+we*_.inChannels;let Te=se,Ce=ge;for(let Ae=0;Ae<_.inChannels;++Ae){const Me=C[Ie+Ae];for(let Re=0;Re<T;++Re)P[Te+Re]+=Me*k[Ce+Re];Te+=T,Ce+=T}}}}}}return r.makeTensorInfo(O.shape,O.dtype,O.values)}const depthwiseConv2dNativeConfig={kernelName:DepthwiseConv2dNative,backendName:"cpu",kernelFunc:depthwiseConv2dNative};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function depthwiseConv2dNativeBackpropFilter(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,dy:o}=t,{strides:l,dilations:f,pad:u,dimRoundingMode:g,filterShape:y}=s;assertNotComplex([i,o],"depthwiseConv2dNativeBackpropFilter");const a=computeConv2DInfo(i.shape,y,l,f,u,g,!0),{strideHeight:m,strideWidth:_,filterHeight:b,filterWidth:c}=a,w=new TensorBuffer(a.filterShape,"float32"),S=a.padInfo.left,E=a.padInfo.top,I=a.outChannels/a.inChannels,A=r.data.get(i.dataId).values,T=new TensorBuffer(i.shape,i.dtype,A),O=r.data.get(o.dataId).values,C=new TensorBuffer(o.shape,o.dtype,O);for(let k=0;k<b;++k){const P=Math.max(0,Math.ceil((E-k)/m)),N=Math.min(a.outHeight,(a.inHeight+E-k)/m);for(let L=0;L<c;++L){const F=Math.max(0,Math.ceil((S-L)/_)),V=Math.min(a.outWidth,(a.inWidth+S-L)/_);for(let j=0;j<a.outChannels;++j){const K=Math.trunc(j/I),U=j%I;let X=0;for(let J=0;J<a.batchSize;++J)for(let Y=P;Y<N;++Y){const te=k+Y*m-E;for(let se=F;se<V;++se){const de=L+se*_-S;X+=T.get(J,te,de,K)*C.get(J,Y,se,j)}}w.set(X,k,L,K,U)}}}return r.makeTensorInfo(w.shape,w.dtype,w.values)}const depthwiseConv2dNativeBackpropFilterConfig={kernelName:DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:depthwiseConv2dNativeBackpropFilter};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function depthwiseConv2dNativeBackpropInput(n){const{inputs:t,backend:r,attrs:s}=n,{dy:i,filter:o}=t,{strides:l,dilations:f,pad:u,dimRoundingMode:g,inputShape:y}=s;assertNotComplex([i,o],"depthwiseConv2DNativeBackpropInput");const a=computeStrides(i.shape),m=computeStrides(o.shape),_=computeConv2DInfo(y,o.shape,l,f,u,g,!0),b=new TensorBuffer(_.inShape,"float32"),c=b.values,[w,S,E]=b.strides,I=r.data.get(i.dataId).values,[A,T,O]=a,C=r.data.get(o.dataId).values,[k,P,N]=m,{batchSize:L,filterHeight:F,filterWidth:V,inChannels:j,inHeight:K,inWidth:U,outChannels:X,outHeight:J,outWidth:Y,strideHeight:te,strideWidth:se}=_,de=F-1-_.padInfo.top,Se=V-1-_.padInfo.left,we=X/j;for(let ge=0;ge<L;++ge)for(let Ie=0;Ie<j;++Ie)for(let Te=0;Te<K;++Te){const Ce=Te-de,Ae=Math.max(0,Math.ceil(Ce/te)),Me=Math.min(J,(F+Ce)/te);for(let Re=0;Re<U;++Re){const G=Re-Se,Q=Math.max(0,Math.ceil(G/se)),ie=Math.min(Y,(V+G)/se);let le=0;for(let ue=Ae;ue<Me;++ue){const he=ue*te-Ce;for(let ve=Q;ve<ie;++ve){const be=ve*se-G,ye=A*ge+T*ue+O*ve,B=k*(F-1-he)+P*(V-1-be)+N*Ie;for(let M=0;M<we;++M){const D=Ie*we+M,z=I[ye+D],Z=C[B+M];le+=z*Z}}}c[w*ge+S*Te+E*Re+Ie]=le}}return r.makeTensorInfo(b.shape,b.dtype,b.values)}const depthwiseConv2dNativeBackpropInputConfig={kernelName:DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:depthwiseConv2dNativeBackpropInput};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function diag(n){const{inputs:t,backend:r}=n,{x:s}=t,i=sizeFromShape(s.shape),o=r.data.get(s.dataId).values,l=buffer([i,i],s.dtype),f=l.values;for(let g=0;g<o.length;g++)f[g*i+g]=o[g];const u=[...s.shape,...s.shape];return r.makeTensorInfo(u,l.dtype,l.values)}const diagConfig={kernelName:Diag,backendName:"cpu",kernelFunc:diag};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dilation2DConfig={kernelName:Dilation2D,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:r})=>{const{x:s,filter:i}=n,{strides:o,pad:l,dilations:f}=r,u=t,g=u.data.get(s.dataId).values,y=s.shape.length,a=u.data.get(i.dataId).values,m=i.shape.length,{batchSize:_,inHeight:b,inWidth:c,inChannels:w,outHeight:S,outWidth:E,padInfo:I,strideHeight:A,strideWidth:T,filterHeight:O,filterWidth:C,dilationHeight:k,dilationWidth:P,outShape:N}=computeDilation2DInfo(s.shape,i.shape,o,l,"NHWC",f),L=sizeFromShape(N),F=N.length,V=getArrayFromDType(s.dtype,L);for(let K=0;K<_;++K)for(let U=0;U<S;++U){const X=U*A-I.top;for(let J=0;J<E;++J){const Y=J*T-I.left;for(let te=0;te<w;++te){let se=Number.MIN_SAFE_INTEGER;for(let Se=0;Se<O;++Se){const we=X+Se*k;if(we>=0&&we<b)for(let ge=0;ge<C;++ge){const Ie=Y+ge*P;if(Ie>=0&&Ie<c){const Te=locToIndex([K,we,Ie,te],y,computeStrides(s.shape)),Ce=locToIndex([Se,ge,te],m,computeStrides(i.shape)),Ae=g[Te]+a[Ce];Ae>se&&(se=Ae)}}}const de=locToIndex([K,U,J,te],F,computeStrides(N));V[de]=se}}}return{dataId:u.write(toTypedArray(V,s.dtype),N,s.dtype),shape:N,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dilation2DBackpropFilterConfig={kernelName:Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:r})=>{const{x:s,filter:i,dy:o}=n,{strides:l,pad:f,dilations:u}=r,g=t,y=toNestedArray(s.shape,g.data.get(s.dataId).values),a=toNestedArray(i.shape,g.data.get(i.dataId).values),{batchSize:m,inHeight:_,inWidth:b,inChannels:c,outHeight:w,outWidth:S,padInfo:E,strideHeight:I,strideWidth:A,filterHeight:T,filterWidth:O,dilationHeight:C,dilationWidth:k,outShape:P}=computeDilation2DInfo(s.shape,i.shape,l,f,"NHWC",u);assert(o.rank===P.length,()=>`Error in ${Dilation2DBackpropFilter}, dy must have the same rank as output ${P.length}, but got ${o.rank}`);const N=toNestedArray(P,g.data.get(o.dataId).values),L=makeZerosNestedTypedArray(i.shape,i.dtype);for(let V=0;V<m;++V)for(let j=0;j<w;++j){const K=j*I-E.top;for(let U=0;U<S;++U){const X=U*A-E.left;for(let J=0;J<c;++J){let Y=Number.MIN_SAFE_INTEGER,te=0,se=0;for(let de=0;de<T;++de){const Se=K+de*C;if(Se>=0&&Se<_)for(let we=0;we<O;++we){const ge=X+we*k;if(ge>=0&&ge<b){const Ie=y[V][Se][ge][J]+a[de][we][J];Ie>Y&&(Y=Ie,te=de,se=we)}}}L[te][se][J]+=N[V][j][U][J]}}}return{dataId:g.write(toTypedArray(L,s.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dilation2DBackpropInputConfig={kernelName:Dilation2DBackpropInput,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:r})=>{const{x:s,filter:i,dy:o}=n,{strides:l,pad:f,dilations:u}=r,g=t,y=toNestedArray(s.shape,g.data.get(s.dataId).values),a=toNestedArray(i.shape,g.data.get(i.dataId).values),{batchSize:m,inHeight:_,inWidth:b,inChannels:c,outHeight:w,outWidth:S,padInfo:E,strideHeight:I,strideWidth:A,filterHeight:T,filterWidth:O,dilationHeight:C,dilationWidth:k,outShape:P}=computeDilation2DInfo(s.shape,i.shape,l,f,"NHWC",u);assert(o.rank===P.length,()=>`Error in ${Dilation2DBackpropInput}, dy must have the same rank as output ${P.length}, but got ${o.rank}`);const N=toNestedArray(P,g.data.get(o.dataId).values),L=makeZerosNestedTypedArray(s.shape,s.dtype);for(let V=0;V<m;++V)for(let j=0;j<w;++j){const K=j*I-E.top;for(let U=0;U<S;++U){const X=U*A-E.left;for(let J=0;J<c;++J){let Y=Number.MIN_SAFE_INTEGER,te=K<0?0:K,se=X<0?0:X;for(let de=0;de<T;++de){const Se=K+de*C;if(Se>=0&&Se<_)for(let we=0;we<O;++we){const ge=X+we*k;if(ge>=0&&ge<b){const Ie=y[V][Se][ge][J]+a[de][we][J];Ie>Y&&(Y=Ie,te=Se,se=ge)}}}L[V][te][se][J]+=N[V][j][U][J]}}}return{dataId:g.write(toTypedArray(L,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function draw(n){const{inputs:t,backend:r,attrs:s}=n,{image:i}=t,{canvas:o,options:l}=s,{contextOptions:f,imageOptions:u}=l||{},g=(u==null?void 0:u.alpha)||1,y=(f==null?void 0:f.contextType)||"2d";if(y!=="2d")throw new Error(`Context type ${f.contextType} is not supported by the CPU backend.`);const a=o.getContext(y,(f==null?void 0:f.contextAttributes)||{});if(a==null)throw new Error(`Could not get the context with ${y} type.`);const[m,_]=i.shape.slice(0,2),b=i.shape.length===2?1:i.shape[2],c=r.data.get(i.dataId).values,w=i.dtype==="float32"?255:1,S=new Uint8ClampedArray(_*m*4);for(let I=0;I<m*_;++I){const A=[0,0,0,255*g];for(let O=0;O<b;O++){const C=c[I*b+O];if(i.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(i.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);b===1?(A[0]=C*w,A[1]=C*w,A[2]=C*w):A[O]=C*w}const T=I*4;S[T+0]=Math.round(A[0]),S[T+1]=Math.round(A[1]),S[T+2]=Math.round(A[2]),S[T+3]=Math.round(A[3])}o.width=_,o.height=m;const E=new ImageData(S,_,m);return a.putImageData(E,0,0),i}const drawConfig={kernelName:Draw,backendName:"cpu",kernelFunc:draw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sum(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,keepDims:l}=s;assertNotComplex(i,"sum");let f;i.dtype==="bool"?f=cast({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):f=identity({inputs:{x:i},backend:r});const u=f.shape.length,g=parseAxisParam(o,f.shape),y=getAxesPermutation(g,u);let a=g,m=f;y!=null&&(m=transpose({inputs:{x:f},backend:r,attrs:{perm:y}}),a=getInnerMostAxes(a.length,u)),assertAxesAreInnerMostDims("sum",a,m.shape.length);const[_,b]=computeOutAndReduceShapes(m.shape,a),c=upcastType(m.dtype,"int32");let w=zeros(r,_,c);const S=sizeFromShape(b),E=r.data.get(w.dataId).values,I=r.data.get(m.dataId).values;for(let A=0;A<E.length;++A){const T=A*S;let O=0;for(let C=0;C<S;++C)O+=I[T+C];E[A]=O}if(l){const A=expandShapeToKeepDim(w.shape,g),T=w;w=reshape({inputs:{x:w},backend:r,attrs:{shape:A}}),r.disposeIntermediateTensorInfo(T)}return r.disposeIntermediateTensorInfo(f),y!=null&&r.disposeIntermediateTensorInfo(m),w}const sumConfig={kernelName:Sum,backendName:"cpu",kernelFunc:sum};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function einsum(n){const{inputs:t,backend:r,attrs:s}=n,{equation:i}=s,o=t,{allDims:l,summedDims:f,idDims:u}=decodeEinsumEquation(i,o.length);checkEinsumDimSizes(l.length,u,o);const{path:g,steps:y}=getEinsumComputePath(f,u),a=y.length;let m=null,_=l.length;const b=[];for(let c=0;c<a;++c){for(const w of y[c]){const{permutationIndices:S,expandDims:E}=getEinsumPermutation(_,u[w]);let I;isIdentityPermutation(S)?I=o[w]:(I=transpose({inputs:{x:o[w]},backend:r,attrs:{perm:S}}),b.push(I));const A=I.shape.slice();for(let T=0;T<E.length;++T)A.splice(E[T],0,1);arraysEqual(I.shape,A)||(I=reshape({inputs:{x:I},backend:r,attrs:{shape:A}}),b.push(I)),m===null?m=I:(m=multiply({inputs:{a:I,b:m},backend:r}),b.push(m))}c<a-1&&(g[c]>=0&&(m=sum({inputs:{x:m},backend:r,attrs:{axis:g[c]-(l.length-_),keepDims:!1}}),b.push(m)),_--)}for(const c of b)c!==m&&r.disposeIntermediateTensorInfo(c);return m}const einsumConfig={kernelName:Einsum,backendName:"cpu",kernelFunc:einsum};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eluGrad(n){const{inputs:t,backend:r}=n,{dy:s,y:i}=t;assertNotComplex([s,i],"eluGrad");const o=new Float32Array(sizeFromShape(i.shape)),l=r.data.get(i.dataId).values,f=r.data.get(s.dataId).values;for(let u=0;u<l.length;++u){const g=l[u];g>=0?o[u]=f[u]:o[u]=f[u]*(g+1)}return r.makeTensorInfo(i.shape,"float32",o)}const eluGradConfig={kernelName:EluGrad,backendName:"cpu",kernelFunc:eluGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p=ERF_P,a1=ERF_A1,a2=ERF_A2,a3=ERF_A3,a4=ERF_A4,a5=ERF_A5,erf=unaryKernelFunc(Erf,n=>{const t=Math.sign(n),r=Math.abs(n),s=1/(1+p*r);return t*(1-((((a5*s+a4)*s+a3)*s+a2)*s+a1)*s*Math.exp(-r*r))}),erfConfig={kernelName:Erf,backendName:"cpu",kernelFunc:erf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function expandDims(n){const{inputs:t,backend:r,attrs:s}=n,{input:i}=t,{dim:o}=s,l=i.shape.length,f=i.shape.slice();let u=o;return o<0&&(assert(-(l+1)<=o,()=>`Axis must be in the interval [${-(l+1)}, ${l}]`),u=l+o+1),f.splice(u,0,1),reshape({inputs:{x:i},backend:r,attrs:{shape:f}})}const expandDimsConfig={kernelName:ExpandDims,backendName:"cpu",kernelFunc:expandDims};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const realDivImpl=createSimpleBinaryKernelImpl((n,t)=>n/t),div=binaryKernelFunc(RealDiv,realDivImpl),realDivConfig={kernelName:RealDiv,backendName:"cpu",kernelFunc:div};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fftBatch(n,t,r){const s=n.shape,i=s[0],o=s[1],l=r.data.get(n.dataId),f=l.complexTensorInfos.real,u=l.complexTensorInfos.imag,g=[i,o],y=sizeFromShape(g),a=getTypedArrayFromDType("float32",y),m=getTypedArrayFromDType("float32",y);for(let w=0;w<i;w++){const S=slice({inputs:{x:f},backend:r,attrs:{begin:[w,0],size:[1,o]}}),E=slice({inputs:{x:u},backend:r,attrs:{begin:[w,0],size:[1,o]}}),I=complex({inputs:{real:S,imag:E},backend:r}),{real:A,imag:T}=fftImpl(I,t,r),O=mergeRealAndImagArrays(A,T);for(let C=0;C<o;C++){const k=getComplexWithIndex(O,C);a[w*o+C]=k.real,m[w*o+C]=k.imag}r.disposeIntermediateTensorInfo(S),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(I)}const _=r.makeTensorInfo(g,"float32",a),b=r.makeTensorInfo(g,"float32",m),c=complex({inputs:{real:_,imag:b},backend:r});return r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(b),c}function fftImpl(n,t,r){const s=sizeFromShape(n.shape),i=r.data.get(n.dataId),o=r.data.get(i.complexTensorInfos.real.dataId).values,l=r.data.get(i.complexTensorInfos.imag.dataId).values;if(isExponentOf2(s)){const f=fftRadix2(o,l,s,t,r),u=[n.shape[0],n.shape[1]];if(t){const g=r.makeTensorInfo(u,"float32",f.real),y=r.makeTensorInfo(u,"float32",f.imag),a=r.makeTensorInfo([],"float32",createScalarValue(s,"float32")),m=identity({inputs:{x:a},backend:r}),_=realDivConfig.kernelFunc({inputs:{a:g,b:a},backend:r}),b=realDivConfig.kernelFunc({inputs:{a:y,b:m},backend:r}),c=r.data.get(_.dataId).values,w=r.data.get(b.dataId).values;return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(b),{real:c,imag:w}}return f}else{const f=mergeRealAndImagArrays(o,l),u=fourierTransformByMatmul(f,s,t);return splitRealAndImagArrays(u)}}function isExponentOf2(n){return(n&n-1)===0}function fftRadix2(n,t,r,s,i){if(r===1)return{real:n,imag:t};const o=mergeRealAndImagArrays(n,t),l=r/2,f=complexWithEvenIndex(o),u=f.real,g=f.imag,y=[u.length],a=i.makeTensorInfo(y,"float32",u),m=i.makeTensorInfo(y,"float32",g),_=complex({inputs:{real:a,imag:m},backend:i}),b=complexWithOddIndex(o),c=b.real,w=b.imag,S=[c.length],E=i.makeTensorInfo(S,"float32",c),I=i.makeTensorInfo(S,"float32",w),A=complex({inputs:{real:E,imag:I},backend:i}),T=fftRadix2(u,g,l,s,i),O=T.real,C=T.imag,k=[O.length],P=i.makeTensorInfo(k,"float32",O),N=i.makeTensorInfo(k,"float32",C),L=complex({inputs:{real:P,imag:N},backend:i}),F=fftRadix2(c,w,l,s,i),V=F.real,j=F.imag,K=[V.length],U=i.makeTensorInfo(K,"float32",V),X=i.makeTensorInfo(K,"float32",j),J=complex({inputs:{real:U,imag:X},backend:i}),Y=exponents(r,s),te=[Y.real.length],se=i.makeTensorInfo(te,"float32",Y.real),de=i.makeTensorInfo(te,"float32",Y.imag),Se=complex({inputs:{real:se,imag:de},backend:i}),we=multiply({inputs:{a:Se,b:J},backend:i}),ge=add({inputs:{a:L,b:we},backend:i}),Ie=sub({inputs:{a:L,b:we},backend:i}),Te=real({inputs:{input:ge},backend:i}),Ce=real({inputs:{input:Ie},backend:i}),Ae=imag({inputs:{input:ge},backend:i}),Me=imag({inputs:{input:Ie},backend:i}),Re=concat({inputs:[Te,Ce],backend:i,attrs:{axis:0}}),G=concat({inputs:[Ae,Me],backend:i,attrs:{axis:0}}),Q=i.data.get(Re.dataId).values,ie=i.data.get(G.dataId).values;return i.disposeIntermediateTensorInfo(a),i.disposeIntermediateTensorInfo(m),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(A),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo(N),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(J),i.disposeIntermediateTensorInfo(se),i.disposeIntermediateTensorInfo(de),i.disposeIntermediateTensorInfo(Se),i.disposeIntermediateTensorInfo(we),i.disposeIntermediateTensorInfo(ge),i.disposeIntermediateTensorInfo(Ie),i.disposeIntermediateTensorInfo(Te),i.disposeIntermediateTensorInfo(Ae),i.disposeIntermediateTensorInfo(Ce),i.disposeIntermediateTensorInfo(Me),i.disposeIntermediateTensorInfo(Re),i.disposeIntermediateTensorInfo(G),{real:Q,imag:ie}}function fourierTransformByMatmul(n,t,r){const s=new Float32Array(t*2);for(let i=0;i<t;i++){let o=0,l=0;for(let f=0;f<t;f++){const u=exponent(i*f,t,r),g=getComplexWithIndex(n,f);o+=g.real*u.real-g.imag*u.imag,l+=g.real*u.imag+g.imag*u.real}r&&(o/=t,l/=t),assignToTypedArray(s,o,l,i)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fft(n){const{inputs:t,backend:r}=n,{input:s}=t,i=sizeFromShape(s.shape),o=s.shape[s.shape.length-1],l=i/o,f=reshape({inputs:{x:s},backend:r,attrs:{shape:[l,o]}}),u=fftBatch(f,!1,r),g=reshape({inputs:{x:u},backend:r,attrs:{shape:s.shape}});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(u),g}const fftConfig={kernelName:FFT,backendName:"cpu",kernelFunc:fft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fill(n){const{backend:t,attrs:r}=n,{shape:s,value:i,dtype:o}=r,l=o||inferDtype(i),f=getArrayFromDType(l,sizeFromShape(s));return fillValues(f,i,l),t.makeTensorInfo(s,l,f)}const fillConfig={kernelName:Fill,backendName:"cpu",kernelFunc:fill};function fillValues(n,t,r){n.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const flipLeftRightConfig={kernelName:FlipLeftRight,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:r})=>{const{image:s}=n,i=r,o=getTypedArrayFromDType(s.dtype,sizeFromShape(s.shape)),[l,f,u,g]=s.shape,y=i.data.get(s.dataId).values;for(let m=0;m<l;m++){const _=m*u*f*g;for(let b=0;b<f;b++){const c=b*(u*g);for(let w=0;w<u;w++){const S=w*g;for(let E=0;E<g;E++){const I=Math.round(u-w-1),A=_+c+S+E;let T=y[A];if(I>=0&&I<u){const O=I*g,C=_+c+O+E;T=y[C]}o[A]=T}}}}return{dataId:i.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fusedConv2D(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,filter:o,bias:l,preluActivationWeights:f}=t,{strides:u,pad:g,dataFormat:y,dilations:a,dimRoundingMode:m,activation:_,leakyreluAlpha:b}=s;let c=conv2D({inputs:{x:i,filter:o},backend:r,attrs:{strides:u,pad:g,dataFormat:y,dilations:a,dimRoundingMode:m}});if(l){const w=c;if(y==="NCHW"&&l.shape.length===1&&l.shape[0]!==1){const S=reshape({inputs:{x:l},backend:r,attrs:{shape:[l.shape[0],1,1]}});c=add({inputs:{a:c,b:S},backend:r}),r.disposeIntermediateTensorInfo(S)}else c=add({inputs:{a:c,b:l},backend:r});r.disposeIntermediateTensorInfo(w)}if(_){const w=c;if(y==="NCHW"&&_==="prelu"&&f.shape.length===1&&f.shape[0]!==1){const S=reshape({inputs:{x:f},backend:r,attrs:{shape:[f.shape[0],1,1]}});c=applyActivation(r,c,_,S,b),r.disposeIntermediateTensorInfo(S)}else c=applyActivation(r,c,_,f,b);r.disposeIntermediateTensorInfo(w)}return c}const fusedConv2DConfig={kernelName:FusedConv2D,backendName:"cpu",kernelFunc:fusedConv2D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fusedDepthwiseConv2D(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,filter:o,bias:l,preluActivationWeights:f}=t,{strides:u,pad:g,dataFormat:y,dilations:a,dimRoundingMode:m,activation:_,leakyreluAlpha:b}=s;let c=depthwiseConv2dNative({inputs:{x:i,filter:o},backend:r,attrs:{strides:u,pad:g,dataFormat:y,dilations:a,dimRoundingMode:m}});if(l){const w=c;c=add({inputs:{a:c,b:l},backend:r}),r.disposeIntermediateTensorInfo(w)}if(_){const w=c;c=applyActivation(r,c,_,f,b),r.disposeIntermediateTensorInfo(w)}return c}const fusedDepthwiseConv2DConfig={kernelName:FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:fusedDepthwiseConv2D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gatherNd(n){const{inputs:t,backend:r}=n,{params:s,indices:i}=t,o=sizeFromShape(s.shape),l=i.shape,f=l[l.length-1],[u,g,y,a]=prepareAndValidate(s,i);if(g===0)return r.makeTensorInfo(u,s.dtype,[]);const m=r.data.get(i.dataId).values,_=r.bufferSync(s),b=gatherNdImpl(m,_,s.dtype,g,f,y,a,s.shape,o);return r.makeTensorInfo(u,s.dtype,b.values)}const gatherNdConfig={kernelName:GatherNd,backendName:"cpu",kernelFunc:gatherNd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gatherV2(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,indices:o}=t,{axis:l,batchDims:f}=s;assertNotComplex([i,o],"gatherV2");const u=parseAxisParam(l,i.shape)[0],g=r.data.get(o.dataId).values,y=i.shape[u];for(let A=0;A<g.length;++A){const T=g[A];assert(T<=y-1&&T>=0,()=>`GatherV2: the index value ${T} is not in [0, ${y-1}]`)}let a=f;f==null&&(a=0);const m=sizeFromShape(o.shape),_=collectGatherOpShapeInfo(i,o,u,a),b=reshape({inputs:{x:i},backend:r,attrs:{shape:[_.batchSize,_.outerSize,_.dimSize,_.sliceSize]}}),c=reshape({inputs:{x:o},backend:r,attrs:{shape:[_.batchSize,m/_.batchSize]}}),w=[_.batchSize,_.outerSize,m/_.batchSize,_.sliceSize],S=r.bufferSync(c),E=r.bufferSync(b),I=gatherV2Impl(E,S,w);return r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(c),r.makeTensorInfo(_.outputShape,I.dtype,I.values)}const gatherV2Config={kernelName:GatherV2,backendName:"cpu",kernelFunc:gatherV2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ifft(n){const{inputs:t,backend:r}=n,{input:s}=t,i=sizeFromShape(s.shape),o=s.shape[s.shape.length-1],l=i/o,f=reshape({inputs:{x:s},backend:r,attrs:{shape:[l,o]}}),u=fftBatch(f,!0,r),g=reshape({inputs:{x:u},backend:r,attrs:{shape:s.shape}});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(u),g}const ifftConfig={kernelName:IFFT,backendName:"cpu",kernelFunc:ifft};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const isFinite$1=unaryKernelFunc(IsFinite,n=>Number.isFinite(n)?1:0,"bool"),isFiniteConfig={kernelName:IsFinite,backendName:"cpu",kernelFunc:isFinite$1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const isInf=unaryKernelFunc(IsInf,n=>Math.abs(n)===1/0?1:0,"bool"),isInfConfig={kernelName:IsInf,backendName:"cpu",kernelFunc:isInf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const isNaN$1=unaryKernelFunc(IsNan,n=>Number.isNaN(n)?1:0,"bool"),isNaNConfig={kernelName:IsNan,backendName:"cpu",kernelFunc:isNaN$1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function linSpace(n){const{backend:t,attrs:r}=n,{start:s,stop:i,num:o}=r,l=linSpaceImpl(s,i,o);return t.makeTensorInfo([l.length],"float32",l)}const linSpaceConfig={kernelName:LinSpace,backendName:"cpu",kernelFunc:linSpace};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const log1p=unaryKernelFunc(Log1p,n=>Math.log1p(n)),log1pConfig={kernelName:Log1p,backendName:"cpu",kernelFunc:log1p};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const logicalAndImpl=createSimpleBinaryKernelImpl((n,t)=>n&&t),logicalAnd=binaryKernelFunc(LogicalAnd,logicalAndImpl,null,"bool"),logicalAndConfig={kernelName:LogicalAnd,backendName:"cpu",kernelFunc:logicalAnd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const logicalNot=unaryKernelFunc(LogicalNot,n=>n?0:1,"bool"),logicalNotConfig={kernelName:LogicalNot,backendName:"cpu",kernelFunc:logicalNot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const logicalOrImpl=createSimpleBinaryKernelImpl((n,t)=>n||t),logicalOr=binaryKernelFunc(LogicalOr,logicalOrImpl,null,"bool"),logicalOrConfig={kernelName:LogicalOr,backendName:"cpu",kernelFunc:logicalOr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lRN(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{depthRadius:o,bias:l,alpha:f,beta:u}=s;assertNotComplex(i,"LRN");const g=i.shape[3],y=g-1,a=r.data.get(i.dataId).values,m=sizeFromShape(i.shape),_=new Float32Array(m);function b(c){const w=c%g;let S=c-w+Math.max(0,w-o);const E=c-w+Math.min(w+o,y);let I=0;for(;S<=E;S++){const A=a[S];I+=A*A}return I}for(let c=0;c<m;c++){const w=b(c),S=a[c]*Math.pow(l+f*w,-u);_[c]=S}return r.makeTensorInfo(i.shape,i.dtype,_)}const LRNConfig={kernelName:LRN,backendName:"cpu",kernelFunc:lRN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lRNGrad(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,y:o,dy:l}=t,{depthRadius:f,bias:u,alpha:g,beta:y}=s;assertNotComplex(l,"LRNGrad");const a=sizeFromShape(l.shape),m=l.shape[3],_=r.data.get(l.dataId).values,b=r.data.get(i.dataId).values,c=r.data.get(o.dataId).values,w=new Float32Array(a),S=a;for(let E=0;E<S;E++){const I=E%m,A=E-I+Math.max(0,I-f),T=E-I+Math.min(m,I+f+1);let O=0;for(let C=A;C<T;C++)O+=Math.pow(b[C],2);O=g*O+u;for(let C=A;C<T;C++){let k=-2*g*y*b[C]*c[E]/O;E===C&&(k+=Math.pow(O,-y)),k*=_[E],w[C]+=k}}return r.makeTensorInfo(l.shape,i.dtype,w)}const LRNGradConfig={kernelName:LRNGrad,backendName:"cpu",kernelFunc:lRNGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function max(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{reductionIndices:o,keepDims:l}=s,f=r;let u=i.shape;const g=u.length,y=parseAxisParam(o,u);let a=y;const m=getAxesPermutation(a,g);let _=f.data.get(i.dataId).values;if(m!=null){const A=new Array(g);for(let T=0;T<A.length;T++)A[T]=u[m[T]];_=transposeImpl(_,u,i.dtype,m,A),a=getInnerMostAxes(a.length,g),u=A}assertNotComplex(i,"max"),assertAxesAreInnerMostDims("max",a,g);const[b,c]=computeOutAndReduceShapes(u,a),w=sizeFromShape(c),S=maxImpl(_,w,b,i.dtype),E=f.write(S,b,i.dtype);let I=b;return l&&(I=expandShapeToKeepDim(b,y)),{dataId:E,shape:I,dtype:i.dtype}}const maxConfig={kernelName:Max,backendName:"cpu",kernelFunc:max};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function maxPool(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t;assertNotComplex(i,"maxPool");const{filterSize:o,strides:l,pad:f,dimRoundingMode:u}=s,g=1;assert(eitherStridesOrDilationsAreOne(l,g),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=computePool2DInfo(i.shape,o,l,g,f,u);let a;if(y.filterWidth===1&&y.filterHeight===1&&arraysEqual(y.inShape,y.outShape))a=identity({inputs:{x:i},backend:r});else{const m=r.data.get(i.dataId).values,_=computeStrides(i.shape),b=pool(m,i.shape,i.dtype,_,y,"max");a=r.makeTensorInfo(y.outShape,i.dtype,b.values)}return a}const maxPoolConfig={kernelName:MaxPool,backendName:"cpu",kernelFunc:maxPool};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function maxPool3D(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{filterSize:o,strides:l,pad:f,dimRoundingMode:u,dataFormat:g}=s;assertNotComplex(i,"maxPool3d");const y=computePool3DInfo(i.shape,o,l,1,f,u,g),a=r.data.get(i.dataId).values,m=pool3d(a,i.shape,i.dtype,computeStrides(i.shape),y,"max");return r.makeTensorInfo(m.shape,"float32",m.values)}const maxPool3DConfig={kernelName:MaxPool3D,backendName:"cpu",kernelFunc:maxPool3D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function maxPool3DGrad(n){const{inputs:t,backend:r,attrs:s}=n,{dy:i,input:o}=t,{filterSize:l,strides:f,pad:u,dimRoundingMode:g}=s;assertNotComplex([i,o],"maxPool3DGrad");const y=computePool3DInfo(o.shape,l,f,1,u,g),a=r.bufferSync(o),m=maxPool3dPositions(a,y),_=y.strideDepth,b=y.strideHeight,c=y.strideWidth,w=y.dilationDepth,S=y.dilationHeight,E=y.dilationWidth,I=y.effectiveFilterDepth,A=y.effectiveFilterHeight,T=y.effectiveFilterWidth,O=I-1-y.padInfo.front,C=T-1-y.padInfo.left,k=A-1-y.padInfo.top,P=buffer(o.shape,"float32"),N=r.bufferSync(i);for(let L=0;L<y.batchSize;++L)for(let F=0;F<y.inChannels;++F)for(let V=0;V<y.inDepth;++V)for(let j=0;j<y.inHeight;++j)for(let K=0;K<y.inWidth;++K){const U=V-O,X=j-k,J=K-C;let Y=0;for(let te=0;te<I;te+=w){const se=(U+te)/_;if(!(se<0||se>=y.outDepth||Math.floor(se)!==se))for(let de=0;de<A;de+=S){const Se=(X+de)/b;if(!(Se<0||Se>=y.outHeight||Math.floor(Se)!==Se))for(let we=0;we<T;we+=E){const ge=(J+we)/c;if(ge<0||ge>=y.outWidth||Math.floor(ge)!==ge)continue;const Ie=I*A*T-1-m.get(L,se,Se,ge,F),Te=te*A*T+de*T+we,Ce=Ie===Te?1:0;if(Ce===0)continue;const Ae=N.get(L,se,Se,ge,F);Y+=Ae*Ce}}}P.set(Y,L,V,j,K,F)}return r.makeTensorInfo(P.shape,P.dtype,P.values)}const maxPool3DGradConfig={kernelName:MaxPool3DGrad,backendName:"cpu",kernelFunc:maxPool3DGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function maxPoolGrad(n){const{inputs:t,backend:r,attrs:s}=n,{dy:i,input:o,output:l}=t,f=o;assertNotComplex([o,l],"maxPoolGrad");const{filterSize:u,strides:g,pad:y,dimRoundingMode:a}=s,m=computePool2DInfo(f.shape,u,g,1,y,a),_=r.data.get(f.dataId).values,b=buffer(m.outShape,f.dtype,maxPoolPositions(_,f.shape,f.dtype,m).values),c=m.strideHeight,w=m.strideWidth,S=m.dilationHeight,E=m.dilationWidth,I=m.effectiveFilterHeight,A=m.effectiveFilterWidth,T=A-1-m.padInfo.left,O=I-1-m.padInfo.top,C=buffer(f.shape,"float32"),k=r.data.get(i.dataId).values,P=buffer(i.shape,"float32",k);for(let N=0;N<m.batchSize;++N)for(let L=0;L<m.inChannels;++L)for(let F=0;F<m.inHeight;++F)for(let V=0;V<m.inWidth;++V){const j=F-O,K=V-T;let U=0;for(let X=0;X<I;X+=S){const J=(j+X)/c;if(!(J<0||J>=m.outHeight||Math.floor(J)!==J))for(let Y=0;Y<A;Y+=E){const te=(K+Y)/w;if(te<0||te>=m.outWidth||Math.floor(te)!==te)continue;const se=I*A-1-b.get(N,J,te,L),de=X*A+Y,Se=se===de?1:0;if(Se===0)continue;const we=P.get(N,J,te,L);U+=we*Se}}C.set(U,N,F,V,L)}return r.makeTensorInfo(C.shape,C.dtype,C.values)}const maxPoolGradConfig={kernelName:MaxPoolGrad,backendName:"cpu",kernelFunc:maxPoolGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function maxPoolWithArgmaxImpl(n,t,r,s,i){const o=computeStrides(t),l=pool(n,t,r,o,i,"max"),f=maxPoolPositions(n,t,r,i,!0,s);return[l.values,f.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const maxPoolWithArgmaxConfig={kernelName:MaxPoolWithArgmax,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:r})=>{const{x:s}=n,{filterSize:i,strides:o,pad:l,includeBatchInIndex:f}=t,u=r;assertNotComplex(s,"MaxPoolWithArgmax");const g=u.data.get(s.dataId).values,y=computePool2DInfo(s.shape,i,o,[1,1],l),[a,m]=maxPoolWithArgmaxImpl(g,s.shape,s.dtype,f,y),_=u.write(a,y.outShape,s.dtype),b=u.write(m,y.outShape,s.dtype);return[{dataId:_,shape:y.outShape,dtype:s.dtype},{dataId:b,shape:y.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mean(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,keepDims:l}=s,f=parseAxisParam(o,i.shape),g=computeOutAndReduceShapes(i.shape,f)[1],y=sizeFromShape(g),a=[],m=r.makeTensorInfo([],"float32",new Float32Array([y]));a.push(m);const _=cast({inputs:{x:i},backend:r,attrs:{dtype:"float32"}});a.push(_);const b=div({inputs:{a:_,b:m},backend:r});a.push(b);const c=sum({inputs:{x:b},backend:r,attrs:{axis:o,keepDims:l}});return a.forEach(w=>r.disposeIntermediateTensorInfo(w)),c}const meanConfig={kernelName:Mean,backendName:"cpu",kernelFunc:mean};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function min(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{axis:o,keepDims:l}=s;assertNotComplex(i,"min");const f=parseAxisParam(o,i.shape);let u=f;const g=getAxesPermutation(u,i.shape.length);let y=i;g!=null&&(y=transpose({inputs:{x:i},backend:r,attrs:{perm:g}}),u=getInnerMostAxes(u.length,i.shape.length)),assertAxesAreInnerMostDims("min",u,y.shape.length);const[a,m]=computeOutAndReduceShapes(y.shape,u),_=sizeFromShape(m),b=makeZerosTypedArray(sizeFromShape(a),y.dtype),c=r.data.get(y.dataId).values;for(let S=0;S<b.length;++S){const E=S*_;let I=c[E];for(let A=0;A<_;++A){const T=c[E+A];(Number.isNaN(T)||T<I)&&(I=T)}b[S]=I}g!=null&&r.disposeIntermediateTensorInfo(y);const w=r.makeTensorInfo(a,y.dtype,b);if(l){const S=expandShapeToKeepDim(a,f),E=reshape({inputs:{x:w},backend:r,attrs:{shape:S}});return r.disposeIntermediateTensorInfo(w),E}return w}const minConfig={kernelName:Min,backendName:"cpu",kernelFunc:min};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mirrorPad(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{paddings:o,mode:l}=s;assertNotComplex(i,"mirrorPad");const f=o.map((I,A)=>I[0]+i.shape[A]+I[1]),u=o.map(I=>I[0]),g=o.map((I,A)=>I[0]+i.shape[A]),y=l==="reflect"?0:1,a=r.data.get(i.dataId).values,m=i.shape.length,_=computeStrides(i.shape),b=sizeFromShape(f),c=f.length,w=computeStrides(f),S=getTypedArrayFromDType(i.dtype,b);for(let I=0;I<b;I++){let A=indexToLoc(I,c,w);for(let O=0;O<c;O++)A[O]<u[O]?A[O]=u[O]*2-A[O]-y:A[O]>=g[O]&&(A[O]=(g[O]-1)*2-A[O]+y);A=A.map((O,C)=>O-u[C]);const T=locToIndex(A,m,_);S[I]=a[T]}return{dataId:r.write(S,f,i.dtype),shape:f,dtype:i.dtype}}const mirrorPadConfig={kernelName:MirrorPad,backendName:"cpu",kernelFunc:mirrorPad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const modImpl=createSimpleBinaryKernelImpl((n,t)=>{const r=n%t;return n<0&&t<0||n>=0&&t>=0?r:(r+t)%t}),mod=binaryKernelFunc(Mod,modImpl),modConfig={kernelName:Mod,backendName:"cpu",kernelFunc:mod};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function softmax(n){const{inputs:t,backend:r,attrs:s}=n,{logits:i}=t,{dim:o}=s,l=i.shape.length;let f=o;if(f===-1&&(f=l-1),f!==l-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${l} and dim was ${f}`);const u=parseAxisParam([f],i.shape),g=max({inputs:{x:i},backend:r,attrs:{reductionIndices:u,keepDims:!1}}),y=expandShapeToKeepDim(g.shape,u),a=reshape({inputs:{x:g},backend:r,attrs:{shape:y}}),m=sub({inputs:{a:i,b:a},backend:r}),_=exp({inputs:{x:m},backend:r}),b=sum({inputs:{x:_},backend:r,attrs:{axis:u,keepDims:!1}}),c=reshape({inputs:{x:b},backend:r,attrs:{shape:y}}),w=div({inputs:{a:_,b:c},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(c),w}const softmaxConfig={kernelName:Softmax,backendName:"cpu",kernelFunc:softmax};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function multinomial(n){const{inputs:t,backend:r,attrs:s}=n,{logits:i}=t,{numSamples:o,seed:l,normalized:f}=s;assertNotComplex(i,"multinomial");const u=f?i:softmax({inputs:{logits:i},backend:r,attrs:{dim:-1}}),g=u.shape[0],y=u.shape[1],a=r.data.get(u.dataId).values,m=[g,o],_=makeZerosTypedArray(sizeFromShape(m),"int32");for(let b=0;b<g;++b){const c=b*y,w=new Float32Array(y-1);w[0]=a[c];for(let I=1;I<w.length;++I)w[I]=w[I-1]+a[c+I];const S=seedrandom.alea(l.toString()),E=b*o;for(let I=0;I<o;++I){const A=S();_[E+I]=w.length;for(let T=0;T<w.length;T++)if(A<w[T]){_[E+I]=T;break}}}return f||r.disposeIntermediateTensorInfo(u),r.makeTensorInfo(m,"int32",_)}const multinomialConfig={kernelName:Multinomial,backendName:"cpu",kernelFunc:multinomial};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nonMaxSuppressionV3Impl=nonMaxSuppressionV3Impl$1;function nonMaxSuppressionV3(n){const{inputs:t,backend:r,attrs:s}=n,{boxes:i,scores:o}=t,{maxOutputSize:l,iouThreshold:f,scoreThreshold:u}=s;assertNotComplex(i,"NonMaxSuppression");const g=r.data.get(i.dataId).values,y=r.data.get(o.dataId).values,{selectedIndices:a}=nonMaxSuppressionV3Impl(g,y,l,f,u);return r.makeTensorInfo([a.length],"int32",new Int32Array(a))}const nonMaxSuppressionV3Config={kernelName:NonMaxSuppressionV3,backendName:"cpu",kernelFunc:nonMaxSuppressionV3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nonMaxSuppressionV4Impl=nonMaxSuppressionV4Impl$1;function nonMaxSuppressionV4(n){const{inputs:t,backend:r,attrs:s}=n,{boxes:i,scores:o}=t,{maxOutputSize:l,iouThreshold:f,scoreThreshold:u,padToMaxOutputSize:g}=s;assertNotComplex(i,"NonMaxSuppressionPadded");const y=r.data.get(i.dataId).values,a=r.data.get(o.dataId).values,{selectedIndices:m,validOutputs:_}=nonMaxSuppressionV4Impl(y,a,l,f,u,g);return[r.makeTensorInfo([m.length],"int32",new Int32Array(m)),r.makeTensorInfo([],"int32",new Int32Array([_]))]}const nonMaxSuppressionV4Config={kernelName:NonMaxSuppressionV4,backendName:"cpu",kernelFunc:nonMaxSuppressionV4};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nonMaxSuppressionV5Impl=nonMaxSuppressionV5Impl$1;function nonMaxSuppressionV5(n){const{inputs:t,backend:r,attrs:s}=n,{boxes:i,scores:o}=t,{maxOutputSize:l,iouThreshold:f,scoreThreshold:u,softNmsSigma:g}=s;assertNotComplex(i,"NonMaxSuppressionWithScore");const y=r.data.get(i.dataId).values,a=r.data.get(o.dataId).values,m=l,_=f,b=u,c=g,{selectedIndices:w,selectedScores:S}=nonMaxSuppressionV5Impl(y,a,m,_,b,c);return[r.makeTensorInfo([w.length],"int32",new Int32Array(w)),r.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const nonMaxSuppressionV5Config={kernelName:NonMaxSuppressionV5,backendName:"cpu",kernelFunc:nonMaxSuppressionV5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oneHot(n){const{inputs:t,backend:r,attrs:s}=n,{indices:i}=t,{dtype:o,depth:l,onValue:f,offValue:u}=s;assertNotComplex(i,"oneHot");const g=sizeFromShape(i.shape),y=new Float32Array(g*l);y.fill(u);const a=r.data.get(i.dataId).values;for(let m=0;m<g;++m)a[m]>=0&&a[m]<l&&(y[m*l+a[m]]=f);return r.makeTensorInfo([...i.shape,l],o,y)}const oneHotConfig={kernelName:OneHot,backendName:"cpu",kernelFunc:oneHot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zerosLike(n){const{inputs:t,backend:r}=n,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const i=real({inputs:{input:s},backend:r}),o=zerosLike({inputs:{x:i},backend:r}),l=imag({inputs:{input:s},backend:r}),f=zerosLike({inputs:{x:l},backend:r}),u=complex({inputs:{real:o,imag:f},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),r.disposeIntermediateTensorInfo(f),u}else return fill({backend:r,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const zerosLikeConfig={kernelName:ZerosLike,backendName:"cpu",kernelFunc:zerosLike};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function onesLike(n){const{inputs:t,backend:r}=n,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const i=real({inputs:{input:s},backend:r}),o=onesLike({inputs:{x:i},backend:r}),l=imag({inputs:{input:s},backend:r}),f=zerosLike({inputs:{x:l},backend:r}),u=complex({inputs:{real:o,imag:f},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),r.disposeIntermediateTensorInfo(f),u}else return fill({backend:r,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const onesLikeConfig={kernelName:OnesLike,backendName:"cpu",kernelFunc:onesLike};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pack(n){const{inputs:t,backend:r,attrs:s}=n,{axis:i}=s;if(t.length===1)return expandDims({inputs:{input:t[0]},backend:r,attrs:{dim:i}});const o=t[0].shape,l=t[0].dtype;t.forEach(y=>{assertShapesMatch(o,y.shape,"All tensors passed to stack must have matching shapes"),assert(l===y.dtype,()=>"All tensors passed to stack must have matching dtypes")});const f=[],u=t.map(y=>{const a=expandDims({inputs:{input:y},backend:r,attrs:{dim:i}});return f.push(a),a}),g=concat({inputs:u,backend:r,attrs:{axis:i}});return f.forEach(y=>r.disposeIntermediateTensorInfo(y)),g}const packConfig={kernelName:Pack,backendName:"cpu",kernelFunc:pack};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function padV2(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{paddings:o,constantValue:l}=s;assertNotComplex(i,"pad");const f=o.map((E,I)=>E[0]+i.shape[I]+E[1]),u=o.map(E=>E[0]),g=r.data.get(i.dataId).values,y=sizeFromShape(i.shape),a=i.shape.length,m=computeStrides(i.shape),_=sizeFromShape(f),b=f.length,c=computeStrides(f),w=getTypedArrayFromDType(i.dtype,_);l!==0&&w.fill(l);for(let E=0;E<y;E++){const A=indexToLoc(E,a,m).map((O,C)=>O+u[C]),T=locToIndex(A,b,c);w[T]=g[E]}return{dataId:r.write(w,f,i.dtype),shape:f,dtype:i.dtype}}const padV2Config={kernelName:PadV2,backendName:"cpu",kernelFunc:padV2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const powImpl=createSimpleBinaryKernelImpl((n,t)=>Math.pow(n,t)),pow=binaryKernelFunc(Pow,powImpl),powConfig={kernelName:Pow,backendName:"cpu",kernelFunc:pow};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function raggedGather(n){const{inputs:t,backend:r,attrs:s}=n,{paramsNestedSplits:i,paramsDenseValues:o,indices:l}=t,f=i.map(w=>r.data.get(w.dataId).values),u=i.map(w=>w.shape),g=r.data.get(o.dataId).values,y=r.data.get(l.dataId).values,[a,m,_]=raggedGatherImpl(f,u,g,o.shape,o.dtype,y,l.shape),b=a.map(w=>r.makeTensorInfo([w.length],"int32",w)),c=r.makeTensorInfo(_,o.dtype,m);return b.concat([c])}const raggedGatherConfig={kernelName:RaggedGather,backendName:"cpu",kernelFunc:raggedGather};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function raggedRange(n){const{inputs:t,backend:r}=n,{starts:s,limits:i,deltas:o}=t,l=r.data.get(s.dataId).values,f=r.data.get(i.dataId).values,u=r.data.get(o.dataId).values,[g,y]=raggedRangeImpl(l,s.shape,s.dtype,f,i.shape,u,o.shape),a=r.makeTensorInfo([g.length],"int32",g),m=r.makeTensorInfo([y.length],s.dtype,y);return[a,m]}const raggedRangeConfig={kernelName:RaggedRange,backendName:"cpu",kernelFunc:raggedRange};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function raggedTensorToTensor(n){const{inputs:t,backend:r,attrs:s}=n,{shape:i,values:o,defaultValue:l,rowPartitionTensors:f}=t,{rowPartitionTypes:u}=s,g=r.data.get(i.dataId).values,y=r.data.get(o.dataId).values,a=r.data.get(l.dataId).values,m=f.map(w=>r.data.get(w.dataId).values),_=f.map(w=>w.shape),[b,c]=raggedTensorToTensorImpl(g,i.shape,y,o.shape,o.dtype,a,l.shape,m,_,u);return r.makeTensorInfo(b,o.dtype,c)}const raggedTensorToTensorConfig={kernelName:RaggedTensorToTensor,backendName:"cpu",kernelFunc:raggedTensorToTensor};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function range(n){const{backend:t,attrs:r}=n,{start:s,stop:i,dtype:o,step:l}=r,f=rangeImpl(s,i,l,o);return t.makeTensorInfo([f.length],o,f)}const rangeConfig={kernelName:Range,backendName:"cpu",kernelFunc:range};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const reciprocal=unaryKernelFunc(Reciprocal,n=>1/n),reciprocalConfig={kernelName:Reciprocal,backendName:"cpu",kernelFunc:reciprocal};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function resizeBilinear(n){const{inputs:t,backend:r,attrs:s}=n,{images:i}=t,{alignCorners:o,halfPixelCenters:l,size:f}=s;assertNotComplex(i,"resizeBilinear");const u=computeStrides(i.shape),[g,y]=f,[a,m,_,b]=i.shape,c=r.data.get(i.dataId).values,w=new Float32Array(sizeFromShape([a,g,y,b])),S=[o&&g>1?m-1:m,o&&y>1?_-1:_],E=[o&&g>1?g-1:g,o&&y>1?y-1:y];let I=0;const A=S[0]/E[0],T=S[1]/E[1];for(let O=0;O<a;O++)for(let C=0;C<g;C++){let k;l?k=A*(C+.5)-.5:k=A*C;const P=Math.max(0,Math.floor(k)),N=k-P,L=Math.min(m-1,Math.ceil(k)),F=O*u[0]+P*u[1],V=O*u[0]+L*u[1];for(let j=0;j<y;j++){let K;l?K=T*(j+.5)-.5:K=T*j;const U=Math.max(0,Math.floor(K)),X=K-U,J=Math.min(_-1,Math.ceil(K)),Y=F+U*u[2],te=V+U*u[2],se=F+J*u[2],de=V+J*u[2];for(let Se=0;Se<b;Se++){const we=c[Y+Se],ge=c[te+Se],Ie=c[se+Se],Te=c[de+Se],Ce=we+(Ie-we)*X,Ae=ge+(Te-ge)*X,Me=Ce+(Ae-Ce)*N;w[I++]=Me}}}return r.makeTensorInfo([a,g,y,b],"float32",w)}const resizeBilinearConfig={kernelName:ResizeBilinear,backendName:"cpu",kernelFunc:resizeBilinear};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function resizeBilinearGrad(n){const{inputs:t,backend:r,attrs:s}=n,{images:i,dy:o}=t,{alignCorners:l}=s;assertNotComplex([o,i],"resizeBilinearGrad");const f=computeStrides(i.shape),[u,g,y,a]=i.shape,[,m,_]=o.shape,b=new Float32Array(u*g*y*a),c=[l&&m>1?g-1:g,l&&_>1?y-1:y],w=[l&&m>1?m-1:m,l&&_>1?_-1:_],S=c[0]/w[0],E=c[1]/w[1],I=r.data.get(o.dataId).values;let A=0;for(let T=0;T<u;T++){const O=T*f[0];for(let C=0;C<m;C++){const k=C*S,P=Math.floor(k),N=Math.min(Math.ceil(k),g-1),L=O+P*f[1],F=O+N*f[1],V=k-P,j=1-V;for(let K=0;K<_;K++){const U=K*E,X=Math.floor(U),J=Math.min(Math.ceil(U),y-1),Y=U-X,te=1-Y,se=L+X*f[2],de=L+J*f[2],Se=F+X*f[2],we=F+J*f[2],ge=j*te,Ie=j*Y,Te=V*te,Ce=V*Y;for(let Ae=0;Ae<a;Ae++){const Me=I[A++];b[se+Ae]+=Me*ge,b[de+Ae]+=Me*Ie,b[Se+Ae]+=Me*Te,b[we+Ae]+=Me*Ce}}}}return r.makeTensorInfo([u,y,g,a],"float32",b)}const resizeBilinearGradConfig={kernelName:ResizeBilinearGrad,backendName:"cpu",kernelFunc:resizeBilinearGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function resizeNearestNeighbor(n){const{inputs:t,backend:r,attrs:s}=n,{images:i}=t,{alignCorners:o,halfPixelCenters:l,size:f}=s;assertNotComplex(i,"resizeNearestNeighbor");const u=computeStrides(i.shape),[g,y]=f,[a,m,_,b]=i.shape,c=r.data.get(i.dataId).values,w=new Float32Array(a*g*y*b),S=[o&&g>1?m-1:m,o&&y>1?_-1:_],E=[o&&g>1?g-1:g,o&&y>1?y-1:y],I=S[0]/E[0],A=S[1]/E[1];let T=0;for(let O=0;O<a;O++){const C=O*u[0];for(let k=0;k<g;k++){const P=l?I*(k+.5):I*k;let N=Math.min(m-1,o?Math.round(P):Math.floor(P));l&&(N=Math.max(0,N));const L=C+N*u[1];for(let F=0;F<y;F++){const V=l?A*(F+.5):A*F;let j=Math.min(_-1,o?Math.round(V):Math.floor(V));l&&(j=Math.max(0,j));const K=L+j*u[2];for(let U=0;U<b;U++){const X=c[K+U];w[T++]=X}}}}return r.makeTensorInfo([a,g,y,b],i.dtype,w)}const resizeNearestNeighborConfig={kernelName:ResizeNearestNeighbor,backendName:"cpu",kernelFunc:resizeNearestNeighbor};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function resizeNearestNeighborGrad(n){const{inputs:t,backend:r,attrs:s}=n,{images:i,dy:o}=t,{alignCorners:l}=s;assertNotComplex([o,i],"resizeNearestNeighborGrad");const f=computeStrides(i.shape),u=computeStrides(o.shape),[g,y,a,m]=i.shape,[,_,b]=o.shape,c=new Float32Array(g*y*a*m),w=r.data.get(o.dataId).values,S=[l&&_>1?y-1:y,l&&b>1?a-1:a],E=[l&&_>1?_-1:_,l&&b>1?b-1:b],I=S[0]/E[0],A=S[1]/E[1],T=1/I,O=1/A,C=Math.ceil(T)*2+2,k=Math.ceil(O)*2+2;for(let P=0;P<g;P++){const N=P*f[0];for(let L=0;L<y;L++){const F=N+L*f[1],V=Math.floor(L*T),j=Math.floor(V-C/2);for(let K=0;K<a;K++){const U=F+K*f[2],X=Math.floor(K*O),J=Math.floor(X-k/2);for(let Y=0;Y<m;Y++){let te=0;for(let se=0;se<C;se++){const de=se+j;if(de<0||de>=_)continue;const Se=N+de*u[1],we=de*I,ge=Math.min(y-1,l?Math.round(we):Math.floor(we));if(L===ge)for(let Ie=0;Ie<k;Ie++){const Te=Ie+J;if(Te<0||Te>=b)continue;const Ce=Se+Te*u[2],Ae=Te*A,Me=Math.min(a-1,l?Math.round(Ae):Math.floor(Ae));K===Me&&(te+=w[Ce+Y])}}c[U+Y]=te}}}}return r.makeTensorInfo(i.shape,i.dtype,c)}const resizeNearestNeighborGradConfig={kernelName:ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:resizeNearestNeighborGrad};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function reverse(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{dims:o}=s;assertNotComplex(i,"reverse");const l=i.shape.length,f=parseAxisParam(o,i.shape);if(l===0)return identity({inputs:{x:i},backend:r});const u=new TensorBuffer(i.shape,i.dtype),g=r.bufferSync(i);for(let y=0;y<u.size;y++){const a=u.indexToLoc(y),m=a.slice();f.forEach(_=>m[_]=i.shape[_]-1-m[_]),u.set(g.get(...m),...a)}return r.makeTensorInfo(u.shape,u.dtype,u.values)}const reverseConfig={kernelName:Reverse,backendName:"cpu",kernelFunc:reverse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rotateWithOffsetConfig={kernelName:RotateWithOffset,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:r})=>{const{image:s}=n,{radians:i,fillValue:o,center:l}=t,f=r,u=getTypedArrayFromDType(s.dtype,sizeFromShape(s.shape)),[g,y,a,m]=s.shape,[_,b]=getImageCenter(l,y,a),c=255,w=Math.sin(i),S=Math.cos(i),E=f.data.get(s.dataId).values;for(let A=0;A<g;A++){const T=A*a*y*m;for(let O=0;O<y;O++){const C=O*(a*m);for(let k=0;k<a;k++){const P=k*m;for(let N=0;N<m;N++){const L=[g,O,k,N],F=L[2],V=L[1];let j=(F-_)*S-(V-b)*w,K=(F-_)*w+(V-b)*S;j=Math.round(j+_),K=Math.round(K+b);let U=o;if(typeof o!="number"&&(N===3?U=c:U=o[N]),j>=0&&j<a&&K>=0&&K<y){const J=K*(a*m),Y=j*m,te=T+J+Y+N;U=E[te]}const X=T+C+P+N;u[X]=U}}}}return{dataId:f.write(u,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const round=unaryKernelFunc(Round,n=>{const t=Math.floor(n);return n-t<.5?Math.floor(n):n-t>.5?Math.ceil(n):t%2===0?t:t+1}),roundConfig={kernelName:Round,backendName:"cpu",kernelFunc:round};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function scatterNd(n){const{inputs:t,backend:r,attrs:s}=n,{indices:i,updates:o}=t,{shape:l}=s,{sliceRank:f,numUpdates:u,sliceSize:g,strides:y,outputSize:a}=calculateShapes(o,i,l),m=!0,_=r.bufferSync(i),b=r.bufferSync(o),c=scatterImpl(_,b,l,a,g,u,f,y,0,m);return r.makeTensorInfo(l,c.dtype,c.values)}const scatterNdConfig={kernelName:ScatterNd,backendName:"cpu",kernelFunc:scatterNd};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lowerBound(n,t){let r=0,s=n.length,i=0;for(;r<s;)i=Math.floor((r+s)/2),n[i]<t?r=i+1:s=i;return s}function upperBound(n,t){let r=0,s=n.length,i=0;for(;r<s;)i=Math.floor((r+s)/2),n[i]<=t?r=i+1:s=i;return s}function searchSortedImpl(n,t,r,s,i,o){const l=getArrayFromDType("int32",r*i);for(let f=0;f<r;++f){const u=n.slice(f*s,(f+1)*s),g=f*i;for(let y=0;y<i;++y)l[g+y]=o==="left"?lowerBound(u,t[y+g]):upperBound(u,t[y+g])}return l}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function searchSorted(n){const{inputs:t,backend:r,attrs:s}=n,{sortedSequence:i,values:o}=t,{side:l}=s,f=r.data.get(i.dataId).values,u=r.data.get(o.dataId).values,g=searchSortedImpl(f,u,i.shape[0],i.shape[1],o.shape[1],l);return r.makeTensorInfo(o.shape,"int32",g)}const searchSortedConfig={kernelName:SearchSorted,backendName:"cpu",kernelFunc:searchSorted};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function select(n){const{inputs:t,backend:r}=n,{condition:s,t:i,e:o}=t;assertNotComplex([s,i,o],"select");const l=s.shape.length,f=r.data.get(s.dataId).values,u=r.data.get(i.dataId).values,g=r.data.get(o.dataId).values,y=upcastType(i.dtype,o.dtype),a=makeZerosTypedArray(sizeFromShape(i.shape),y);let m=0;const _=l===0||l>1||i.shape.length===1?1:sizeFromShape(i.shape.slice(1));for(let b=0;b<f.length;b++)for(let c=0;c<_;c++)f[b]===1?a[m++]=u[b]:a[m++]=g[b];return r.makeTensorInfo(i.shape,y,a)}const selectConfig={kernelName:Select,backendName:"cpu",kernelFunc:select};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const scaleAlpha=SELU_SCALEALPHA,scale=SELU_SCALE,selu=unaryKernelFunc(Selu,n=>n>=0?scale*n:scaleAlpha*(Math.exp(n)-1)),seluConfig={kernelName:Selu,backendName:"cpu",kernelFunc:selu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sign=unaryKernelFunc(Sign,n=>n<0?-1:n>0?1:0),signConfig={kernelName:Sign,backendName:"cpu",kernelFunc:sign};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sin=unaryKernelFunc(Sin,n=>Math.sin(n)),sinConfig={kernelName:Sin,backendName:"cpu",kernelFunc:sin};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sinh=unaryKernelFunc(Sinh,n=>Math.sinh(n)),sinhConfig={kernelName:Sinh,backendName:"cpu",kernelFunc:sinh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epsilon=11920928955078125e-23,threshold=Math.log(epsilon)+2,softplus=unaryKernelFunc(Softplus,n=>{const t=n>-threshold,r=n<threshold,s=Math.exp(n);let i;return r?i=s:t?i=n:i=Math.log(1+s),i}),softplusConfig={kernelName:Softplus,backendName:"cpu",kernelFunc:softplus};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spaceToBatchND(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{blockShape:o,paddings:l}=s;assertNotComplex([i],"spaceToBatchND");const f=sizeFromShape(o),u=[[0,0]];u.push(...l);for(let O=1+o.length;O<i.shape.length;++O)u.push([0,0]);const g=padV2Config.kernelFunc({inputs:{x:i},backend:r,attrs:{paddings:u,constantValue:0}}),y=getReshaped(g.shape,o,f,!1),a=getPermuted(y.length,o.length,!1),m=getReshapedPermuted(g.shape,o,f,!1),c=reshape({inputs:{x:g},backend:r,attrs:{shape:y}}),E=transpose({inputs:{x:c},backend:r,attrs:{perm:a}}),T=reshape({inputs:{x:E},backend:r,attrs:{shape:m}});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(c),r.disposeIntermediateTensorInfo(E),T}const spaceToBatchNDConfig={kernelName:SpaceToBatchND,backendName:"cpu",kernelFunc:spaceToBatchND};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseFillEmptyRows(n){const{inputs:t,backend:r}=n,{indices:s,values:i,denseShape:o,defaultValue:l}=t;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(l.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${l.shape}`);const f=r.data.get(s.dataId).values,u=r.data.get(i.dataId).values,g=r.data.get(o.dataId).values,y=r.data.get(l.dataId).values[0],[a,m,_,b,c]=sparseFillEmptyRowsImpl(f,s.shape,s.dtype,u,i.dtype,g,y);return[r.makeTensorInfo(m,s.dtype,a),r.makeTensorInfo([m[0]],i.dtype,_),r.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(w=>Number(w)))),r.makeTensorInfo([c.length],s.dtype,new Int32Array(c))]}const sparseFillEmptyRowsConfig={kernelName:SparseFillEmptyRows,backendName:"cpu",kernelFunc:sparseFillEmptyRows};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseReshape(n){const{inputs:t,backend:r}=n,{inputIndices:s,inputShape:i,newShape:o}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const l=Array.from(r.data.get(i.dataId).values),f=r.data.get(s.dataId).values,u=Array.from(r.data.get(o.dataId).values),[g,y,a]=sparseReshapeImpl(f,s.shape,s.dtype,l,u);return[r.makeTensorInfo(y,s.dtype,g),r.makeTensorInfo([a.length],o.dtype,new Int32Array(a))]}const sparseReshapeConfig={kernelName:SparseReshape,backendName:"cpu",kernelFunc:sparseReshape};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseSegmentMean(n){const{inputs:t,backend:r}=n,{data:s,indices:i,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const l=r.data.get(s.dataId).values,f=r.data.get(i.dataId).values,u=r.data.get(o.dataId).values,[g,y]=sparseSegmentReductionImpl(l,s.shape,s.dtype,f,u,!0);return r.makeTensorInfo(y,s.dtype,g)}const sparseSegmentMeanConfig={kernelName:SparseSegmentMean,backendName:"cpu",kernelFunc:sparseSegmentMean};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseSegmentSum(n){const{inputs:t,backend:r}=n,{data:s,indices:i,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(i.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const l=r.data.get(s.dataId).values,f=r.data.get(i.dataId).values,u=r.data.get(o.dataId).values,[g,y]=sparseSegmentReductionImpl(l,s.shape,s.dtype,f,u);return r.makeTensorInfo(y,s.dtype,g)}const sparseSegmentSumConfig={kernelName:SparseSegmentSum,backendName:"cpu",kernelFunc:sparseSegmentSum};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sparseToDense(n){const{inputs:t,backend:r,attrs:s}=n,{sparseIndices:i,sparseValues:o,defaultValue:l}=t,{outputShape:f}=s,{sliceRank:u,numUpdates:g,sliceSize:y,strides:a,outputSize:m}=calculateShapes(o,i,f),_=!1,b=r.bufferSync(i);let c;switch(o.dtype){case"bool":{const w=r.bufferSync(o),S=!!r.data.get(l.dataId).values[0];c=scatterImpl(b,w,f,m,y,g,u,a,S,_);break}case"float32":{const w=r.bufferSync(o),S=r.data.get(l.dataId).values[0];c=scatterImpl(b,w,f,m,y,g,u,a,S,_);break}case"int32":{const w=r.bufferSync(o),S=r.data.get(l.dataId).values[0];c=scatterImpl(b,w,f,m,y,g,u,a,S,_);break}case"string":{const w=r.bufferSync(o),S=decodeString(r.data.get(l.dataId).values[0]);c=scatterImpl(b,w,f,m,y,g,u,a,S,_);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return r.makeTensorInfo(f,c.dtype,c.values)}const sparseToDenseConfig={kernelName:SparseToDense,backendName:"cpu",kernelFunc:sparseToDense};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function splitV(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{numOrSizeSplits:o,axis:l}=s,f=parseAxisParam(l,i.shape)[0],u=prepareSplitSize(i,o,f),g=new Array(i.shape.length).fill(0),y=i.shape.slice();return u.map(a=>{const m=[...y];m[f]=a;const _=slice({inputs:{x:i},backend:r,attrs:{begin:g,size:m}});return g[f]+=a,_})}const splitVConfig={kernelName:SplitV,backendName:"cpu",kernelFunc:splitV};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const squareConfig={kernelName:Square,backendName:"cpu",kernelFunc:({inputs:n,backend:t})=>{const{x:r}=n,s=t;assertNotComplex(r,"square");const i=s.data.get(r.dataId).values,o=new Float32Array(i.length);for(let f=0;f<i.length;++f){const u=i[f];o[f]=u*u}return{dataId:s.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const step=unaryKernelFunc(Step,(n,t)=>{const r=t;return isNaN(n)?NaN:n>0?1:r.alpha}),stepConfig={kernelName:Step,backendName:"cpu",kernelFunc:step};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function stridedSlice(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{begin:o,end:l,strides:f,beginMask:u,endMask:g,ellipsisMask:y,newAxisMask:a,shrinkAxisMask:m}=s;assertNotComplex(i,"stridedSlice");const{finalShapeSparse:_,finalShape:b,isIdentity:c,sliceDim0:w,isSimpleSlice:S,begin:E,end:I,strides:A}=sliceInfo(i.shape,o,l,f,u,g,y,a,m);let T;if(c)T=reshape({inputs:{x:i},backend:r,attrs:{shape:b}});else if(w||S){assert(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const O=computeOutShape$1(E,I,A),C=slice({inputs:{x:i},backend:r,attrs:{begin:E,size:O}});T=reshape({inputs:{x:C},backend:r,attrs:{shape:b}}),r.disposeIntermediateTensorInfo(C)}else{const O=r.bufferSync(i),C=stridedSliceImpl(_,O,A,E);T=r.makeTensorInfo(b,C.dtype,C.values)}return T}const stridedSliceConfig={kernelName:StridedSlice,backendName:"cpu",kernelFunc:stridedSlice};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function stringNGrams(n){const{inputs:t,backend:r,attrs:s}=n,{separator:i,nGramWidths:o,leftPad:l,rightPad:f,padWidth:u,preserveShortSequences:g}=s,{data:y,dataSplits:a}=t,m=r.data.get(y.dataId).values,_=r.data.get(a.dataId).values,[b,c]=stringNGramsImpl(m,_,i,o,l,f,u,g);return[r.makeTensorInfo([b.length],"string",b),r.makeTensorInfo(a.shape,"int32",c)]}const stringNGramsConfig={kernelName:StringNGrams,backendName:"cpu",kernelFunc:stringNGrams};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function stringSplit(n){const{inputs:t,backend:r,attrs:s}=n,{skipEmpty:i}=s,{input:o,delimiter:l}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(l.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${l.shape}`);const f=r.data.get(o.dataId).values,u=r.data.get(l.dataId).values[0],[g,y,a]=stringSplitImpl(f,u,i),m=y.length;return[r.makeTensorInfo([m,2],"int32",g),r.makeTensorInfo([m],"string",y),r.makeTensorInfo([2],"int32",new Int32Array(a))]}const stringSplitConfig={kernelName:StringSplit,backendName:"cpu",kernelFunc:stringSplit};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function stringToHashBucketFast(n){const{inputs:t,backend:r,attrs:s}=n,{numBuckets:i}=s,{input:o}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const l=r.data.get(o.dataId).values,f=stringToHashBucketFastImpl(l,i);return r.makeTensorInfo(o.shape,"int32",f)}const stringToHashBucketFastConfig={kernelName:StringToHashBucketFast,backendName:"cpu",kernelFunc:stringToHashBucketFast};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tan=unaryKernelFunc(Tan,n=>Math.tan(n)),tanConfig={kernelName:Tan,backendName:"cpu",kernelFunc:tan};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tanh=unaryKernelFunc(Tanh,n=>Math.tanh(n)),tanhConfig={kernelName:Tanh,backendName:"cpu",kernelFunc:tanh};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tensorScatterUpdate(n){const{inputs:t,backend:r}=n,{tensor:s,indices:i,updates:o}=t,{sliceRank:l,numUpdates:f,sliceSize:u,strides:g,outputSize:y}=calculateShapes(o,i,s.shape),a=!1,m=r.bufferSync(i),_=r.bufferSync(o),b=r.bufferSync(s),c=scatterImpl(m,_,s.shape,y,u,f,l,g,b,a);return r.makeTensorInfo(s.shape,c.dtype,c.values)}const tensorScatterUpdateConfig={kernelName:TensorScatterUpdate,backendName:"cpu",kernelFunc:tensorScatterUpdate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tile(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{reps:o}=s;assertNotComplex(i,"tile");const l=tileImpl(r.bufferSync(i),o);return r.makeTensorInfo(l.shape,l.dtype,l.values)}const tileConfig={kernelName:Tile,backendName:"cpu",kernelFunc:tile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function topK(n){const{inputs:t,backend:r,attrs:s}=n,{x:i}=t,{k:o,sorted:l}=s;assertNotComplex(i,"topk");const f=r.data.get(i.dataId).values,[u,g]=topKImpl(f,i.shape,i.dtype,o,l);return[r.makeTensorInfo(u.shape,u.dtype,u.values),r.makeTensorInfo(g.shape,g.dtype,g.values)]}const topKConfig={kernelName:TopK,backendName:"cpu",kernelFunc:topK};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function transform(n){const{inputs:t,attrs:r,backend:s}=n,{image:i,transforms:o}=t,{interpolation:l,fillMode:f,fillValue:u,outputShape:g}=r,[y,a,m,_]=i.shape,[b,c]=g??[a,m],w=[y,b,c,_],S=computeStrides(i.shape),E=S[0],I=S[1],A=S[2],T=computeStrides(w),O=T[0],C=T[1],k=T[2],P=getTypedArrayFromDType(i.dtype,sizeFromShape(w));P.fill(u);const N=s.data.get(i.dataId).values,L=s.data.get(o.dataId).values;for(let V=0;V<y;++V){const j=o.shape[0]===1?L:L.subarray(V*8,V*8+8);for(let K=0;K<b;++K)for(let U=0;U<c;++U)for(let X=0;X<_;++X){let J;const Y=j[6]*U+j[7]*K+1;if(Y===0)continue;const te=(j[0]*U+j[1]*K+j[2])/Y,se=(j[3]*U+j[4]*K+j[5])/Y,de=mapCoord(te,m,f),Se=mapCoord(se,a,f);switch(l){case"nearest":J=nearestInterpolation(N,a,m,E,I,A,V,Se,de,X,u);break;case"bilinear":J=bilinearInterpolation(N,a,m,E,I,A,V,Se,de,X,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${l}`)}const we=V*O+K*C+U*k+X;P[we]=J}return s.makeTensorInfo(w,i.dtype,P)}return{dataId:s.write(P,w,i.dtype),shape:i.shape,dtype:i.dtype}}const transformConfig={kernelName:Transform,backendName:"cpu",kernelFunc:transform};function mapCoord(n,t,r){switch(r){case"reflect":return mapCoordReflect(n,t);case"wrap":return mapCoordWrap(n,t);case"nearest":return mapCoordNearest(n,t);case"constant":default:return mapCoordConstant(n)}}function mapCoordReflect(n,t){let r=n;if(r<0)if(t<=1)r=0;else{const s=2*t;r<s&&(r=s*Math.trunc(-r/s)+r),r=r<-t?r+s:-r-1}else if(r>t-1)if(t<=1)r=0;else{const s=2*t;r-=s*Math.trunc(r/s),r>=t&&(r=s-r-1)}return clamp(0,r,t-1)}function mapCoordWrap(n,t){let r=n;if(r<0)if(t<=1)r=0;else{const s=t-1;r+=t*(Math.trunc(-r/s)+1)}else if(r>t-1)if(t<=1)r=0;else{const s=t-1;r-=t*Math.trunc(r/s)}return clamp(0,r,t-1)}function mapCoordConstant(n,t){return n}function mapCoordNearest(n,t){return clamp(0,n,t-1)}function readWithFillValue(n,t,r,s,i,o,l,f,u,g,y){const a=l*s+f*i+u*o+g;return 0<=f&&f<t&&0<=u&&u<r?n[a]:y}function nearestInterpolation(n,t,r,s,i,o,l,f,u,g,y){const a=Math.round(f),m=Math.round(u);return readWithFillValue(n,t,r,s,i,o,l,a,m,g,y)}function bilinearInterpolation(n,t,r,s,i,o,l,f,u,g,y){const a=Math.floor(f),m=Math.floor(u),_=a+1,b=m+1,c=(b-u)*readWithFillValue(n,t,r,s,i,o,l,a,m,g,y)+(u-m)*readWithFillValue(n,t,r,s,i,o,l,a,b,g,y),w=(b-u)*readWithFillValue(n,t,r,s,i,o,l,_,m,g,y)+(u-m)*readWithFillValue(n,t,r,s,i,o,l,_,b,g,y);return(_-f)*c+(f-a)*w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function unique(n){const{inputs:t,attrs:r,backend:s}=n,{axis:i}=r,{x:o}=t;assertNotComplex(o,"unique");const l=s.data.get(o.dataId).values,{outputValues:f,outputShape:u,indices:g}=uniqueImpl(l,i,o.shape,o.dtype);return[s.makeTensorInfo(u,o.dtype,f),s.makeTensorInfo([g.length],"int32",g)]}const uniqueConfig={kernelName:Unique,backendName:"cpu",kernelFunc:unique};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function unpack(n){const{inputs:t,backend:r,attrs:s}=n,{value:i}=t;let{axis:o}=s;o<0&&(o+=i.shape.length);const l=i.shape.length,f=i.shape[o],u=new Array(l-1);let g=0;for(let _=0;_<l;_++)_!==o&&(u[g++]=i.shape[_]);const y=new Array(l).fill(0),a=i.shape.slice();a[o]=1;const m=new Array(f);for(let _=0;_<m.length;_++){y[o]=_;const b=slice({inputs:{x:i},backend:r,attrs:{begin:y,size:a}});m[_]=reshape({inputs:{x:b},backend:r,attrs:{shape:u}}),r.disposeIntermediateTensorInfo(b)}return m}const unpackConfig={kernelName:Unpack,backendName:"cpu",kernelFunc:unpack};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function unsortedSegmentSum(n){const{inputs:t,backend:r,attrs:s}=n,{x:i,segmentIds:o}=t,{numSegments:l}=s;assertNotComplex(i,"unsortedSegmentSum");const f=i.shape.length,u=o.shape.length,g=[],y=[],a=f-u;let m=o;for(let b=0;b<a;++b){const c=expandDims({inputs:{input:m},backend:r,attrs:{dim:b+1}});m=c,y.push(c)}for(let b=0;b<l;++b){const c=createScalarValue(b,"int32"),w=r.makeTensorInfo([],"int32",c),S=equal({inputs:{a:w,b:m},backend:r}),E=cast({inputs:{x:S},backend:r,attrs:{dtype:"float32"}}),I=multiply({inputs:{a:E,b:i},backend:r}),A=sum({inputs:{x:I},backend:r,attrs:{axis:0,keepDims:!1}});g.push(A),y.push(w),y.push(S),y.push(E),y.push(I),y.push(A)}const _=pack({inputs:g,backend:r,attrs:{axis:0}});return y.forEach(b=>r.disposeIntermediateTensorInfo(b)),_}const unsortedSegmentSumConfig={kernelName:UnsortedSegmentSum,backendName:"cpu",kernelFunc:unsortedSegmentSum};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kernelConfigs=[_fusedMatMulConfig,absConfig,acosConfig,acoshConfig,addConfig,addNConfig,allConfig,anyConfig,argMaxConfig,argMinConfig,asinConfig,asinhConfig,atanConfig,atan2Config,atanhConfig,avgPoolConfig,avgPool3DConfig,avgPool3DGradConfig,avgPoolGradConfig,batchMatMulConfig,batchNormConfig,batchToSpaceNDConfig,bincountConfig,bitwiseAndConfig,broadcastArgsConfig,castConfig,ceilConfig,clipByValueConfig,complexConfig,complexAbsConfig,concatConfig,conv2DConfig,conv2DBackpropFilterConfig,conv2DBackpropInputConfig,conv3DConfig,conv3DBackpropFilterV2Config,conv3DBackpropInputV2Config,cosConfig,coshConfig,cropAndResizeConfig,cumprodConfig,cumsumConfig,denseBincountConfig,depthToSpaceConfig,depthwiseConv2dNativeConfig,depthwiseConv2dNativeBackpropFilterConfig,depthwiseConv2dNativeBackpropInputConfig,diagConfig,dilation2DConfig,dilation2DBackpropFilterConfig,dilation2DBackpropInputConfig,drawConfig,einsumConfig,eluConfig,eluGradConfig,equalConfig,erfConfig,expConfig,expandDimsConfig,expm1Config,fftConfig,fillConfig,flipLeftRightConfig,floorConfig,floorDivConfig,fusedConv2DConfig,fusedDepthwiseConv2DConfig,gatherNdConfig,gatherV2Config,greaterConfig,greaterEqualConfig,identityConfig,ifftConfig,imagConfig,isFiniteConfig,isInfConfig,isNaNConfig,leakyReluConfig,lessConfig,lessEqualConfig,linSpaceConfig,logConfig,log1pConfig,logicalAndConfig,logicalNotConfig,logicalOrConfig,LRNConfig,LRNGradConfig,maxConfig,maximumConfig,maxPoolConfig,maxPool3DConfig,maxPool3DGradConfig,maxPoolGradConfig,maxPoolWithArgmaxConfig,meanConfig,minConfig,minimumConfig,mirrorPadConfig,modConfig,multinomialConfig,multiplyConfig,negConfig,nonMaxSuppressionV3Config,nonMaxSuppressionV4Config,nonMaxSuppressionV5Config,notEqualConfig,oneHotConfig,onesLikeConfig,packConfig,padV2Config,powConfig,preluConfig,prodConfig,raggedGatherConfig,raggedRangeConfig,raggedTensorToTensorConfig,rangeConfig,realConfig,realDivConfig,reciprocalConfig,reluConfig,relu6Config,reshapeConfig,resizeBilinearConfig,resizeBilinearGradConfig,resizeNearestNeighborConfig,resizeNearestNeighborGradConfig,reverseConfig,rotateWithOffsetConfig,roundConfig,rsqrtConfig,scatterNdConfig,searchSortedConfig,selectConfig,seluConfig,sigmoidConfig,signConfig,sinConfig,sinhConfig,sliceConfig,softmaxConfig,softplusConfig,spaceToBatchNDConfig,sparseFillEmptyRowsConfig,sparseReshapeConfig,sparseSegmentMeanConfig,sparseSegmentSumConfig,sparseToDenseConfig,splitVConfig,sqrtConfig,squareConfig,squaredDifferenceConfig,staticRegexReplaceConfig,stepConfig,stridedSliceConfig,stringNGramsConfig,stringSplitConfig,stringToHashBucketFastConfig,subConfig,sumConfig,tanConfig,tanhConfig,tensorScatterUpdateConfig,tileConfig,topKConfig,transformConfig,transposeConfig,uniqueConfig,unpackConfig,unsortedSegmentSumConfig,zerosLikeConfig];for(const n of kernelConfigs)registerKernel(n);var lodash$1={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */lodash$1.exports;(function(n,t){(function(){var r,s="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",g=500,y="__lodash_placeholder__",a=1,m=2,_=4,b=1,c=2,w=1,S=2,E=4,I=8,A=16,T=32,O=64,C=128,k=256,P=512,N=30,L="...",F=800,V=16,j=1,K=2,U=3,X=1/0,J=9007199254740991,Y=17976931348623157e292,te=NaN,se=4294967295,de=se-1,Se=se>>>1,we=[["ary",C],["bind",w],["bindKey",S],["curry",I],["curryRight",A],["flip",P],["partial",T],["partialRight",O],["rearg",k]],ge="[object Arguments]",Ie="[object Array]",Te="[object AsyncFunction]",Ce="[object Boolean]",Ae="[object Date]",Me="[object DOMException]",Re="[object Error]",G="[object Function]",Q="[object GeneratorFunction]",ie="[object Map]",le="[object Number]",ue="[object Null]",he="[object Object]",ve="[object Promise]",be="[object Proxy]",ye="[object RegExp]",B="[object Set]",M="[object String]",D="[object Symbol]",z="[object Undefined]",Z="[object WeakMap]",oe="[object WeakSet]",ae="[object ArrayBuffer]",Ee="[object DataView]",Pe="[object Float32Array]",$e="[object Float64Array]",Ke="[object Int8Array]",Ge="[object Int16Array]",ot="[object Int32Array]",Nt="[object Uint8Array]",nt="[object Uint8ClampedArray]",yt="[object Uint16Array]",_n="[object Uint32Array]",xa=/\b__p \+= '';/g,Ta=/\b(__p \+=) '' \+/g,Aa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ys=/&(?:amp|lt|gt|quot|#39);/g,Xs=/[&<>"']/g,ka=RegExp(Ys.source),Ca=RegExp(Xs.source),Oa=/<%-([\s\S]+?)%>/g,Pa=/<%([\s\S]+?)%>/g,Js=/<%=([\s\S]+?)%>/g,Ra=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ma=/^\w*$/,Da=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$r=/[\\^$.*+?()[\]{}|]/g,Fa=RegExp($r.source),Br=/^\s+/,Na=/\s/,$a=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ba=/\{\n\/\* \[wrapped with (.+)\] \*/,ja=/,? & /,La=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ua=/[()=,{}\[\]\/\s]/,Wa=/\\(\\)?/g,Va=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Zs=/\w*$/,za=/^[-+]0x[0-9a-f]+$/i,Ha=/^0b[01]+$/i,Ka=/^\[object .+?Constructor\]$/,Ga=/^0o[0-7]+$/i,qa=/^(?:0|[1-9]\d*)$/,Ya=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qn=/($^)/,Xa=/['\n\r\u2028\u2029\\]/g,Yn="\\ud800-\\udfff",Ja="\\u0300-\\u036f",Za="\\ufe20-\\ufe2f",Qa="\\u20d0-\\u20ff",Qs=Ja+Za+Qa,ei="\\u2700-\\u27bf",ti="a-z\\xdf-\\xf6\\xf8-\\xff",ec="\\xac\\xb1\\xd7\\xf7",tc="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",nc="\\u2000-\\u206f",rc=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ni="A-Z\\xc0-\\xd6\\xd8-\\xde",ri="\\ufe0e\\ufe0f",si=ec+tc+nc+rc,jr="['’]",sc="["+Yn+"]",ii="["+si+"]",Xn="["+Qs+"]",oi="\\d+",ic="["+ei+"]",ai="["+ti+"]",ci="[^"+Yn+si+oi+ei+ti+ni+"]",Lr="\\ud83c[\\udffb-\\udfff]",oc="(?:"+Xn+"|"+Lr+")",li="[^"+Yn+"]",Ur="(?:\\ud83c[\\udde6-\\uddff]){2}",Wr="[\\ud800-\\udbff][\\udc00-\\udfff]",vn="["+ni+"]",ui="\\u200d",di="(?:"+ai+"|"+ci+")",ac="(?:"+vn+"|"+ci+")",fi="(?:"+jr+"(?:d|ll|m|re|s|t|ve))?",hi="(?:"+jr+"(?:D|LL|M|RE|S|T|VE))?",pi=oc+"?",mi="["+ri+"]?",cc="(?:"+ui+"(?:"+[li,Ur,Wr].join("|")+")"+mi+pi+")*",lc="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",uc="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",gi=mi+pi+cc,dc="(?:"+[ic,Ur,Wr].join("|")+")"+gi,fc="(?:"+[li+Xn+"?",Xn,Ur,Wr,sc].join("|")+")",hc=RegExp(jr,"g"),pc=RegExp(Xn,"g"),Vr=RegExp(Lr+"(?="+Lr+")|"+fc+gi,"g"),mc=RegExp([vn+"?"+ai+"+"+fi+"(?="+[ii,vn,"$"].join("|")+")",ac+"+"+hi+"(?="+[ii,vn+di,"$"].join("|")+")",vn+"?"+di+"+"+fi,vn+"+"+hi,uc,lc,oi,dc].join("|"),"g"),gc=RegExp("["+ui+Yn+Qs+ri+"]"),yc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_c=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],vc=-1,Qe={};Qe[Pe]=Qe[$e]=Qe[Ke]=Qe[Ge]=Qe[ot]=Qe[Nt]=Qe[nt]=Qe[yt]=Qe[_n]=!0,Qe[ge]=Qe[Ie]=Qe[ae]=Qe[Ce]=Qe[Ee]=Qe[Ae]=Qe[Re]=Qe[G]=Qe[ie]=Qe[le]=Qe[he]=Qe[ye]=Qe[B]=Qe[M]=Qe[Z]=!1;var Ze={};Ze[ge]=Ze[Ie]=Ze[ae]=Ze[Ee]=Ze[Ce]=Ze[Ae]=Ze[Pe]=Ze[$e]=Ze[Ke]=Ze[Ge]=Ze[ot]=Ze[ie]=Ze[le]=Ze[he]=Ze[ye]=Ze[B]=Ze[M]=Ze[D]=Ze[Nt]=Ze[nt]=Ze[yt]=Ze[_n]=!0,Ze[Re]=Ze[G]=Ze[Z]=!1;var bc={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},wc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Sc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ic={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ec=parseFloat,xc=parseInt,yi=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,Tc=typeof self=="object"&&self&&self.Object===Object&&self,ut=yi||Tc||Function("return this")(),zr=t&&!t.nodeType&&t,ln=zr&&!0&&n&&!n.nodeType&&n,_i=ln&&ln.exports===zr,Hr=_i&&yi.process,kt=function(){try{var ne=ln&&ln.require&&ln.require("util").types;return ne||Hr&&Hr.binding&&Hr.binding("util")}catch{}}(),vi=kt&&kt.isArrayBuffer,bi=kt&&kt.isDate,wi=kt&&kt.isMap,Si=kt&&kt.isRegExp,Ii=kt&&kt.isSet,Ei=kt&&kt.isTypedArray;function St(ne,fe,ce){switch(ce.length){case 0:return ne.call(fe);case 1:return ne.call(fe,ce[0]);case 2:return ne.call(fe,ce[0],ce[1]);case 3:return ne.call(fe,ce[0],ce[1],ce[2])}return ne.apply(fe,ce)}function Ac(ne,fe,ce,ke){for(var Be=-1,qe=ne==null?0:ne.length;++Be<qe;){var at=ne[Be];fe(ke,at,ce(at),ne)}return ke}function Ct(ne,fe){for(var ce=-1,ke=ne==null?0:ne.length;++ce<ke&&fe(ne[ce],ce,ne)!==!1;);return ne}function kc(ne,fe){for(var ce=ne==null?0:ne.length;ce--&&fe(ne[ce],ce,ne)!==!1;);return ne}function xi(ne,fe){for(var ce=-1,ke=ne==null?0:ne.length;++ce<ke;)if(!fe(ne[ce],ce,ne))return!1;return!0}function Qt(ne,fe){for(var ce=-1,ke=ne==null?0:ne.length,Be=0,qe=[];++ce<ke;){var at=ne[ce];fe(at,ce,ne)&&(qe[Be++]=at)}return qe}function Jn(ne,fe){var ce=ne==null?0:ne.length;return!!ce&&bn(ne,fe,0)>-1}function Kr(ne,fe,ce){for(var ke=-1,Be=ne==null?0:ne.length;++ke<Be;)if(ce(fe,ne[ke]))return!0;return!1}function et(ne,fe){for(var ce=-1,ke=ne==null?0:ne.length,Be=Array(ke);++ce<ke;)Be[ce]=fe(ne[ce],ce,ne);return Be}function en(ne,fe){for(var ce=-1,ke=fe.length,Be=ne.length;++ce<ke;)ne[Be+ce]=fe[ce];return ne}function Gr(ne,fe,ce,ke){var Be=-1,qe=ne==null?0:ne.length;for(ke&&qe&&(ce=ne[++Be]);++Be<qe;)ce=fe(ce,ne[Be],Be,ne);return ce}function Cc(ne,fe,ce,ke){var Be=ne==null?0:ne.length;for(ke&&Be&&(ce=ne[--Be]);Be--;)ce=fe(ce,ne[Be],Be,ne);return ce}function qr(ne,fe){for(var ce=-1,ke=ne==null?0:ne.length;++ce<ke;)if(fe(ne[ce],ce,ne))return!0;return!1}var Oc=Yr("length");function Pc(ne){return ne.split("")}function Rc(ne){return ne.match(La)||[]}function Ti(ne,fe,ce){var ke;return ce(ne,function(Be,qe,at){if(fe(Be,qe,at))return ke=qe,!1}),ke}function Zn(ne,fe,ce,ke){for(var Be=ne.length,qe=ce+(ke?1:-1);ke?qe--:++qe<Be;)if(fe(ne[qe],qe,ne))return qe;return-1}function bn(ne,fe,ce){return fe===fe?zc(ne,fe,ce):Zn(ne,Ai,ce)}function Mc(ne,fe,ce,ke){for(var Be=ce-1,qe=ne.length;++Be<qe;)if(ke(ne[Be],fe))return Be;return-1}function Ai(ne){return ne!==ne}function ki(ne,fe){var ce=ne==null?0:ne.length;return ce?Jr(ne,fe)/ce:te}function Yr(ne){return function(fe){return fe==null?r:fe[ne]}}function Xr(ne){return function(fe){return ne==null?r:ne[fe]}}function Ci(ne,fe,ce,ke,Be){return Be(ne,function(qe,at,Je){ce=ke?(ke=!1,qe):fe(ce,qe,at,Je)}),ce}function Dc(ne,fe){var ce=ne.length;for(ne.sort(fe);ce--;)ne[ce]=ne[ce].value;return ne}function Jr(ne,fe){for(var ce,ke=-1,Be=ne.length;++ke<Be;){var qe=fe(ne[ke]);qe!==r&&(ce=ce===r?qe:ce+qe)}return ce}function Zr(ne,fe){for(var ce=-1,ke=Array(ne);++ce<ne;)ke[ce]=fe(ce);return ke}function Fc(ne,fe){return et(fe,function(ce){return[ce,ne[ce]]})}function Oi(ne){return ne&&ne.slice(0,Di(ne)+1).replace(Br,"")}function It(ne){return function(fe){return ne(fe)}}function Qr(ne,fe){return et(fe,function(ce){return ne[ce]})}function Mn(ne,fe){return ne.has(fe)}function Pi(ne,fe){for(var ce=-1,ke=ne.length;++ce<ke&&bn(fe,ne[ce],0)>-1;);return ce}function Ri(ne,fe){for(var ce=ne.length;ce--&&bn(fe,ne[ce],0)>-1;);return ce}function Nc(ne,fe){for(var ce=ne.length,ke=0;ce--;)ne[ce]===fe&&++ke;return ke}var $c=Xr(bc),Bc=Xr(wc);function jc(ne){return"\\"+Ic[ne]}function Lc(ne,fe){return ne==null?r:ne[fe]}function wn(ne){return gc.test(ne)}function Uc(ne){return yc.test(ne)}function Wc(ne){for(var fe,ce=[];!(fe=ne.next()).done;)ce.push(fe.value);return ce}function es(ne){var fe=-1,ce=Array(ne.size);return ne.forEach(function(ke,Be){ce[++fe]=[Be,ke]}),ce}function Mi(ne,fe){return function(ce){return ne(fe(ce))}}function tn(ne,fe){for(var ce=-1,ke=ne.length,Be=0,qe=[];++ce<ke;){var at=ne[ce];(at===fe||at===y)&&(ne[ce]=y,qe[Be++]=ce)}return qe}function Qn(ne){var fe=-1,ce=Array(ne.size);return ne.forEach(function(ke){ce[++fe]=ke}),ce}function Vc(ne){var fe=-1,ce=Array(ne.size);return ne.forEach(function(ke){ce[++fe]=[ke,ke]}),ce}function zc(ne,fe,ce){for(var ke=ce-1,Be=ne.length;++ke<Be;)if(ne[ke]===fe)return ke;return-1}function Hc(ne,fe,ce){for(var ke=ce+1;ke--;)if(ne[ke]===fe)return ke;return ke}function Sn(ne){return wn(ne)?Gc(ne):Oc(ne)}function $t(ne){return wn(ne)?qc(ne):Pc(ne)}function Di(ne){for(var fe=ne.length;fe--&&Na.test(ne.charAt(fe)););return fe}var Kc=Xr(Sc);function Gc(ne){for(var fe=Vr.lastIndex=0;Vr.test(ne);)++fe;return fe}function qc(ne){return ne.match(Vr)||[]}function Yc(ne){return ne.match(mc)||[]}var Xc=function ne(fe){fe=fe==null?ut:In.defaults(ut.Object(),fe,In.pick(ut,_c));var ce=fe.Array,ke=fe.Date,Be=fe.Error,qe=fe.Function,at=fe.Math,Je=fe.Object,ts=fe.RegExp,Jc=fe.String,Ot=fe.TypeError,er=ce.prototype,Zc=qe.prototype,En=Je.prototype,tr=fe["__core-js_shared__"],nr=Zc.toString,Xe=En.hasOwnProperty,Qc=0,Fi=function(){var d=/[^.]+$/.exec(tr&&tr.keys&&tr.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),rr=En.toString,el=nr.call(Je),tl=ut._,nl=ts("^"+nr.call(Xe).replace($r,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ir=_i?fe.Buffer:r,nn=fe.Symbol,or=fe.Uint8Array,Ni=ir?ir.allocUnsafe:r,ar=Mi(Je.getPrototypeOf,Je),$i=Je.create,Bi=En.propertyIsEnumerable,cr=er.splice,ji=nn?nn.isConcatSpreadable:r,Dn=nn?nn.iterator:r,un=nn?nn.toStringTag:r,lr=function(){try{var d=mn(Je,"defineProperty");return d({},"",{}),d}catch{}}(),rl=fe.clearTimeout!==ut.clearTimeout&&fe.clearTimeout,sl=ke&&ke.now!==ut.Date.now&&ke.now,il=fe.setTimeout!==ut.setTimeout&&fe.setTimeout,ur=at.ceil,dr=at.floor,ns=Je.getOwnPropertySymbols,ol=ir?ir.isBuffer:r,Li=fe.isFinite,al=er.join,cl=Mi(Je.keys,Je),ct=at.max,ft=at.min,ll=ke.now,ul=fe.parseInt,Ui=at.random,dl=er.reverse,rs=mn(fe,"DataView"),Fn=mn(fe,"Map"),ss=mn(fe,"Promise"),xn=mn(fe,"Set"),Nn=mn(fe,"WeakMap"),$n=mn(Je,"create"),fr=Nn&&new Nn,Tn={},fl=gn(rs),hl=gn(Fn),pl=gn(ss),ml=gn(xn),gl=gn(Nn),hr=nn?nn.prototype:r,Bn=hr?hr.valueOf:r,Wi=hr?hr.toString:r;function W(d){if(rt(d)&&!je(d)&&!(d instanceof ze)){if(d instanceof Pt)return d;if(Xe.call(d,"__wrapped__"))return zo(d)}return new Pt(d)}var An=function(){function d(){}return function(v){if(!tt(v))return{};if($i)return $i(v);d.prototype=v;var x=new d;return d.prototype=r,x}}();function pr(){}function Pt(d,v){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!v,this.__index__=0,this.__values__=r}W.templateSettings={escape:Oa,evaluate:Pa,interpolate:Js,variable:"",imports:{_:W}},W.prototype=pr.prototype,W.prototype.constructor=W,Pt.prototype=An(pr.prototype),Pt.prototype.constructor=Pt;function ze(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=se,this.__views__=[]}function yl(){var d=new ze(this.__wrapped__);return d.__actions__=_t(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=_t(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=_t(this.__views__),d}function _l(){if(this.__filtered__){var d=new ze(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function vl(){var d=this.__wrapped__.value(),v=this.__dir__,x=je(d),R=v<0,$=x?d.length:0,H=Pu(0,$,this.__views__),q=H.start,ee=H.end,re=ee-q,pe=R?ee:q-1,me=this.__iteratees__,_e=me.length,xe=0,Oe=ft(re,this.__takeCount__);if(!x||!R&&$==re&&Oe==re)return ho(d,this.__actions__);var Fe=[];e:for(;re--&&xe<Oe;){pe+=v;for(var Ue=-1,Ne=d[pe];++Ue<_e;){var Ve=me[Ue],He=Ve.iteratee,Tt=Ve.type,gt=He(Ne);if(Tt==K)Ne=gt;else if(!gt){if(Tt==j)continue e;break e}}Fe[xe++]=Ne}return Fe}ze.prototype=An(pr.prototype),ze.prototype.constructor=ze;function dn(d){var v=-1,x=d==null?0:d.length;for(this.clear();++v<x;){var R=d[v];this.set(R[0],R[1])}}function bl(){this.__data__=$n?$n(null):{},this.size=0}function wl(d){var v=this.has(d)&&delete this.__data__[d];return this.size-=v?1:0,v}function Sl(d){var v=this.__data__;if($n){var x=v[d];return x===u?r:x}return Xe.call(v,d)?v[d]:r}function Il(d){var v=this.__data__;return $n?v[d]!==r:Xe.call(v,d)}function El(d,v){var x=this.__data__;return this.size+=this.has(d)?0:1,x[d]=$n&&v===r?u:v,this}dn.prototype.clear=bl,dn.prototype.delete=wl,dn.prototype.get=Sl,dn.prototype.has=Il,dn.prototype.set=El;function zt(d){var v=-1,x=d==null?0:d.length;for(this.clear();++v<x;){var R=d[v];this.set(R[0],R[1])}}function xl(){this.__data__=[],this.size=0}function Tl(d){var v=this.__data__,x=mr(v,d);if(x<0)return!1;var R=v.length-1;return x==R?v.pop():cr.call(v,x,1),--this.size,!0}function Al(d){var v=this.__data__,x=mr(v,d);return x<0?r:v[x][1]}function kl(d){return mr(this.__data__,d)>-1}function Cl(d,v){var x=this.__data__,R=mr(x,d);return R<0?(++this.size,x.push([d,v])):x[R][1]=v,this}zt.prototype.clear=xl,zt.prototype.delete=Tl,zt.prototype.get=Al,zt.prototype.has=kl,zt.prototype.set=Cl;function Ht(d){var v=-1,x=d==null?0:d.length;for(this.clear();++v<x;){var R=d[v];this.set(R[0],R[1])}}function Ol(){this.size=0,this.__data__={hash:new dn,map:new(Fn||zt),string:new dn}}function Pl(d){var v=Ar(this,d).delete(d);return this.size-=v?1:0,v}function Rl(d){return Ar(this,d).get(d)}function Ml(d){return Ar(this,d).has(d)}function Dl(d,v){var x=Ar(this,d),R=x.size;return x.set(d,v),this.size+=x.size==R?0:1,this}Ht.prototype.clear=Ol,Ht.prototype.delete=Pl,Ht.prototype.get=Rl,Ht.prototype.has=Ml,Ht.prototype.set=Dl;function fn(d){var v=-1,x=d==null?0:d.length;for(this.__data__=new Ht;++v<x;)this.add(d[v])}function Fl(d){return this.__data__.set(d,u),this}function Nl(d){return this.__data__.has(d)}fn.prototype.add=fn.prototype.push=Fl,fn.prototype.has=Nl;function Bt(d){var v=this.__data__=new zt(d);this.size=v.size}function $l(){this.__data__=new zt,this.size=0}function Bl(d){var v=this.__data__,x=v.delete(d);return this.size=v.size,x}function jl(d){return this.__data__.get(d)}function Ll(d){return this.__data__.has(d)}function Ul(d,v){var x=this.__data__;if(x instanceof zt){var R=x.__data__;if(!Fn||R.length<i-1)return R.push([d,v]),this.size=++x.size,this;x=this.__data__=new Ht(R)}return x.set(d,v),this.size=x.size,this}Bt.prototype.clear=$l,Bt.prototype.delete=Bl,Bt.prototype.get=jl,Bt.prototype.has=Ll,Bt.prototype.set=Ul;function Vi(d,v){var x=je(d),R=!x&&yn(d),$=!x&&!R&&cn(d),H=!x&&!R&&!$&&Pn(d),q=x||R||$||H,ee=q?Zr(d.length,Jc):[],re=ee.length;for(var pe in d)(v||Xe.call(d,pe))&&!(q&&(pe=="length"||$&&(pe=="offset"||pe=="parent")||H&&(pe=="buffer"||pe=="byteLength"||pe=="byteOffset")||Yt(pe,re)))&&ee.push(pe);return ee}function zi(d){var v=d.length;return v?d[ms(0,v-1)]:r}function Wl(d,v){return kr(_t(d),hn(v,0,d.length))}function Vl(d){return kr(_t(d))}function is(d,v,x){(x!==r&&!jt(d[v],x)||x===r&&!(v in d))&&Kt(d,v,x)}function jn(d,v,x){var R=d[v];(!(Xe.call(d,v)&&jt(R,x))||x===r&&!(v in d))&&Kt(d,v,x)}function mr(d,v){for(var x=d.length;x--;)if(jt(d[x][0],v))return x;return-1}function zl(d,v,x,R){return rn(d,function($,H,q){v(R,$,x($),q)}),R}function Hi(d,v){return d&&Wt(v,lt(v),d)}function Hl(d,v){return d&&Wt(v,bt(v),d)}function Kt(d,v,x){v=="__proto__"&&lr?lr(d,v,{configurable:!0,enumerable:!0,value:x,writable:!0}):d[v]=x}function os(d,v){for(var x=-1,R=v.length,$=ce(R),H=d==null;++x<R;)$[x]=H?r:Ls(d,v[x]);return $}function hn(d,v,x){return d===d&&(x!==r&&(d=d<=x?d:x),v!==r&&(d=d>=v?d:v)),d}function Rt(d,v,x,R,$,H){var q,ee=v&a,re=v&m,pe=v&_;if(x&&(q=$?x(d,R,$,H):x(d)),q!==r)return q;if(!tt(d))return d;var me=je(d);if(me){if(q=Mu(d),!ee)return _t(d,q)}else{var _e=ht(d),xe=_e==G||_e==Q;if(cn(d))return go(d,ee);if(_e==he||_e==ge||xe&&!$){if(q=re||xe?{}:Fo(d),!ee)return re?Su(d,Hl(q,d)):wu(d,Hi(q,d))}else{if(!Ze[_e])return $?d:{};q=Du(d,_e,ee)}}H||(H=new Bt);var Oe=H.get(d);if(Oe)return Oe;H.set(d,q),ua(d)?d.forEach(function(Ne){q.add(Rt(Ne,v,x,Ne,d,H))}):ca(d)&&d.forEach(function(Ne,Ve){q.set(Ve,Rt(Ne,v,x,Ve,d,H))});var Fe=pe?re?Ts:xs:re?bt:lt,Ue=me?r:Fe(d);return Ct(Ue||d,function(Ne,Ve){Ue&&(Ve=Ne,Ne=d[Ve]),jn(q,Ve,Rt(Ne,v,x,Ve,d,H))}),q}function Kl(d){var v=lt(d);return function(x){return Ki(x,d,v)}}function Ki(d,v,x){var R=x.length;if(d==null)return!R;for(d=Je(d);R--;){var $=x[R],H=v[$],q=d[$];if(q===r&&!($ in d)||!H(q))return!1}return!0}function Gi(d,v,x){if(typeof d!="function")throw new Ot(l);return Kn(function(){d.apply(r,x)},v)}function Ln(d,v,x,R){var $=-1,H=Jn,q=!0,ee=d.length,re=[],pe=v.length;if(!ee)return re;x&&(v=et(v,It(x))),R?(H=Kr,q=!1):v.length>=i&&(H=Mn,q=!1,v=new fn(v));e:for(;++$<ee;){var me=d[$],_e=x==null?me:x(me);if(me=R||me!==0?me:0,q&&_e===_e){for(var xe=pe;xe--;)if(v[xe]===_e)continue e;re.push(me)}else H(v,_e,R)||re.push(me)}return re}var rn=wo(Ut),qi=wo(cs,!0);function Gl(d,v){var x=!0;return rn(d,function(R,$,H){return x=!!v(R,$,H),x}),x}function gr(d,v,x){for(var R=-1,$=d.length;++R<$;){var H=d[R],q=v(H);if(q!=null&&(ee===r?q===q&&!xt(q):x(q,ee)))var ee=q,re=H}return re}function ql(d,v,x,R){var $=d.length;for(x=Le(x),x<0&&(x=-x>$?0:$+x),R=R===r||R>$?$:Le(R),R<0&&(R+=$),R=x>R?0:fa(R);x<R;)d[x++]=v;return d}function Yi(d,v){var x=[];return rn(d,function(R,$,H){v(R,$,H)&&x.push(R)}),x}function dt(d,v,x,R,$){var H=-1,q=d.length;for(x||(x=Nu),$||($=[]);++H<q;){var ee=d[H];v>0&&x(ee)?v>1?dt(ee,v-1,x,R,$):en($,ee):R||($[$.length]=ee)}return $}var as=So(),Xi=So(!0);function Ut(d,v){return d&&as(d,v,lt)}function cs(d,v){return d&&Xi(d,v,lt)}function yr(d,v){return Qt(v,function(x){return Xt(d[x])})}function pn(d,v){v=on(v,d);for(var x=0,R=v.length;d!=null&&x<R;)d=d[Vt(v[x++])];return x&&x==R?d:r}function Ji(d,v,x){var R=v(d);return je(d)?R:en(R,x(d))}function pt(d){return d==null?d===r?z:ue:un&&un in Je(d)?Ou(d):Vu(d)}function ls(d,v){return d>v}function Yl(d,v){return d!=null&&Xe.call(d,v)}function Xl(d,v){return d!=null&&v in Je(d)}function Jl(d,v,x){return d>=ft(v,x)&&d<ct(v,x)}function us(d,v,x){for(var R=x?Kr:Jn,$=d[0].length,H=d.length,q=H,ee=ce(H),re=1/0,pe=[];q--;){var me=d[q];q&&v&&(me=et(me,It(v))),re=ft(me.length,re),ee[q]=!x&&(v||$>=120&&me.length>=120)?new fn(q&&me):r}me=d[0];var _e=-1,xe=ee[0];e:for(;++_e<$&&pe.length<re;){var Oe=me[_e],Fe=v?v(Oe):Oe;if(Oe=x||Oe!==0?Oe:0,!(xe?Mn(xe,Fe):R(pe,Fe,x))){for(q=H;--q;){var Ue=ee[q];if(!(Ue?Mn(Ue,Fe):R(d[q],Fe,x)))continue e}xe&&xe.push(Fe),pe.push(Oe)}}return pe}function Zl(d,v,x,R){return Ut(d,function($,H,q){v(R,x($),H,q)}),R}function Un(d,v,x){v=on(v,d),d=jo(d,v);var R=d==null?d:d[Vt(Dt(v))];return R==null?r:St(R,d,x)}function Zi(d){return rt(d)&&pt(d)==ge}function Ql(d){return rt(d)&&pt(d)==ae}function eu(d){return rt(d)&&pt(d)==Ae}function Wn(d,v,x,R,$){return d===v?!0:d==null||v==null||!rt(d)&&!rt(v)?d!==d&&v!==v:tu(d,v,x,R,Wn,$)}function tu(d,v,x,R,$,H){var q=je(d),ee=je(v),re=q?Ie:ht(d),pe=ee?Ie:ht(v);re=re==ge?he:re,pe=pe==ge?he:pe;var me=re==he,_e=pe==he,xe=re==pe;if(xe&&cn(d)){if(!cn(v))return!1;q=!0,me=!1}if(xe&&!me)return H||(H=new Bt),q||Pn(d)?Ro(d,v,x,R,$,H):ku(d,v,re,x,R,$,H);if(!(x&b)){var Oe=me&&Xe.call(d,"__wrapped__"),Fe=_e&&Xe.call(v,"__wrapped__");if(Oe||Fe){var Ue=Oe?d.value():d,Ne=Fe?v.value():v;return H||(H=new Bt),$(Ue,Ne,x,R,H)}}return xe?(H||(H=new Bt),Cu(d,v,x,R,$,H)):!1}function nu(d){return rt(d)&&ht(d)==ie}function ds(d,v,x,R){var $=x.length,H=$,q=!R;if(d==null)return!H;for(d=Je(d);$--;){var ee=x[$];if(q&&ee[2]?ee[1]!==d[ee[0]]:!(ee[0]in d))return!1}for(;++$<H;){ee=x[$];var re=ee[0],pe=d[re],me=ee[1];if(q&&ee[2]){if(pe===r&&!(re in d))return!1}else{var _e=new Bt;if(R)var xe=R(pe,me,re,d,v,_e);if(!(xe===r?Wn(me,pe,b|c,R,_e):xe))return!1}}return!0}function Qi(d){if(!tt(d)||Bu(d))return!1;var v=Xt(d)?nl:Ka;return v.test(gn(d))}function ru(d){return rt(d)&&pt(d)==ye}function su(d){return rt(d)&&ht(d)==B}function iu(d){return rt(d)&&Dr(d.length)&&!!Qe[pt(d)]}function eo(d){return typeof d=="function"?d:d==null?wt:typeof d=="object"?je(d)?ro(d[0],d[1]):no(d):Ia(d)}function fs(d){if(!Hn(d))return cl(d);var v=[];for(var x in Je(d))Xe.call(d,x)&&x!="constructor"&&v.push(x);return v}function ou(d){if(!tt(d))return Wu(d);var v=Hn(d),x=[];for(var R in d)R=="constructor"&&(v||!Xe.call(d,R))||x.push(R);return x}function hs(d,v){return d<v}function to(d,v){var x=-1,R=vt(d)?ce(d.length):[];return rn(d,function($,H,q){R[++x]=v($,H,q)}),R}function no(d){var v=ks(d);return v.length==1&&v[0][2]?$o(v[0][0],v[0][1]):function(x){return x===d||ds(x,d,v)}}function ro(d,v){return Os(d)&&No(v)?$o(Vt(d),v):function(x){var R=Ls(x,d);return R===r&&R===v?Us(x,d):Wn(v,R,b|c)}}function _r(d,v,x,R,$){d!==v&&as(v,function(H,q){if($||($=new Bt),tt(H))au(d,v,q,x,_r,R,$);else{var ee=R?R(Rs(d,q),H,q+"",d,v,$):r;ee===r&&(ee=H),is(d,q,ee)}},bt)}function au(d,v,x,R,$,H,q){var ee=Rs(d,x),re=Rs(v,x),pe=q.get(re);if(pe){is(d,x,pe);return}var me=H?H(ee,re,x+"",d,v,q):r,_e=me===r;if(_e){var xe=je(re),Oe=!xe&&cn(re),Fe=!xe&&!Oe&&Pn(re);me=re,xe||Oe||Fe?je(ee)?me=ee:st(ee)?me=_t(ee):Oe?(_e=!1,me=go(re,!0)):Fe?(_e=!1,me=yo(re,!0)):me=[]:Gn(re)||yn(re)?(me=ee,yn(ee)?me=ha(ee):(!tt(ee)||Xt(ee))&&(me=Fo(re))):_e=!1}_e&&(q.set(re,me),$(me,re,R,H,q),q.delete(re)),is(d,x,me)}function so(d,v){var x=d.length;if(x)return v+=v<0?x:0,Yt(v,x)?d[v]:r}function io(d,v,x){v.length?v=et(v,function(H){return je(H)?function(q){return pn(q,H.length===1?H[0]:H)}:H}):v=[wt];var R=-1;v=et(v,It(De()));var $=to(d,function(H,q,ee){var re=et(v,function(pe){return pe(H)});return{criteria:re,index:++R,value:H}});return Dc($,function(H,q){return bu(H,q,x)})}function cu(d,v){return oo(d,v,function(x,R){return Us(d,R)})}function oo(d,v,x){for(var R=-1,$=v.length,H={};++R<$;){var q=v[R],ee=pn(d,q);x(ee,q)&&Vn(H,on(q,d),ee)}return H}function lu(d){return function(v){return pn(v,d)}}function ps(d,v,x,R){var $=R?Mc:bn,H=-1,q=v.length,ee=d;for(d===v&&(v=_t(v)),x&&(ee=et(d,It(x)));++H<q;)for(var re=0,pe=v[H],me=x?x(pe):pe;(re=$(ee,me,re,R))>-1;)ee!==d&&cr.call(ee,re,1),cr.call(d,re,1);return d}function ao(d,v){for(var x=d?v.length:0,R=x-1;x--;){var $=v[x];if(x==R||$!==H){var H=$;Yt($)?cr.call(d,$,1):_s(d,$)}}return d}function ms(d,v){return d+dr(Ui()*(v-d+1))}function uu(d,v,x,R){for(var $=-1,H=ct(ur((v-d)/(x||1)),0),q=ce(H);H--;)q[R?H:++$]=d,d+=x;return q}function gs(d,v){var x="";if(!d||v<1||v>J)return x;do v%2&&(x+=d),v=dr(v/2),v&&(d+=d);while(v);return x}function We(d,v){return Ms(Bo(d,v,wt),d+"")}function du(d){return zi(Rn(d))}function fu(d,v){var x=Rn(d);return kr(x,hn(v,0,x.length))}function Vn(d,v,x,R){if(!tt(d))return d;v=on(v,d);for(var $=-1,H=v.length,q=H-1,ee=d;ee!=null&&++$<H;){var re=Vt(v[$]),pe=x;if(re==="__proto__"||re==="constructor"||re==="prototype")return d;if($!=q){var me=ee[re];pe=R?R(me,re,ee):r,pe===r&&(pe=tt(me)?me:Yt(v[$+1])?[]:{})}jn(ee,re,pe),ee=ee[re]}return d}var co=fr?function(d,v){return fr.set(d,v),d}:wt,hu=lr?function(d,v){return lr(d,"toString",{configurable:!0,enumerable:!1,value:Vs(v),writable:!0})}:wt;function pu(d){return kr(Rn(d))}function Mt(d,v,x){var R=-1,$=d.length;v<0&&(v=-v>$?0:$+v),x=x>$?$:x,x<0&&(x+=$),$=v>x?0:x-v>>>0,v>>>=0;for(var H=ce($);++R<$;)H[R]=d[R+v];return H}function mu(d,v){var x;return rn(d,function(R,$,H){return x=v(R,$,H),!x}),!!x}function vr(d,v,x){var R=0,$=d==null?R:d.length;if(typeof v=="number"&&v===v&&$<=Se){for(;R<$;){var H=R+$>>>1,q=d[H];q!==null&&!xt(q)&&(x?q<=v:q<v)?R=H+1:$=H}return $}return ys(d,v,wt,x)}function ys(d,v,x,R){var $=0,H=d==null?0:d.length;if(H===0)return 0;v=x(v);for(var q=v!==v,ee=v===null,re=xt(v),pe=v===r;$<H;){var me=dr(($+H)/2),_e=x(d[me]),xe=_e!==r,Oe=_e===null,Fe=_e===_e,Ue=xt(_e);if(q)var Ne=R||Fe;else pe?Ne=Fe&&(R||xe):ee?Ne=Fe&&xe&&(R||!Oe):re?Ne=Fe&&xe&&!Oe&&(R||!Ue):Oe||Ue?Ne=!1:Ne=R?_e<=v:_e<v;Ne?$=me+1:H=me}return ft(H,de)}function lo(d,v){for(var x=-1,R=d.length,$=0,H=[];++x<R;){var q=d[x],ee=v?v(q):q;if(!x||!jt(ee,re)){var re=ee;H[$++]=q===0?0:q}}return H}function uo(d){return typeof d=="number"?d:xt(d)?te:+d}function Et(d){if(typeof d=="string")return d;if(je(d))return et(d,Et)+"";if(xt(d))return Wi?Wi.call(d):"";var v=d+"";return v=="0"&&1/d==-X?"-0":v}function sn(d,v,x){var R=-1,$=Jn,H=d.length,q=!0,ee=[],re=ee;if(x)q=!1,$=Kr;else if(H>=i){var pe=v?null:Tu(d);if(pe)return Qn(pe);q=!1,$=Mn,re=new fn}else re=v?[]:ee;e:for(;++R<H;){var me=d[R],_e=v?v(me):me;if(me=x||me!==0?me:0,q&&_e===_e){for(var xe=re.length;xe--;)if(re[xe]===_e)continue e;v&&re.push(_e),ee.push(me)}else $(re,_e,x)||(re!==ee&&re.push(_e),ee.push(me))}return ee}function _s(d,v){return v=on(v,d),d=jo(d,v),d==null||delete d[Vt(Dt(v))]}function fo(d,v,x,R){return Vn(d,v,x(pn(d,v)),R)}function br(d,v,x,R){for(var $=d.length,H=R?$:-1;(R?H--:++H<$)&&v(d[H],H,d););return x?Mt(d,R?0:H,R?H+1:$):Mt(d,R?H+1:0,R?$:H)}function ho(d,v){var x=d;return x instanceof ze&&(x=x.value()),Gr(v,function(R,$){return $.func.apply($.thisArg,en([R],$.args))},x)}function vs(d,v,x){var R=d.length;if(R<2)return R?sn(d[0]):[];for(var $=-1,H=ce(R);++$<R;)for(var q=d[$],ee=-1;++ee<R;)ee!=$&&(H[$]=Ln(H[$]||q,d[ee],v,x));return sn(dt(H,1),v,x)}function po(d,v,x){for(var R=-1,$=d.length,H=v.length,q={};++R<$;){var ee=R<H?v[R]:r;x(q,d[R],ee)}return q}function bs(d){return st(d)?d:[]}function ws(d){return typeof d=="function"?d:wt}function on(d,v){return je(d)?d:Os(d,v)?[d]:Vo(Ye(d))}var gu=We;function an(d,v,x){var R=d.length;return x=x===r?R:x,!v&&x>=R?d:Mt(d,v,x)}var mo=rl||function(d){return ut.clearTimeout(d)};function go(d,v){if(v)return d.slice();var x=d.length,R=Ni?Ni(x):new d.constructor(x);return d.copy(R),R}function Ss(d){var v=new d.constructor(d.byteLength);return new or(v).set(new or(d)),v}function yu(d,v){var x=v?Ss(d.buffer):d.buffer;return new d.constructor(x,d.byteOffset,d.byteLength)}function _u(d){var v=new d.constructor(d.source,Zs.exec(d));return v.lastIndex=d.lastIndex,v}function vu(d){return Bn?Je(Bn.call(d)):{}}function yo(d,v){var x=v?Ss(d.buffer):d.buffer;return new d.constructor(x,d.byteOffset,d.length)}function _o(d,v){if(d!==v){var x=d!==r,R=d===null,$=d===d,H=xt(d),q=v!==r,ee=v===null,re=v===v,pe=xt(v);if(!ee&&!pe&&!H&&d>v||H&&q&&re&&!ee&&!pe||R&&q&&re||!x&&re||!$)return 1;if(!R&&!H&&!pe&&d<v||pe&&x&&$&&!R&&!H||ee&&x&&$||!q&&$||!re)return-1}return 0}function bu(d,v,x){for(var R=-1,$=d.criteria,H=v.criteria,q=$.length,ee=x.length;++R<q;){var re=_o($[R],H[R]);if(re){if(R>=ee)return re;var pe=x[R];return re*(pe=="desc"?-1:1)}}return d.index-v.index}function vo(d,v,x,R){for(var $=-1,H=d.length,q=x.length,ee=-1,re=v.length,pe=ct(H-q,0),me=ce(re+pe),_e=!R;++ee<re;)me[ee]=v[ee];for(;++$<q;)(_e||$<H)&&(me[x[$]]=d[$]);for(;pe--;)me[ee++]=d[$++];return me}function bo(d,v,x,R){for(var $=-1,H=d.length,q=-1,ee=x.length,re=-1,pe=v.length,me=ct(H-ee,0),_e=ce(me+pe),xe=!R;++$<me;)_e[$]=d[$];for(var Oe=$;++re<pe;)_e[Oe+re]=v[re];for(;++q<ee;)(xe||$<H)&&(_e[Oe+x[q]]=d[$++]);return _e}function _t(d,v){var x=-1,R=d.length;for(v||(v=ce(R));++x<R;)v[x]=d[x];return v}function Wt(d,v,x,R){var $=!x;x||(x={});for(var H=-1,q=v.length;++H<q;){var ee=v[H],re=R?R(x[ee],d[ee],ee,x,d):r;re===r&&(re=d[ee]),$?Kt(x,ee,re):jn(x,ee,re)}return x}function wu(d,v){return Wt(d,Cs(d),v)}function Su(d,v){return Wt(d,Mo(d),v)}function wr(d,v){return function(x,R){var $=je(x)?Ac:zl,H=v?v():{};return $(x,d,De(R,2),H)}}function kn(d){return We(function(v,x){var R=-1,$=x.length,H=$>1?x[$-1]:r,q=$>2?x[2]:r;for(H=d.length>3&&typeof H=="function"?($--,H):r,q&&mt(x[0],x[1],q)&&(H=$<3?r:H,$=1),v=Je(v);++R<$;){var ee=x[R];ee&&d(v,ee,R,H)}return v})}function wo(d,v){return function(x,R){if(x==null)return x;if(!vt(x))return d(x,R);for(var $=x.length,H=v?$:-1,q=Je(x);(v?H--:++H<$)&&R(q[H],H,q)!==!1;);return x}}function So(d){return function(v,x,R){for(var $=-1,H=Je(v),q=R(v),ee=q.length;ee--;){var re=q[d?ee:++$];if(x(H[re],re,H)===!1)break}return v}}function Iu(d,v,x){var R=v&w,$=zn(d);function H(){var q=this&&this!==ut&&this instanceof H?$:d;return q.apply(R?x:this,arguments)}return H}function Io(d){return function(v){v=Ye(v);var x=wn(v)?$t(v):r,R=x?x[0]:v.charAt(0),$=x?an(x,1).join(""):v.slice(1);return R[d]()+$}}function Cn(d){return function(v){return Gr(wa(ba(v).replace(hc,"")),d,"")}}function zn(d){return function(){var v=arguments;switch(v.length){case 0:return new d;case 1:return new d(v[0]);case 2:return new d(v[0],v[1]);case 3:return new d(v[0],v[1],v[2]);case 4:return new d(v[0],v[1],v[2],v[3]);case 5:return new d(v[0],v[1],v[2],v[3],v[4]);case 6:return new d(v[0],v[1],v[2],v[3],v[4],v[5]);case 7:return new d(v[0],v[1],v[2],v[3],v[4],v[5],v[6])}var x=An(d.prototype),R=d.apply(x,v);return tt(R)?R:x}}function Eu(d,v,x){var R=zn(d);function $(){for(var H=arguments.length,q=ce(H),ee=H,re=On($);ee--;)q[ee]=arguments[ee];var pe=H<3&&q[0]!==re&&q[H-1]!==re?[]:tn(q,re);if(H-=pe.length,H<x)return ko(d,v,Sr,$.placeholder,r,q,pe,r,r,x-H);var me=this&&this!==ut&&this instanceof $?R:d;return St(me,this,q)}return $}function Eo(d){return function(v,x,R){var $=Je(v);if(!vt(v)){var H=De(x,3);v=lt(v),x=function(ee){return H($[ee],ee,$)}}var q=d(v,x,R);return q>-1?$[H?v[q]:q]:r}}function xo(d){return qt(function(v){var x=v.length,R=x,$=Pt.prototype.thru;for(d&&v.reverse();R--;){var H=v[R];if(typeof H!="function")throw new Ot(l);if($&&!q&&Tr(H)=="wrapper")var q=new Pt([],!0)}for(R=q?R:x;++R<x;){H=v[R];var ee=Tr(H),re=ee=="wrapper"?As(H):r;re&&Ps(re[0])&&re[1]==(C|I|T|k)&&!re[4].length&&re[9]==1?q=q[Tr(re[0])].apply(q,re[3]):q=H.length==1&&Ps(H)?q[ee]():q.thru(H)}return function(){var pe=arguments,me=pe[0];if(q&&pe.length==1&&je(me))return q.plant(me).value();for(var _e=0,xe=x?v[_e].apply(this,pe):me;++_e<x;)xe=v[_e].call(this,xe);return xe}})}function Sr(d,v,x,R,$,H,q,ee,re,pe){var me=v&C,_e=v&w,xe=v&S,Oe=v&(I|A),Fe=v&P,Ue=xe?r:zn(d);function Ne(){for(var Ve=arguments.length,He=ce(Ve),Tt=Ve;Tt--;)He[Tt]=arguments[Tt];if(Oe)var gt=On(Ne),At=Nc(He,gt);if(R&&(He=vo(He,R,$,Oe)),H&&(He=bo(He,H,q,Oe)),Ve-=At,Oe&&Ve<pe){var it=tn(He,gt);return ko(d,v,Sr,Ne.placeholder,x,He,it,ee,re,pe-Ve)}var Lt=_e?x:this,Zt=xe?Lt[d]:d;return Ve=He.length,ee?He=zu(He,ee):Fe&&Ve>1&&He.reverse(),me&&re<Ve&&(He.length=re),this&&this!==ut&&this instanceof Ne&&(Zt=Ue||zn(Zt)),Zt.apply(Lt,He)}return Ne}function To(d,v){return function(x,R){return Zl(x,d,v(R),{})}}function Ir(d,v){return function(x,R){var $;if(x===r&&R===r)return v;if(x!==r&&($=x),R!==r){if($===r)return R;typeof x=="string"||typeof R=="string"?(x=Et(x),R=Et(R)):(x=uo(x),R=uo(R)),$=d(x,R)}return $}}function Is(d){return qt(function(v){return v=et(v,It(De())),We(function(x){var R=this;return d(v,function($){return St($,R,x)})})})}function Er(d,v){v=v===r?" ":Et(v);var x=v.length;if(x<2)return x?gs(v,d):v;var R=gs(v,ur(d/Sn(v)));return wn(v)?an($t(R),0,d).join(""):R.slice(0,d)}function xu(d,v,x,R){var $=v&w,H=zn(d);function q(){for(var ee=-1,re=arguments.length,pe=-1,me=R.length,_e=ce(me+re),xe=this&&this!==ut&&this instanceof q?H:d;++pe<me;)_e[pe]=R[pe];for(;re--;)_e[pe++]=arguments[++ee];return St(xe,$?x:this,_e)}return q}function Ao(d){return function(v,x,R){return R&&typeof R!="number"&&mt(v,x,R)&&(x=R=r),v=Jt(v),x===r?(x=v,v=0):x=Jt(x),R=R===r?v<x?1:-1:Jt(R),uu(v,x,R,d)}}function xr(d){return function(v,x){return typeof v=="string"&&typeof x=="string"||(v=Ft(v),x=Ft(x)),d(v,x)}}function ko(d,v,x,R,$,H,q,ee,re,pe){var me=v&I,_e=me?q:r,xe=me?r:q,Oe=me?H:r,Fe=me?r:H;v|=me?T:O,v&=~(me?O:T),v&E||(v&=~(w|S));var Ue=[d,v,$,Oe,_e,Fe,xe,ee,re,pe],Ne=x.apply(r,Ue);return Ps(d)&&Lo(Ne,Ue),Ne.placeholder=R,Uo(Ne,d,v)}function Es(d){var v=at[d];return function(x,R){if(x=Ft(x),R=R==null?0:ft(Le(R),292),R&&Li(x)){var $=(Ye(x)+"e").split("e"),H=v($[0]+"e"+(+$[1]+R));return $=(Ye(H)+"e").split("e"),+($[0]+"e"+(+$[1]-R))}return v(x)}}var Tu=xn&&1/Qn(new xn([,-0]))[1]==X?function(d){return new xn(d)}:Ks;function Co(d){return function(v){var x=ht(v);return x==ie?es(v):x==B?Vc(v):Fc(v,d(v))}}function Gt(d,v,x,R,$,H,q,ee){var re=v&S;if(!re&&typeof d!="function")throw new Ot(l);var pe=R?R.length:0;if(pe||(v&=~(T|O),R=$=r),q=q===r?q:ct(Le(q),0),ee=ee===r?ee:Le(ee),pe-=$?$.length:0,v&O){var me=R,_e=$;R=$=r}var xe=re?r:As(d),Oe=[d,v,x,R,$,me,_e,H,q,ee];if(xe&&Uu(Oe,xe),d=Oe[0],v=Oe[1],x=Oe[2],R=Oe[3],$=Oe[4],ee=Oe[9]=Oe[9]===r?re?0:d.length:ct(Oe[9]-pe,0),!ee&&v&(I|A)&&(v&=~(I|A)),!v||v==w)var Fe=Iu(d,v,x);else v==I||v==A?Fe=Eu(d,v,ee):(v==T||v==(w|T))&&!$.length?Fe=xu(d,v,x,R):Fe=Sr.apply(r,Oe);var Ue=xe?co:Lo;return Uo(Ue(Fe,Oe),d,v)}function Oo(d,v,x,R){return d===r||jt(d,En[x])&&!Xe.call(R,x)?v:d}function Po(d,v,x,R,$,H){return tt(d)&&tt(v)&&(H.set(v,d),_r(d,v,r,Po,H),H.delete(v)),d}function Au(d){return Gn(d)?r:d}function Ro(d,v,x,R,$,H){var q=x&b,ee=d.length,re=v.length;if(ee!=re&&!(q&&re>ee))return!1;var pe=H.get(d),me=H.get(v);if(pe&&me)return pe==v&&me==d;var _e=-1,xe=!0,Oe=x&c?new fn:r;for(H.set(d,v),H.set(v,d);++_e<ee;){var Fe=d[_e],Ue=v[_e];if(R)var Ne=q?R(Ue,Fe,_e,v,d,H):R(Fe,Ue,_e,d,v,H);if(Ne!==r){if(Ne)continue;xe=!1;break}if(Oe){if(!qr(v,function(Ve,He){if(!Mn(Oe,He)&&(Fe===Ve||$(Fe,Ve,x,R,H)))return Oe.push(He)})){xe=!1;break}}else if(!(Fe===Ue||$(Fe,Ue,x,R,H))){xe=!1;break}}return H.delete(d),H.delete(v),xe}function ku(d,v,x,R,$,H,q){switch(x){case Ee:if(d.byteLength!=v.byteLength||d.byteOffset!=v.byteOffset)return!1;d=d.buffer,v=v.buffer;case ae:return!(d.byteLength!=v.byteLength||!H(new or(d),new or(v)));case Ce:case Ae:case le:return jt(+d,+v);case Re:return d.name==v.name&&d.message==v.message;case ye:case M:return d==v+"";case ie:var ee=es;case B:var re=R&b;if(ee||(ee=Qn),d.size!=v.size&&!re)return!1;var pe=q.get(d);if(pe)return pe==v;R|=c,q.set(d,v);var me=Ro(ee(d),ee(v),R,$,H,q);return q.delete(d),me;case D:if(Bn)return Bn.call(d)==Bn.call(v)}return!1}function Cu(d,v,x,R,$,H){var q=x&b,ee=xs(d),re=ee.length,pe=xs(v),me=pe.length;if(re!=me&&!q)return!1;for(var _e=re;_e--;){var xe=ee[_e];if(!(q?xe in v:Xe.call(v,xe)))return!1}var Oe=H.get(d),Fe=H.get(v);if(Oe&&Fe)return Oe==v&&Fe==d;var Ue=!0;H.set(d,v),H.set(v,d);for(var Ne=q;++_e<re;){xe=ee[_e];var Ve=d[xe],He=v[xe];if(R)var Tt=q?R(He,Ve,xe,v,d,H):R(Ve,He,xe,d,v,H);if(!(Tt===r?Ve===He||$(Ve,He,x,R,H):Tt)){Ue=!1;break}Ne||(Ne=xe=="constructor")}if(Ue&&!Ne){var gt=d.constructor,At=v.constructor;gt!=At&&"constructor"in d&&"constructor"in v&&!(typeof gt=="function"&&gt instanceof gt&&typeof At=="function"&&At instanceof At)&&(Ue=!1)}return H.delete(d),H.delete(v),Ue}function qt(d){return Ms(Bo(d,r,Go),d+"")}function xs(d){return Ji(d,lt,Cs)}function Ts(d){return Ji(d,bt,Mo)}var As=fr?function(d){return fr.get(d)}:Ks;function Tr(d){for(var v=d.name+"",x=Tn[v],R=Xe.call(Tn,v)?x.length:0;R--;){var $=x[R],H=$.func;if(H==null||H==d)return $.name}return v}function On(d){var v=Xe.call(W,"placeholder")?W:d;return v.placeholder}function De(){var d=W.iteratee||zs;return d=d===zs?eo:d,arguments.length?d(arguments[0],arguments[1]):d}function Ar(d,v){var x=d.__data__;return $u(v)?x[typeof v=="string"?"string":"hash"]:x.map}function ks(d){for(var v=lt(d),x=v.length;x--;){var R=v[x],$=d[R];v[x]=[R,$,No($)]}return v}function mn(d,v){var x=Lc(d,v);return Qi(x)?x:r}function Ou(d){var v=Xe.call(d,un),x=d[un];try{d[un]=r;var R=!0}catch{}var $=rr.call(d);return R&&(v?d[un]=x:delete d[un]),$}var Cs=ns?function(d){return d==null?[]:(d=Je(d),Qt(ns(d),function(v){return Bi.call(d,v)}))}:Gs,Mo=ns?function(d){for(var v=[];d;)en(v,Cs(d)),d=ar(d);return v}:Gs,ht=pt;(rs&&ht(new rs(new ArrayBuffer(1)))!=Ee||Fn&&ht(new Fn)!=ie||ss&&ht(ss.resolve())!=ve||xn&&ht(new xn)!=B||Nn&&ht(new Nn)!=Z)&&(ht=function(d){var v=pt(d),x=v==he?d.constructor:r,R=x?gn(x):"";if(R)switch(R){case fl:return Ee;case hl:return ie;case pl:return ve;case ml:return B;case gl:return Z}return v});function Pu(d,v,x){for(var R=-1,$=x.length;++R<$;){var H=x[R],q=H.size;switch(H.type){case"drop":d+=q;break;case"dropRight":v-=q;break;case"take":v=ft(v,d+q);break;case"takeRight":d=ct(d,v-q);break}}return{start:d,end:v}}function Ru(d){var v=d.match(Ba);return v?v[1].split(ja):[]}function Do(d,v,x){v=on(v,d);for(var R=-1,$=v.length,H=!1;++R<$;){var q=Vt(v[R]);if(!(H=d!=null&&x(d,q)))break;d=d[q]}return H||++R!=$?H:($=d==null?0:d.length,!!$&&Dr($)&&Yt(q,$)&&(je(d)||yn(d)))}function Mu(d){var v=d.length,x=new d.constructor(v);return v&&typeof d[0]=="string"&&Xe.call(d,"index")&&(x.index=d.index,x.input=d.input),x}function Fo(d){return typeof d.constructor=="function"&&!Hn(d)?An(ar(d)):{}}function Du(d,v,x){var R=d.constructor;switch(v){case ae:return Ss(d);case Ce:case Ae:return new R(+d);case Ee:return yu(d,x);case Pe:case $e:case Ke:case Ge:case ot:case Nt:case nt:case yt:case _n:return yo(d,x);case ie:return new R;case le:case M:return new R(d);case ye:return _u(d);case B:return new R;case D:return vu(d)}}function Fu(d,v){var x=v.length;if(!x)return d;var R=x-1;return v[R]=(x>1?"& ":"")+v[R],v=v.join(x>2?", ":" "),d.replace($a,`{
/* [wrapped with `+v+`] */
`)}function Nu(d){return je(d)||yn(d)||!!(ji&&d&&d[ji])}function Yt(d,v){var x=typeof d;return v=v??J,!!v&&(x=="number"||x!="symbol"&&qa.test(d))&&d>-1&&d%1==0&&d<v}function mt(d,v,x){if(!tt(x))return!1;var R=typeof v;return(R=="number"?vt(x)&&Yt(v,x.length):R=="string"&&v in x)?jt(x[v],d):!1}function Os(d,v){if(je(d))return!1;var x=typeof d;return x=="number"||x=="symbol"||x=="boolean"||d==null||xt(d)?!0:Ma.test(d)||!Ra.test(d)||v!=null&&d in Je(v)}function $u(d){var v=typeof d;return v=="string"||v=="number"||v=="symbol"||v=="boolean"?d!=="__proto__":d===null}function Ps(d){var v=Tr(d),x=W[v];if(typeof x!="function"||!(v in ze.prototype))return!1;if(d===x)return!0;var R=As(x);return!!R&&d===R[0]}function Bu(d){return!!Fi&&Fi in d}var ju=tr?Xt:qs;function Hn(d){var v=d&&d.constructor,x=typeof v=="function"&&v.prototype||En;return d===x}function No(d){return d===d&&!tt(d)}function $o(d,v){return function(x){return x==null?!1:x[d]===v&&(v!==r||d in Je(x))}}function Lu(d){var v=Rr(d,function(R){return x.size===g&&x.clear(),R}),x=v.cache;return v}function Uu(d,v){var x=d[1],R=v[1],$=x|R,H=$<(w|S|C),q=R==C&&x==I||R==C&&x==k&&d[7].length<=v[8]||R==(C|k)&&v[7].length<=v[8]&&x==I;if(!(H||q))return d;R&w&&(d[2]=v[2],$|=x&w?0:E);var ee=v[3];if(ee){var re=d[3];d[3]=re?vo(re,ee,v[4]):ee,d[4]=re?tn(d[3],y):v[4]}return ee=v[5],ee&&(re=d[5],d[5]=re?bo(re,ee,v[6]):ee,d[6]=re?tn(d[5],y):v[6]),ee=v[7],ee&&(d[7]=ee),R&C&&(d[8]=d[8]==null?v[8]:ft(d[8],v[8])),d[9]==null&&(d[9]=v[9]),d[0]=v[0],d[1]=$,d}function Wu(d){var v=[];if(d!=null)for(var x in Je(d))v.push(x);return v}function Vu(d){return rr.call(d)}function Bo(d,v,x){return v=ct(v===r?d.length-1:v,0),function(){for(var R=arguments,$=-1,H=ct(R.length-v,0),q=ce(H);++$<H;)q[$]=R[v+$];$=-1;for(var ee=ce(v+1);++$<v;)ee[$]=R[$];return ee[v]=x(q),St(d,this,ee)}}function jo(d,v){return v.length<2?d:pn(d,Mt(v,0,-1))}function zu(d,v){for(var x=d.length,R=ft(v.length,x),$=_t(d);R--;){var H=v[R];d[R]=Yt(H,x)?$[H]:r}return d}function Rs(d,v){if(!(v==="constructor"&&typeof d[v]=="function")&&v!="__proto__")return d[v]}var Lo=Wo(co),Kn=il||function(d,v){return ut.setTimeout(d,v)},Ms=Wo(hu);function Uo(d,v,x){var R=v+"";return Ms(d,Fu(R,Hu(Ru(R),x)))}function Wo(d){var v=0,x=0;return function(){var R=ll(),$=V-(R-x);if(x=R,$>0){if(++v>=F)return arguments[0]}else v=0;return d.apply(r,arguments)}}function kr(d,v){var x=-1,R=d.length,$=R-1;for(v=v===r?R:v;++x<v;){var H=ms(x,$),q=d[H];d[H]=d[x],d[x]=q}return d.length=v,d}var Vo=Lu(function(d){var v=[];return d.charCodeAt(0)===46&&v.push(""),d.replace(Da,function(x,R,$,H){v.push($?H.replace(Wa,"$1"):R||x)}),v});function Vt(d){if(typeof d=="string"||xt(d))return d;var v=d+"";return v=="0"&&1/d==-X?"-0":v}function gn(d){if(d!=null){try{return nr.call(d)}catch{}try{return d+""}catch{}}return""}function Hu(d,v){return Ct(we,function(x){var R="_."+x[0];v&x[1]&&!Jn(d,R)&&d.push(R)}),d.sort()}function zo(d){if(d instanceof ze)return d.clone();var v=new Pt(d.__wrapped__,d.__chain__);return v.__actions__=_t(d.__actions__),v.__index__=d.__index__,v.__values__=d.__values__,v}function Ku(d,v,x){(x?mt(d,v,x):v===r)?v=1:v=ct(Le(v),0);var R=d==null?0:d.length;if(!R||v<1)return[];for(var $=0,H=0,q=ce(ur(R/v));$<R;)q[H++]=Mt(d,$,$+=v);return q}function Gu(d){for(var v=-1,x=d==null?0:d.length,R=0,$=[];++v<x;){var H=d[v];H&&($[R++]=H)}return $}function qu(){var d=arguments.length;if(!d)return[];for(var v=ce(d-1),x=arguments[0],R=d;R--;)v[R-1]=arguments[R];return en(je(x)?_t(x):[x],dt(v,1))}var Yu=We(function(d,v){return st(d)?Ln(d,dt(v,1,st,!0)):[]}),Xu=We(function(d,v){var x=Dt(v);return st(x)&&(x=r),st(d)?Ln(d,dt(v,1,st,!0),De(x,2)):[]}),Ju=We(function(d,v){var x=Dt(v);return st(x)&&(x=r),st(d)?Ln(d,dt(v,1,st,!0),r,x):[]});function Zu(d,v,x){var R=d==null?0:d.length;return R?(v=x||v===r?1:Le(v),Mt(d,v<0?0:v,R)):[]}function Qu(d,v,x){var R=d==null?0:d.length;return R?(v=x||v===r?1:Le(v),v=R-v,Mt(d,0,v<0?0:v)):[]}function ed(d,v){return d&&d.length?br(d,De(v,3),!0,!0):[]}function td(d,v){return d&&d.length?br(d,De(v,3),!0):[]}function nd(d,v,x,R){var $=d==null?0:d.length;return $?(x&&typeof x!="number"&&mt(d,v,x)&&(x=0,R=$),ql(d,v,x,R)):[]}function Ho(d,v,x){var R=d==null?0:d.length;if(!R)return-1;var $=x==null?0:Le(x);return $<0&&($=ct(R+$,0)),Zn(d,De(v,3),$)}function Ko(d,v,x){var R=d==null?0:d.length;if(!R)return-1;var $=R-1;return x!==r&&($=Le(x),$=x<0?ct(R+$,0):ft($,R-1)),Zn(d,De(v,3),$,!0)}function Go(d){var v=d==null?0:d.length;return v?dt(d,1):[]}function rd(d){var v=d==null?0:d.length;return v?dt(d,X):[]}function sd(d,v){var x=d==null?0:d.length;return x?(v=v===r?1:Le(v),dt(d,v)):[]}function id(d){for(var v=-1,x=d==null?0:d.length,R={};++v<x;){var $=d[v];R[$[0]]=$[1]}return R}function qo(d){return d&&d.length?d[0]:r}function od(d,v,x){var R=d==null?0:d.length;if(!R)return-1;var $=x==null?0:Le(x);return $<0&&($=ct(R+$,0)),bn(d,v,$)}function ad(d){var v=d==null?0:d.length;return v?Mt(d,0,-1):[]}var cd=We(function(d){var v=et(d,bs);return v.length&&v[0]===d[0]?us(v):[]}),ld=We(function(d){var v=Dt(d),x=et(d,bs);return v===Dt(x)?v=r:x.pop(),x.length&&x[0]===d[0]?us(x,De(v,2)):[]}),ud=We(function(d){var v=Dt(d),x=et(d,bs);return v=typeof v=="function"?v:r,v&&x.pop(),x.length&&x[0]===d[0]?us(x,r,v):[]});function dd(d,v){return d==null?"":al.call(d,v)}function Dt(d){var v=d==null?0:d.length;return v?d[v-1]:r}function fd(d,v,x){var R=d==null?0:d.length;if(!R)return-1;var $=R;return x!==r&&($=Le(x),$=$<0?ct(R+$,0):ft($,R-1)),v===v?Hc(d,v,$):Zn(d,Ai,$,!0)}function hd(d,v){return d&&d.length?so(d,Le(v)):r}var pd=We(Yo);function Yo(d,v){return d&&d.length&&v&&v.length?ps(d,v):d}function md(d,v,x){return d&&d.length&&v&&v.length?ps(d,v,De(x,2)):d}function gd(d,v,x){return d&&d.length&&v&&v.length?ps(d,v,r,x):d}var yd=qt(function(d,v){var x=d==null?0:d.length,R=os(d,v);return ao(d,et(v,function($){return Yt($,x)?+$:$}).sort(_o)),R});function _d(d,v){var x=[];if(!(d&&d.length))return x;var R=-1,$=[],H=d.length;for(v=De(v,3);++R<H;){var q=d[R];v(q,R,d)&&(x.push(q),$.push(R))}return ao(d,$),x}function Ds(d){return d==null?d:dl.call(d)}function vd(d,v,x){var R=d==null?0:d.length;return R?(x&&typeof x!="number"&&mt(d,v,x)?(v=0,x=R):(v=v==null?0:Le(v),x=x===r?R:Le(x)),Mt(d,v,x)):[]}function bd(d,v){return vr(d,v)}function wd(d,v,x){return ys(d,v,De(x,2))}function Sd(d,v){var x=d==null?0:d.length;if(x){var R=vr(d,v);if(R<x&&jt(d[R],v))return R}return-1}function Id(d,v){return vr(d,v,!0)}function Ed(d,v,x){return ys(d,v,De(x,2),!0)}function xd(d,v){var x=d==null?0:d.length;if(x){var R=vr(d,v,!0)-1;if(jt(d[R],v))return R}return-1}function Td(d){return d&&d.length?lo(d):[]}function Ad(d,v){return d&&d.length?lo(d,De(v,2)):[]}function kd(d){var v=d==null?0:d.length;return v?Mt(d,1,v):[]}function Cd(d,v,x){return d&&d.length?(v=x||v===r?1:Le(v),Mt(d,0,v<0?0:v)):[]}function Od(d,v,x){var R=d==null?0:d.length;return R?(v=x||v===r?1:Le(v),v=R-v,Mt(d,v<0?0:v,R)):[]}function Pd(d,v){return d&&d.length?br(d,De(v,3),!1,!0):[]}function Rd(d,v){return d&&d.length?br(d,De(v,3)):[]}var Md=We(function(d){return sn(dt(d,1,st,!0))}),Dd=We(function(d){var v=Dt(d);return st(v)&&(v=r),sn(dt(d,1,st,!0),De(v,2))}),Fd=We(function(d){var v=Dt(d);return v=typeof v=="function"?v:r,sn(dt(d,1,st,!0),r,v)});function Nd(d){return d&&d.length?sn(d):[]}function $d(d,v){return d&&d.length?sn(d,De(v,2)):[]}function Bd(d,v){return v=typeof v=="function"?v:r,d&&d.length?sn(d,r,v):[]}function Fs(d){if(!(d&&d.length))return[];var v=0;return d=Qt(d,function(x){if(st(x))return v=ct(x.length,v),!0}),Zr(v,function(x){return et(d,Yr(x))})}function Xo(d,v){if(!(d&&d.length))return[];var x=Fs(d);return v==null?x:et(x,function(R){return St(v,r,R)})}var jd=We(function(d,v){return st(d)?Ln(d,v):[]}),Ld=We(function(d){return vs(Qt(d,st))}),Ud=We(function(d){var v=Dt(d);return st(v)&&(v=r),vs(Qt(d,st),De(v,2))}),Wd=We(function(d){var v=Dt(d);return v=typeof v=="function"?v:r,vs(Qt(d,st),r,v)}),Vd=We(Fs);function zd(d,v){return po(d||[],v||[],jn)}function Hd(d,v){return po(d||[],v||[],Vn)}var Kd=We(function(d){var v=d.length,x=v>1?d[v-1]:r;return x=typeof x=="function"?(d.pop(),x):r,Xo(d,x)});function Jo(d){var v=W(d);return v.__chain__=!0,v}function Gd(d,v){return v(d),d}function Cr(d,v){return v(d)}var qd=qt(function(d){var v=d.length,x=v?d[0]:0,R=this.__wrapped__,$=function(H){return os(H,d)};return v>1||this.__actions__.length||!(R instanceof ze)||!Yt(x)?this.thru($):(R=R.slice(x,+x+(v?1:0)),R.__actions__.push({func:Cr,args:[$],thisArg:r}),new Pt(R,this.__chain__).thru(function(H){return v&&!H.length&&H.push(r),H}))});function Yd(){return Jo(this)}function Xd(){return new Pt(this.value(),this.__chain__)}function Jd(){this.__values__===r&&(this.__values__=da(this.value()));var d=this.__index__>=this.__values__.length,v=d?r:this.__values__[this.__index__++];return{done:d,value:v}}function Zd(){return this}function Qd(d){for(var v,x=this;x instanceof pr;){var R=zo(x);R.__index__=0,R.__values__=r,v?$.__wrapped__=R:v=R;var $=R;x=x.__wrapped__}return $.__wrapped__=d,v}function ef(){var d=this.__wrapped__;if(d instanceof ze){var v=d;return this.__actions__.length&&(v=new ze(this)),v=v.reverse(),v.__actions__.push({func:Cr,args:[Ds],thisArg:r}),new Pt(v,this.__chain__)}return this.thru(Ds)}function nf(){return ho(this.__wrapped__,this.__actions__)}var rf=wr(function(d,v,x){Xe.call(d,x)?++d[x]:Kt(d,x,1)});function sf(d,v,x){var R=je(d)?xi:Gl;return x&&mt(d,v,x)&&(v=r),R(d,De(v,3))}function of(d,v){var x=je(d)?Qt:Yi;return x(d,De(v,3))}var af=Eo(Ho),cf=Eo(Ko);function lf(d,v){return dt(Or(d,v),1)}function uf(d,v){return dt(Or(d,v),X)}function df(d,v,x){return x=x===r?1:Le(x),dt(Or(d,v),x)}function Zo(d,v){var x=je(d)?Ct:rn;return x(d,De(v,3))}function Qo(d,v){var x=je(d)?kc:qi;return x(d,De(v,3))}var ff=wr(function(d,v,x){Xe.call(d,x)?d[x].push(v):Kt(d,x,[v])});function hf(d,v,x,R){d=vt(d)?d:Rn(d),x=x&&!R?Le(x):0;var $=d.length;return x<0&&(x=ct($+x,0)),Fr(d)?x<=$&&d.indexOf(v,x)>-1:!!$&&bn(d,v,x)>-1}var pf=We(function(d,v,x){var R=-1,$=typeof v=="function",H=vt(d)?ce(d.length):[];return rn(d,function(q){H[++R]=$?St(v,q,x):Un(q,v,x)}),H}),mf=wr(function(d,v,x){Kt(d,x,v)});function Or(d,v){var x=je(d)?et:to;return x(d,De(v,3))}function gf(d,v,x,R){return d==null?[]:(je(v)||(v=v==null?[]:[v]),x=R?r:x,je(x)||(x=x==null?[]:[x]),io(d,v,x))}var yf=wr(function(d,v,x){d[x?0:1].push(v)},function(){return[[],[]]});function _f(d,v,x){var R=je(d)?Gr:Ci,$=arguments.length<3;return R(d,De(v,4),x,$,rn)}function vf(d,v,x){var R=je(d)?Cc:Ci,$=arguments.length<3;return R(d,De(v,4),x,$,qi)}function bf(d,v){var x=je(d)?Qt:Yi;return x(d,Mr(De(v,3)))}function wf(d){var v=je(d)?zi:du;return v(d)}function Sf(d,v,x){(x?mt(d,v,x):v===r)?v=1:v=Le(v);var R=je(d)?Wl:fu;return R(d,v)}function If(d){var v=je(d)?Vl:pu;return v(d)}function Ef(d){if(d==null)return 0;if(vt(d))return Fr(d)?Sn(d):d.length;var v=ht(d);return v==ie||v==B?d.size:fs(d).length}function xf(d,v,x){var R=je(d)?qr:mu;return x&&mt(d,v,x)&&(v=r),R(d,De(v,3))}var Tf=We(function(d,v){if(d==null)return[];var x=v.length;return x>1&&mt(d,v[0],v[1])?v=[]:x>2&&mt(v[0],v[1],v[2])&&(v=[v[0]]),io(d,dt(v,1),[])}),Pr=sl||function(){return ut.Date.now()};function Af(d,v){if(typeof v!="function")throw new Ot(l);return d=Le(d),function(){if(--d<1)return v.apply(this,arguments)}}function ea(d,v,x){return v=x?r:v,v=d&&v==null?d.length:v,Gt(d,C,r,r,r,r,v)}function ta(d,v){var x;if(typeof v!="function")throw new Ot(l);return d=Le(d),function(){return--d>0&&(x=v.apply(this,arguments)),d<=1&&(v=r),x}}var Ns=We(function(d,v,x){var R=w;if(x.length){var $=tn(x,On(Ns));R|=T}return Gt(d,R,v,x,$)}),na=We(function(d,v,x){var R=w|S;if(x.length){var $=tn(x,On(na));R|=T}return Gt(v,R,d,x,$)});function ra(d,v,x){v=x?r:v;var R=Gt(d,I,r,r,r,r,r,v);return R.placeholder=ra.placeholder,R}function sa(d,v,x){v=x?r:v;var R=Gt(d,A,r,r,r,r,r,v);return R.placeholder=sa.placeholder,R}function ia(d,v,x){var R,$,H,q,ee,re,pe=0,me=!1,_e=!1,xe=!0;if(typeof d!="function")throw new Ot(l);v=Ft(v)||0,tt(x)&&(me=!!x.leading,_e="maxWait"in x,H=_e?ct(Ft(x.maxWait)||0,v):H,xe="trailing"in x?!!x.trailing:xe);function Oe(it){var Lt=R,Zt=$;return R=$=r,pe=it,q=d.apply(Zt,Lt),q}function Fe(it){return pe=it,ee=Kn(Ve,v),me?Oe(it):q}function Ue(it){var Lt=it-re,Zt=it-pe,Ea=v-Lt;return _e?ft(Ea,H-Zt):Ea}function Ne(it){var Lt=it-re,Zt=it-pe;return re===r||Lt>=v||Lt<0||_e&&Zt>=H}function Ve(){var it=Pr();if(Ne(it))return He(it);ee=Kn(Ve,Ue(it))}function He(it){return ee=r,xe&&R?Oe(it):(R=$=r,q)}function Tt(){ee!==r&&mo(ee),pe=0,R=re=$=ee=r}function gt(){return ee===r?q:He(Pr())}function At(){var it=Pr(),Lt=Ne(it);if(R=arguments,$=this,re=it,Lt){if(ee===r)return Fe(re);if(_e)return mo(ee),ee=Kn(Ve,v),Oe(re)}return ee===r&&(ee=Kn(Ve,v)),q}return At.cancel=Tt,At.flush=gt,At}var kf=We(function(d,v){return Gi(d,1,v)}),Cf=We(function(d,v,x){return Gi(d,Ft(v)||0,x)});function Of(d){return Gt(d,P)}function Rr(d,v){if(typeof d!="function"||v!=null&&typeof v!="function")throw new Ot(l);var x=function(){var R=arguments,$=v?v.apply(this,R):R[0],H=x.cache;if(H.has($))return H.get($);var q=d.apply(this,R);return x.cache=H.set($,q)||H,q};return x.cache=new(Rr.Cache||Ht),x}Rr.Cache=Ht;function Mr(d){if(typeof d!="function")throw new Ot(l);return function(){var v=arguments;switch(v.length){case 0:return!d.call(this);case 1:return!d.call(this,v[0]);case 2:return!d.call(this,v[0],v[1]);case 3:return!d.call(this,v[0],v[1],v[2])}return!d.apply(this,v)}}function Pf(d){return ta(2,d)}var Rf=gu(function(d,v){v=v.length==1&&je(v[0])?et(v[0],It(De())):et(dt(v,1),It(De()));var x=v.length;return We(function(R){for(var $=-1,H=ft(R.length,x);++$<H;)R[$]=v[$].call(this,R[$]);return St(d,this,R)})}),$s=We(function(d,v){var x=tn(v,On($s));return Gt(d,T,r,v,x)}),oa=We(function(d,v){var x=tn(v,On(oa));return Gt(d,O,r,v,x)}),Mf=qt(function(d,v){return Gt(d,k,r,r,r,v)});function Df(d,v){if(typeof d!="function")throw new Ot(l);return v=v===r?v:Le(v),We(d,v)}function Ff(d,v){if(typeof d!="function")throw new Ot(l);return v=v==null?0:ct(Le(v),0),We(function(x){var R=x[v],$=an(x,0,v);return R&&en($,R),St(d,this,$)})}function Nf(d,v,x){var R=!0,$=!0;if(typeof d!="function")throw new Ot(l);return tt(x)&&(R="leading"in x?!!x.leading:R,$="trailing"in x?!!x.trailing:$),ia(d,v,{leading:R,maxWait:v,trailing:$})}function $f(d){return ea(d,1)}function Bf(d,v){return $s(ws(v),d)}function jf(){if(!arguments.length)return[];var d=arguments[0];return je(d)?d:[d]}function Lf(d){return Rt(d,_)}function Uf(d,v){return v=typeof v=="function"?v:r,Rt(d,_,v)}function Wf(d){return Rt(d,a|_)}function Vf(d,v){return v=typeof v=="function"?v:r,Rt(d,a|_,v)}function zf(d,v){return v==null||Ki(d,v,lt(v))}function jt(d,v){return d===v||d!==d&&v!==v}var Hf=xr(ls),Kf=xr(function(d,v){return d>=v}),yn=Zi(function(){return arguments}())?Zi:function(d){return rt(d)&&Xe.call(d,"callee")&&!Bi.call(d,"callee")},je=ce.isArray,Gf=vi?It(vi):Ql;function vt(d){return d!=null&&Dr(d.length)&&!Xt(d)}function st(d){return rt(d)&&vt(d)}function qf(d){return d===!0||d===!1||rt(d)&&pt(d)==Ce}var cn=ol||qs,Yf=bi?It(bi):eu;function Xf(d){return rt(d)&&d.nodeType===1&&!Gn(d)}function Jf(d){if(d==null)return!0;if(vt(d)&&(je(d)||typeof d=="string"||typeof d.splice=="function"||cn(d)||Pn(d)||yn(d)))return!d.length;var v=ht(d);if(v==ie||v==B)return!d.size;if(Hn(d))return!fs(d).length;for(var x in d)if(Xe.call(d,x))return!1;return!0}function Zf(d,v){return Wn(d,v)}function Qf(d,v,x){x=typeof x=="function"?x:r;var R=x?x(d,v):r;return R===r?Wn(d,v,r,x):!!R}function Bs(d){if(!rt(d))return!1;var v=pt(d);return v==Re||v==Me||typeof d.message=="string"&&typeof d.name=="string"&&!Gn(d)}function eh(d){return typeof d=="number"&&Li(d)}function Xt(d){if(!tt(d))return!1;var v=pt(d);return v==G||v==Q||v==Te||v==be}function aa(d){return typeof d=="number"&&d==Le(d)}function Dr(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=J}function tt(d){var v=typeof d;return d!=null&&(v=="object"||v=="function")}function rt(d){return d!=null&&typeof d=="object"}var ca=wi?It(wi):nu;function th(d,v){return d===v||ds(d,v,ks(v))}function nh(d,v,x){return x=typeof x=="function"?x:r,ds(d,v,ks(v),x)}function rh(d){return la(d)&&d!=+d}function sh(d){if(ju(d))throw new Be(o);return Qi(d)}function ih(d){return d===null}function oh(d){return d==null}function la(d){return typeof d=="number"||rt(d)&&pt(d)==le}function Gn(d){if(!rt(d)||pt(d)!=he)return!1;var v=ar(d);if(v===null)return!0;var x=Xe.call(v,"constructor")&&v.constructor;return typeof x=="function"&&x instanceof x&&nr.call(x)==el}var js=Si?It(Si):ru;function ah(d){return aa(d)&&d>=-J&&d<=J}var ua=Ii?It(Ii):su;function Fr(d){return typeof d=="string"||!je(d)&&rt(d)&&pt(d)==M}function xt(d){return typeof d=="symbol"||rt(d)&&pt(d)==D}var Pn=Ei?It(Ei):iu;function ch(d){return d===r}function lh(d){return rt(d)&&ht(d)==Z}function uh(d){return rt(d)&&pt(d)==oe}var dh=xr(hs),fh=xr(function(d,v){return d<=v});function da(d){if(!d)return[];if(vt(d))return Fr(d)?$t(d):_t(d);if(Dn&&d[Dn])return Wc(d[Dn]());var v=ht(d),x=v==ie?es:v==B?Qn:Rn;return x(d)}function Jt(d){if(!d)return d===0?d:0;if(d=Ft(d),d===X||d===-X){var v=d<0?-1:1;return v*Y}return d===d?d:0}function Le(d){var v=Jt(d),x=v%1;return v===v?x?v-x:v:0}function fa(d){return d?hn(Le(d),0,se):0}function Ft(d){if(typeof d=="number")return d;if(xt(d))return te;if(tt(d)){var v=typeof d.valueOf=="function"?d.valueOf():d;d=tt(v)?v+"":v}if(typeof d!="string")return d===0?d:+d;d=Oi(d);var x=Ha.test(d);return x||Ga.test(d)?xc(d.slice(2),x?2:8):za.test(d)?te:+d}function ha(d){return Wt(d,bt(d))}function hh(d){return d?hn(Le(d),-J,J):d===0?d:0}function Ye(d){return d==null?"":Et(d)}var ph=kn(function(d,v){if(Hn(v)||vt(v)){Wt(v,lt(v),d);return}for(var x in v)Xe.call(v,x)&&jn(d,x,v[x])}),pa=kn(function(d,v){Wt(v,bt(v),d)}),Nr=kn(function(d,v,x,R){Wt(v,bt(v),d,R)}),mh=kn(function(d,v,x,R){Wt(v,lt(v),d,R)}),gh=qt(os);function yh(d,v){var x=An(d);return v==null?x:Hi(x,v)}var _h=We(function(d,v){d=Je(d);var x=-1,R=v.length,$=R>2?v[2]:r;for($&&mt(v[0],v[1],$)&&(R=1);++x<R;)for(var H=v[x],q=bt(H),ee=-1,re=q.length;++ee<re;){var pe=q[ee],me=d[pe];(me===r||jt(me,En[pe])&&!Xe.call(d,pe))&&(d[pe]=H[pe])}return d}),vh=We(function(d){return d.push(r,Po),St(ma,r,d)});function bh(d,v){return Ti(d,De(v,3),Ut)}function wh(d,v){return Ti(d,De(v,3),cs)}function Sh(d,v){return d==null?d:as(d,De(v,3),bt)}function Ih(d,v){return d==null?d:Xi(d,De(v,3),bt)}function Eh(d,v){return d&&Ut(d,De(v,3))}function xh(d,v){return d&&cs(d,De(v,3))}function Th(d){return d==null?[]:yr(d,lt(d))}function Ah(d){return d==null?[]:yr(d,bt(d))}function Ls(d,v,x){var R=d==null?r:pn(d,v);return R===r?x:R}function kh(d,v){return d!=null&&Do(d,v,Yl)}function Us(d,v){return d!=null&&Do(d,v,Xl)}var Ch=To(function(d,v,x){v!=null&&typeof v.toString!="function"&&(v=rr.call(v)),d[v]=x},Vs(wt)),Oh=To(function(d,v,x){v!=null&&typeof v.toString!="function"&&(v=rr.call(v)),Xe.call(d,v)?d[v].push(x):d[v]=[x]},De),Ph=We(Un);function lt(d){return vt(d)?Vi(d):fs(d)}function bt(d){return vt(d)?Vi(d,!0):ou(d)}function Rh(d,v){var x={};return v=De(v,3),Ut(d,function(R,$,H){Kt(x,v(R,$,H),R)}),x}function Mh(d,v){var x={};return v=De(v,3),Ut(d,function(R,$,H){Kt(x,$,v(R,$,H))}),x}var Dh=kn(function(d,v,x){_r(d,v,x)}),ma=kn(function(d,v,x,R){_r(d,v,x,R)}),Fh=qt(function(d,v){var x={};if(d==null)return x;var R=!1;v=et(v,function(H){return H=on(H,d),R||(R=H.length>1),H}),Wt(d,Ts(d),x),R&&(x=Rt(x,a|m|_,Au));for(var $=v.length;$--;)_s(x,v[$]);return x});function Nh(d,v){return ga(d,Mr(De(v)))}var $h=qt(function(d,v){return d==null?{}:cu(d,v)});function ga(d,v){if(d==null)return{};var x=et(Ts(d),function(R){return[R]});return v=De(v),oo(d,x,function(R,$){return v(R,$[0])})}function Bh(d,v,x){v=on(v,d);var R=-1,$=v.length;for($||($=1,d=r);++R<$;){var H=d==null?r:d[Vt(v[R])];H===r&&(R=$,H=x),d=Xt(H)?H.call(d):H}return d}function jh(d,v,x){return d==null?d:Vn(d,v,x)}function Lh(d,v,x,R){return R=typeof R=="function"?R:r,d==null?d:Vn(d,v,x,R)}var ya=Co(lt),_a=Co(bt);function Uh(d,v,x){var R=je(d),$=R||cn(d)||Pn(d);if(v=De(v,4),x==null){var H=d&&d.constructor;$?x=R?new H:[]:tt(d)?x=Xt(H)?An(ar(d)):{}:x={}}return($?Ct:Ut)(d,function(q,ee,re){return v(x,q,ee,re)}),x}function Wh(d,v){return d==null?!0:_s(d,v)}function Vh(d,v,x){return d==null?d:fo(d,v,ws(x))}function zh(d,v,x,R){return R=typeof R=="function"?R:r,d==null?d:fo(d,v,ws(x),R)}function Rn(d){return d==null?[]:Qr(d,lt(d))}function Hh(d){return d==null?[]:Qr(d,bt(d))}function Kh(d,v,x){return x===r&&(x=v,v=r),x!==r&&(x=Ft(x),x=x===x?x:0),v!==r&&(v=Ft(v),v=v===v?v:0),hn(Ft(d),v,x)}function Gh(d,v,x){return v=Jt(v),x===r?(x=v,v=0):x=Jt(x),d=Ft(d),Jl(d,v,x)}function qh(d,v,x){if(x&&typeof x!="boolean"&&mt(d,v,x)&&(v=x=r),x===r&&(typeof v=="boolean"?(x=v,v=r):typeof d=="boolean"&&(x=d,d=r)),d===r&&v===r?(d=0,v=1):(d=Jt(d),v===r?(v=d,d=0):v=Jt(v)),d>v){var R=d;d=v,v=R}if(x||d%1||v%1){var $=Ui();return ft(d+$*(v-d+Ec("1e-"+(($+"").length-1))),v)}return ms(d,v)}var Yh=Cn(function(d,v,x){return v=v.toLowerCase(),d+(x?va(v):v)});function va(d){return Ws(Ye(d).toLowerCase())}function ba(d){return d=Ye(d),d&&d.replace(Ya,$c).replace(pc,"")}function Xh(d,v,x){d=Ye(d),v=Et(v);var R=d.length;x=x===r?R:hn(Le(x),0,R);var $=x;return x-=v.length,x>=0&&d.slice(x,$)==v}function Jh(d){return d=Ye(d),d&&Ca.test(d)?d.replace(Xs,Bc):d}function Zh(d){return d=Ye(d),d&&Fa.test(d)?d.replace($r,"\\$&"):d}var Qh=Cn(function(d,v,x){return d+(x?"-":"")+v.toLowerCase()}),ep=Cn(function(d,v,x){return d+(x?" ":"")+v.toLowerCase()}),tp=Io("toLowerCase");function np(d,v,x){d=Ye(d),v=Le(v);var R=v?Sn(d):0;if(!v||R>=v)return d;var $=(v-R)/2;return Er(dr($),x)+d+Er(ur($),x)}function rp(d,v,x){d=Ye(d),v=Le(v);var R=v?Sn(d):0;return v&&R<v?d+Er(v-R,x):d}function sp(d,v,x){d=Ye(d),v=Le(v);var R=v?Sn(d):0;return v&&R<v?Er(v-R,x)+d:d}function ip(d,v,x){return x||v==null?v=0:v&&(v=+v),ul(Ye(d).replace(Br,""),v||0)}function ap(d,v,x){return(x?mt(d,v,x):v===r)?v=1:v=Le(v),gs(Ye(d),v)}function cp(){var d=arguments,v=Ye(d[0]);return d.length<3?v:v.replace(d[1],d[2])}var lp=Cn(function(d,v,x){return d+(x?"_":"")+v.toLowerCase()});function up(d,v,x){return x&&typeof x!="number"&&mt(d,v,x)&&(v=x=r),x=x===r?se:x>>>0,x?(d=Ye(d),d&&(typeof v=="string"||v!=null&&!js(v))&&(v=Et(v),!v&&wn(d))?an($t(d),0,x):d.split(v,x)):[]}var dp=Cn(function(d,v,x){return d+(x?" ":"")+Ws(v)});function fp(d,v,x){return d=Ye(d),x=x==null?0:hn(Le(x),0,d.length),v=Et(v),d.slice(x,x+v.length)==v}function hp(d,v,x){var R=W.templateSettings;x&&mt(d,v,x)&&(v=r),d=Ye(d),v=Nr({},v,R,Oo);var $=Nr({},v.imports,R.imports,Oo),H=lt($),q=Qr($,H),ee,re,pe=0,me=v.interpolate||qn,_e="__p += '",xe=ts((v.escape||qn).source+"|"+me.source+"|"+(me===Js?Va:qn).source+"|"+(v.evaluate||qn).source+"|$","g"),Oe="//# sourceURL="+(Xe.call(v,"sourceURL")?(v.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++vc+"]")+`
`;d.replace(xe,function(Ne,Ve,He,Tt,gt,At){return He||(He=Tt),_e+=d.slice(pe,At).replace(Xa,jc),Ve&&(ee=!0,_e+=`' +
__e(`+Ve+`) +
'`),gt&&(re=!0,_e+=`';
`+gt+`;
__p += '`),He&&(_e+=`' +
((__t = (`+He+`)) == null ? '' : __t) +
'`),pe=At+Ne.length,Ne}),_e+=`';
`;var Fe=Xe.call(v,"variable")&&v.variable;if(!Fe)_e=`with (obj) {
`+_e+`
}
`;else if(Ua.test(Fe))throw new Be(f);_e=(re?_e.replace(xa,""):_e).replace(Ta,"$1").replace(Aa,"$1;"),_e="function("+(Fe||"obj")+`) {
`+(Fe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ee?", __e = _.escape":"")+(re?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+_e+`return __p
}`;var Ue=Sa(function(){return qe(H,Oe+"return "+_e).apply(r,q)});if(Ue.source=_e,Bs(Ue))throw Ue;return Ue}function pp(d){return Ye(d).toLowerCase()}function mp(d){return Ye(d).toUpperCase()}function gp(d,v,x){if(d=Ye(d),d&&(x||v===r))return Oi(d);if(!d||!(v=Et(v)))return d;var R=$t(d),$=$t(v),H=Pi(R,$),q=Ri(R,$)+1;return an(R,H,q).join("")}function yp(d,v,x){if(d=Ye(d),d&&(x||v===r))return d.slice(0,Di(d)+1);if(!d||!(v=Et(v)))return d;var R=$t(d),$=Ri(R,$t(v))+1;return an(R,0,$).join("")}function _p(d,v,x){if(d=Ye(d),d&&(x||v===r))return d.replace(Br,"");if(!d||!(v=Et(v)))return d;var R=$t(d),$=Pi(R,$t(v));return an(R,$).join("")}function vp(d,v){var x=N,R=L;if(tt(v)){var $="separator"in v?v.separator:$;x="length"in v?Le(v.length):x,R="omission"in v?Et(v.omission):R}d=Ye(d);var H=d.length;if(wn(d)){var q=$t(d);H=q.length}if(x>=H)return d;var ee=x-Sn(R);if(ee<1)return R;var re=q?an(q,0,ee).join(""):d.slice(0,ee);if($===r)return re+R;if(q&&(ee+=re.length-ee),js($)){if(d.slice(ee).search($)){var pe,me=re;for($.global||($=ts($.source,Ye(Zs.exec($))+"g")),$.lastIndex=0;pe=$.exec(me);)var _e=pe.index;re=re.slice(0,_e===r?ee:_e)}}else if(d.indexOf(Et($),ee)!=ee){var xe=re.lastIndexOf($);xe>-1&&(re=re.slice(0,xe))}return re+R}function bp(d){return d=Ye(d),d&&ka.test(d)?d.replace(Ys,Kc):d}var wp=Cn(function(d,v,x){return d+(x?" ":"")+v.toUpperCase()}),Ws=Io("toUpperCase");function wa(d,v,x){return d=Ye(d),v=x?r:v,v===r?Uc(d)?Yc(d):Rc(d):d.match(v)||[]}var Sa=We(function(d,v){try{return St(d,r,v)}catch(x){return Bs(x)?x:new Be(x)}}),Sp=qt(function(d,v){return Ct(v,function(x){x=Vt(x),Kt(d,x,Ns(d[x],d))}),d});function Ip(d){var v=d==null?0:d.length,x=De();return d=v?et(d,function(R){if(typeof R[1]!="function")throw new Ot(l);return[x(R[0]),R[1]]}):[],We(function(R){for(var $=-1;++$<v;){var H=d[$];if(St(H[0],this,R))return St(H[1],this,R)}})}function Ep(d){return Kl(Rt(d,a))}function Vs(d){return function(){return d}}function xp(d,v){return d==null||d!==d?v:d}var Tp=xo(),Ap=xo(!0);function wt(d){return d}function zs(d){return eo(typeof d=="function"?d:Rt(d,a))}function kp(d){return no(Rt(d,a))}function Cp(d,v){return ro(d,Rt(v,a))}var Op=We(function(d,v){return function(x){return Un(x,d,v)}}),Pp=We(function(d,v){return function(x){return Un(d,x,v)}});function Hs(d,v,x){var R=lt(v),$=yr(v,R);x==null&&!(tt(v)&&($.length||!R.length))&&(x=v,v=d,d=this,$=yr(v,lt(v)));var H=!(tt(x)&&"chain"in x)||!!x.chain,q=Xt(d);return Ct($,function(ee){var re=v[ee];d[ee]=re,q&&(d.prototype[ee]=function(){var pe=this.__chain__;if(H||pe){var me=d(this.__wrapped__),_e=me.__actions__=_t(this.__actions__);return _e.push({func:re,args:arguments,thisArg:d}),me.__chain__=pe,me}return re.apply(d,en([this.value()],arguments))})}),d}function Rp(){return ut._===this&&(ut._=tl),this}function Ks(){}function Mp(d){return d=Le(d),We(function(v){return so(v,d)})}var Dp=Is(et),Fp=Is(xi),Np=Is(qr);function Ia(d){return Os(d)?Yr(Vt(d)):lu(d)}function $p(d){return function(v){return d==null?r:pn(d,v)}}var Bp=Ao(),jp=Ao(!0);function Gs(){return[]}function qs(){return!1}function Lp(){return{}}function Up(){return""}function Wp(){return!0}function Vp(d,v){if(d=Le(d),d<1||d>J)return[];var x=se,R=ft(d,se);v=De(v),d-=se;for(var $=Zr(R,v);++x<d;)v(x);return $}function zp(d){return je(d)?et(d,Vt):xt(d)?[d]:_t(Vo(Ye(d)))}function Hp(d){var v=++Qc;return Ye(d)+v}var Kp=Ir(function(d,v){return d+v},0),Gp=Es("ceil"),qp=Ir(function(d,v){return d/v},1),Yp=Es("floor");function Xp(d){return d&&d.length?gr(d,wt,ls):r}function Jp(d,v){return d&&d.length?gr(d,De(v,2),ls):r}function Zp(d){return ki(d,wt)}function Qp(d,v){return ki(d,De(v,2))}function em(d){return d&&d.length?gr(d,wt,hs):r}function tm(d,v){return d&&d.length?gr(d,De(v,2),hs):r}var nm=Ir(function(d,v){return d*v},1),rm=Es("round"),sm=Ir(function(d,v){return d-v},0);function im(d){return d&&d.length?Jr(d,wt):0}function om(d,v){return d&&d.length?Jr(d,De(v,2)):0}return W.after=Af,W.ary=ea,W.assign=ph,W.assignIn=pa,W.assignInWith=Nr,W.assignWith=mh,W.at=gh,W.before=ta,W.bind=Ns,W.bindAll=Sp,W.bindKey=na,W.castArray=jf,W.chain=Jo,W.chunk=Ku,W.compact=Gu,W.concat=qu,W.cond=Ip,W.conforms=Ep,W.constant=Vs,W.countBy=rf,W.create=yh,W.curry=ra,W.curryRight=sa,W.debounce=ia,W.defaults=_h,W.defaultsDeep=vh,W.defer=kf,W.delay=Cf,W.difference=Yu,W.differenceBy=Xu,W.differenceWith=Ju,W.drop=Zu,W.dropRight=Qu,W.dropRightWhile=ed,W.dropWhile=td,W.fill=nd,W.filter=of,W.flatMap=lf,W.flatMapDeep=uf,W.flatMapDepth=df,W.flatten=Go,W.flattenDeep=rd,W.flattenDepth=sd,W.flip=Of,W.flow=Tp,W.flowRight=Ap,W.fromPairs=id,W.functions=Th,W.functionsIn=Ah,W.groupBy=ff,W.initial=ad,W.intersection=cd,W.intersectionBy=ld,W.intersectionWith=ud,W.invert=Ch,W.invertBy=Oh,W.invokeMap=pf,W.iteratee=zs,W.keyBy=mf,W.keys=lt,W.keysIn=bt,W.map=Or,W.mapKeys=Rh,W.mapValues=Mh,W.matches=kp,W.matchesProperty=Cp,W.memoize=Rr,W.merge=Dh,W.mergeWith=ma,W.method=Op,W.methodOf=Pp,W.mixin=Hs,W.negate=Mr,W.nthArg=Mp,W.omit=Fh,W.omitBy=Nh,W.once=Pf,W.orderBy=gf,W.over=Dp,W.overArgs=Rf,W.overEvery=Fp,W.overSome=Np,W.partial=$s,W.partialRight=oa,W.partition=yf,W.pick=$h,W.pickBy=ga,W.property=Ia,W.propertyOf=$p,W.pull=pd,W.pullAll=Yo,W.pullAllBy=md,W.pullAllWith=gd,W.pullAt=yd,W.range=Bp,W.rangeRight=jp,W.rearg=Mf,W.reject=bf,W.remove=_d,W.rest=Df,W.reverse=Ds,W.sampleSize=Sf,W.set=jh,W.setWith=Lh,W.shuffle=If,W.slice=vd,W.sortBy=Tf,W.sortedUniq=Td,W.sortedUniqBy=Ad,W.split=up,W.spread=Ff,W.tail=kd,W.take=Cd,W.takeRight=Od,W.takeRightWhile=Pd,W.takeWhile=Rd,W.tap=Gd,W.throttle=Nf,W.thru=Cr,W.toArray=da,W.toPairs=ya,W.toPairsIn=_a,W.toPath=zp,W.toPlainObject=ha,W.transform=Uh,W.unary=$f,W.union=Md,W.unionBy=Dd,W.unionWith=Fd,W.uniq=Nd,W.uniqBy=$d,W.uniqWith=Bd,W.unset=Wh,W.unzip=Fs,W.unzipWith=Xo,W.update=Vh,W.updateWith=zh,W.values=Rn,W.valuesIn=Hh,W.without=jd,W.words=wa,W.wrap=Bf,W.xor=Ld,W.xorBy=Ud,W.xorWith=Wd,W.zip=Vd,W.zipObject=zd,W.zipObjectDeep=Hd,W.zipWith=Kd,W.entries=ya,W.entriesIn=_a,W.extend=pa,W.extendWith=Nr,Hs(W,W),W.add=Kp,W.attempt=Sa,W.camelCase=Yh,W.capitalize=va,W.ceil=Gp,W.clamp=Kh,W.clone=Lf,W.cloneDeep=Wf,W.cloneDeepWith=Vf,W.cloneWith=Uf,W.conformsTo=zf,W.deburr=ba,W.defaultTo=xp,W.divide=qp,W.endsWith=Xh,W.eq=jt,W.escape=Jh,W.escapeRegExp=Zh,W.every=sf,W.find=af,W.findIndex=Ho,W.findKey=bh,W.findLast=cf,W.findLastIndex=Ko,W.findLastKey=wh,W.floor=Yp,W.forEach=Zo,W.forEachRight=Qo,W.forIn=Sh,W.forInRight=Ih,W.forOwn=Eh,W.forOwnRight=xh,W.get=Ls,W.gt=Hf,W.gte=Kf,W.has=kh,W.hasIn=Us,W.head=qo,W.identity=wt,W.includes=hf,W.indexOf=od,W.inRange=Gh,W.invoke=Ph,W.isArguments=yn,W.isArray=je,W.isArrayBuffer=Gf,W.isArrayLike=vt,W.isArrayLikeObject=st,W.isBoolean=qf,W.isBuffer=cn,W.isDate=Yf,W.isElement=Xf,W.isEmpty=Jf,W.isEqual=Zf,W.isEqualWith=Qf,W.isError=Bs,W.isFinite=eh,W.isFunction=Xt,W.isInteger=aa,W.isLength=Dr,W.isMap=ca,W.isMatch=th,W.isMatchWith=nh,W.isNaN=rh,W.isNative=sh,W.isNil=oh,W.isNull=ih,W.isNumber=la,W.isObject=tt,W.isObjectLike=rt,W.isPlainObject=Gn,W.isRegExp=js,W.isSafeInteger=ah,W.isSet=ua,W.isString=Fr,W.isSymbol=xt,W.isTypedArray=Pn,W.isUndefined=ch,W.isWeakMap=lh,W.isWeakSet=uh,W.join=dd,W.kebabCase=Qh,W.last=Dt,W.lastIndexOf=fd,W.lowerCase=ep,W.lowerFirst=tp,W.lt=dh,W.lte=fh,W.max=Xp,W.maxBy=Jp,W.mean=Zp,W.meanBy=Qp,W.min=em,W.minBy=tm,W.stubArray=Gs,W.stubFalse=qs,W.stubObject=Lp,W.stubString=Up,W.stubTrue=Wp,W.multiply=nm,W.nth=hd,W.noConflict=Rp,W.noop=Ks,W.now=Pr,W.pad=np,W.padEnd=rp,W.padStart=sp,W.parseInt=ip,W.random=qh,W.reduce=_f,W.reduceRight=vf,W.repeat=ap,W.replace=cp,W.result=Bh,W.round=rm,W.runInContext=ne,W.sample=wf,W.size=Ef,W.snakeCase=lp,W.some=xf,W.sortedIndex=bd,W.sortedIndexBy=wd,W.sortedIndexOf=Sd,W.sortedLastIndex=Id,W.sortedLastIndexBy=Ed,W.sortedLastIndexOf=xd,W.startCase=dp,W.startsWith=fp,W.subtract=sm,W.sum=im,W.sumBy=om,W.template=hp,W.times=Vp,W.toFinite=Jt,W.toInteger=Le,W.toLength=fa,W.toLower=pp,W.toNumber=Ft,W.toSafeInteger=hh,W.toString=Ye,W.toUpper=mp,W.trim=gp,W.trimEnd=yp,W.trimStart=_p,W.truncate=vp,W.unescape=bp,W.uniqueId=Hp,W.upperCase=wp,W.upperFirst=Ws,W.each=Zo,W.eachRight=Qo,W.first=qo,Hs(W,function(){var d={};return Ut(W,function(v,x){Xe.call(W.prototype,x)||(d[x]=v)}),d}(),{chain:!1}),W.VERSION=s,Ct(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){W[d].placeholder=W}),Ct(["drop","take"],function(d,v){ze.prototype[d]=function(x){x=x===r?1:ct(Le(x),0);var R=this.__filtered__&&!v?new ze(this):this.clone();return R.__filtered__?R.__takeCount__=ft(x,R.__takeCount__):R.__views__.push({size:ft(x,se),type:d+(R.__dir__<0?"Right":"")}),R},ze.prototype[d+"Right"]=function(x){return this.reverse()[d](x).reverse()}}),Ct(["filter","map","takeWhile"],function(d,v){var x=v+1,R=x==j||x==U;ze.prototype[d]=function($){var H=this.clone();return H.__iteratees__.push({iteratee:De($,3),type:x}),H.__filtered__=H.__filtered__||R,H}}),Ct(["head","last"],function(d,v){var x="take"+(v?"Right":"");ze.prototype[d]=function(){return this[x](1).value()[0]}}),Ct(["initial","tail"],function(d,v){var x="drop"+(v?"":"Right");ze.prototype[d]=function(){return this.__filtered__?new ze(this):this[x](1)}}),ze.prototype.compact=function(){return this.filter(wt)},ze.prototype.find=function(d){return this.filter(d).head()},ze.prototype.findLast=function(d){return this.reverse().find(d)},ze.prototype.invokeMap=We(function(d,v){return typeof d=="function"?new ze(this):this.map(function(x){return Un(x,d,v)})}),ze.prototype.reject=function(d){return this.filter(Mr(De(d)))},ze.prototype.slice=function(d,v){d=Le(d);var x=this;return x.__filtered__&&(d>0||v<0)?new ze(x):(d<0?x=x.takeRight(-d):d&&(x=x.drop(d)),v!==r&&(v=Le(v),x=v<0?x.dropRight(-v):x.take(v-d)),x)},ze.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},ze.prototype.toArray=function(){return this.take(se)},Ut(ze.prototype,function(d,v){var x=/^(?:filter|find|map|reject)|While$/.test(v),R=/^(?:head|last)$/.test(v),$=W[R?"take"+(v=="last"?"Right":""):v],H=R||/^find/.test(v);$&&(W.prototype[v]=function(){var q=this.__wrapped__,ee=R?[1]:arguments,re=q instanceof ze,pe=ee[0],me=re||je(q),_e=function(Ve){var He=$.apply(W,en([Ve],ee));return R&&xe?He[0]:He};me&&x&&typeof pe=="function"&&pe.length!=1&&(re=me=!1);var xe=this.__chain__,Oe=!!this.__actions__.length,Fe=H&&!xe,Ue=re&&!Oe;if(!H&&me){q=Ue?q:new ze(this);var Ne=d.apply(q,ee);return Ne.__actions__.push({func:Cr,args:[_e],thisArg:r}),new Pt(Ne,xe)}return Fe&&Ue?d.apply(this,ee):(Ne=this.thru(_e),Fe?R?Ne.value()[0]:Ne.value():Ne)})}),Ct(["pop","push","shift","sort","splice","unshift"],function(d){var v=er[d],x=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",R=/^(?:pop|shift)$/.test(d);W.prototype[d]=function(){var $=arguments;if(R&&!this.__chain__){var H=this.value();return v.apply(je(H)?H:[],$)}return this[x](function(q){return v.apply(je(q)?q:[],$)})}}),Ut(ze.prototype,function(d,v){var x=W[v];if(x){var R=x.name+"";Xe.call(Tn,R)||(Tn[R]=[]),Tn[R].push({name:v,func:x})}}),Tn[Sr(r,S).name]=[{name:"wrapper",func:r}],ze.prototype.clone=yl,ze.prototype.reverse=_l,ze.prototype.value=vl,W.prototype.at=qd,W.prototype.chain=Yd,W.prototype.commit=Xd,W.prototype.next=Jd,W.prototype.plant=Qd,W.prototype.reverse=ef,W.prototype.toJSON=W.prototype.valueOf=W.prototype.value=nf,W.prototype.first=W.prototype.head,Dn&&(W.prototype[Dn]=Zd),W},In=Xc();ln?((ln.exports=In)._=In,zr._=In):ut._=In}).call(commonjsGlobal)})(lodash$1,lodash$1.exports);var lodashExports=lodash$1.exports;const lodash=getDefaultExportFromCjs(lodashExports);function inferImgAxes(n,t="bcz"){if(n.length===2)return"yx";if(n.length<=5){let r=n.indexOf(Math.min(...n)),s=n.slice();s.splice(r,1);let i=inferImgAxes(s,t.slice(1));const o=t[0];return insertCharAtPosition(i,o,r)}else throw new Error(`Image shape [${n.join(", ")}] is not supported.`)}function inferImgAxesViaSpec(n,t,r=!1){let s;if(r)if(n.length===2)s="yx";else if(n.length===3)s="yxc";else if(n.length===4)t.includes("z")?s="zyxc":s="cyxb";else throw new Error(`Image shape [${n.join(", ")}] is not supported.`);else{let i="bcz";t.includes("c")?t.includes("z")?t.includes("b")||(i="cz"):i="bc":i="bz",s=inferImgAxes(n,i)}return s}function insertCharAtPosition(n,t,r){return n.substring(0,r)+t+n.substring(r)}function getConstructor(n){let t;if(n=="uint8")t=Uint8Array;else if(n=="int8")t=Int8Array;else if(n=="uint16")t=Uint16Array;else if(n=="int16")t=Int16Array;else if(n=="uint32")t=Uint32Array;else if(n=="int32")t=Int32Array;else if(n=="float32")t=Float32Array;else if(n=="float64")t=Float64Array;else if(n=="bool")t=Uint8Array;else throw new Error("Unsupported dtype: "+n);return t}function reverseEndianness(n,t){let r=new Uint8Array(n);for(let s=0;s<r.length;s+=t)for(let i=s,o=s+t-1;i<o;i++,o--)[r[i],r[o]]=[r[o],r[i]];return n}function imjoyToTfjs(n){n._rvalue instanceof ArrayBuffer&&(n._rvalue=new Uint8Array(n._rvalue));let t=new ArrayBuffer(n._rvalue.length);new Uint8Array(t).set(n._rvalue);const s=getConstructor(n._rdtype);let i=new s(t);if(n._rdtype==="bool")for(let l=0;l<i.length;l++)i[l]===1&&(i[l]=255);const o=tensor(Array.from(i),n._rshape);return o._rdtype=n._rdtype,o}function tfjsToImJoy(n,t=!1,r=null){const s=n.dataSync();r===null&&(r=n._rdtype);const i=getConstructor(r);let o=new i(s.length);for(let u=0;u<s.length;u++)o[u]=s[u];t&&(o=new i(reverseEndianness(o.buffer,i.BYTES_PER_ELEMENT)));const l=new Uint8Array(o.buffer);return{_rtype:"ndarray",_rdtype:r,_rshape:n.shape,_rvalue:l}}function pick(n,t){const r=[];for(let l=0;l<n.shape.length;l++)t[l]===null?r.push(0):r.push(t[l]);const s=[];for(let l=0;l<n.shape.length;l++)t[l]===null?s.push(n.shape[l]):s.push(1);const i=slice$1(n,r,s),o=[];for(let l=0;l<n.shape.length;l++)t[l]===null&&o.push(n.shape[l]);return reshape$1(i,o)}function mapAxes(n,t,r){if(t.length!==n.shape.length)throw new Error(`Number of axes ${t.length} and dimension of input ${n.shape.length} don't match`);const s=[];t.split("").forEach((f,u)=>{const g=n.shape[u];if(r.includes(f))s.push(null);else{let y=0;"zyx".includes(f)&&(y=Math.floor(g/2)),s.push(y)}});let i=t.split("").filter((f,u)=>s[u]===null),o=pick(n,s);r.split("").forEach(f=>{t.includes(f)||(o=reshape$1(o,o.shape.concat([1])),i.push(f))});const l=[];for(let f=0;f<r.length;f++){const u=r[f],g=i.indexOf(u);l.push(g)}return o=transpose$1(o,l),o._rdtype=n._rdtype,o}const splitBy=(n,t,r)=>{const s=r.indexOf(t),i=n.shape[s],o=[];for(let l=0;l<i;l++){const f=[];for(let g=0;g<n.shape.length;g++)g===s?f.push(l):f.push(null);const u=pick(n,f);o.push(u)}return o};function splitForShow(n,t){if(!t.includes("x")||!t.includes("y"))throw new Error("Unsupported axes: "+t);const r=t.includes("c"),s=n.shape[t.indexOf("c")],i=t.includes("z"),o=n.shape[t.indexOf("z")];let l=[];if(t.length===2)l.push(n);else if(t.length===3)r?s===3?n._rdtype==="uint8"?l.push(mapAxes(n,t,"yxc")):l.push(mapAxes(n,t,"cyx")):s===1?l.push(mapAxes(n,t,"yx")):l.push(mapAxes(n,t,"cyx")):i?l.push(mapAxes(n,t,"zyx")):l=splitBy(n,"b",t);else if(t.length===4)r&&i?s==3?l.push(mapAxes(n,t,"zyxc")):s==1?l.push(mapAxes(n,t,"zyx")):o==1?l.push(mapAxes(n,t,"cyx")):splitBy(n,"c",t).map(f=>{const u=t.replace("c","");l=l.concat(splitForShow(f,u))}):splitBy(n,"b",t).map(f=>{const u=t.replace("b","");l=l.concat(splitForShow(f,u))});else if(t.length===5)splitBy(n,"b",t).map(f=>{const u=t.replace("b","");l=l.concat(splitForShow(f,u))});else throw new Error("Unsupported axes: "+t);return l}function processForShow(n,t){const r=t.includes("x")&&t.includes("y");let s;return r?s=splitForShow(n,t):t.length>2&&t.includes("b")?s=splitBy(n,"b",t):s=[n],s.map(i=>(i._rdtype=n._rdtype,tfjsToImJoy(i)))}function getNpyDtype(n){const t=new DataView(n.slice(8,10)).getUint8(0),r=new TextDecoder("utf-8").decode(new Uint8Array(n.slice(10,10+t)));return JSON.parse(r.toLowerCase().replace(/'/g,'"').replace("(","[").replace(/,*\),*/g,"]")).descr}async function getNpyEndianness(n){const t=await fetch(n,{headers:{Range:"bytes=0-999"}});if(!t.ok)return console.error(t),null;const r=await t.arrayBuffer();return getNpyDtype(r)[0]}class ImgPadder{constructor(t,r,s,i=0){this.fixedPaddedShape=t,this.padMin=r,this.padStep=s,this.padValue=i}getPaddedShape(t){let r=[];if(this.fixedPaddedShape)r=this.fixedPaddedShape;else{const s=this.padMin,i=this.padStep;for(let o=0;o<t.length;o++)if(i[o]===0)r.push(t[o]);else{const l=Math.max(0,Math.ceil((t[o]-s[o])/i[o])*i[o]);r.push(l+s[o])}}return r}pad(t,r="center"){const s=this.getPaddedShape(t.shape),i=[];for(let l=0;l<t.shape.length;l++){if(s[l]<t.shape[l])throw new Error(`Invalid shape: ${t.shape} for ${this.inputSpec.shape}`);const f=s[l]-t.shape[l];if(r==="center")i.push([Math.floor(f/2),Math.ceil(f/2)]);else if(r==="begin")i.push([0,f]);else if(r==="end")i.push([f,0]);else throw new Error(`Invalid position: ${r}`)}const o=pad(t,i,this.padValue);return o._rdtype=t._rdtype,[o,i]}crop(t,r,s=void 0){let i;return s?i=slice$1(t,r.map((o,l)=>o[0]+s[l]),t.shape.map((o,l)=>o-r[l][0]-r[l][1]-s[l]*2)):i=slice$1(t,r.map(o=>o[0]),t.shape.map((o,l)=>o-r[l][0]-r[l][1])),i._rdtype=t._rdtype,i}}class ImgTile{constructor(t,r,s){this.starts=t,this.ends=r,this.indexes=s,this.shape=r.map((i,o)=>i-this.starts[o]),this.data=null}slice(t){this.data=slice$1(t,this.starts,this.shape),this.data._rdtype=t._rdtype}merge(t,r){const s=this.starts.slice(),i=this.ends.slice();i[r]=t.ends[r];const o=this.ends[r]-t.starts[r];if(o<0)throw new Error("Cannot merge tiles with negative overlap.");let l;if(this.data===null||t.data===null)l=null;else{if(o===0)l=concat$1([this.data,t.data],r);else{const u=this.data.shape.slice();u[r]-=Math.ceil(o/2);const g=u.map(()=>0),y=slice$1(this.data,g,u),a=t.data.shape.slice();a[r]-=Math.floor(o/2);const m=a.map(()=>0);m[r]+=Math.floor(o/2);const _=slice$1(t.data,m,a);l=concat$1([y,_],r)}l._rdtype=this.data._rdtype}const f=new ImgTile(s,i,this.indexes);return f.data=l,f}mergeMean(t){const r=this.starts.slice(),s=this.ends.slice(),i=add$1(this.data,t.data).div(2);i._rdtype=this.data._rdtype;const o=new ImgTile(r,s,this.indexes);return o.data=i,o}}const cartesian=(...n)=>n.reduce((t,r)=>t.flatMap(s=>r.map(i=>[s,i].flat())));class ImgTiler{constructor(t,r,s=void 0){this.imgShape=t,this.tileShape=r,s===void 0&&(s=r.map(()=>0)),this.overlap=s}getNTiles(){const t=this.overlap,r=this.tileShape,s=this.imgShape;return r.map((o,l)=>Math.ceil(s[l]/(o-t[l])))}getTiles(){const t=this.overlap,r=this.tileShape,s=this.imgShape,i=this.getNTiles(),o=cartesian(...i.map(g=>Array.from(Array(g).keys()))),l=o.map(g=>g.map((y,a)=>y*(r[a]-t[a]))),f=l.map(g=>g.map((y,a)=>Math.min(y+r[a],s[a])));return l.map((g,y)=>new ImgTile(g,f[y],o[y]))}}class TileMerger{constructor(t){this.imgShape=t}mergeTiles(t){for(let s=0;s<this.imgShape.length;s++){const i=[],o=f=>{const u=[];return f.indexes.map((g,y)=>{y!==s&&u.push(g)}),u.join("-")},l=lodash.groupBy(t,o);for(let f in l){const u=l[f];if(u.sort((g,y)=>g.indexes[s]-y.indexes[s]),u.length>1){let g=u[0];for(let y=1;y<u.length;y++)g=g.merge(u[y],s);i.push(g)}else i.push(u[0])}t=i}return t[0]}}class MeanTileMerger extends TileMerger{constructor(t){super(t)}mergeTiles(t){const r=t[0];for(let s=1;s<t.length;s++)r.mergeMean(t[s]);return r}}const _export_sfc=(n,t)=>{const r=n.__vccOpts||n;for(const[s,i]of t)r[s]=i;return r},_sfc_main$7={props:{summary:String}};function _sfc_render$6(n,t,r,s,i,o){return openBlock(),createElementBlock("details",null,[renderSlot(n.$slots,"default",{},void 0,!0),createBaseVNode("summary",null,toDisplayString(r.summary),1)])}const HideContainer=_export_sfc(_sfc_main$7,[["render",_sfc_render$6],["__scopeId","data-v-1a1edfed"]]),_sfc_main$6={props:{open:Boolean}},_hoisted_1$5={class:"overlay-container"},_hoisted_2$4={key:0,class:"overlay"};function _sfc_render$5(n,t,r,s,i,o){return openBlock(),createElementBlock("div",_hoisted_1$5,[r.open?(openBlock(),createElementBlock("div",_hoisted_2$4)):createCommentVNode("",!0),renderSlot(n.$slots,"default",{},void 0,!0)])}const OverlayContainer=_export_sfc(_sfc_main$6,[["render",_sfc_render$5],["__scopeId","data-v-82e95675"]]),useServerStore=defineStore("server",{state:()=>({serverUrl:"https://ai.imjoy.io",serviceId:"triton-client"}),persist:!0}),loadCellposeRdf=()=>({id:"cellpose-python",name:"Cellpose",nickname:"cellpose-python",nickname_icon:"🌸",description:"Cellpose model for segmenting nuclei and cytoplasms.",inputs:[{axes:"cyx",data_type:"float32",shape:{min:[1,64,64],step:[1,16,16]}}],outputs:[{axes:"cyx"}],sample_inputs:["https://zenodo.org/api/records/6647674/files/sample_input_0.tif/content"],additional_parameters:[{name:"Cellpose Parameters",parameters:[{name:"diameter",type:"number",default:30,description:"Diameter of the nuclei in pixels."},{name:"model_type",type:"string",default:"nuclei",description:"Type of cells to segment.",enum:["nuclei","cyto"]},{name:"flow_threshold",type:"number",default:.4,description:"Threshold for the flow."}]}]}),useStore=defineStore("store",{state:()=>({runner:null,viewerControl:null,models:[],currentModel:null}),actions:{setCurrentModel(n){this.currentModel=n}},getters:{tritonConfig(n){return n.runner?n.runner.modelTritonConfig:{}},inputMinShape(n){var t;return(t=n==null?void 0:n.runner)!=null&&t.rdf?n.runner.getInputMinShape():{}},inputMaxShape(n){var t;return(t=n==null?void 0:n.runner)!=null&&t.rdf?n.runner.getInputMaxShape():{}},inputSpec(n){var t;return(t=n==null?void 0:n.runner)!=null&&t.rdf?n.runner.rdf.inputs[0]:{}},outputSpec(n){var t;return(t=n==null?void 0:n.runner)!=null&&t.rdf?n.runner.rdf.outputs[0]:{}},additionalModels(){return[loadCellposeRdf()]}}}),useParametersStore=defineStore("parameters",{state:()=>({tileSizes:{x:0,y:0,z:0},tileOverlaps:{x:0,y:0,z:0},additionalParameters:{},additionalParametersSchema:{}})}),_sfc_main$5={setup(){const n=useStore(),t=useServerStore(),r=useParametersStore(),s=ref(t.serverUrl),i=ref(t.serviceId),o=()=>{t.$patch({serverUrl:s.value,serviceId:i.value})};return watch(()=>(t.serverUrl,t.serviceId),()=>{console.log("serverUrl:",t.serverUrl),console.log("serviceId:",t.serviceId),s.value=t.serverUrl,i.value=t.serviceId}),{store:n,serverStore:t,parametersStore:r,serverURL:s,serviceId:i,updateServerSetting:o}}},_withScopeId$1=n=>(pushScopeId("data-v-c360517f"),n=n(),popScopeId(),n),_hoisted_1$4={class:"advance-setting-container"},_hoisted_2$3={class:"server-setting"},_hoisted_3$3=_withScopeId$1(()=>createBaseVNode("h3",null,"Settings for server",-1)),_hoisted_4$1={class:"field-row"},_hoisted_5$1={class:"field-column",style:{width:"200px"}},_hoisted_6$1=_withScopeId$1(()=>createBaseVNode("label",{class:"field-label"},"Server URL",-1)),_hoisted_7$1={class:"field-column",style:{width:"140px"}},_hoisted_8$1=_withScopeId$1(()=>createBaseVNode("label",{class:"field-label"},"Service ID",-1)),_hoisted_9$1={key:0,class:"tiling-setting"},_hoisted_10$1=_withScopeId$1(()=>createBaseVNode("h3",null,"Settings for image tiling",-1)),_hoisted_11$1={class:"field-row"},_hoisted_12={class:"field-column tile-field"},_hoisted_13={key:0},_hoisted_14=_withScopeId$1(()=>createBaseVNode("label",{class:"field-label"},"Tile size(XY)",-1)),_hoisted_15={key:1},_hoisted_16=_withScopeId$1(()=>createBaseVNode("label",{class:"field-label"},"Tile size(Z)",-1)),_hoisted_17={class:"field-column tile-field"},_hoisted_18={key:0},_hoisted_19=_withScopeId$1(()=>createBaseVNode("label",{class:"field-label"},"Tile overlap(XY)",-1)),_hoisted_20={key:1},_hoisted_21=_withScopeId$1(()=>createBaseVNode("label",{class:"field-label"},"Tile overlap(Z)",-1));function _sfc_render$4(n,t,r,s,i,o){const l=resolveComponent("InputText"),f=resolveComponent("Button"),u=resolveComponent("InputNumber");return openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("div",_hoisted_2$3,[_hoisted_3$3,createBaseVNode("div",_hoisted_4$1,[createBaseVNode("div",_hoisted_5$1,[_hoisted_6$1,createVNode(l,{id:"server-select",modelValue:s.serverURL,"onUpdate:modelValue":t[0]||(t[0]=g=>s.serverURL=g)},null,8,["modelValue"])]),createBaseVNode("div",_hoisted_7$1,[_hoisted_8$1,createVNode(l,{id:"service-select",style:{width:"140px"},modelValue:s.serviceId,"onUpdate:modelValue":t[1]||(t[1]=g=>s.serviceId=g)},null,8,["modelValue"])]),createVNode(f,{onClick:s.updateServerSetting,style:{"margin-top":"25px"}},{default:withCtx(()=>[createTextVNode("Update")]),_:1},8,["onClick"])])]),s.store.tritonConfig?(openBlock(),createElementBlock("div",_hoisted_9$1,[_hoisted_10$1,createBaseVNode("div",_hoisted_11$1,[createBaseVNode("div",_hoisted_12,["x"in s.store.inputMinShape&&"y"in s.store.inputMinShape?(openBlock(),createElementBlock("div",_hoisted_13,[_hoisted_14,createVNode(u,{modelValue:s.parametersStore.tileSizes.x,"onUpdate:modelValue":t[2]||(t[2]=g=>s.parametersStore.tileSizes.x=g),showButtons:"",min:s.store.inputMinShape.x,max:s.store.inputMaxShape.x},null,8,["modelValue","min","max"])])):createCommentVNode("",!0),"z"in s.store.inputMinShape?(openBlock(),createElementBlock("div",_hoisted_15,[_hoisted_16,createVNode(u,{modelValue:s.parametersStore.tileSizes.z,"onUpdate:modelValue":t[3]||(t[3]=g=>s.parametersStore.tileSizes.z=g),showButtons:"",min:s.store.inputMinShape.z,max:s.store.inputMaxShape.z},null,8,["modelValue","min","max"])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_17,["x"in s.store.inputMinShape&&"y"in s.store.inputMinShape?(openBlock(),createElementBlock("div",_hoisted_18,[_hoisted_19,createVNode(u,{modelValue:s.parametersStore.tileOverlaps.x,"onUpdate:modelValue":t[4]||(t[4]=g=>s.parametersStore.tileOverlaps.x=g),showButtons:"",min:0,max:s.store.inputMaxShape.x},null,8,["modelValue","max"])])):createCommentVNode("",!0),"z"in s.store.inputMinShape?(openBlock(),createElementBlock("div",_hoisted_20,[_hoisted_21,createVNode(u,{modelValue:s.parametersStore.tileOverlaps.z,"onUpdate:modelValue":t[5]||(t[5]=g=>s.parametersStore.tileOverlaps.z=g),showButtons:"",min:0,max:s.store.inputMaxShape.z},null,8,["modelValue","max"])])):createCommentVNode("",!0)])])])):createCommentVNode("",!0)])}const AdvanceSetting=_export_sfc(_sfc_main$5,[["render",_sfc_render$4],["__scopeId","data-v-c360517f"]]),_sfc_main$4={},_hoisted_1$3={class:"loading-animation"};function _sfc_render$3(n,t){return openBlock(),createElementBlock("div",_hoisted_1$3)}const LoadingAnimation=_export_sfc(_sfc_main$4,[["render",_sfc_render$3],["__scopeId","data-v-91fefc2d"]]),_sfc_main$3={setup(){return{store:useStore()}},props:{open:{type:Boolean,default:!1}},mounted(){this.fetchModels()},methods:{async fetchAvailableModels(){return(await(await fetch("https://raw.githubusercontent.com/bioimage-io/bioengine-model-runner/gh-pages/manifest.bioengine.json")).json()).collection.map(i=>i.id)},async fetchCollections(){return(await(await fetch("https://bioimage-io.github.io/collection-bioimage-io/rdf.json")).json()).collection},async fetchModels(){const n=await this.fetchAvailableModels();let r=(await this.fetchCollections()).filter(o=>n.includes(o.id));const s=useStore(),i=s.additionalModels;i.length>0&&(r=r.concat(i)),s.$patch({models:r,currentModel:r[0]})}}},_hoisted_1$2={key:0},_hoisted_2$2={key:1},_hoisted_3$2=["title"];function _sfc_render$2(n,t,r,s,i,o){const l=resolveComponent("Dropdown");return openBlock(),createElementBlock("div",null,[createVNode(l,{disabled:!r.open,modelValue:s.store.currentModel,"onUpdate:modelValue":t[0]||(t[0]=f=>s.store.currentModel=f),options:s.store.models,"option-label":"name"},{value:withCtx(f=>[f.value?(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",null,toDisplayString(f.value.nickname_icon)+" "+toDisplayString(f.value.name),1)])):(openBlock(),createElementBlock("span",_hoisted_2$2,toDisplayString(f.placeholder),1))]),option:withCtx(f=>[createBaseVNode("div",null,[createBaseVNode("div",{title:f.option.description},toDisplayString(f.option.nickname_icon)+" "+toDisplayString(f.option.name),9,_hoisted_3$2)])]),_:1},8,["disabled","modelValue","options"])])}const ModelSelect=_export_sfc(_sfc_main$3,[["render",_sfc_render$2]]),_sfc_main$2={setup(){return{pstore:useParametersStore()}},props:{overlay:Boolean},components:{HideContainer,OverlayContainer}},_hoisted_1$1={key:0},_hoisted_2$1={class:"model-params-container"},_hoisted_3$1={class:"field-label"};function _sfc_render$1(n,t,r,s,i,o){const l=resolveComponent("InputNumber"),f=resolveComponent("Dropdown"),u=resolveComponent("InputText"),g=resolveComponent("OverlayContainer"),y=resolveComponent("HideContainer");return s.pstore.additionalParametersSchema&&s.pstore.additionalParametersSchema.length>0?(openBlock(),createElementBlock("div",_hoisted_1$1,[createVNode(y,{summary:"Model parameters"},{default:withCtx(()=>[createVNode(g,{open:r.overlay},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(s.pstore.additionalParametersSchema,(a,m)=>(openBlock(),createElementBlock("div",{key:m},[createBaseVNode("h3",null,toDisplayString(a.name),1),(openBlock(!0),createElementBlock(Fragment,null,renderList(a.parameters,(_,b)=>(openBlock(),createElementBlock("div",{key:m},[createBaseVNode("label",_hoisted_3$1,toDisplayString(_.name),1),_.type==="number"?(openBlock(),createBlock(l,{key:0,showButtons:"",modelValue:s.pstore.additionalParameters[_.name],"onUpdate:modelValue":c=>s.pstore.additionalParameters[_.name]=c},null,8,["modelValue","onUpdate:modelValue"])):_.enum?(openBlock(),createBlock(f,{key:1,options:_.enum,modelValue:s.pstore.additionalParameters[_.name],"onUpdate:modelValue":c=>s.pstore.additionalParameters[_.name]=c},null,8,["options","modelValue","onUpdate:modelValue"])):(openBlock(),createBlock(u,{key:2,modelValue:s.pstore.additionalParameters[_.name],"onUpdate:modelValue":c=>s.pstore.additionalParameters[_.name]=c},null,8,["modelValue","onUpdate:modelValue"]))]))),128))]))),128))])]),_:1},8,["open"])]),_:1})])):createCommentVNode("",!0)}const ModelParameters=_export_sfc(_sfc_main$2,[["render",_sfc_render$1],["__scopeId","data-v-6b8b5f3a"]]),scriptRel="modulepreload",assetsURL=function(n){return"/bioengine-web-client/"+n},seen={},__vitePreload=function(t,r,s){let i=Promise.resolve();if(r&&r.length>0){const o=document.getElementsByTagName("link");i=Promise.all(r.map(l=>{if(l=assetsURL(l),l in seen)return;seen[l]=!0;const f=l.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(!!s)for(let a=o.length-1;a>=0;a--){const m=o[a];if(m.href===l&&(!f||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${u}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":scriptRel,f||(y.as="script",y.crossOrigin=""),y.href=l,document.head.appendChild(y),f)return new Promise((a,m)=>{y.addEventListener("load",a),y.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}return i.then(()=>t()).catch(o=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o})};var imjoyRpc$1={exports:{}};(function(module,exports){(function(t,r){module.exports=r()})(window,function(){return function(n){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return n[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=n,r.c=t,r.d=function(s,i,o){r.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:o})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,i){if(i&1&&(s=r(s)),i&8||i&4&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),i&2&&typeof s!="string")for(var l in s)r.d(o,l,(function(f){return s[f]}).bind(null,l));return o},r.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(i,"a",i),i},r.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},r.p="",r(r.s="./src/main.js")}({"./node_modules/worker-loader/dist/workers/InlineWorker.js":function(n,t,r){var s=window.URL||window.webkitURL;n.exports=function(i,o){try{try{var l;try{var f=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;l=new f,l.append(i),l=l.getBlob()}catch{l=new Blob([i])}return new Worker(s.createObjectURL(l))}catch{return new Worker("data:application/javascript,"+encodeURIComponent(i))}}catch{if(!o)throw Error("Inline worker is not supported");return new Worker(o)}}},"./package.json":function(n){n.exports=JSON.parse('{"name":"imjoy-rpc","version":"0.5.46","description":"Remote procedure calls for ImJoy.","module":"index.js","types":"index.d.ts","scripts":{"build":"rm -rf dist && npm run build-umd","build-umd":"webpack --config webpack.config.js --mode development && NODE_ENV=production webpack --config webpack.config.js --mode production --devtool source-map ","watch":"NODE_ENV=production webpack --watch --progress --config webpack.config.js --mode production --devtool source-map","publish-npm":"npm install && npm run build && npm publish","serve":"webpack-dev-server","stats":"webpack --profile --json > stats.json","stats-prod":"webpack --profile --json --mode production > stats-prod.json","analyze":"webpack-bundle-analyzer -p 9999 stats.json","analyze-prod":"webpack-bundle-analyzer -p 9999 stats-prod.json","clean":"rimraf dist/*","deploy":"npm run build && node deploy-site.js","format":"prettier --write \\"{src,tests}/**/**\\"","check-format":"prettier --check \\"{src,tests}/**/**\\"","test":"karma start --single-run --browsers ChromeHeadless,FirefoxHeadless karma.conf.js","test-watch":"karma start --auto-watch --browsers ChromeDebugging karma.conf.js --debug"},"repository":{"type":"git","url":"git+https://github.com/imjoy-team/imjoy-rpc.git"},"keywords":["imjoy","rpc"],"author":"imjoy-team <imjoy.team@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/imjoy-team/imjoy-rpc/issues"},"homepage":"https://github.com/imjoy-team/imjoy-rpc","dependencies":{"@msgpack/msgpack":"^2.7.1","socket.io-client":"^4.6.2"},"devDependencies":{"@babel/core":"^7.16.12","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/polyfill":"^7.12.1","@babel/preset-env":"^7.16.11","@types/requirejs":"^2.1.34","babel-core":"^6.26.0","babel-eslint":"^10.1.0","babel-loader":"^8.2.3","babel-runtime":"^6.26.0","chai":"^4.3.6","clean-webpack-plugin":"^0.1.19","copy-webpack-plugin":"^5.1.2","eslint":"^6.8.0","eslint-config-prettier":"^4.2.0","eslint-loader":"^4.0.2","file-loader":"^0.11.2","fs-extra":"^0.30.0","gh-pages":"^2.0.1","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","json-loader":"^0.5.4","karma":"^6.3.12","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^1.3.0","karma-mocha":"^2.0.1","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"0.0.32","karma-webpack":"^4.0.2","lerna":"^6.0.3","lodash.debounce":"^4.0.8","mocha":"^10.1.0","postcss":"^7.0.36","prettier":"^1.6.1","rimraf":"^2.6.2","schema-utils":"^0.4.3","style-loader":"^0.18.1","ts-loader":"^9.4.3","url-loader":"^0.5.9","webpack":"^4.46.0","webpack-bundle-analyzer":"^4.7.0","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.3","webpack-merge":"^4.1.1","workbox-webpack-plugin":"^4.3.1","worker-loader":"^2.0.0","write-file-webpack-plugin":"^4.5.1"},"eslintConfig":{"globals":{"document":true,"window":true}}}')},"./src/main.js":function(n,t,r){r.r(t),r.d(t,"waitForInitialization",function(){return m}),r.d(t,"setupRPC",function(){return _});var s=r("./src/plugin.webworker.js"),i=r.n(s),o=r("./src/pluginIframe.js"),l=r("./src/utils.js");r.d(t,"loadRequirements",function(){return l.loadRequirements});var f=r("./src/rpc.js");r.d(t,"RPC",function(){return f.RPC}),r.d(t,"API_VERSION",function(){return f.API_VERSION});var u=r("./package.json");r.d(t,"VERSION",function(){return u.version});function g(){try{return window.self!==window.top}catch{return!0}}function y(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function a(b){if(!b.allow_execution)throw new Error("web-worker plugin can only work with allow_execution=true");let c=null;b.broadcastChannel&&(c=new BroadcastChannel(b.broadcastChannel));const w=new i.a,S=setTimeout(function(){w.terminate(),console.warn("Plugin failed to start as a web-worker, running in an iframe instead."),Object(o.default)(b)},2e3),E=Object(l.randId)();w.addEventListener("message",function(I){let A;const T=I.data;if(T.type==="worker-ready"){w.postMessage({type:"connectRPC",config:b}),clearTimeout(S);return}else T.type==="initialized"?(T.config=Object.assign({},b,T.config),T.origin=globalThis.location.origin,T.peer_id=E):T.type==="imjoy_remote_api_ready"?globalThis.dispatchEvent(new CustomEvent("imjoy_remote_api_ready",{detail:null})):T.type==="cacheRequirements"&&typeof cache_requirements=="function"?cache_requirements(T.requirements):T.type==="disconnect"?w.terminate():T.__transferables__&&(A=T.__transferables__,delete T.__transferables__);c?c.postMessage(T):parent.postMessage(T,b.target_origin||"*",A)}),(c||window).addEventListener("message",function(I){if(I.type==="message"&&(c||b.target_origin==="*"||I.origin===b.target_origin)){let A;const T=I.data;T.__transferables__&&(A=T.__transferables__,delete T.__transferables__),T.peer_id===E?w.postMessage(T,A):b.debug&&console.log(`connection peer id mismatch ${T.peer_id} !== ${E}`)}})}function m(b){y()&&(globalThis.parent=self),b=b||{},b.enable_service_worker&&(Object(l.setupServiceWorker)(b.base_url,b.target_origin,b.cache_requirements),b.enable_service_worker=!1),b.cache_requirements&&delete b.cache_requirements;const c=b.target_origin||"*";if(b.credential_required&&typeof b.verify_credential!="function")throw new Error("Please also provide the `verify_credential` function with `credential_required`.");if(b.credential_required&&c==="*")throw new Error("`target_origin` was set to `*` with `credential_required=true`, there is a security risk that you may leak the credential to website from other origin. Please specify the `target_origin` explicitly.");const w=()=>{globalThis.removeEventListener("message",E)},S=Object(l.randId)(),E=I=>{if(I.type==="message"&&(!I.origin||c==="*"||I.origin===c))if(I.data.type==="initialize"){w(),I.data.peer_id!==S&&console.warn(`${I.data.config&&I.data.config.name}: connection peer id mismatch ${I.data.peer_id} !== ${S}`);const A=I.data.config;c!=="*"&&(A.target_origin=c),b.credential_required?b.verify_credential(A.credential).then(T=>{if(T&&T.auth&&!T.error)A.auth=T.auth,_(A).then(()=>{console.log("ImJoy RPC loaded successfully!")});else throw new Error("Failed to verify the credentail:"+(T&&T.error))}):_(A).then(()=>{console.log("ImJoy RPC loaded successfully!")})}else throw new Error(`unrecognized message: ${I.data}`)};globalThis.addEventListener("message",E),y()?parent.postMessage({type:"imjoyRPCReady",config:b,peer_id:S}):parent.postMessage({type:"imjoyRPCReady",config:b,peer_id:S},"*")}function _(b){return b=b||{},b.name=b.name||Object(l.randId)(),b=Object(l.normalizeConfig)(b),b.enable_service_worker&&Object(l.setupServiceWorker)(b.base_url,b.target_origin,b.cache_requirements),b.cache_requirements&&delete b.cache_requirements,new Promise((c,w)=>{const S=E=>{const I=E.detail;b.expose_api_globally&&(globalThis.api=I),c(I),globalThis.removeEventListener("imjoy_remote_api_ready",S)};if(g()){if(b.type==="web-worker")try{a(b)}catch{Object(o.default)(b)}else if(["rpc-window","rpc-worker","iframe","window"].includes(b.type))Object(o.default)(b);else{console.error("Unsupported plugin type: "+b.type),w("Unsupported plugin type: "+b.type);return}globalThis.addEventListener("imjoy_remote_api_ready",S)}else y()?Object(o.default)(b):w(new Error("imjoy-rpc should only run inside an iframe or a webworker."))})}},"./src/plugin.webworker.js":function(n,t,r){n.exports=function(){return r("./node_modules/worker-loader/dist/workers/InlineWorker.js")(`/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/plugin.webworker.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/plugin.webworker.js":
/*!*********************************!*\\
  !*** ./src/plugin.webworker.js ***!
  \\*********************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _pluginCore_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pluginCore.js */ "./src/pluginCore.js");
/* harmony import */ var _rpc_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rpc.js */ "./src/rpc.js");
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ "./src/utils.js");
/**
 * Contains the routines loaded by the plugin Worker under web-browser.
 *
 * Initializes the web environment version of the platform-dependent
 * connection object for the plugin site
 */




// make sure this runs inside a webworker
if (
  typeof WorkerGlobalScope === "undefined" ||
  !self ||
  !(self instanceof WorkerGlobalScope)
) {
  throw new Error("This script can only loaded in a webworker");
}

async function executeEsModule(content) {
  const dataUri =
    "data:text/javascript;charset=utf-8," + encodeURIComponent(content);
  await import(/* webpackIgnore: true */ dataUri);
}

/**
 * Connection object provided to the RPC constructor,
 * plugin site implementation for the web-based environment.
 * Global will be then cleared to prevent exposure into the
 * Worker, so we put this local connection object into a closure
 */
class Connection extends _utils_js__WEBPACK_IMPORTED_MODULE_2__["MessageEmitter"] {
  constructor(config) {
    super(config && config.debug);
    this.config = config || {};
  }
  connect() {
    self.addEventListener("message", e => {
      this._fire(e.data.type, e.data);
    });
    this.emit({
      type: "initialized",
      config: this.config
    });
  }
  disconnect() {
    this._fire("beforeDisconnect");
    self.close();
    this._fire("disconnected");
  }
  emit(data) {
    let transferables = undefined;
    if (data.__transferables__) {
      transferables = data.__transferables__;
      delete data.__transferables__;
    }
    self.postMessage(data, transferables);
  }
  async execute(code) {
    if (code.type === "requirements") {
      await Object(_utils_js__WEBPACK_IMPORTED_MODULE_2__["loadRequirementsInWebworker"])(code.requirements);
    } else if (code.type === "script") {
      try {
        if (code.attrs.type === "module") {
          await executeEsModule(code.content);
        } else {
          eval(code.content);
        }
      } catch (e) {
        console.error(e.message, e.stack);
        throw e;
      }
    } else {
      throw "unsupported code type.";
    }
    if (code.type === "requirements") {
      self.postMessage({
        type: "cacheRequirements",
        requirements: code.requirements
      });
    }
  }
}
const config = {
  type: "web-worker",
  dedicated_thread: true,
  allow_execution: true,
  lang: "javascript",
  api_version: _rpc_js__WEBPACK_IMPORTED_MODULE_1__["API_VERSION"]
};
const conn = new Connection(config);
conn.on("connectRPC", data => {
  Object(_pluginCore_js__WEBPACK_IMPORTED_MODULE_0__["connectRPC"])(conn, Object.assign(data.config, config));
});
conn.connect();
self.postMessage({
  type: "worker-ready"
});


/***/ }),

/***/ "./src/pluginCore.js":
/*!***************************!*\\
  !*** ./src/pluginCore.js ***!
  \\***************************/
/*! exports provided: connectRPC */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "connectRPC", function() { return connectRPC; });
/* harmony import */ var _rpc_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rpc.js */ "./src/rpc.js");
/**
 * Core plugin script loaded into the plugin process/thread.
 *
 * Initializes the plugin-site API global methods.
 */

function connectRPC(connection, config) {
  config = config || {};
  const codecs = {};
  const rpc = new _rpc_js__WEBPACK_IMPORTED_MODULE_0__["RPC"](connection, config, codecs);
  rpc.on("getInterface", function () {
    launchConnected();
  });
  rpc.on("remoteReady", function () {
    const api = rpc.getRemote() || {};

    api.registerCodec = function (config) {
      if (!config["name"] || !config["encoder"] && !config["decoder"]) {
        throw new Error("Invalid codec format, please make sure you provide a name, type, encoder and decoder.");
      } else {
        if (config.type) {
          for (let k of Object.keys(codecs)) {
            if (codecs[k].type === config.type || k === config.name) {
              delete codecs[k];
              console.warn("Remove duplicated codec: " + k);
            }
          }
        }

        codecs[config["name"]] = config;
      }
    };

    api.init = function (config) {
      // register a minimal plugin api
      rpc.setInterface({
        setup() {}

      }, config);
    };

    api.disposeObject = function (obj) {
      rpc.disposeObject(obj);
    };

    api.export = function (_interface, config) {
      rpc.setInterface(_interface, config);
    };

    api.onLoad = function (handler) {
      handler = checkHandler(handler);

      if (connected) {
        handler();
      } else {
        connectedHandlers.push(handler);
      }
    };

    api.dispose = function (_interface) {
      rpc.disconnect();
    };

    api._rpc = rpc;

    if (typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope) {
      self.api = api;
      self.postMessage({
        type: "imjoy_remote_api_ready"
      });
      self.dispatchEvent(new CustomEvent("imjoy_remote_api_ready", {
        detail: api
      }));
    } else if (typeof window) {
      window.dispatchEvent(new CustomEvent("imjoy_remote_api_ready", {
        detail: api
      }));
    }
  });
  let connected = false;
  const connectedHandlers = [];

  const launchConnected = function () {
    if (!connected) {
      connected = true;
      let handler;

      while (handler = connectedHandlers.pop()) {
        handler();
      }
    }
  };

  const checkHandler = function (handler) {
    const type = typeof handler;

    if (type !== "function") {
      const msg = "A function may only be subsribed to the event, " + type + " was provided instead";
      throw new Error(msg);
    }

    return handler;
  };

  return rpc;
}

/***/ }),

/***/ "./src/rpc.js":
/*!********************!*\\
  !*** ./src/rpc.js ***!
  \\********************/
/*! exports provided: API_VERSION, RPC */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_VERSION", function() { return API_VERSION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RPC", function() { return RPC; });
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ "./src/utils.js");
/**
 * Contains the RPC object used both by the application
 * site, and by each plugin
 */

const API_VERSION = "0.2.3";
const ArrayBufferView = Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array())).constructor;

function _appendBuffer(buffer1, buffer2) {
  const tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);
  tmp.set(new Uint8Array(buffer1), 0);
  tmp.set(new Uint8Array(buffer2), buffer1.byteLength);
  return tmp.buffer;
}

function indexObject(obj, is) {
  if (!is) throw new Error("undefined index");
  if (typeof is === "string") return indexObject(obj, is.split("."));else if (is.length === 0) return obj;else return indexObject(obj[is[0]], is.slice(1));
}
/**
 * RPC object represents a single site in the
 * communication protocol between the application and the plugin
 *
 * @param {Object} connection a special object allowing to send
 * and receive messages from the opposite site (basically it
 * should only provide send() and onMessage() methods)
 */


class RPC extends _utils_js__WEBPACK_IMPORTED_MODULE_0__["MessageEmitter"] {
  constructor(connection, config, codecs) {
    super(config && config.debug);
    this._connection = connection;
    this.config = config || {};
    this._codecs = codecs || {};
    this._object_store = {};
    this._method_weakmap = new WeakMap();
    this._object_weakmap = new WeakMap();
    this._local_api = null;
    this._remote_set = false; // make sure there is an execute function

    const name = this.config.name;

    this._connection.execute = this._connection.execute || function () {
      throw new Error(\`connection.execute not implemented (in "\${name}")\`);
    };

    this._store = new ReferenceStore();
    this._method_refs = new ReferenceStore();

    this._method_refs.onReady(() => {
      this._fire("remoteIdle");
    });

    this._method_refs.onBusy(() => {
      this._fire("remoteBusy");
    });

    this._setupMessageHanlders();
  }

  init() {
    this._connection.emit({
      type: "initialized",
      config: this.config,
      peer_id: this._connection.peer_id
    });
  }

  setConfig(config) {
    if (config) for (const k of Object.keys(config)) {
      this.config[k] = config[k];
    }
  }
  /**
   * Set a handler to be called when received a responce from the
   * remote site reporting that the previously provided interface
   * has been successfully set as remote for that site
   *
   * @param {Function} handler
   */


  getRemoteCallStack() {
    return this._method_refs.getStack();
  }
  /**
   * @returns {Object} set of remote interface methods
   */


  getRemote() {
    return this._remote_interface;
  }
  /**
   * Sets the interface of this site making it available to the
   * remote site by sending a message with a set of methods names
   *
   * @param {Object} _interface to set
   */


  setInterface(_interface, config) {
    config = config || {};
    this.config.name = config.name || this.config.name;
    this.config.description = config.description || this.config.description;

    if (this.config.forwarding_functions) {
      for (let func_name of this.config.forwarding_functions) {
        const _remote = this._remote_interface;

        if (_remote[func_name]) {
          if (_interface.constructor === Object) {
            if (!_interface[func_name]) {
              _interface[func_name] = (...args) => {
                _remote[func_name](...args);
              };
            }
          } else if (_interface.constructor.constructor === Function) {
            if (!_interface.constructor.prototype[func_name]) {
              _interface.constructor.prototype[func_name] = (...args) => {
                _remote[func_name](...args);
              };
            }
          }
        }
      }
    }

    this._local_api = _interface;
    if (!this._remote_set) this._fire("interfaceAvailable");else this.sendInterface();
    return new Promise(resolve => {
      this.once("interfaceSetAsRemote", resolve);
    });
  }
  /**
   * Sends the actual interface to the remote site upon it was
   * updated or by a special request of the remote site
   */


  sendInterface() {
    if (!this._local_api) {
      throw new Error("interface is not set.");
    }

    this._encode(this._local_api, true).then(api => {
      this._connection.emit({
        type: "setInterface",
        api: api
      });
    });
  }

  _disposeObject(objectId) {
    if (this._object_store[objectId]) {
      delete this._object_store[objectId];
    } else {
      throw new Error(\`Object (id=\${objectId}) not found.\`);
    }
  }

  disposeObject(obj) {
    return new Promise((resolve, reject) => {
      if (this._object_weakmap.has(obj)) {
        const objectId = this._object_weakmap.get(obj);

        this._connection.once("disposed", data => {
          if (data.error) reject(new Error(data.error));else resolve();
        });

        this._connection.emit({
          type: "disposeObject",
          object_id: objectId
        });
      } else {
        throw new Error("Invalid object");
      }
    });
  }
  /**
   * Handles a message from the remote site
   */


  _setupMessageHanlders() {
    this._connection.on("init", this.init);

    this._connection.on("execute", data => {
      Promise.resolve(this._connection.execute(data.code)).then(() => {
        this._connection.emit({
          type: "executed"
        });
      }).catch(e => {
        console.error(e);

        this._connection.emit({
          type: "executed",
          error: String(e)
        });
      });
    });

    this._connection.on("method", async data => {
      let resolve, reject, method, method_this, args, result;

      try {
        if (data.promise) {
          [resolve, reject] = await this._unwrap(data.promise, false);
        }

        const _interface = this._object_store[data.object_id];
        method = indexObject(_interface, data.name);

        if (data.name.includes(".")) {
          const tmp = data.name.split(".");
          const intf_index = tmp.slice(0, tmp.length - 1).join(".");
          method_this = indexObject(_interface, intf_index);
        } else {
          method_this = _interface;
        }

        args = await this._unwrap(data.args, true);

        if (data.promise) {
          result = method.apply(method_this, args);

          if (result instanceof Promise || method.constructor && method.constructor.name === "AsyncFunction") {
            result.then(resolve).catch(reject);
          } else {
            resolve(result);
          }
        } else {
          method.apply(method_this, args);
        }
      } catch (err) {
        console.error(this.config.name, err);

        if (reject) {
          reject(err);
        }
      }
    });

    this._connection.on("callback", async data => {
      let resolve, reject, method, args, result;

      try {
        if (data.promise) {
          [resolve, reject] = await this._unwrap(data.promise, false);
        }

        if (data.promise) {
          method = this._store.fetch(data.id);
          args = await this._unwrap(data.args, true);

          if (!method) {
            throw new Error("Callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");
          }

          result = method.apply(null, args);

          if (result instanceof Promise || method.constructor && method.constructor.name === "AsyncFunction") {
            result.then(resolve).catch(reject);
          } else {
            resolve(result);
          }
        } else {
          method = this._store.fetch(data.id);
          args = await this._unwrap(data.args, true);

          if (!method) {
            throw new Error("Please notice that callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");
          }

          method.apply(null, args);
        }
      } catch (err) {
        console.error(this.config.name, err);

        if (reject) {
          reject(err);
        }
      }
    });

    this._connection.on("disposeObject", data => {
      try {
        this._disposeObject(data.object_id);

        this._connection.emit({
          type: "disposed"
        });
      } catch (e) {
        console.error(e);

        this._connection.emit({
          type: "disposed",
          error: String(e)
        });
      }
    });

    this._connection.on("setInterface", data => {
      this._setRemoteInterface(data.api);
    });

    this._connection.on("getInterface", () => {
      this._fire("getInterface");

      if (this._local_api) {
        this.sendInterface();
      } else {
        this.once("interfaceAvailable", () => {
          this.sendInterface();
        });
      }
    });

    this._connection.on("interfaceSetAsRemote", () => {
      this._remote_set = true;

      this._fire("interfaceSetAsRemote");
    });

    this._connection.on("disconnect", () => {
      this._fire("beforeDisconnect");

      this._connection.disconnect();

      this._fire("disconnected");
    });
  }
  /**
   * Sends a requests to the remote site asking it to provide its
   * current interface
   */


  requestRemote() {
    this._connection.emit({
      type: "getInterface"
    });
  }

  _ndarray(typedArray, shape, dtype) {
    const _dtype = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["typedArrayToDtype"])(typedArray);

    if (dtype && dtype !== _dtype) {
      throw "dtype doesn't match the type of the array: " + _dtype + " != " + dtype;
    }

    shape = shape || [typedArray.length];
    return {
      _rtype: "ndarray",
      _rvalue: typedArray.buffer,
      _rshape: shape,
      _rdtype: _dtype
    };
  }
  /**
   * Sets the new remote interface provided by the other site
   *
   * @param {Array} names list of function names
   */


  _setRemoteInterface(api) {
    this._decode(api).then(intf => {
      // update existing interface instead of recreating it
      // this will preserve the object reference
      if (this._remote_interface) {
        // clear the interface
        for (let k in this._remote_interface) delete this._remote_interface[k]; // then assign the new interfaces


        Object.assign(this._remote_interface, intf);
      } else this._remote_interface = intf;

      this._fire("remoteReady");

      this._reportRemoteSet();
    });
  }
  /**
   * Generates the wrapped function corresponding to a single remote
   * method. When the generated function is called, it will send the
   * corresponding message to the remote site asking it to execute
   * the particular method of its interface
   *
   * @param {String} name of the remote method
   *
   * @returns {Function} wrapped remote method
   */


  _genRemoteMethod(targetId, name, objectId) {
    const me = this;

    const remoteMethod = function () {
      return new Promise(async (resolve, reject) => {
        let id = null;

        try {
          id = me._method_refs.put(objectId ? objectId + "/" + name : name);

          const wrapped_resolve = function () {
            if (id !== null) me._method_refs.fetch(id);
            return resolve.apply(this, arguments);
          };

          const wrapped_reject = function () {
            if (id !== null) me._method_refs.fetch(id);
            return reject.apply(this, arguments);
          };

          const encodedPromise = await me._wrap([wrapped_resolve, wrapped_reject]); // store the key id for removing them from the reference store together

          wrapped_resolve.__promise_pair = encodedPromise[1]._rvalue;
          wrapped_reject.__promise_pair = encodedPromise[0]._rvalue;
          let args = Array.prototype.slice.call(arguments);
          const argLength = args.length; // if the last argument is an object, mark it as kwargs

          const withKwargs = argLength > 0 && typeof args[argLength - 1] === "object" && args[argLength - 1] !== null && args[argLength - 1]._rkwargs;
          if (withKwargs) delete args[argLength - 1]._rkwargs;

          if (name === "register" || name === "registerService" || name === "register_service" || name === "export" || name === "on") {
            args = await me._wrap(args, true);
          } else {
            args = await me._wrap(args);
          }

          const transferables = args.__transferables__;
          if (transferables) delete args.__transferables__;

          me._connection.emit({
            type: "method",
            target_id: targetId,
            name: name,
            object_id: objectId,
            args: args,
            promise: encodedPromise,
            with_kwargs: withKwargs
          }, transferables);
        } catch (e) {
          if (id) me._method_refs.fetch(id);
          reject(\`Failed to exectue remote method (interface: \${objectId || me.id}, method: \${name}), error: \${e}\`);
        }
      });
    };

    remoteMethod.__remote_method = true;
    return remoteMethod;
  }
  /**
   * Sends a responce reporting that interface just provided by the
   * remote site was successfully set by this site as remote
   */


  _reportRemoteSet() {
    this._connection.emit({
      type: "interfaceSetAsRemote"
    });
  }
  /**
   * Prepares the provided set of remote method arguments for
   * sending to the remote site, replaces all the callbacks with
   * identifiers
   *
   * @param {Array} args to wrap
   *
   * @returns {Array} wrapped arguments
   */


  async _encode(aObject, asInterface, objectId) {
    const aType = typeof aObject;

    if (aType === "number" || aType === "string" || aType === "boolean" || aObject === null || aObject === undefined || aObject instanceof ArrayBuffer) {
      return aObject;
    }

    let bObject;

    if (typeof aObject === "function") {
      if (asInterface) {
        if (!objectId) throw new Error("objectId is not specified.");
        bObject = {
          _rtype: "interface",
          _rtarget_id: this._connection.peer_id,
          _rintf: objectId,
          _rvalue: asInterface
        };

        this._method_weakmap.set(aObject, bObject);
      } else if (this._method_weakmap.has(aObject)) {
        bObject = this._method_weakmap.get(aObject);
      } else {
        const cid = this._store.put(aObject);

        bObject = {
          _rtype: "callback",
          _rtarget_id: this._connection.peer_id,
          _rname: aObject.constructor && aObject.constructor.name || cid,
          _rvalue: cid
        };
      }

      return bObject;
    } // skip if already encoded


    if (aObject.constructor instanceof Object && aObject._rtype) {
      // make sure the interface functions are encoded
      if (aObject._rintf) {
        const temp = aObject._rtype;
        delete aObject._rtype;
        bObject = await this._encode(aObject, asInterface, objectId);
        bObject._rtype = temp;
      } else {
        bObject = aObject;
      }

      return bObject;
    }

    const transferables = [];
    const _transfer = aObject._transfer;
    const isarray = Array.isArray(aObject);

    for (let tp of Object.keys(this._codecs)) {
      const codec = this._codecs[tp];

      if (codec.encoder && aObject instanceof codec.type) {
        // TODO: what if multiple encoders found
        let encodedObj = await Promise.resolve(codec.encoder(aObject));
        if (encodedObj && !encodedObj._rtype) encodedObj._rtype = codec.name; // encode the functions in the interface object

        if (encodedObj && encodedObj._rintf) {
          const temp = encodedObj._rtype;
          delete encodedObj._rtype;
          encodedObj = await this._encode(encodedObj, asInterface, objectId);
          encodedObj._rtype = temp;
        }

        bObject = encodedObj;
        return bObject;
      }
    }

    if (
    /*global tf*/
    typeof tf !== "undefined" && tf.Tensor && aObject instanceof tf.Tensor) {
      const v_buffer = aObject.dataSync();

      if (aObject._transfer || _transfer) {
        transferables.push(v_buffer.buffer);
        delete aObject._transfer;
      }

      bObject = {
        _rtype: "ndarray",
        _rvalue: v_buffer.buffer,
        _rshape: aObject.shape,
        _rdtype: aObject.dtype
      };
    } else if (
    /*global nj*/
    typeof nj !== "undefined" && nj.NdArray && aObject instanceof nj.NdArray) {
      const dtype = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["typedArrayToDtype"])(aObject.selection.data);

      if (aObject._transfer || _transfer) {
        transferables.push(aObject.selection.data.buffer);
        delete aObject._transfer;
      }

      bObject = {
        _rtype: "ndarray",
        _rvalue: aObject.selection.data.buffer,
        _rshape: aObject.shape,
        _rdtype: dtype
      };
    } else if (aObject instanceof Error) {
      console.error(aObject);
      bObject = {
        _rtype: "error",
        _rvalue: aObject.toString()
      };
    } else if (typeof File !== "undefined" && aObject instanceof File) {
      bObject = {
        _rtype: "file",
        _rvalue: aObject,
        _rpath: aObject._path || aObject.webkitRelativePath
      };
    } // send objects supported by structure clone algorithm
    // https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm
    else if (aObject !== Object(aObject) || aObject instanceof Boolean || aObject instanceof String || aObject instanceof Date || aObject instanceof RegExp || aObject instanceof ImageData || typeof FileList !== "undefined" && aObject instanceof FileList || typeof FileSystemDirectoryHandle !== "undefined" && aObject instanceof FileSystemDirectoryHandle || typeof FileSystemFileHandle !== "undefined" && aObject instanceof FileSystemFileHandle || typeof FileSystemHandle !== "undefined" && aObject instanceof FileSystemHandle || typeof FileSystemWritableFileStream !== "undefined" && aObject instanceof FileSystemWritableFileStream) {
      bObject = aObject; // TODO: avoid object such as DynamicPlugin instance.
    } else if (typeof File !== "undefined" && aObject instanceof File) {
      bObject = {
        _rtype: "file",
        _rname: aObject.name,
        _rmime: aObject.type,
        _rvalue: aObject,
        _rpath: aObject._path || aObject.webkitRelativePath
      };
    } else if (aObject instanceof Blob) {
      bObject = {
        _rtype: "blob",
        _rvalue: aObject
      };
    } else if (aObject instanceof ArrayBufferView) {
      if (aObject._transfer || _transfer) {
        transferables.push(aObject.buffer);
        delete aObject._transfer;
      }

      const dtype = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["typedArrayToDtype"])(aObject);
      bObject = {
        _rtype: "typedarray",
        _rvalue: aObject.buffer,
        _rdtype: dtype
      };
    } else if (aObject instanceof DataView) {
      if (aObject._transfer || _transfer) {
        transferables.push(aObject.buffer);
        delete aObject._transfer;
      }

      bObject = {
        _rtype: "memoryview",
        _rvalue: aObject.buffer
      };
    } else if (aObject instanceof Set) {
      bObject = {
        _rtype: "set",
        _rvalue: await this._encode(Array.from(aObject), asInterface)
      };
    } else if (aObject instanceof Map) {
      bObject = {
        _rtype: "orderedmap",
        _rvalue: await this._encode(Array.from(aObject), asInterface)
      };
    } else if (aObject.constructor instanceof Object || Array.isArray(aObject)) {
      bObject = isarray ? [] : {};
      let keys; // an object/array

      if (aObject.constructor === Object || Array.isArray(aObject)) {
        keys = Object.keys(aObject);
      } // a class
      else if (aObject.constructor === Function) {
        throw new Error("Please instantiate the class before exportting it.");
      } // instance of a class
      else if (aObject.constructor.constructor === Function) {
        keys = Object.getOwnPropertyNames(Object.getPrototypeOf(aObject)).concat(Object.keys(aObject)); // TODO: use a proxy object to represent the actual object
        // always encode class instance as interface

        asInterface = true;
      } else {
        throw Error("Unsupported interface type");
      }

      let hasFunction = false; // encode interfaces

      if (aObject._rintf || asInterface) {
        if (!objectId) {
          if (typeof aObject._rintf === "string" && aObject._rintf.length > 0) {
            objectId = aObject._rintf; // enable custom object id
          } else {
            objectId = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["randId"])();
          } // Note: object with the same id will be overwritten


          if (this._object_store[objectId]) console.warn(\`Overwritting interface object with the same id: \${objectId}\`);
          this._object_store[objectId] = aObject;
        }

        for (let k of keys) {
          if (k === "constructor") continue;

          if (k.startsWith("_")) {
            continue;
          }

          bObject[k] = await this._encode(aObject[k], typeof asInterface === "string" ? asInterface + "." + k : k, objectId);

          if (typeof aObject[k] === "function") {
            hasFunction = true;
          }
        } // object id for dispose the object remotely


        if (hasFunction) bObject._rintf = objectId; // remove interface when closed

        if (aObject.on && typeof aObject.on === "function") {
          aObject.on("close", () => {
            delete this._object_store[objectId];
          });
        }
      } else {
        for (let k of keys) {
          if (["hasOwnProperty", "constructor"].includes(k)) continue;
          bObject[k] = await this._encode(aObject[k]);
        }
      } // for example, browserFS object

    } else if (typeof aObject === "object") {
      const keys = Object.getOwnPropertyNames(Object.getPrototypeOf(aObject)).concat(Object.keys(aObject));
      const objectId = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["randId"])();

      for (let k of keys) {
        if (["hasOwnProperty", "constructor"].includes(k)) continue; // encode as interface

        bObject[k] = await this._encode(aObject[k], k, bObject);
      } // object id, used for dispose the object


      bObject._rintf = objectId;
    } else {
      throw "imjoy-rpc: Unsupported data type:" + aObject;
    }

    if (transferables.length > 0) {
      bObject.__transferables__ = transferables;
    }

    if (!bObject) {
      throw new Error("Failed to encode object");
    }

    return bObject;
  }

  async _decode(aObject, withPromise) {
    if (!aObject) {
      return aObject;
    }

    let bObject;

    if (aObject["_rtype"]) {
      if (this._codecs[aObject._rtype] && this._codecs[aObject._rtype].decoder) {
        if (aObject._rintf) {
          const temp = aObject._rtype;
          delete aObject._rtype;
          aObject = await this._decode(aObject, withPromise);
          aObject._rtype = temp;
        }

        bObject = await Promise.resolve(this._codecs[aObject._rtype].decoder(aObject));
      } else if (aObject._rtype === "callback") {
        bObject = this._genRemoteCallback(aObject._rtarget_id, aObject._rvalue, withPromise);
      } else if (aObject._rtype === "interface") {
        bObject = this._genRemoteMethod(aObject._rtarget_id, aObject._rvalue, aObject._rintf);
      } else if (aObject._rtype === "ndarray") {
        /*global nj tf*/
        //create build array/tensor if used in the plugin
        if (typeof nj !== "undefined" && nj.array) {
          if (Array.isArray(aObject._rvalue)) {
            aObject._rvalue = aObject._rvalue.reduce(_appendBuffer);
          }

          bObject = nj.array(new Uint8(aObject._rvalue), aObject._rdtype).reshape(aObject._rshape);
        } else if (typeof tf !== "undefined" && tf.Tensor) {
          if (Array.isArray(aObject._rvalue)) {
            aObject._rvalue = aObject._rvalue.reduce(_appendBuffer);
          }

          const arraytype = _utils_js__WEBPACK_IMPORTED_MODULE_0__["dtypeToTypedArray"][aObject._rdtype];
          bObject = tf.tensor(new arraytype(aObject._rvalue), aObject._rshape, aObject._rdtype);
        } else {
          //keep it as regular if transfered to the main app
          bObject = aObject;
        }
      } else if (aObject._rtype === "error") {
        bObject = new Error(aObject._rvalue);
      } else if (aObject._rtype === "file") {
        if (aObject._rvalue instanceof File) {
          bObject = aObject._rvalue; //patch _path

          bObject._path = aObject._rpath;
        } else {
          bObject = new File([aObject._rvalue], aObject._rname, {
            type: aObject._rmime
          });
          bObject._path = aObject._rpath;
        }
      } else if (aObject._rtype === "typedarray") {
        const arraytype = _utils_js__WEBPACK_IMPORTED_MODULE_0__["dtypeToTypedArray"][aObject._rdtype];
        if (!arraytype) throw new Error("unsupported dtype: " + aObject._rdtype);
        bObject = new arraytype(aObject._rvalue);
      } else if (aObject._rtype === "memoryview") {
        bObject = new DataView(aObject._rvalue);
      } else if (aObject._rtype === "blob") {
        if (aObject._rvalue instanceof Blob) {
          bObject = aObject._rvalue;
        } else {
          bObject = new Blob([aObject._rvalue], {
            type: aObject._rmime
          });
        }
      } else if (aObject._rtype === "orderedmap") {
        bObject = new Map(await this._decode(aObject._rvalue, withPromise));
      } else if (aObject._rtype === "set") {
        bObject = new Set(await this._decode(aObject._rvalue, withPromise));
      } else {
        // make sure all the interface functions are decoded
        if (aObject._rintf) {
          const temp = aObject._rtype;
          delete aObject._rtype;
          bObject = await this._decode(aObject, withPromise);
          bObject._rtype = temp;
        } else bObject = aObject;
      }
    } else if (aObject.constructor === Object || Array.isArray(aObject)) {
      const isarray = Array.isArray(aObject);
      bObject = isarray ? [] : {};

      for (let k of Object.keys(aObject)) {
        if (isarray || aObject.hasOwnProperty(k)) {
          const v = aObject[k];
          bObject[k] = await this._decode(v, withPromise);
        }
      }
    } else {
      bObject = aObject;
    }

    if (bObject === undefined) {
      throw new Error("Failed to decode object");
    } // store the object id for dispose


    if (aObject._rintf) {
      this._object_weakmap.set(bObject, aObject._rintf);
    }

    return bObject;
  }

  async _wrap(args, asInterface) {
    return await this._encode(args, asInterface);
  }
  /**
   * Unwraps the set of arguments delivered from the remote site,
   * replaces all callback identifiers with a function which will
   * initiate sending that callback identifier back to other site
   *
   * @param {Object} args to unwrap
   *
   * @param {Boolean} withPromise is true means this the callback should contain a promise
   *
   * @returns {Array} unwrapped args
   */


  async _unwrap(args, withPromise) {
    return await this._decode(args, withPromise);
  }
  /**
   * Generates the wrapped function corresponding to a single remote
   * callback. When the generated function is called, it will send
   * the corresponding message to the remote site asking it to
   * execute the particular callback previously saved during a call
   * by the remote site a method from the interface of this site
   *
   * @param {Number} id of the remote callback to execute
   * @param {Number} argNum argument index of the callback
   * @param {Boolean} withPromise is true means this the callback should contain a promise
   *
   * @returns {Function} wrapped remote callback
   */


  _genRemoteCallback(targetId, cid, withPromise) {
    const me = this;
    let remoteCallback;

    if (withPromise) {
      remoteCallback = function () {
        return new Promise(async (resolve, reject) => {
          const args = await me._wrap(Array.prototype.slice.call(arguments));
          const argLength = args.length; // if the last argument is an object, mark it as kwargs

          const withKwargs = argLength > 0 && typeof args[argLength - 1] === "object" && args[argLength - 1] !== null && args[argLength - 1]._rkwargs;
          if (withKwargs) delete args[argLength - 1]._rkwargs;
          const transferables = args.__transferables__;
          if (transferables) delete args.__transferables__;
          const encodedPromise = await me._wrap([resolve, reject]); // store the key id for removing them from the reference store together

          resolve.__promise_pair = encodedPromise[1]._rvalue;
          reject.__promise_pair = encodedPromise[0]._rvalue;

          try {
            me._connection.emit({
              type: "callback",
              target_id: targetId,
              id: cid,
              args: args,
              promise: encodedPromise,
              with_kwargs: withKwargs
            }, transferables);
          } catch (e) {
            reject(\`Failed to exectue remote callback ( id: \${cid}).\`);
          }
        });
      };

      return remoteCallback;
    } else {
      remoteCallback = async function () {
        const args = await me._wrap(Array.prototype.slice.call(arguments));
        const argLength = args.length; // if the last argument is an object, mark it as kwargs

        const withKwargs = argLength > 0 && typeof args[argLength - 1] === "object" && args[argLength - 1] !== null && args[argLength - 1]._rkwargs;
        if (withKwargs) delete args[argLength - 1]._rkwargs;
        const transferables = args.__transferables__;
        if (transferables) delete args.__transferables__;
        return me._connection.emit({
          type: "callback",
          target_id: targetId,
          id: cid,
          args: args,
          with_kwargs: withKwargs
        }, transferables);
      };

      return remoteCallback;
    }
  }

  reset() {
    this._event_handlers = {};
    this._once_handlers = {};
    this._remote_interface = null;
    this._object_store = {};
    this._method_weakmap = new WeakMap();
    this._object_weakmap = new WeakMap();
    this._local_api = null;
    this._store = new ReferenceStore();
    this._method_refs = new ReferenceStore();
  }
  /**
   * Sends the notification message and breaks the connection
   */


  disconnect() {
    this._connection.emit({
      type: "disconnect"
    });

    this.reset();
    setTimeout(() => {
      this._connection.disconnect();
    }, 2000);
  }

}
/**
 * ReferenceStore is a special object which stores other objects
 * and provides the references (number) instead. This reference
 * may then be sent over a json-based communication channel (IPC
 * to another Node.js process or a message to the Worker). Other
 * site may then provide the reference in the responce message
 * implying the given object should be activated.
 *
 * Primary usage for the ReferenceStore is a storage for the
 * callbacks, which therefore makes it possible to initiate a
 * callback execution by the opposite site (which normally cannot
 * directly execute functions over the communication channel).
 *
 * Each stored object can only be fetched once and is not
 * available for the second time. Each stored object must be
 * fetched, since otherwise it will remain stored forever and
 * consume memory.
 *
 * Stored object indeces are simply the numbers, which are however
 * released along with the objects, and are later reused again (in
 * order to postpone the overflow, which should not likely happen,
 * but anyway).
 */

class ReferenceStore {
  constructor() {
    this._store = {}; // stored object

    this._indices = [0]; // smallest available indices

    this._readyHandler = function () {};

    this._busyHandler = function () {};

    this._readyHandler();
  }
  /**
   * call handler when the store is empty
   *
   * @param {FUNCTION} id of a handler
   */


  onReady(readyHandler) {
    this._readyHandler = readyHandler || function () {};
  }
  /**
   * call handler when the store is not empty
   *
   * @param {FUNCTION} id of a handler
   */


  onBusy(busyHandler) {
    this._busyHandler = busyHandler || function () {};
  }
  /**
   * get the length of the store
   *
   */


  getStack() {
    return Object.keys(this._store).length;
  }
  /**
   * @function _genId() generates the new reference id
   *
   * @returns {Number} smallest available id and reserves it
   */


  _genId() {
    let id;

    if (this._indices.length === 1) {
      id = this._indices[0]++;
    } else {
      id = this._indices.shift();
    }

    return id;
  }
  /**
   * Releases the given reference id so that it will be available by
   * another object stored
   *
   * @param {Number} id to release
   */


  _releaseId(id) {
    for (let i = 0; i < this._indices.length; i++) {
      if (id < this._indices[i]) {
        this._indices.splice(i, 0, id);

        break;
      }
    } // cleaning-up the sequence tail


    for (let i = this._indices.length - 1; i >= 0; i--) {
      if (this._indices[i] - 1 === this._indices[i - 1]) {
        this._indices.pop();
      } else {
        break;
      }
    }
  }
  /**
   * Stores the given object and returns the refernce id instead
   *
   * @param {Object} obj to store
   *
   * @returns {Number} reference id of the stored object
   */


  put(obj) {
    if (this._busyHandler && Object.keys(this._store).length === 0) {
      this._busyHandler();
    }

    const id = this._genId();

    this._store[id] = obj;
    return id;
  }
  /**
   * Retrieves previously stored object and releases its reference
   *
   * @param {Number} id of an object to retrieve
   */


  fetch(id) {
    const obj = this._store[id];

    if (obj && !obj.__remote_method) {
      delete this._store[id];

      this._releaseId(id);

      if (this._readyHandler && Object.keys(this._store).length === 0) {
        this._readyHandler();
      }
    }

    if (obj && obj.__promise_pair) {
      this.fetch(obj.__promise_pair);
    }

    return obj;
  }

}

/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\\
  !*** ./src/utils.js ***!
  \\**********************/
/*! exports provided: randId, dtypeToTypedArray, loadRequirementsInWindow, loadRequirementsInWebworker, loadRequirements, normalizeConfig, typedArrayToDtypeMapping, typedArrayToDtype, cacheRequirements, setupServiceWorker, urlJoin, MessageEmitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "randId", function() { return randId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtypeToTypedArray", function() { return dtypeToTypedArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadRequirementsInWindow", function() { return loadRequirementsInWindow; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadRequirementsInWebworker", function() { return loadRequirementsInWebworker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadRequirements", function() { return loadRequirements; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizeConfig", function() { return normalizeConfig; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "typedArrayToDtypeMapping", function() { return typedArrayToDtypeMapping; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "typedArrayToDtype", function() { return typedArrayToDtype; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cacheRequirements", function() { return cacheRequirements; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setupServiceWorker", function() { return setupServiceWorker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "urlJoin", function() { return urlJoin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageEmitter", function() { return MessageEmitter; });
function randId() {
  return Math.random().toString(36).substr(2, 10) + new Date().getTime();
}
const dtypeToTypedArray = {
  int8: Int8Array,
  int16: Int16Array,
  int32: Int32Array,
  uint8: Uint8Array,
  uint16: Uint16Array,
  uint32: Uint32Array,
  float32: Float32Array,
  float64: Float64Array,
  array: Array
};
async function loadRequirementsInWindow(requirements) {
  function _importScript(url) {
    //url is URL of external file, implementationCode is the code
    //to be called from the file, location is the location to
    //insert the <script> element
    return new Promise((resolve, reject) => {
      var scriptTag = document.createElement("script");
      scriptTag.src = url;
      scriptTag.type = "text/javascript";
      scriptTag.onload = resolve;

      scriptTag.onreadystatechange = function () {
        if (this.readyState === "loaded" || this.readyState === "complete") {
          resolve();
        }
      };

      scriptTag.onerror = reject;
      document.head.appendChild(scriptTag);
    });
  } // support importScripts outside web worker


  async function importScripts() {
    var args = Array.prototype.slice.call(arguments),
        len = args.length,
        i = 0;

    for (; i < len; i++) {
      await _importScript(args[i]);
    }
  }

  if (requirements && (Array.isArray(requirements) || typeof requirements === "string")) {
    try {
      var link_node;
      requirements = typeof requirements === "string" ? [requirements] : requirements;

      if (Array.isArray(requirements)) {
        for (var i = 0; i < requirements.length; i++) {
          if (requirements[i].toLowerCase().endsWith(".css") || requirements[i].startsWith("css:")) {
            if (requirements[i].startsWith("css:")) {
              requirements[i] = requirements[i].slice(4);
            }

            link_node = document.createElement("link");
            link_node.rel = "stylesheet";
            link_node.href = requirements[i];
            document.head.appendChild(link_node);
          } else if (requirements[i].toLowerCase().endsWith(".mjs") || requirements[i].startsWith("mjs:")) {
            // import esmodule
            if (requirements[i].startsWith("mjs:")) {
              requirements[i] = requirements[i].slice(4);
            }

            await import(
            /* webpackIgnore: true */
            requirements[i]);
          } else if (requirements[i].toLowerCase().endsWith(".js") || requirements[i].startsWith("js:")) {
            if (requirements[i].startsWith("js:")) {
              requirements[i] = requirements[i].slice(3);
            }

            await importScripts(requirements[i]);
          } else if (requirements[i].startsWith("http")) {
            await importScripts(requirements[i]);
          } else if (requirements[i].startsWith("cache:")) {//ignore cache
          } else {
            console.log("Unprocessed requirements url: " + requirements[i]);
          }
        }
      } else {
        throw "unsupported requirements definition";
      }
    } catch (e) {
      throw "failed to import required scripts: " + requirements.toString();
    }
  }
}
async function loadRequirementsInWebworker(requirements) {
  if (requirements && (Array.isArray(requirements) || typeof requirements === "string")) {
    try {
      if (!Array.isArray(requirements)) {
        requirements = [requirements];
      }

      for (var i = 0; i < requirements.length; i++) {
        if (requirements[i].toLowerCase().endsWith(".css") || requirements[i].startsWith("css:")) {
          throw "unable to import css in a webworker";
        } else if (requirements[i].toLowerCase().endsWith(".js") || requirements[i].startsWith("js:")) {
          if (requirements[i].startsWith("js:")) {
            requirements[i] = requirements[i].slice(3);
          }

          importScripts(requirements[i]);
        } else if (requirements[i].startsWith("http")) {
          importScripts(requirements[i]);
        } else if (requirements[i].startsWith("cache:")) {//ignore cache
        } else {
          console.log("Unprocessed requirements url: " + requirements[i]);
        }
      }
    } catch (e) {
      throw "failed to import required scripts: " + requirements.toString();
    }
  }
}
function loadRequirements(requirements) {
  if (typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope) {
    return loadRequirementsInWebworker(requirements);
  } else {
    return loadRequirementsInWindow(requirements);
  }
}
function normalizeConfig(config) {
  config.version = config.version || "0.1.0";
  config.description = config.description || \`[TODO: add description for \${config.name} ]\`;
  config.type = config.type || "rpc-window";
  config.id = config.id || randId();
  config.target_origin = config.target_origin || "*";
  config.allow_execution = config.allow_execution || false; // remove functions

  config = Object.keys(config).reduce((p, c) => {
    if (typeof config[c] !== "function") p[c] = config[c];
    return p;
  }, {});
  return config;
}
const typedArrayToDtypeMapping = {
  Int8Array: "int8",
  Int16Array: "int16",
  Int32Array: "int32",
  Uint8Array: "uint8",
  Uint16Array: "uint16",
  Uint32Array: "uint32",
  Float32Array: "float32",
  Float64Array: "float64",
  Array: "array"
};
const typedArrayToDtypeKeys = [];

for (const arrType of Object.keys(typedArrayToDtypeMapping)) {
  typedArrayToDtypeKeys.push(eval(arrType));
}

function typedArrayToDtype(obj) {
  let dtype = typedArrayToDtypeMapping[obj.constructor.name];

  if (!dtype) {
    const pt = Object.getPrototypeOf(obj);

    for (const arrType of typedArrayToDtypeKeys) {
      if (pt instanceof arrType) {
        dtype = typedArrayToDtypeMapping[arrType.name];
        break;
      }
    }
  }

  return dtype;
}

function cacheUrlInServiceWorker(url) {
  return new Promise(function (resolve, reject) {
    const message = {
      command: "add",
      url: url
    };

    if (!navigator.serviceWorker || !navigator.serviceWorker.register) {
      reject("Service worker is not supported.");
      return;
    }

    const messageChannel = new MessageChannel();

    messageChannel.port1.onmessage = function (event) {
      if (event.data && event.data.error) {
        reject(event.data.error);
      } else {
        resolve(event.data && event.data.result);
      }
    };

    if (navigator.serviceWorker && navigator.serviceWorker.controller) {
      navigator.serviceWorker.controller.postMessage(message, [messageChannel.port2]);
    } else {
      reject("Service worker controller is not available");
    }
  });
}

async function cacheRequirements(requirements) {
  requirements = requirements || [];

  if (!Array.isArray(requirements)) {
    requirements = [requirements];
  }

  for (let req of requirements) {
    //remove prefix
    if (req.startsWith("js:")) req = req.slice(3);
    if (req.startsWith("css:")) req = req.slice(4);
    if (req.startsWith("cache:")) req = req.slice(6);
    if (!req.startsWith("http")) continue;
    await cacheUrlInServiceWorker(req).catch(e => {
      console.error(e);
    });
  }
}
function setupServiceWorker(baseUrl, targetOrigin, cacheCallback) {
  // register service worker for offline access
  if ("serviceWorker" in navigator) {
    baseUrl = baseUrl || "/";
    navigator.serviceWorker.register(baseUrl + "plugin-service-worker.js").then(function (registration) {
      // Registration was successful
      console.log("ServiceWorker registration successful with scope: ", registration.scope);
    }, function (err) {
      // registration failed :(
      console.log("ServiceWorker registration failed: ", err);
    });
    targetOrigin = targetOrigin || "*";
    cacheCallback = cacheCallback || cacheRequirements;

    if (cacheCallback && typeof cacheCallback !== "function") {
      throw new Error("config.cache_requirements must be a function");
    }

    window.addEventListener("message", function (e) {
      if (targetOrigin === "*" || e.origin === targetOrigin) {
        const m = e.data;

        if (m.type === "cacheRequirements") {
          cacheCallback(m.requirements);
        }
      }
    });
  }
} //#Source https://bit.ly/2neWfJ2

function urlJoin(...args) {
  return args.join("/").replace(/[\\/]+/g, "/").replace(/^(.+):\\//, "$1://").replace(/^file:/, "file:/").replace(/\\/(\\?|&|#[^!])/g, "$1").replace(/\\?/g, "&").replace("&", "?");
}
class MessageEmitter {
  constructor(debug) {
    this._event_handlers = {};
    this._once_handlers = {};
    this._debug = debug;
  }

  emit() {
    throw new Error("emit is not implemented");
  }

  on(event, handler) {
    if (!this._event_handlers[event]) {
      this._event_handlers[event] = [];
    }

    this._event_handlers[event].push(handler);
  }

  once(event, handler) {
    handler.___event_run_once = true;
    this.on(event, handler);
  }

  off(event, handler) {
    if (!event && !handler) {
      // remove all events handlers
      this._event_handlers = {};
    } else if (event && !handler) {
      // remove all hanlders for the event
      if (this._event_handlers[event]) this._event_handlers[event] = [];
    } else {
      // remove a specific handler
      if (this._event_handlers[event]) {
        const idx = this._event_handlers[event].indexOf(handler);

        if (idx >= 0) {
          this._event_handlers[event].splice(idx, 1);
        }
      }
    }
  }

  _fire(event, data) {
    if (this._event_handlers[event]) {
      var i = this._event_handlers[event].length;

      while (i--) {
        const handler = this._event_handlers[event][i];

        try {
          handler(data);
        } catch (e) {
          console.error(e);
        } finally {
          if (handler.___event_run_once) {
            this._event_handlers[event].splice(i, 1);
          }
        }
      }
    } else {
      if (this._debug) {
        console.warn("unhandled event", event, data);
      }
    }
  }

}

/***/ })

/******/ });
//# sourceMappingURL=plugin.webworker.js.map`,null)}},"./src/pluginCore.js":function(n,t,r){r.r(t),r.d(t,"connectRPC",function(){return i});var s=r("./src/rpc.js");function i(o,l){l=l||{};const f={},u=new s.RPC(o,l,f);u.on("getInterface",function(){a()}),u.on("remoteReady",function(){const _=u.getRemote()||{};_.registerCodec=function(b){if(!b.name||!b.encoder&&!b.decoder)throw new Error("Invalid codec format, please make sure you provide a name, type, encoder and decoder.");if(b.type)for(let c of Object.keys(f))(f[c].type===b.type||c===b.name)&&(delete f[c],console.warn("Remove duplicated codec: "+c));f[b.name]=b},_.init=function(b){u.setInterface({setup(){}},b)},_.disposeObject=function(b){u.disposeObject(b)},_.export=function(b,c){u.setInterface(b,c)},_.onLoad=function(b){b=m(b),g?b():y.push(b)},_.dispose=function(b){u.disconnect()},_._rpc=u,typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?(self.api=_,self.postMessage({type:"imjoy_remote_api_ready"}),self.dispatchEvent(new CustomEvent("imjoy_remote_api_ready",{detail:_}))):window.dispatchEvent(new CustomEvent("imjoy_remote_api_ready",{detail:_}))});let g=!1;const y=[],a=function(){if(!g){g=!0;let _;for(;_=y.pop();)_()}},m=function(_){const b=typeof _;if(b!=="function"){const c="A function may only be subsribed to the event, "+b+" was provided instead";throw new Error(c)}return _};return u}},"./src/pluginIframe.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Connection",function(){return Connection}),__webpack_require__.d(__webpack_exports__,"default",function(){return setupIframe});var _pluginCore_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/pluginCore.js"),_rpc_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/rpc.js"),_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils.js");function _htmlToElement(n){var t=document.createElement("template");return n=n.trim(),t.innerHTML=n,t.content.firstChild}const _inWebWorker=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;async function executeEsModule(n){const t="data:text/javascript;charset=utf-8,"+encodeURIComponent(n);await __vitePreload(()=>import(t),__vite__mapDeps([]))}class Connection extends _utils_js__WEBPACK_IMPORTED_MODULE_2__.MessageEmitter{constructor(n){super(n&&n.debug),this.config=n||{},this.peer_id=Object(_utils_js__WEBPACK_IMPORTED_MODULE_2__.randId)()}connect(){this.config.target_origin=this.config.target_origin||"*",this.config.broadcastChannel?this.broadcastChannel=new BroadcastChannel(this.config.broadcastChannel):this.broadcastChannel=null,this.broadcastChannel?this.broadcastChannel.addEventListener("message",this):globalThis.addEventListener("message",this),this.emit({type:"initialized",config:this.config,origin:globalThis.location.origin,peer_id:this.peer_id}),this._fire("connected")}handleEvent(n){n.type==="message"&&(this.broadcastChannel||this.config.target_origin==="*"||!n.origin||n.origin===this.config.target_origin)&&(n.data.peer_id===this.peer_id?this._fire(n.data.type,n.data):this.config.debug&&console.log(`connection peer id mismatch ${n.data.peer_id} !== ${this.peer_id}`))}disconnect(){this._fire("beforeDisconnect"),globalThis.removeEventListener("message",this),this._fire("disconnected")}emit(n){let t;this.broadcastChannel?this.broadcastChannel.postMessage(n):n.__transferables__?(t=n.__transferables__,delete n.__transferables__):_inWebWorker?self.postMessage(n,t):parent.postMessage(n,this.config.target_origin,t)}async execute(code){try{if(code.type==="requirements")await Object(_utils_js__WEBPACK_IMPORTED_MODULE_2__.loadRequirementsInWindow)(code.requirements);else if(code.type==="script")if(code.src){var script_node=document.createElement("script");script_node.setAttribute("type",code.attrs.type),script_node.setAttribute("src",code.src),document.head.appendChild(script_node)}else if(code.content&&code.attrs.lang==="javascript")code.attrs.type==="module"?await executeEsModule(code.content):eval(code.content);else{var node=document.createElement("script");for(let n in code.attrs)node.setAttribute(n,code.attrs[n]);node.appendChild(document.createTextNode(code.content)),document.body.appendChild(node)}else if(code.type==="style"){const n=document.createElement("style");code.src&&(n.src=code.src),n.innerHTML=code.content,document.head.appendChild(n)}else if(code.type==="link"){const n=document.createElement("link");code.rel&&(n.rel=code.rel),code.href&&(n.href=code.href),code.attrs&&code.attrs.type&&(n.type=code.attrs.type),document.head.appendChild(n)}else if(code.type==="html")document.body.appendChild(_htmlToElement(code.content));else throw"unsupported code type.";_inWebWorker?self.postMessage({type:"executed"}):parent.postMessage({type:"executed"},this.config.target_origin)}catch(n){console.error("failed to execute scripts: ",code,n),_inWebWorker?self.postMessage({type:"executed",error:n.stack||String(n)}):parent.postMessage({type:"executed",error:n.stack||String(n)},this.config.target_origin)}}}function setupIframe(n){n=n||{},n.dedicated_thread=!1,n.lang="javascript",n.api_version=_rpc_js__WEBPACK_IMPORTED_MODULE_1__.API_VERSION;const t=new Connection(n);Object(_pluginCore_js__WEBPACK_IMPORTED_MODULE_0__.connectRPC)(t,n),t.connect()}},"./src/rpc.js":function(n,t,r){r.r(t),r.d(t,"API_VERSION",function(){return i}),r.d(t,"RPC",function(){return u});var s=r("./src/utils.js");const i="0.2.3",o=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;function l(y,a){const m=new Uint8Array(y.byteLength+a.byteLength);return m.set(new Uint8Array(y),0),m.set(new Uint8Array(a),y.byteLength),m.buffer}function f(y,a){if(!a)throw new Error("undefined index");return typeof a=="string"?f(y,a.split(".")):a.length===0?y:f(y[a[0]],a.slice(1))}class u extends s.MessageEmitter{constructor(a,m,_){super(m&&m.debug),this._connection=a,this.config=m||{},this._codecs=_||{},this._object_store={},this._method_weakmap=new WeakMap,this._object_weakmap=new WeakMap,this._local_api=null,this._remote_set=!1;const b=this.config.name;this._connection.execute=this._connection.execute||function(){throw new Error(`connection.execute not implemented (in "${b}")`)},this._store=new g,this._method_refs=new g,this._method_refs.onReady(()=>{this._fire("remoteIdle")}),this._method_refs.onBusy(()=>{this._fire("remoteBusy")}),this._setupMessageHanlders()}init(){this._connection.emit({type:"initialized",config:this.config,peer_id:this._connection.peer_id})}setConfig(a){if(a)for(const m of Object.keys(a))this.config[m]=a[m]}getRemoteCallStack(){return this._method_refs.getStack()}getRemote(){return this._remote_interface}setInterface(a,m){if(m=m||{},this.config.name=m.name||this.config.name,this.config.description=m.description||this.config.description,this.config.forwarding_functions)for(let _ of this.config.forwarding_functions){const b=this._remote_interface;b[_]&&(a.constructor===Object?a[_]||(a[_]=(...c)=>{b[_](...c)}):a.constructor.constructor===Function&&(a.constructor.prototype[_]||(a.constructor.prototype[_]=(...c)=>{b[_](...c)})))}return this._local_api=a,this._remote_set?this.sendInterface():this._fire("interfaceAvailable"),new Promise(_=>{this.once("interfaceSetAsRemote",_)})}sendInterface(){if(!this._local_api)throw new Error("interface is not set.");this._encode(this._local_api,!0).then(a=>{this._connection.emit({type:"setInterface",api:a})})}_disposeObject(a){if(this._object_store[a])delete this._object_store[a];else throw new Error(`Object (id=${a}) not found.`)}disposeObject(a){return new Promise((m,_)=>{if(this._object_weakmap.has(a)){const b=this._object_weakmap.get(a);this._connection.once("disposed",c=>{c.error?_(new Error(c.error)):m()}),this._connection.emit({type:"disposeObject",object_id:b})}else throw new Error("Invalid object")})}_setupMessageHanlders(){this._connection.on("init",this.init),this._connection.on("execute",a=>{Promise.resolve(this._connection.execute(a.code)).then(()=>{this._connection.emit({type:"executed"})}).catch(m=>{console.error(m),this._connection.emit({type:"executed",error:String(m)})})}),this._connection.on("method",async a=>{let m,_,b,c,w,S;try{a.promise&&([m,_]=await this._unwrap(a.promise,!1));const E=this._object_store[a.object_id];if(b=f(E,a.name),a.name.includes(".")){const I=a.name.split("."),A=I.slice(0,I.length-1).join(".");c=f(E,A)}else c=E;w=await this._unwrap(a.args,!0),a.promise?(S=b.apply(c,w),S instanceof Promise||b.constructor&&b.constructor.name==="AsyncFunction"?S.then(m).catch(_):m(S)):b.apply(c,w)}catch(E){console.error(this.config.name,E),_&&_(E)}}),this._connection.on("callback",async a=>{let m,_,b,c,w;try{if(a.promise&&([m,_]=await this._unwrap(a.promise,!1)),a.promise){if(b=this._store.fetch(a.id),c=await this._unwrap(a.args,!0),!b)throw new Error("Callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");w=b.apply(null,c),w instanceof Promise||b.constructor&&b.constructor.name==="AsyncFunction"?w.then(m).catch(_):m(w)}else{if(b=this._store.fetch(a.id),c=await this._unwrap(a.args,!0),!b)throw new Error("Please notice that callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");b.apply(null,c)}}catch(S){console.error(this.config.name,S),_&&_(S)}}),this._connection.on("disposeObject",a=>{try{this._disposeObject(a.object_id),this._connection.emit({type:"disposed"})}catch(m){console.error(m),this._connection.emit({type:"disposed",error:String(m)})}}),this._connection.on("setInterface",a=>{this._setRemoteInterface(a.api)}),this._connection.on("getInterface",()=>{this._fire("getInterface"),this._local_api?this.sendInterface():this.once("interfaceAvailable",()=>{this.sendInterface()})}),this._connection.on("interfaceSetAsRemote",()=>{this._remote_set=!0,this._fire("interfaceSetAsRemote")}),this._connection.on("disconnect",()=>{this._fire("beforeDisconnect"),this._connection.disconnect(),this._fire("disconnected")})}requestRemote(){this._connection.emit({type:"getInterface"})}_ndarray(a,m,_){const b=Object(s.typedArrayToDtype)(a);if(_&&_!==b)throw"dtype doesn't match the type of the array: "+b+" != "+_;return m=m||[a.length],{_rtype:"ndarray",_rvalue:a.buffer,_rshape:m,_rdtype:b}}_setRemoteInterface(a){this._decode(a).then(m=>{if(this._remote_interface){for(let _ in this._remote_interface)delete this._remote_interface[_];Object.assign(this._remote_interface,m)}else this._remote_interface=m;this._fire("remoteReady"),this._reportRemoteSet()})}_genRemoteMethod(a,m,_){const b=this,c=function(){return new Promise(async(w,S)=>{let E=null;try{E=b._method_refs.put(_?_+"/"+m:m);const I=function(){return E!==null&&b._method_refs.fetch(E),w.apply(this,arguments)},A=function(){return E!==null&&b._method_refs.fetch(E),S.apply(this,arguments)},T=await b._wrap([I,A]);I.__promise_pair=T[1]._rvalue,A.__promise_pair=T[0]._rvalue;let O=Array.prototype.slice.call(arguments);const C=O.length,k=C>0&&typeof O[C-1]=="object"&&O[C-1]!==null&&O[C-1]._rkwargs;k&&delete O[C-1]._rkwargs,m==="register"||m==="registerService"||m==="register_service"||m==="export"||m==="on"?O=await b._wrap(O,!0):O=await b._wrap(O);const P=O.__transferables__;P&&delete O.__transferables__,b._connection.emit({type:"method",target_id:a,name:m,object_id:_,args:O,promise:T,with_kwargs:k},P)}catch(I){E&&b._method_refs.fetch(E),S(`Failed to exectue remote method (interface: ${_||b.id}, method: ${m}), error: ${I}`)}})};return c.__remote_method=!0,c}_reportRemoteSet(){this._connection.emit({type:"interfaceSetAsRemote"})}async _encode(a,m,_){const b=typeof a;if(b==="number"||b==="string"||b==="boolean"||a===null||a===void 0||a instanceof ArrayBuffer)return a;let c;if(typeof a=="function"){if(m){if(!_)throw new Error("objectId is not specified.");c={_rtype:"interface",_rtarget_id:this._connection.peer_id,_rintf:_,_rvalue:m},this._method_weakmap.set(a,c)}else if(this._method_weakmap.has(a))c=this._method_weakmap.get(a);else{const I=this._store.put(a);c={_rtype:"callback",_rtarget_id:this._connection.peer_id,_rname:a.constructor&&a.constructor.name||I,_rvalue:I}}return c}if(a.constructor instanceof Object&&a._rtype){if(a._rintf){const I=a._rtype;delete a._rtype,c=await this._encode(a,m,_),c._rtype=I}else c=a;return c}const w=[],S=a._transfer,E=Array.isArray(a);for(let I of Object.keys(this._codecs)){const A=this._codecs[I];if(A.encoder&&a instanceof A.type){let T=await Promise.resolve(A.encoder(a));if(T&&!T._rtype&&(T._rtype=A.name),T&&T._rintf){const O=T._rtype;delete T._rtype,T=await this._encode(T,m,_),T._rtype=O}return c=T,c}}if(typeof tf<"u"&&tf.Tensor&&a instanceof tf.Tensor){const I=a.dataSync();(a._transfer||S)&&(w.push(I.buffer),delete a._transfer),c={_rtype:"ndarray",_rvalue:I.buffer,_rshape:a.shape,_rdtype:a.dtype}}else if(typeof nj<"u"&&nj.NdArray&&a instanceof nj.NdArray){const I=Object(s.typedArrayToDtype)(a.selection.data);(a._transfer||S)&&(w.push(a.selection.data.buffer),delete a._transfer),c={_rtype:"ndarray",_rvalue:a.selection.data.buffer,_rshape:a.shape,_rdtype:I}}else if(a instanceof Error)console.error(a),c={_rtype:"error",_rvalue:a.toString()};else if(typeof File<"u"&&a instanceof File)c={_rtype:"file",_rvalue:a,_rpath:a._path||a.webkitRelativePath};else if(a!==Object(a)||a instanceof Boolean||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof ImageData||typeof FileList<"u"&&a instanceof FileList||typeof FileSystemDirectoryHandle<"u"&&a instanceof FileSystemDirectoryHandle||typeof FileSystemFileHandle<"u"&&a instanceof FileSystemFileHandle||typeof FileSystemHandle<"u"&&a instanceof FileSystemHandle||typeof FileSystemWritableFileStream<"u"&&a instanceof FileSystemWritableFileStream)c=a;else if(typeof File<"u"&&a instanceof File)c={_rtype:"file",_rname:a.name,_rmime:a.type,_rvalue:a,_rpath:a._path||a.webkitRelativePath};else if(a instanceof Blob)c={_rtype:"blob",_rvalue:a};else if(a instanceof o){(a._transfer||S)&&(w.push(a.buffer),delete a._transfer);const I=Object(s.typedArrayToDtype)(a);c={_rtype:"typedarray",_rvalue:a.buffer,_rdtype:I}}else if(a instanceof DataView)(a._transfer||S)&&(w.push(a.buffer),delete a._transfer),c={_rtype:"memoryview",_rvalue:a.buffer};else if(a instanceof Set)c={_rtype:"set",_rvalue:await this._encode(Array.from(a),m)};else if(a instanceof Map)c={_rtype:"orderedmap",_rvalue:await this._encode(Array.from(a),m)};else if(a.constructor instanceof Object||Array.isArray(a)){c=E?[]:{};let I;if(a.constructor===Object||Array.isArray(a))I=Object.keys(a);else{if(a.constructor===Function)throw new Error("Please instantiate the class before exportting it.");if(a.constructor.constructor===Function)I=Object.getOwnPropertyNames(Object.getPrototypeOf(a)).concat(Object.keys(a)),m=!0;else throw Error("Unsupported interface type")}let A=!1;if(a._rintf||m){_||(typeof a._rintf=="string"&&a._rintf.length>0?_=a._rintf:_=Object(s.randId)(),this._object_store[_]&&console.warn(`Overwritting interface object with the same id: ${_}`),this._object_store[_]=a);for(let T of I)T!=="constructor"&&(T.startsWith("_")||(c[T]=await this._encode(a[T],typeof m=="string"?m+"."+T:T,_),typeof a[T]=="function"&&(A=!0)));A&&(c._rintf=_),a.on&&typeof a.on=="function"&&a.on("close",()=>{delete this._object_store[_]})}else for(let T of I)["hasOwnProperty","constructor"].includes(T)||(c[T]=await this._encode(a[T]))}else if(typeof a=="object"){const I=Object.getOwnPropertyNames(Object.getPrototypeOf(a)).concat(Object.keys(a)),A=Object(s.randId)();for(let T of I)["hasOwnProperty","constructor"].includes(T)||(c[T]=await this._encode(a[T],T,c));c._rintf=A}else throw"imjoy-rpc: Unsupported data type:"+a;if(w.length>0&&(c.__transferables__=w),!c)throw new Error("Failed to encode object");return c}async _decode(a,m){if(!a)return a;let _;if(a._rtype)if(this._codecs[a._rtype]&&this._codecs[a._rtype].decoder){if(a._rintf){const b=a._rtype;delete a._rtype,a=await this._decode(a,m),a._rtype=b}_=await Promise.resolve(this._codecs[a._rtype].decoder(a))}else if(a._rtype==="callback")_=this._genRemoteCallback(a._rtarget_id,a._rvalue,m);else if(a._rtype==="interface")_=this._genRemoteMethod(a._rtarget_id,a._rvalue,a._rintf);else if(a._rtype==="ndarray")if(typeof nj<"u"&&nj.array)Array.isArray(a._rvalue)&&(a._rvalue=a._rvalue.reduce(l)),_=nj.array(new Uint8(a._rvalue),a._rdtype).reshape(a._rshape);else if(typeof tf<"u"&&tf.Tensor){Array.isArray(a._rvalue)&&(a._rvalue=a._rvalue.reduce(l));const b=s.dtypeToTypedArray[a._rdtype];_=tf.tensor(new b(a._rvalue),a._rshape,a._rdtype)}else _=a;else if(a._rtype==="error")_=new Error(a._rvalue);else if(a._rtype==="file")a._rvalue instanceof File?(_=a._rvalue,_._path=a._rpath):(_=new File([a._rvalue],a._rname,{type:a._rmime}),_._path=a._rpath);else if(a._rtype==="typedarray"){const b=s.dtypeToTypedArray[a._rdtype];if(!b)throw new Error("unsupported dtype: "+a._rdtype);_=new b(a._rvalue)}else if(a._rtype==="memoryview")_=new DataView(a._rvalue);else if(a._rtype==="blob")a._rvalue instanceof Blob?_=a._rvalue:_=new Blob([a._rvalue],{type:a._rmime});else if(a._rtype==="orderedmap")_=new Map(await this._decode(a._rvalue,m));else if(a._rtype==="set")_=new Set(await this._decode(a._rvalue,m));else if(a._rintf){const b=a._rtype;delete a._rtype,_=await this._decode(a,m),_._rtype=b}else _=a;else if(a.constructor===Object||Array.isArray(a)){const b=Array.isArray(a);_=b?[]:{};for(let c of Object.keys(a))if(b||a.hasOwnProperty(c)){const w=a[c];_[c]=await this._decode(w,m)}}else _=a;if(_===void 0)throw new Error("Failed to decode object");return a._rintf&&this._object_weakmap.set(_,a._rintf),_}async _wrap(a,m){return await this._encode(a,m)}async _unwrap(a,m){return await this._decode(a,m)}_genRemoteCallback(a,m,_){const b=this;let c;return _?(c=function(){return new Promise(async(w,S)=>{const E=await b._wrap(Array.prototype.slice.call(arguments)),I=E.length,A=I>0&&typeof E[I-1]=="object"&&E[I-1]!==null&&E[I-1]._rkwargs;A&&delete E[I-1]._rkwargs;const T=E.__transferables__;T&&delete E.__transferables__;const O=await b._wrap([w,S]);w.__promise_pair=O[1]._rvalue,S.__promise_pair=O[0]._rvalue;try{b._connection.emit({type:"callback",target_id:a,id:m,args:E,promise:O,with_kwargs:A},T)}catch{S(`Failed to exectue remote callback ( id: ${m}).`)}})},c):(c=async function(){const w=await b._wrap(Array.prototype.slice.call(arguments)),S=w.length,E=S>0&&typeof w[S-1]=="object"&&w[S-1]!==null&&w[S-1]._rkwargs;E&&delete w[S-1]._rkwargs;const I=w.__transferables__;return I&&delete w.__transferables__,b._connection.emit({type:"callback",target_id:a,id:m,args:w,with_kwargs:E},I)},c)}reset(){this._event_handlers={},this._once_handlers={},this._remote_interface=null,this._object_store={},this._method_weakmap=new WeakMap,this._object_weakmap=new WeakMap,this._local_api=null,this._store=new g,this._method_refs=new g}disconnect(){this._connection.emit({type:"disconnect"}),this.reset(),setTimeout(()=>{this._connection.disconnect()},2e3)}}class g{constructor(){this._store={},this._indices=[0],this._readyHandler=function(){},this._busyHandler=function(){},this._readyHandler()}onReady(a){this._readyHandler=a||function(){}}onBusy(a){this._busyHandler=a||function(){}}getStack(){return Object.keys(this._store).length}_genId(){let a;return this._indices.length===1?a=this._indices[0]++:a=this._indices.shift(),a}_releaseId(a){for(let m=0;m<this._indices.length;m++)if(a<this._indices[m]){this._indices.splice(m,0,a);break}for(let m=this._indices.length-1;m>=0&&this._indices[m]-1===this._indices[m-1];m--)this._indices.pop()}put(a){this._busyHandler&&Object.keys(this._store).length===0&&this._busyHandler();const m=this._genId();return this._store[m]=a,m}fetch(a){const m=this._store[a];return m&&!m.__remote_method&&(delete this._store[a],this._releaseId(a),this._readyHandler&&Object.keys(this._store).length===0&&this._readyHandler()),m&&m.__promise_pair&&this.fetch(m.__promise_pair),m}}},"./src/utils.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"randId",function(){return randId}),__webpack_require__.d(__webpack_exports__,"dtypeToTypedArray",function(){return dtypeToTypedArray}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWindow",function(){return loadRequirementsInWindow}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWebworker",function(){return loadRequirementsInWebworker}),__webpack_require__.d(__webpack_exports__,"loadRequirements",function(){return loadRequirements}),__webpack_require__.d(__webpack_exports__,"normalizeConfig",function(){return normalizeConfig}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtypeMapping",function(){return typedArrayToDtypeMapping}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtype",function(){return typedArrayToDtype}),__webpack_require__.d(__webpack_exports__,"cacheRequirements",function(){return cacheRequirements}),__webpack_require__.d(__webpack_exports__,"setupServiceWorker",function(){return setupServiceWorker}),__webpack_require__.d(__webpack_exports__,"urlJoin",function(){return urlJoin}),__webpack_require__.d(__webpack_exports__,"MessageEmitter",function(){return MessageEmitter});function randId(){return Math.random().toString(36).substr(2,10)+new Date().getTime()}const dtypeToTypedArray={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,array:Array};async function loadRequirementsInWindow(n){function t(o){return new Promise((l,f)=>{var u=document.createElement("script");u.src=o,u.type="text/javascript",u.onload=l,u.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&l()},u.onerror=f,document.head.appendChild(u)})}async function r(){for(var o=Array.prototype.slice.call(arguments),l=o.length,f=0;f<l;f++)await t(o[f])}if(n&&(Array.isArray(n)||typeof n=="string"))try{var s;if(n=typeof n=="string"?[n]:n,Array.isArray(n))for(var i=0;i<n.length;i++)n[i].toLowerCase().endsWith(".css")||n[i].startsWith("css:")?(n[i].startsWith("css:")&&(n[i]=n[i].slice(4)),s=document.createElement("link"),s.rel="stylesheet",s.href=n[i],document.head.appendChild(s)):n[i].toLowerCase().endsWith(".mjs")||n[i].startsWith("mjs:")?(n[i].startsWith("mjs:")&&(n[i]=n[i].slice(4)),await __vitePreload(()=>import(n[i]),__vite__mapDeps([]))):n[i].toLowerCase().endsWith(".js")||n[i].startsWith("js:")?(n[i].startsWith("js:")&&(n[i]=n[i].slice(3)),await r(n[i])):n[i].startsWith("http")?await r(n[i]):n[i].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[i]);else throw"unsupported requirements definition"}catch{throw"failed to import required scripts: "+n.toString()}}async function loadRequirementsInWebworker(n){if(n&&(Array.isArray(n)||typeof n=="string"))try{Array.isArray(n)||(n=[n]);for(var t=0;t<n.length;t++){if(n[t].toLowerCase().endsWith(".css")||n[t].startsWith("css:"))throw"unable to import css in a webworker";n[t].toLowerCase().endsWith(".js")||n[t].startsWith("js:")?(n[t].startsWith("js:")&&(n[t]=n[t].slice(3)),importScripts(n[t])):n[t].startsWith("http")?importScripts(n[t]):n[t].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[t])}}catch{throw"failed to import required scripts: "+n.toString()}}function loadRequirements(n){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?loadRequirementsInWebworker(n):loadRequirementsInWindow(n)}function normalizeConfig(n){return n.version=n.version||"0.1.0",n.description=n.description||`[TODO: add description for ${n.name} ]`,n.type=n.type||"rpc-window",n.id=n.id||randId(),n.target_origin=n.target_origin||"*",n.allow_execution=n.allow_execution||!1,n=Object.keys(n).reduce((t,r)=>(typeof n[r]!="function"&&(t[r]=n[r]),t),{}),n}const typedArrayToDtypeMapping={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"array"},typedArrayToDtypeKeys=[];for(const arrType of Object.keys(typedArrayToDtypeMapping))typedArrayToDtypeKeys.push(eval(arrType));function typedArrayToDtype(n){let t=typedArrayToDtypeMapping[n.constructor.name];if(!t){const r=Object.getPrototypeOf(n);for(const s of typedArrayToDtypeKeys)if(r instanceof s){t=typedArrayToDtypeMapping[s.name];break}}return t}function cacheUrlInServiceWorker(n){return new Promise(function(t,r){const s={command:"add",url:n};if(!navigator.serviceWorker||!navigator.serviceWorker.register){r("Service worker is not supported.");return}const i=new MessageChannel;i.port1.onmessage=function(o){o.data&&o.data.error?r(o.data.error):t(o.data&&o.data.result)},navigator.serviceWorker&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(s,[i.port2]):r("Service worker controller is not available")})}async function cacheRequirements(n){n=n||[],Array.isArray(n)||(n=[n]);for(let t of n)t.startsWith("js:")&&(t=t.slice(3)),t.startsWith("css:")&&(t=t.slice(4)),t.startsWith("cache:")&&(t=t.slice(6)),t.startsWith("http")&&await cacheUrlInServiceWorker(t).catch(r=>{console.error(r)})}function setupServiceWorker(n,t,r){if("serviceWorker"in navigator){if(n=n||"/",navigator.serviceWorker.register(n+"plugin-service-worker.js").then(function(s){console.log("ServiceWorker registration successful with scope: ",s.scope)},function(s){console.log("ServiceWorker registration failed: ",s)}),t=t||"*",r=r||cacheRequirements,r&&typeof r!="function")throw new Error("config.cache_requirements must be a function");window.addEventListener("message",function(s){if(t==="*"||s.origin===t){const i=s.data;i.type==="cacheRequirements"&&r(i.requirements)}})}}function urlJoin(...n){return n.join("/").replace(/[\/]+/g,"/").replace(/^(.+):\//,"$1://").replace(/^file:/,"file:/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/\?/g,"&").replace("&","?")}class MessageEmitter{constructor(t){this._event_handlers={},this._once_handlers={},this._debug=t}emit(){throw new Error("emit is not implemented")}on(t,r){this._event_handlers[t]||(this._event_handlers[t]=[]),this._event_handlers[t].push(r)}once(t,r){r.___event_run_once=!0,this.on(t,r)}off(t,r){if(!t&&!r)this._event_handlers={};else if(t&&!r)this._event_handlers[t]&&(this._event_handlers[t]=[]);else if(this._event_handlers[t]){const s=this._event_handlers[t].indexOf(r);s>=0&&this._event_handlers[t].splice(s,1)}}_fire(t,r){if(this._event_handlers[t])for(var s=this._event_handlers[t].length;s--;){const i=this._event_handlers[t][s];try{i(r)}catch(o){console.error(o)}finally{i.___event_run_once&&this._event_handlers[t].splice(s,1)}}else this._debug&&console.warn("unhandled event",t,r)}}}})})})(imjoyRpc$1);var imjoyRpcExports=imjoyRpc$1.exports,imjoyRpcSocketio={exports:{}};(function(module,exports){(function(t,r){module.exports=r()})(window,function(){return function(n){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return n[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=n,r.c=t,r.d=function(s,i,o){r.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:o})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,i){if(i&1&&(s=r(s)),i&8||i&4&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),i&2&&typeof s!="string")for(var l in s)r.d(o,l,(function(f){return s[f]}).bind(null,l));return o},r.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(i,"a",i),i},r.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},r.p="",r(r.s="./src/socketIOMain.js")}({"./node_modules/@socket.io/base64-arraybuffer/dist/base64-arraybuffer.es5.js":function(n,t,r){r.r(t),r.d(t,"decode",function(){return f}),r.d(t,"encode",function(){return l});for(var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=typeof Uint8Array>"u"?[]:new Uint8Array(256),o=0;o<s.length;o++)i[s.charCodeAt(o)]=o;var l=function(u){var g=new Uint8Array(u),y,a=g.length,m="";for(y=0;y<a;y+=3)m+=s[g[y]>>2],m+=s[(g[y]&3)<<4|g[y+1]>>4],m+=s[(g[y+1]&15)<<2|g[y+2]>>6],m+=s[g[y+2]&63];return a%3===2?m=m.substring(0,m.length-1)+"=":a%3===1&&(m=m.substring(0,m.length-2)+"=="),m},f=function(u){var g=u.length*.75,y=u.length,a,m=0,_,b,c,w;u[u.length-1]==="="&&(g--,u[u.length-2]==="="&&g--);var S=new ArrayBuffer(g),E=new Uint8Array(S);for(a=0;a<y;a+=4)_=i[u.charCodeAt(a)],b=i[u.charCodeAt(a+1)],c=i[u.charCodeAt(a+2)],w=i[u.charCodeAt(a+3)],E[m++]=_<<2|b>>4,E[m++]=(b&15)<<4|c>>2,E[m++]=(c&3)<<6|w&63;return S}},"./node_modules/@socket.io/component-emitter/index.mjs":function(n,t,r){r.r(t),r.d(t,"Emitter",function(){return s});function s(o){if(o)return i(o)}function i(o){for(var l in s.prototype)o[l]=s.prototype[l];return o}s.prototype.on=s.prototype.addEventListener=function(o,l){return this._callbacks=this._callbacks||{},(this._callbacks["$"+o]=this._callbacks["$"+o]||[]).push(l),this},s.prototype.once=function(o,l){function f(){this.off(o,f),l.apply(this,arguments)}return f.fn=l,this.on(o,f),this},s.prototype.off=s.prototype.removeListener=s.prototype.removeAllListeners=s.prototype.removeEventListener=function(o,l){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var f=this._callbacks["$"+o];if(!f)return this;if(arguments.length==1)return delete this._callbacks["$"+o],this;for(var u,g=0;g<f.length;g++)if(u=f[g],u===l||u.fn===l){f.splice(g,1);break}return f.length===0&&delete this._callbacks["$"+o],this},s.prototype.emit=function(o){this._callbacks=this._callbacks||{};for(var l=new Array(arguments.length-1),f=this._callbacks["$"+o],u=1;u<arguments.length;u++)l[u-1]=arguments[u];if(f){f=f.slice(0);for(var u=0,g=f.length;u<g;++u)f[u].apply(this,l)}return this},s.prototype.emitReserved=s.prototype.emit,s.prototype.listeners=function(o){return this._callbacks=this._callbacks||{},this._callbacks["$"+o]||[]},s.prototype.hasListeners=function(o){return!!this.listeners(o).length}},"./node_modules/base64-js/index.js":function(n,t,r){t.byteLength=y,t.toByteArray=m,t.fromByteArray=c;for(var s=[],i=[],o=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,u=l.length;f<u;++f)s[f]=l[f],i[l.charCodeAt(f)]=f;i[45]=62,i[95]=63;function g(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=w.indexOf("=");E===-1&&(E=S);var I=E===S?0:4-E%4;return[E,I]}function y(w){var S=g(w),E=S[0],I=S[1];return(E+I)*3/4-I}function a(w,S,E){return(S+E)*3/4-E}function m(w){var S,E=g(w),I=E[0],A=E[1],T=new o(a(w,I,A)),O=0,C=A>0?I-4:I,k;for(k=0;k<C;k+=4)S=i[w.charCodeAt(k)]<<18|i[w.charCodeAt(k+1)]<<12|i[w.charCodeAt(k+2)]<<6|i[w.charCodeAt(k+3)],T[O++]=S>>16&255,T[O++]=S>>8&255,T[O++]=S&255;return A===2&&(S=i[w.charCodeAt(k)]<<2|i[w.charCodeAt(k+1)]>>4,T[O++]=S&255),A===1&&(S=i[w.charCodeAt(k)]<<10|i[w.charCodeAt(k+1)]<<4|i[w.charCodeAt(k+2)]>>2,T[O++]=S>>8&255,T[O++]=S&255),T}function _(w){return s[w>>18&63]+s[w>>12&63]+s[w>>6&63]+s[w&63]}function b(w,S,E){for(var I,A=[],T=S;T<E;T+=3)I=(w[T]<<16&16711680)+(w[T+1]<<8&65280)+(w[T+2]&255),A.push(_(I));return A.join("")}function c(w){for(var S,E=w.length,I=E%3,A=[],T=16383,O=0,C=E-I;O<C;O+=T)A.push(b(w,O,O+T>C?C:O+T));return I===1?(S=w[E-1],A.push(s[S>>2]+s[S<<4&63]+"==")):I===2&&(S=(w[E-2]<<8)+w[E-1],A.push(s[S>>10]+s[S>>4&63]+s[S<<2&63]+"=")),A.join("")}},"./node_modules/buffer/index.js":function(n,t,r){(function(s){/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <http://feross.org>
* @license  MIT
*/var i=r("./node_modules/base64-js/index.js"),o=r("./node_modules/ieee754/index.js"),l=r("./node_modules/isarray/index.js");t.Buffer=y,t.SlowBuffer=A,t.INSPECT_MAX_BYTES=50,y.TYPED_ARRAY_SUPPORT=s.TYPED_ARRAY_SUPPORT!==void 0?s.TYPED_ARRAY_SUPPORT:f(),t.kMaxLength=u();function f(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},B.foo()===42&&typeof B.subarray=="function"&&B.subarray(1,1).byteLength===0}catch{return!1}}function u(){return y.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function g(B,M){if(u()<M)throw new RangeError("Invalid typed array length");return y.TYPED_ARRAY_SUPPORT?(B=new Uint8Array(M),B.__proto__=y.prototype):(B===null&&(B=new y(M)),B.length=M),B}function y(B,M,D){if(!y.TYPED_ARRAY_SUPPORT&&!(this instanceof y))return new y(B,M,D);if(typeof B=="number"){if(typeof M=="string")throw new Error("If encoding is specified then the first argument must be a string");return b(this,B)}return a(this,B,M,D)}y.poolSize=8192,y._augment=function(B){return B.__proto__=y.prototype,B};function a(B,M,D,z){if(typeof M=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&M instanceof ArrayBuffer?S(B,M,D,z):typeof M=="string"?c(B,M,D):E(B,M)}y.from=function(B,M,D){return a(null,B,M,D)},y.TYPED_ARRAY_SUPPORT&&(y.prototype.__proto__=Uint8Array.prototype,y.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&y[Symbol.species]===y&&Object.defineProperty(y,Symbol.species,{value:null,configurable:!0}));function m(B){if(typeof B!="number")throw new TypeError('"size" argument must be a number');if(B<0)throw new RangeError('"size" argument must not be negative')}function _(B,M,D,z){return m(M),M<=0?g(B,M):D!==void 0?typeof z=="string"?g(B,M).fill(D,z):g(B,M).fill(D):g(B,M)}y.alloc=function(B,M,D){return _(null,B,M,D)};function b(B,M){if(m(M),B=g(B,M<0?0:I(M)|0),!y.TYPED_ARRAY_SUPPORT)for(var D=0;D<M;++D)B[D]=0;return B}y.allocUnsafe=function(B){return b(null,B)},y.allocUnsafeSlow=function(B){return b(null,B)};function c(B,M,D){if((typeof D!="string"||D==="")&&(D="utf8"),!y.isEncoding(D))throw new TypeError('"encoding" must be a valid string encoding');var z=T(M,D)|0;B=g(B,z);var Z=B.write(M,D);return Z!==z&&(B=B.slice(0,Z)),B}function w(B,M){var D=M.length<0?0:I(M.length)|0;B=g(B,D);for(var z=0;z<D;z+=1)B[z]=M[z]&255;return B}function S(B,M,D,z){if(M.byteLength,D<0||M.byteLength<D)throw new RangeError("'offset' is out of bounds");if(M.byteLength<D+(z||0))throw new RangeError("'length' is out of bounds");return D===void 0&&z===void 0?M=new Uint8Array(M):z===void 0?M=new Uint8Array(M,D):M=new Uint8Array(M,D,z),y.TYPED_ARRAY_SUPPORT?(B=M,B.__proto__=y.prototype):B=w(B,M),B}function E(B,M){if(y.isBuffer(M)){var D=I(M.length)|0;return B=g(B,D),B.length===0||M.copy(B,0,0,D),B}if(M){if(typeof ArrayBuffer<"u"&&M.buffer instanceof ArrayBuffer||"length"in M)return typeof M.length!="number"||ye(M.length)?g(B,0):w(B,M);if(M.type==="Buffer"&&l(M.data))return w(B,M.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function I(B){if(B>=u())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u().toString(16)+" bytes");return B|0}function A(B){return+B!=B&&(B=0),y.alloc(+B)}y.isBuffer=function(M){return!!(M!=null&&M._isBuffer)},y.compare=function(M,D){if(!y.isBuffer(M)||!y.isBuffer(D))throw new TypeError("Arguments must be Buffers");if(M===D)return 0;for(var z=M.length,Z=D.length,oe=0,ae=Math.min(z,Z);oe<ae;++oe)if(M[oe]!==D[oe]){z=M[oe],Z=D[oe];break}return z<Z?-1:Z<z?1:0},y.isEncoding=function(M){switch(String(M).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},y.concat=function(M,D){if(!l(M))throw new TypeError('"list" argument must be an Array of Buffers');if(M.length===0)return y.alloc(0);var z;if(D===void 0)for(D=0,z=0;z<M.length;++z)D+=M[z].length;var Z=y.allocUnsafe(D),oe=0;for(z=0;z<M.length;++z){var ae=M[z];if(!y.isBuffer(ae))throw new TypeError('"list" argument must be an Array of Buffers');ae.copy(Z,oe),oe+=ae.length}return Z};function T(B,M){if(y.isBuffer(B))return B.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(B)||B instanceof ArrayBuffer))return B.byteLength;typeof B!="string"&&(B=""+B);var D=B.length;if(D===0)return 0;for(var z=!1;;)switch(M){case"ascii":case"latin1":case"binary":return D;case"utf8":case"utf-8":case void 0:return le(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D*2;case"hex":return D>>>1;case"base64":return ve(B).length;default:if(z)return le(B).length;M=(""+M).toLowerCase(),z=!0}}y.byteLength=T;function O(B,M,D){var z=!1;if((M===void 0||M<0)&&(M=0),M>this.length||((D===void 0||D>this.length)&&(D=this.length),D<=0)||(D>>>=0,M>>>=0,D<=M))return"";for(B||(B="utf8");;)switch(B){case"hex":return de(this,M,D);case"utf8":case"utf-8":return X(this,M,D);case"ascii":return te(this,M,D);case"latin1":case"binary":return se(this,M,D);case"base64":return U(this,M,D);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Se(this,M,D);default:if(z)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),z=!0}}y.prototype._isBuffer=!0;function C(B,M,D){var z=B[M];B[M]=B[D],B[D]=z}y.prototype.swap16=function(){var M=this.length;if(M%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var D=0;D<M;D+=2)C(this,D,D+1);return this},y.prototype.swap32=function(){var M=this.length;if(M%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var D=0;D<M;D+=4)C(this,D,D+3),C(this,D+1,D+2);return this},y.prototype.swap64=function(){var M=this.length;if(M%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var D=0;D<M;D+=8)C(this,D,D+7),C(this,D+1,D+6),C(this,D+2,D+5),C(this,D+3,D+4);return this},y.prototype.toString=function(){var M=this.length|0;return M===0?"":arguments.length===0?X(this,0,M):O.apply(this,arguments)},y.prototype.equals=function(M){if(!y.isBuffer(M))throw new TypeError("Argument must be a Buffer");return this===M?!0:y.compare(this,M)===0},y.prototype.inspect=function(){var M="",D=t.INSPECT_MAX_BYTES;return this.length>0&&(M=this.toString("hex",0,D).match(/.{2}/g).join(" "),this.length>D&&(M+=" ... ")),"<Buffer "+M+">"},y.prototype.compare=function(M,D,z,Z,oe){if(!y.isBuffer(M))throw new TypeError("Argument must be a Buffer");if(D===void 0&&(D=0),z===void 0&&(z=M?M.length:0),Z===void 0&&(Z=0),oe===void 0&&(oe=this.length),D<0||z>M.length||Z<0||oe>this.length)throw new RangeError("out of range index");if(Z>=oe&&D>=z)return 0;if(Z>=oe)return-1;if(D>=z)return 1;if(D>>>=0,z>>>=0,Z>>>=0,oe>>>=0,this===M)return 0;for(var ae=oe-Z,Ee=z-D,Pe=Math.min(ae,Ee),$e=this.slice(Z,oe),Ke=M.slice(D,z),Ge=0;Ge<Pe;++Ge)if($e[Ge]!==Ke[Ge]){ae=$e[Ge],Ee=Ke[Ge];break}return ae<Ee?-1:Ee<ae?1:0};function k(B,M,D,z,Z){if(B.length===0)return-1;if(typeof D=="string"?(z=D,D=0):D>2147483647?D=2147483647:D<-2147483648&&(D=-2147483648),D=+D,isNaN(D)&&(D=Z?0:B.length-1),D<0&&(D=B.length+D),D>=B.length){if(Z)return-1;D=B.length-1}else if(D<0)if(Z)D=0;else return-1;if(typeof M=="string"&&(M=y.from(M,z)),y.isBuffer(M))return M.length===0?-1:P(B,M,D,z,Z);if(typeof M=="number")return M=M&255,y.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?Z?Uint8Array.prototype.indexOf.call(B,M,D):Uint8Array.prototype.lastIndexOf.call(B,M,D):P(B,[M],D,z,Z);throw new TypeError("val must be string, number or Buffer")}function P(B,M,D,z,Z){var oe=1,ae=B.length,Ee=M.length;if(z!==void 0&&(z=String(z).toLowerCase(),z==="ucs2"||z==="ucs-2"||z==="utf16le"||z==="utf-16le")){if(B.length<2||M.length<2)return-1;oe=2,ae/=2,Ee/=2,D/=2}function Pe(Nt,nt){return oe===1?Nt[nt]:Nt.readUInt16BE(nt*oe)}var $e;if(Z){var Ke=-1;for($e=D;$e<ae;$e++)if(Pe(B,$e)===Pe(M,Ke===-1?0:$e-Ke)){if(Ke===-1&&(Ke=$e),$e-Ke+1===Ee)return Ke*oe}else Ke!==-1&&($e-=$e-Ke),Ke=-1}else for(D+Ee>ae&&(D=ae-Ee),$e=D;$e>=0;$e--){for(var Ge=!0,ot=0;ot<Ee;ot++)if(Pe(B,$e+ot)!==Pe(M,ot)){Ge=!1;break}if(Ge)return $e}return-1}y.prototype.includes=function(M,D,z){return this.indexOf(M,D,z)!==-1},y.prototype.indexOf=function(M,D,z){return k(this,M,D,z,!0)},y.prototype.lastIndexOf=function(M,D,z){return k(this,M,D,z,!1)};function N(B,M,D,z){D=Number(D)||0;var Z=B.length-D;z?(z=Number(z),z>Z&&(z=Z)):z=Z;var oe=M.length;if(oe%2!==0)throw new TypeError("Invalid hex string");z>oe/2&&(z=oe/2);for(var ae=0;ae<z;++ae){var Ee=parseInt(M.substr(ae*2,2),16);if(isNaN(Ee))return ae;B[D+ae]=Ee}return ae}function L(B,M,D,z){return be(le(M,B.length-D),B,D,z)}function F(B,M,D,z){return be(ue(M),B,D,z)}function V(B,M,D,z){return F(B,M,D,z)}function j(B,M,D,z){return be(ve(M),B,D,z)}function K(B,M,D,z){return be(he(M,B.length-D),B,D,z)}y.prototype.write=function(M,D,z,Z){if(D===void 0)Z="utf8",z=this.length,D=0;else if(z===void 0&&typeof D=="string")Z=D,z=this.length,D=0;else if(isFinite(D))D=D|0,isFinite(z)?(z=z|0,Z===void 0&&(Z="utf8")):(Z=z,z=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var oe=this.length-D;if((z===void 0||z>oe)&&(z=oe),M.length>0&&(z<0||D<0)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");Z||(Z="utf8");for(var ae=!1;;)switch(Z){case"hex":return N(this,M,D,z);case"utf8":case"utf-8":return L(this,M,D,z);case"ascii":return F(this,M,D,z);case"latin1":case"binary":return V(this,M,D,z);case"base64":return j(this,M,D,z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,M,D,z);default:if(ae)throw new TypeError("Unknown encoding: "+Z);Z=(""+Z).toLowerCase(),ae=!0}},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(B,M,D){return M===0&&D===B.length?i.fromByteArray(B):i.fromByteArray(B.slice(M,D))}function X(B,M,D){D=Math.min(B.length,D);for(var z=[],Z=M;Z<D;){var oe=B[Z],ae=null,Ee=oe>239?4:oe>223?3:oe>191?2:1;if(Z+Ee<=D){var Pe,$e,Ke,Ge;switch(Ee){case 1:oe<128&&(ae=oe);break;case 2:Pe=B[Z+1],(Pe&192)===128&&(Ge=(oe&31)<<6|Pe&63,Ge>127&&(ae=Ge));break;case 3:Pe=B[Z+1],$e=B[Z+2],(Pe&192)===128&&($e&192)===128&&(Ge=(oe&15)<<12|(Pe&63)<<6|$e&63,Ge>2047&&(Ge<55296||Ge>57343)&&(ae=Ge));break;case 4:Pe=B[Z+1],$e=B[Z+2],Ke=B[Z+3],(Pe&192)===128&&($e&192)===128&&(Ke&192)===128&&(Ge=(oe&15)<<18|(Pe&63)<<12|($e&63)<<6|Ke&63,Ge>65535&&Ge<1114112&&(ae=Ge))}}ae===null?(ae=65533,Ee=1):ae>65535&&(ae-=65536,z.push(ae>>>10&1023|55296),ae=56320|ae&1023),z.push(ae),Z+=Ee}return Y(z)}var J=4096;function Y(B){var M=B.length;if(M<=J)return String.fromCharCode.apply(String,B);for(var D="",z=0;z<M;)D+=String.fromCharCode.apply(String,B.slice(z,z+=J));return D}function te(B,M,D){var z="";D=Math.min(B.length,D);for(var Z=M;Z<D;++Z)z+=String.fromCharCode(B[Z]&127);return z}function se(B,M,D){var z="";D=Math.min(B.length,D);for(var Z=M;Z<D;++Z)z+=String.fromCharCode(B[Z]);return z}function de(B,M,D){var z=B.length;(!M||M<0)&&(M=0),(!D||D<0||D>z)&&(D=z);for(var Z="",oe=M;oe<D;++oe)Z+=ie(B[oe]);return Z}function Se(B,M,D){for(var z=B.slice(M,D),Z="",oe=0;oe<z.length;oe+=2)Z+=String.fromCharCode(z[oe]+z[oe+1]*256);return Z}y.prototype.slice=function(M,D){var z=this.length;M=~~M,D=D===void 0?z:~~D,M<0?(M+=z,M<0&&(M=0)):M>z&&(M=z),D<0?(D+=z,D<0&&(D=0)):D>z&&(D=z),D<M&&(D=M);var Z;if(y.TYPED_ARRAY_SUPPORT)Z=this.subarray(M,D),Z.__proto__=y.prototype;else{var oe=D-M;Z=new y(oe,void 0);for(var ae=0;ae<oe;++ae)Z[ae]=this[ae+M]}return Z};function we(B,M,D){if(B%1!==0||B<0)throw new RangeError("offset is not uint");if(B+M>D)throw new RangeError("Trying to access beyond buffer length")}y.prototype.readUIntLE=function(M,D,z){M=M|0,D=D|0,z||we(M,D,this.length);for(var Z=this[M],oe=1,ae=0;++ae<D&&(oe*=256);)Z+=this[M+ae]*oe;return Z},y.prototype.readUIntBE=function(M,D,z){M=M|0,D=D|0,z||we(M,D,this.length);for(var Z=this[M+--D],oe=1;D>0&&(oe*=256);)Z+=this[M+--D]*oe;return Z},y.prototype.readUInt8=function(M,D){return D||we(M,1,this.length),this[M]},y.prototype.readUInt16LE=function(M,D){return D||we(M,2,this.length),this[M]|this[M+1]<<8},y.prototype.readUInt16BE=function(M,D){return D||we(M,2,this.length),this[M]<<8|this[M+1]},y.prototype.readUInt32LE=function(M,D){return D||we(M,4,this.length),(this[M]|this[M+1]<<8|this[M+2]<<16)+this[M+3]*16777216},y.prototype.readUInt32BE=function(M,D){return D||we(M,4,this.length),this[M]*16777216+(this[M+1]<<16|this[M+2]<<8|this[M+3])},y.prototype.readIntLE=function(M,D,z){M=M|0,D=D|0,z||we(M,D,this.length);for(var Z=this[M],oe=1,ae=0;++ae<D&&(oe*=256);)Z+=this[M+ae]*oe;return oe*=128,Z>=oe&&(Z-=Math.pow(2,8*D)),Z},y.prototype.readIntBE=function(M,D,z){M=M|0,D=D|0,z||we(M,D,this.length);for(var Z=D,oe=1,ae=this[M+--Z];Z>0&&(oe*=256);)ae+=this[M+--Z]*oe;return oe*=128,ae>=oe&&(ae-=Math.pow(2,8*D)),ae},y.prototype.readInt8=function(M,D){return D||we(M,1,this.length),this[M]&128?(255-this[M]+1)*-1:this[M]},y.prototype.readInt16LE=function(M,D){D||we(M,2,this.length);var z=this[M]|this[M+1]<<8;return z&32768?z|4294901760:z},y.prototype.readInt16BE=function(M,D){D||we(M,2,this.length);var z=this[M+1]|this[M]<<8;return z&32768?z|4294901760:z},y.prototype.readInt32LE=function(M,D){return D||we(M,4,this.length),this[M]|this[M+1]<<8|this[M+2]<<16|this[M+3]<<24},y.prototype.readInt32BE=function(M,D){return D||we(M,4,this.length),this[M]<<24|this[M+1]<<16|this[M+2]<<8|this[M+3]},y.prototype.readFloatLE=function(M,D){return D||we(M,4,this.length),o.read(this,M,!0,23,4)},y.prototype.readFloatBE=function(M,D){return D||we(M,4,this.length),o.read(this,M,!1,23,4)},y.prototype.readDoubleLE=function(M,D){return D||we(M,8,this.length),o.read(this,M,!0,52,8)},y.prototype.readDoubleBE=function(M,D){return D||we(M,8,this.length),o.read(this,M,!1,52,8)};function ge(B,M,D,z,Z,oe){if(!y.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(M>Z||M<oe)throw new RangeError('"value" argument is out of bounds');if(D+z>B.length)throw new RangeError("Index out of range")}y.prototype.writeUIntLE=function(M,D,z,Z){if(M=+M,D=D|0,z=z|0,!Z){var oe=Math.pow(2,8*z)-1;ge(this,M,D,z,oe,0)}var ae=1,Ee=0;for(this[D]=M&255;++Ee<z&&(ae*=256);)this[D+Ee]=M/ae&255;return D+z},y.prototype.writeUIntBE=function(M,D,z,Z){if(M=+M,D=D|0,z=z|0,!Z){var oe=Math.pow(2,8*z)-1;ge(this,M,D,z,oe,0)}var ae=z-1,Ee=1;for(this[D+ae]=M&255;--ae>=0&&(Ee*=256);)this[D+ae]=M/Ee&255;return D+z},y.prototype.writeUInt8=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,1,255,0),y.TYPED_ARRAY_SUPPORT||(M=Math.floor(M)),this[D]=M&255,D+1};function Ie(B,M,D,z){M<0&&(M=65535+M+1);for(var Z=0,oe=Math.min(B.length-D,2);Z<oe;++Z)B[D+Z]=(M&255<<8*(z?Z:1-Z))>>>(z?Z:1-Z)*8}y.prototype.writeUInt16LE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[D]=M&255,this[D+1]=M>>>8):Ie(this,M,D,!0),D+2},y.prototype.writeUInt16BE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,2,65535,0),y.TYPED_ARRAY_SUPPORT?(this[D]=M>>>8,this[D+1]=M&255):Ie(this,M,D,!1),D+2};function Te(B,M,D,z){M<0&&(M=4294967295+M+1);for(var Z=0,oe=Math.min(B.length-D,4);Z<oe;++Z)B[D+Z]=M>>>(z?Z:3-Z)*8&255}y.prototype.writeUInt32LE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[D+3]=M>>>24,this[D+2]=M>>>16,this[D+1]=M>>>8,this[D]=M&255):Te(this,M,D,!0),D+4},y.prototype.writeUInt32BE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,4,4294967295,0),y.TYPED_ARRAY_SUPPORT?(this[D]=M>>>24,this[D+1]=M>>>16,this[D+2]=M>>>8,this[D+3]=M&255):Te(this,M,D,!1),D+4},y.prototype.writeIntLE=function(M,D,z,Z){if(M=+M,D=D|0,!Z){var oe=Math.pow(2,8*z-1);ge(this,M,D,z,oe-1,-oe)}var ae=0,Ee=1,Pe=0;for(this[D]=M&255;++ae<z&&(Ee*=256);)M<0&&Pe===0&&this[D+ae-1]!==0&&(Pe=1),this[D+ae]=(M/Ee>>0)-Pe&255;return D+z},y.prototype.writeIntBE=function(M,D,z,Z){if(M=+M,D=D|0,!Z){var oe=Math.pow(2,8*z-1);ge(this,M,D,z,oe-1,-oe)}var ae=z-1,Ee=1,Pe=0;for(this[D+ae]=M&255;--ae>=0&&(Ee*=256);)M<0&&Pe===0&&this[D+ae+1]!==0&&(Pe=1),this[D+ae]=(M/Ee>>0)-Pe&255;return D+z},y.prototype.writeInt8=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,1,127,-128),y.TYPED_ARRAY_SUPPORT||(M=Math.floor(M)),M<0&&(M=255+M+1),this[D]=M&255,D+1},y.prototype.writeInt16LE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[D]=M&255,this[D+1]=M>>>8):Ie(this,M,D,!0),D+2},y.prototype.writeInt16BE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,2,32767,-32768),y.TYPED_ARRAY_SUPPORT?(this[D]=M>>>8,this[D+1]=M&255):Ie(this,M,D,!1),D+2},y.prototype.writeInt32LE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,4,2147483647,-2147483648),y.TYPED_ARRAY_SUPPORT?(this[D]=M&255,this[D+1]=M>>>8,this[D+2]=M>>>16,this[D+3]=M>>>24):Te(this,M,D,!0),D+4},y.prototype.writeInt32BE=function(M,D,z){return M=+M,D=D|0,z||ge(this,M,D,4,2147483647,-2147483648),M<0&&(M=4294967295+M+1),y.TYPED_ARRAY_SUPPORT?(this[D]=M>>>24,this[D+1]=M>>>16,this[D+2]=M>>>8,this[D+3]=M&255):Te(this,M,D,!1),D+4};function Ce(B,M,D,z,Z,oe){if(D+z>B.length)throw new RangeError("Index out of range");if(D<0)throw new RangeError("Index out of range")}function Ae(B,M,D,z,Z){return Z||Ce(B,M,D,4),o.write(B,M,D,z,23,4),D+4}y.prototype.writeFloatLE=function(M,D,z){return Ae(this,M,D,!0,z)},y.prototype.writeFloatBE=function(M,D,z){return Ae(this,M,D,!1,z)};function Me(B,M,D,z,Z){return Z||Ce(B,M,D,8),o.write(B,M,D,z,52,8),D+8}y.prototype.writeDoubleLE=function(M,D,z){return Me(this,M,D,!0,z)},y.prototype.writeDoubleBE=function(M,D,z){return Me(this,M,D,!1,z)},y.prototype.copy=function(M,D,z,Z){if(z||(z=0),!Z&&Z!==0&&(Z=this.length),D>=M.length&&(D=M.length),D||(D=0),Z>0&&Z<z&&(Z=z),Z===z||M.length===0||this.length===0)return 0;if(D<0)throw new RangeError("targetStart out of bounds");if(z<0||z>=this.length)throw new RangeError("sourceStart out of bounds");if(Z<0)throw new RangeError("sourceEnd out of bounds");Z>this.length&&(Z=this.length),M.length-D<Z-z&&(Z=M.length-D+z);var oe=Z-z,ae;if(this===M&&z<D&&D<Z)for(ae=oe-1;ae>=0;--ae)M[ae+D]=this[ae+z];else if(oe<1e3||!y.TYPED_ARRAY_SUPPORT)for(ae=0;ae<oe;++ae)M[ae+D]=this[ae+z];else Uint8Array.prototype.set.call(M,this.subarray(z,z+oe),D);return oe},y.prototype.fill=function(M,D,z,Z){if(typeof M=="string"){if(typeof D=="string"?(Z=D,D=0,z=this.length):typeof z=="string"&&(Z=z,z=this.length),M.length===1){var oe=M.charCodeAt(0);oe<256&&(M=oe)}if(Z!==void 0&&typeof Z!="string")throw new TypeError("encoding must be a string");if(typeof Z=="string"&&!y.isEncoding(Z))throw new TypeError("Unknown encoding: "+Z)}else typeof M=="number"&&(M=M&255);if(D<0||this.length<D||this.length<z)throw new RangeError("Out of range index");if(z<=D)return this;D=D>>>0,z=z===void 0?this.length:z>>>0,M||(M=0);var ae;if(typeof M=="number")for(ae=D;ae<z;++ae)this[ae]=M;else{var Ee=y.isBuffer(M)?M:le(new y(M,Z).toString()),Pe=Ee.length;for(ae=0;ae<z-D;++ae)this[ae+D]=Ee[ae%Pe]}return this};var Re=/[^+\/0-9A-Za-z-_]/g;function G(B){if(B=Q(B).replace(Re,""),B.length<2)return"";for(;B.length%4!==0;)B=B+"=";return B}function Q(B){return B.trim?B.trim():B.replace(/^\s+|\s+$/g,"")}function ie(B){return B<16?"0"+B.toString(16):B.toString(16)}function le(B,M){M=M||1/0;for(var D,z=B.length,Z=null,oe=[],ae=0;ae<z;++ae){if(D=B.charCodeAt(ae),D>55295&&D<57344){if(!Z){if(D>56319){(M-=3)>-1&&oe.push(239,191,189);continue}else if(ae+1===z){(M-=3)>-1&&oe.push(239,191,189);continue}Z=D;continue}if(D<56320){(M-=3)>-1&&oe.push(239,191,189),Z=D;continue}D=(Z-55296<<10|D-56320)+65536}else Z&&(M-=3)>-1&&oe.push(239,191,189);if(Z=null,D<128){if((M-=1)<0)break;oe.push(D)}else if(D<2048){if((M-=2)<0)break;oe.push(D>>6|192,D&63|128)}else if(D<65536){if((M-=3)<0)break;oe.push(D>>12|224,D>>6&63|128,D&63|128)}else if(D<1114112){if((M-=4)<0)break;oe.push(D>>18|240,D>>12&63|128,D>>6&63|128,D&63|128)}else throw new Error("Invalid code point")}return oe}function ue(B){for(var M=[],D=0;D<B.length;++D)M.push(B.charCodeAt(D)&255);return M}function he(B,M){for(var D,z,Z,oe=[],ae=0;ae<B.length&&!((M-=2)<0);++ae)D=B.charCodeAt(ae),z=D>>8,Z=D%256,oe.push(Z),oe.push(z);return oe}function ve(B){return i.toByteArray(G(B))}function be(B,M,D,z){for(var Z=0;Z<z&&!(Z+D>=M.length||Z>=B.length);++Z)M[Z+D]=B[Z];return Z}function ye(B){return B!==B}}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/engine.io-client/build/esm/contrib/has-cors.js":function(n,t,r){r.r(t),r.d(t,"hasCORS",function(){return i});let s=!1;try{s=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const i=s},"./node_modules/engine.io-client/build/esm/contrib/parseqs.js":function(n,t,r){r.r(t),r.d(t,"encode",function(){return s}),r.d(t,"decode",function(){return i});function s(o){let l="";for(let f in o)o.hasOwnProperty(f)&&(l.length&&(l+="&"),l+=encodeURIComponent(f)+"="+encodeURIComponent(o[f]));return l}function i(o){let l={},f=o.split("&");for(let u=0,g=f.length;u<g;u++){let y=f[u].split("=");l[decodeURIComponent(y[0])]=decodeURIComponent(y[1])}return l}},"./node_modules/engine.io-client/build/esm/contrib/parseuri.js":function(n,t,r){r.r(t),r.d(t,"parse",function(){return o});const s=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function o(u){const g=u,y=u.indexOf("["),a=u.indexOf("]");y!=-1&&a!=-1&&(u=u.substring(0,y)+u.substring(y,a).replace(/:/g,";")+u.substring(a,u.length));let m=s.exec(u||""),_={},b=14;for(;b--;)_[i[b]]=m[b]||"";return y!=-1&&a!=-1&&(_.source=g,_.host=_.host.substring(1,_.host.length-1).replace(/;/g,":"),_.authority=_.authority.replace("[","").replace("]","").replace(/;/g,":"),_.ipv6uri=!0),_.pathNames=l(_,_.path),_.queryKey=f(_,_.query),_}function l(u,g){const y=/\/{2,9}/g,a=g.replace(y,"/").split("/");return(g.slice(0,1)=="/"||g.length===0)&&a.splice(0,1),g.slice(-1)=="/"&&a.splice(a.length-1,1),a}function f(u,g){const y={};return g.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,m,_){m&&(y[m]=_)}),y}},"./node_modules/engine.io-client/build/esm/contrib/yeast.js":function(n,t,r){r.r(t),r.d(t,"encode",function(){return g}),r.d(t,"decode",function(){return y}),r.d(t,"yeast",function(){return a});const s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i=64,o={};let l=0,f=0,u;function g(m){let _="";do _=s[m%i]+_,m=Math.floor(m/i);while(m>0);return _}function y(m){let _=0;for(f=0;f<m.length;f++)_=_*i+o[m.charAt(f)];return _}function a(){const m=g(+new Date);return m!==u?(l=0,u=m):m+"."+g(l++)}for(;f<i;f++)o[s[f]]=f},"./node_modules/engine.io-client/build/esm/globalThis.browser.js":function(n,t,r){r.r(t),r.d(t,"globalThisShim",function(){return s});const s=typeof self<"u"?self:typeof window<"u"?window:Function("return this")()},"./node_modules/engine.io-client/build/esm/index.js":function(n,t,r){r.r(t),r.d(t,"protocol",function(){return g});var s=r("./node_modules/engine.io-client/build/esm/socket.js");r.d(t,"Socket",function(){return s.Socket});var i=r("./node_modules/engine.io-client/build/esm/transport.js");r.d(t,"Transport",function(){return i.Transport});var o=r("./node_modules/engine.io-client/build/esm/transports/index.js");r.d(t,"transports",function(){return o.transports});var l=r("./node_modules/engine.io-client/build/esm/util.js");r.d(t,"installTimerFunctions",function(){return l.installTimerFunctions});var f=r("./node_modules/engine.io-client/build/esm/contrib/parseuri.js");r.d(t,"parse",function(){return f.parse});var u=r("./node_modules/engine.io-client/build/esm/transports/websocket-constructor.browser.js");r.d(t,"nextTick",function(){return u.nextTick});const g=s.Socket.protocol},"./node_modules/engine.io-client/build/esm/socket.js":function(n,t,r){r.r(t),r.d(t,"Socket",function(){return g});var s=r("./node_modules/engine.io-client/build/esm/transports/index.js"),i=r("./node_modules/engine.io-client/build/esm/util.js"),o=r("./node_modules/engine.io-client/build/esm/contrib/parseqs.js"),l=r("./node_modules/engine.io-client/build/esm/contrib/parseuri.js"),f=r("./node_modules/@socket.io/component-emitter/index.mjs"),u=r("./node_modules/engine.io-parser/build/esm/index.js");class g extends f.Emitter{constructor(a,m={}){super(),this.writeBuffer=[],a&&typeof a=="object"&&(m=a,a=null),a?(a=Object(l.parse)(a),m.hostname=a.host,m.secure=a.protocol==="https"||a.protocol==="wss",m.port=a.port,a.query&&(m.query=a.query)):m.host&&(m.hostname=Object(l.parse)(m.host).host),Object(i.installTimerFunctions)(this,m),this.secure=m.secure!=null?m.secure:typeof location<"u"&&location.protocol==="https:",m.hostname&&!m.port&&(m.port=this.secure?"443":"80"),this.hostname=m.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=m.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=m.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},m),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Object(o.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(a){const m=Object.assign({},this.opts.query);m.EIO=u.protocol,m.transport=a,this.id&&(m.sid=this.id);const _=Object.assign({},this.opts.transportOptions[a],this.opts,{query:m,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new s.transports[a](_)}open(){let a;if(this.opts.rememberUpgrade&&g.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)a="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else a=this.transports[0];this.readyState="opening";try{a=this.createTransport(a)}catch{this.transports.shift(),this.open();return}a.open(),this.setTransport(a)}setTransport(a){this.transport&&this.transport.removeAllListeners(),this.transport=a,a.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",m=>this.onClose("transport close",m))}probe(a){let m=this.createTransport(a),_=!1;g.priorWebsocketSuccess=!1;const b=()=>{_||(m.send([{type:"ping",data:"probe"}]),m.once("packet",T=>{if(!_)if(T.type==="pong"&&T.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",m),!m)return;g.priorWebsocketSuccess=m.name==="websocket",this.transport.pause(()=>{_||this.readyState!=="closed"&&(A(),this.setTransport(m),m.send([{type:"upgrade"}]),this.emitReserved("upgrade",m),m=null,this.upgrading=!1,this.flush())})}else{const O=new Error("probe error");O.transport=m.name,this.emitReserved("upgradeError",O)}}))};function c(){_||(_=!0,A(),m.close(),m=null)}const w=T=>{const O=new Error("probe error: "+T);O.transport=m.name,c(),this.emitReserved("upgradeError",O)};function S(){w("transport closed")}function E(){w("socket closed")}function I(T){m&&T.name!==m.name&&c()}const A=()=>{m.removeListener("open",b),m.removeListener("error",w),m.removeListener("close",S),this.off("close",E),this.off("upgrading",I)};m.once("open",b),m.once("error",w),m.once("close",S),this.once("close",E),this.once("upgrading",I),m.open()}onOpen(){if(this.readyState="open",g.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let a=0;const m=this.upgrades.length;for(;a<m;a++)this.probe(this.upgrades[a])}}onPacket(a){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const m=new Error("server error");m.code=a.data,this.onError(m);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data);break}}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.maxPayload=a.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const a=this.getWritablePackets();this.transport.send(a),this.prevBufferLen=a.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let m=1;for(let _=0;_<this.writeBuffer.length;_++){const b=this.writeBuffer[_].data;if(b&&(m+=Object(i.byteLength)(b)),_>0&&m>this.maxPayload)return this.writeBuffer.slice(0,_);m+=2}return this.writeBuffer}write(a,m,_){return this.sendPacket("message",a,m,_),this}send(a,m,_){return this.sendPacket("message",a,m,_),this}sendPacket(a,m,_,b){if(typeof m=="function"&&(b=m,m=void 0),typeof _=="function"&&(b=_,_=null),this.readyState==="closing"||this.readyState==="closed")return;_=_||{},_.compress=_.compress!==!1;const c={type:a,data:m,options:_};this.emitReserved("packetCreate",c),this.writeBuffer.push(c),b&&this.once("flush",b),this.flush()}close(){const a=()=>{this.onClose("forced close"),this.transport.close()},m=()=>{this.off("upgrade",m),this.off("upgradeError",m),a()},_=()=>{this.once("upgrade",m),this.once("upgradeError",m)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?_():a()}):this.upgrading?_():a()),this}onError(a){g.priorWebsocketSuccess=!1,this.emitReserved("error",a),this.onClose("transport error",a)}onClose(a,m){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",a,m),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(a){const m=[];let _=0;const b=a.length;for(;_<b;_++)~this.transports.indexOf(a[_])&&m.push(a[_]);return m}}g.protocol=u.protocol},"./node_modules/engine.io-client/build/esm/transport.js":function(n,t,r){r.r(t),r.d(t,"Transport",function(){return f});var s=r("./node_modules/engine.io-parser/build/esm/index.js"),i=r("./node_modules/@socket.io/component-emitter/index.mjs"),o=r("./node_modules/engine.io-client/build/esm/util.js");class l extends Error{constructor(g,y,a){super(g),this.description=y,this.context=a,this.type="TransportError"}}class f extends i.Emitter{constructor(g){super(),this.writable=!1,Object(o.installTimerFunctions)(this,g),this.opts=g,this.query=g.query,this.socket=g.socket}onError(g,y,a){return super.emitReserved("error",new l(g,y,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(g){this.readyState==="open"&&this.write(g)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(g){const y=Object(s.decodePacket)(g,this.socket.binaryType);this.onPacket(y)}onPacket(g){super.emitReserved("packet",g)}onClose(g){this.readyState="closed",super.emitReserved("close",g)}pause(g){}}},"./node_modules/engine.io-client/build/esm/transports/index.js":function(n,t,r){r.r(t),r.d(t,"transports",function(){return o});var s=r("./node_modules/engine.io-client/build/esm/transports/polling.js"),i=r("./node_modules/engine.io-client/build/esm/transports/websocket.js");const o={websocket:i.WS,polling:s.Polling}},"./node_modules/engine.io-client/build/esm/transports/polling.js":function(n,t,r){r.r(t),r.d(t,"Polling",function(){return _}),r.d(t,"Request",function(){return b});var s=r("./node_modules/engine.io-client/build/esm/transport.js"),i=r("./node_modules/engine.io-client/build/esm/contrib/yeast.js"),o=r("./node_modules/engine.io-client/build/esm/contrib/parseqs.js"),l=r("./node_modules/engine.io-parser/build/esm/index.js"),f=r("./node_modules/engine.io-client/build/esm/transports/xmlhttprequest.browser.js"),u=r("./node_modules/@socket.io/component-emitter/index.mjs"),g=r("./node_modules/engine.io-client/build/esm/util.js"),y=r("./node_modules/engine.io-client/build/esm/globalThis.browser.js");function a(){}const m=function(){return new f.XHR({xdomain:!1}).responseType!=null}();class _ extends s.Transport{constructor(S){if(super(S),this.polling=!1,typeof location<"u"){const I=location.protocol==="https:";let A=location.port;A||(A=I?"443":"80"),this.xd=typeof location<"u"&&S.hostname!==location.hostname||A!==S.port,this.xs=S.secure!==I}const E=S&&S.forceBase64;this.supportsBinary=m&&!E}get name(){return"polling"}doOpen(){this.poll()}pause(S){this.readyState="pausing";const E=()=>{this.readyState="paused",S()};if(this.polling||!this.writable){let I=0;this.polling&&(I++,this.once("pollComplete",function(){--I||E()})),this.writable||(I++,this.once("drain",function(){--I||E()}))}else E()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(S){const E=I=>{if(this.readyState==="opening"&&I.type==="open"&&this.onOpen(),I.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(I)};Object(l.decodePayload)(S,this.socket.binaryType).forEach(E),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const S=()=>{this.write([{type:"close"}])};this.readyState==="open"?S():this.once("open",S)}write(S){this.writable=!1,Object(l.encodePayload)(S,E=>{this.doWrite(E,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let S=this.query||{};const E=this.opts.secure?"https":"http";let I="";this.opts.timestampRequests!==!1&&(S[this.opts.timestampParam]=Object(i.yeast)()),!this.supportsBinary&&!S.sid&&(S.b64=1),this.opts.port&&(E==="https"&&Number(this.opts.port)!==443||E==="http"&&Number(this.opts.port)!==80)&&(I=":"+this.opts.port);const A=Object(o.encode)(S),T=this.opts.hostname.indexOf(":")!==-1;return E+"://"+(T?"["+this.opts.hostname+"]":this.opts.hostname)+I+this.opts.path+(A.length?"?"+A:"")}request(S={}){return Object.assign(S,{xd:this.xd,xs:this.xs},this.opts),new b(this.uri(),S)}doWrite(S,E){const I=this.request({method:"POST",data:S});I.on("success",E),I.on("error",(A,T)=>{this.onError("xhr post error",A,T)})}doPoll(){const S=this.request();S.on("data",this.onData.bind(this)),S.on("error",(E,I)=>{this.onError("xhr poll error",E,I)}),this.pollXhr=S}}class b extends u.Emitter{constructor(S,E){super(),Object(g.installTimerFunctions)(this,E),this.opts=E,this.method=E.method||"GET",this.uri=S,this.async=E.async!==!1,this.data=E.data!==void 0?E.data:null,this.create()}create(){const S=Object(g.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");S.xdomain=!!this.opts.xd,S.xscheme=!!this.opts.xs;const E=this.xhr=new f.XHR(S);try{E.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){E.setDisableHeaderCheck&&E.setDisableHeaderCheck(!0);for(let I in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(I)&&E.setRequestHeader(I,this.opts.extraHeaders[I])}}catch{}if(this.method==="POST")try{E.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{E.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in E&&(E.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(E.timeout=this.opts.requestTimeout),E.onreadystatechange=()=>{E.readyState===4&&(E.status===200||E.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof E.status=="number"?E.status:0)},0))},E.send(this.data)}catch(I){this.setTimeoutFn(()=>{this.onError(I)},0);return}typeof document<"u"&&(this.index=b.requestsCount++,b.requests[this.index]=this)}onError(S){this.emitReserved("error",S,this.xhr),this.cleanup(!0)}cleanup(S){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=a,S)try{this.xhr.abort()}catch{}typeof document<"u"&&delete b.requests[this.index],this.xhr=null}}onLoad(){const S=this.xhr.responseText;S!==null&&(this.emitReserved("data",S),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(b.requestsCount=0,b.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",c);else if(typeof addEventListener=="function"){const w="onpagehide"in y.globalThisShim?"pagehide":"unload";addEventListener(w,c,!1)}}function c(){for(let w in b.requests)b.requests.hasOwnProperty(w)&&b.requests[w].abort()}},"./node_modules/engine.io-client/build/esm/transports/websocket-constructor.browser.js":function(n,t,r){r.r(t),r.d(t,"nextTick",function(){return i}),r.d(t,"WebSocket",function(){return o}),r.d(t,"usingBrowserWebSocket",function(){return l}),r.d(t,"defaultBinaryType",function(){return f});var s=r("./node_modules/engine.io-client/build/esm/globalThis.browser.js");const i=typeof Promise=="function"&&typeof Promise.resolve=="function"?g=>Promise.resolve().then(g):(g,y)=>y(g,0),o=s.globalThisShim.WebSocket||s.globalThisShim.MozWebSocket,l=!0,f="arraybuffer"},"./node_modules/engine.io-client/build/esm/transports/websocket.js":function(n,t,r){r.r(t),(function(s){r.d(t,"WS",function(){return a});var i=r("./node_modules/engine.io-client/build/esm/transport.js"),o=r("./node_modules/engine.io-client/build/esm/contrib/parseqs.js"),l=r("./node_modules/engine.io-client/build/esm/contrib/yeast.js"),f=r("./node_modules/engine.io-client/build/esm/util.js"),u=r("./node_modules/engine.io-client/build/esm/transports/websocket-constructor.browser.js"),g=r("./node_modules/engine.io-parser/build/esm/index.js");const y=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class a extends i.Transport{constructor(_){super(_),this.supportsBinary=!_.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const _=this.uri(),b=this.opts.protocols,c=y?{}:Object(f.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(c.headers=this.opts.extraHeaders);try{this.ws=u.usingBrowserWebSocket&&!y?b?new u.WebSocket(_,b):new u.WebSocket(_):new u.WebSocket(_,b,c)}catch(w){return this.emitReserved("error",w)}this.ws.binaryType=this.socket.binaryType||u.defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=_=>this.onClose({description:"websocket connection closed",context:_}),this.ws.onmessage=_=>this.onData(_.data),this.ws.onerror=_=>this.onError("websocket error",_)}write(_){this.writable=!1;for(let b=0;b<_.length;b++){const c=_[b],w=b===_.length-1;Object(g.encodePacket)(c,this.supportsBinary,S=>{const E={};u.usingBrowserWebSocket||(c.options&&(E.compress=c.options.compress),this.opts.perMessageDeflate&&(typeof S=="string"?s.byteLength(S):S.length)<this.opts.perMessageDeflate.threshold&&(E.compress=!1));try{u.usingBrowserWebSocket?this.ws.send(S):this.ws.send(S,E)}catch{}w&&Object(u.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let _=this.query||{};const b=this.opts.secure?"wss":"ws";let c="";this.opts.port&&(b==="wss"&&Number(this.opts.port)!==443||b==="ws"&&Number(this.opts.port)!==80)&&(c=":"+this.opts.port),this.opts.timestampRequests&&(_[this.opts.timestampParam]=Object(l.yeast)()),this.supportsBinary||(_.b64=1);const w=Object(o.encode)(_),S=this.opts.hostname.indexOf(":")!==-1;return b+"://"+(S?"["+this.opts.hostname+"]":this.opts.hostname)+c+this.opts.path+(w.length?"?"+w:"")}check(){return!!u.WebSocket}}}).call(this,r("./node_modules/buffer/index.js").Buffer)},"./node_modules/engine.io-client/build/esm/transports/xmlhttprequest.browser.js":function(n,t,r){r.r(t),r.d(t,"XHR",function(){return o});var s=r("./node_modules/engine.io-client/build/esm/contrib/has-cors.js"),i=r("./node_modules/engine.io-client/build/esm/globalThis.browser.js");function o(l){const f=l.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!f||s.hasCORS))return new XMLHttpRequest}catch{}if(!f)try{return new i.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}},"./node_modules/engine.io-client/build/esm/util.js":function(n,t,r){r.r(t),r.d(t,"pick",function(){return i}),r.d(t,"installTimerFunctions",function(){return f}),r.d(t,"byteLength",function(){return g});var s=r("./node_modules/engine.io-client/build/esm/globalThis.browser.js");function i(a,...m){return m.reduce((_,b)=>(a.hasOwnProperty(b)&&(_[b]=a[b]),_),{})}const o=s.globalThisShim.setTimeout,l=s.globalThisShim.clearTimeout;function f(a,m){m.useNativeTimers?(a.setTimeoutFn=o.bind(s.globalThisShim),a.clearTimeoutFn=l.bind(s.globalThisShim)):(a.setTimeoutFn=s.globalThisShim.setTimeout.bind(s.globalThisShim),a.clearTimeoutFn=s.globalThisShim.clearTimeout.bind(s.globalThisShim))}const u=1.33;function g(a){return typeof a=="string"?y(a):Math.ceil((a.byteLength||a.size)*u)}function y(a){let m=0,_=0;for(let b=0,c=a.length;b<c;b++)m=a.charCodeAt(b),m<128?_+=1:m<2048?_+=2:m<55296||m>=57344?_+=3:(b++,_+=4);return _}},"./node_modules/engine.io-parser/build/esm/commons.js":function(n,t,r){r.r(t),r.d(t,"PACKET_TYPES",function(){return s}),r.d(t,"PACKET_TYPES_REVERSE",function(){return i}),r.d(t,"ERROR_PACKET",function(){return o});const s=Object.create(null);s.open="0",s.close="1",s.ping="2",s.pong="3",s.message="4",s.upgrade="5",s.noop="6";const i=Object.create(null);Object.keys(s).forEach(l=>{i[s[l]]=l});const o={type:"error",data:"parser error"}},"./node_modules/engine.io-parser/build/esm/decodePacket.browser.js":function(n,t,r){r.r(t);var s=r("./node_modules/engine.io-parser/build/esm/commons.js"),i=r("./node_modules/@socket.io/base64-arraybuffer/dist/base64-arraybuffer.es5.js");const o=typeof ArrayBuffer=="function",l=(g,y)=>{if(typeof g!="string")return{type:"message",data:u(g,y)};const a=g.charAt(0);return a==="b"?{type:"message",data:f(g.substring(1),y)}:s.PACKET_TYPES_REVERSE[a]?g.length>1?{type:s.PACKET_TYPES_REVERSE[a],data:g.substring(1)}:{type:s.PACKET_TYPES_REVERSE[a]}:s.ERROR_PACKET},f=(g,y)=>{if(o){const a=Object(i.decode)(g);return u(a,y)}else return{base64:!0,data:g}},u=(g,y)=>{switch(y){case"blob":return g instanceof ArrayBuffer?new Blob([g]):g;case"arraybuffer":default:return g}};t.default=l},"./node_modules/engine.io-parser/build/esm/encodePacket.browser.js":function(n,t,r){r.r(t);var s=r("./node_modules/engine.io-parser/build/esm/commons.js");const i=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",o=typeof ArrayBuffer=="function",l=g=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(g):g&&g.buffer instanceof ArrayBuffer,f=({type:g,data:y},a,m)=>i&&y instanceof Blob?a?m(y):u(y,m):o&&(y instanceof ArrayBuffer||l(y))?a?m(y):u(new Blob([y]),m):m(s.PACKET_TYPES[g]+(y||"")),u=(g,y)=>{const a=new FileReader;return a.onload=function(){const m=a.result.split(",")[1];y("b"+m)},a.readAsDataURL(g)};t.default=f},"./node_modules/engine.io-parser/build/esm/index.js":function(n,t,r){r.r(t),r.d(t,"protocol",function(){return u}),r.d(t,"encodePayload",function(){return l}),r.d(t,"decodePayload",function(){return f});var s=r("./node_modules/engine.io-parser/build/esm/encodePacket.browser.js");r.d(t,"encodePacket",function(){return s.default});var i=r("./node_modules/engine.io-parser/build/esm/decodePacket.browser.js");r.d(t,"decodePacket",function(){return i.default});const o="",l=(g,y)=>{const a=g.length,m=new Array(a);let _=0;g.forEach((b,c)=>{Object(s.default)(b,!1,w=>{m[c]=w,++_===a&&y(m.join(o))})})},f=(g,y)=>{const a=g.split(o),m=[];for(let _=0;_<a.length;_++){const b=Object(i.default)(a[_],y);if(m.push(b),b.type==="error")break}return m},u=4},"./node_modules/ieee754/index.js":function(n,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(r,s,i,o,l){var f,u,g=l*8-o-1,y=(1<<g)-1,a=y>>1,m=-7,_=i?l-1:0,b=i?-1:1,c=r[s+_];for(_+=b,f=c&(1<<-m)-1,c>>=-m,m+=g;m>0;f=f*256+r[s+_],_+=b,m-=8);for(u=f&(1<<-m)-1,f>>=-m,m+=o;m>0;u=u*256+r[s+_],_+=b,m-=8);if(f===0)f=1-a;else{if(f===y)return u?NaN:(c?-1:1)*(1/0);u=u+Math.pow(2,o),f=f-a}return(c?-1:1)*u*Math.pow(2,f-o)},t.write=function(r,s,i,o,l,f){var u,g,y,a=f*8-l-1,m=(1<<a)-1,_=m>>1,b=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,c=o?0:f-1,w=o?1:-1,S=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(g=isNaN(s)?1:0,u=m):(u=Math.floor(Math.log(s)/Math.LN2),s*(y=Math.pow(2,-u))<1&&(u--,y*=2),u+_>=1?s+=b/y:s+=b*Math.pow(2,1-_),s*y>=2&&(u++,y/=2),u+_>=m?(g=0,u=m):u+_>=1?(g=(s*y-1)*Math.pow(2,l),u=u+_):(g=s*Math.pow(2,_-1)*Math.pow(2,l),u=0));l>=8;r[i+c]=g&255,c+=w,g/=256,l-=8);for(u=u<<l|g,a+=l;a>0;r[i+c]=u&255,c+=w,u/=256,a-=8);r[i+c-w]|=S*128}},"./node_modules/isarray/index.js":function(n,t){var r={}.toString;n.exports=Array.isArray||function(s){return r.call(s)=="[object Array]"}},"./node_modules/socket.io-client/build/esm/contrib/backo2.js":function(n,t,r){r.r(t),r.d(t,"Backoff",function(){return s});function s(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}s.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var o=Math.random(),l=Math.floor(o*this.jitter*i);i=Math.floor(o*10)&1?i+l:i-l}return Math.min(i,this.max)|0},s.prototype.reset=function(){this.attempts=0},s.prototype.setMin=function(i){this.ms=i},s.prototype.setMax=function(i){this.max=i},s.prototype.setJitter=function(i){this.jitter=i}},"./node_modules/socket.io-client/build/esm/index.js":function(n,t,r){r.r(t),r.d(t,"io",function(){return u}),r.d(t,"connect",function(){return u}),r.d(t,"default",function(){return u});var s=r("./node_modules/socket.io-client/build/esm/url.js"),i=r("./node_modules/socket.io-client/build/esm/manager.js");r.d(t,"Manager",function(){return i.Manager});var o=r("./node_modules/socket.io-client/build/esm/socket.js");r.d(t,"Socket",function(){return o.Socket});var l=r("./node_modules/socket.io-parser/build/esm/index.js");r.d(t,"protocol",function(){return l.protocol});const f={};function u(g,y){typeof g=="object"&&(y=g,g=void 0),y=y||{};const a=Object(s.url)(g,y.path||"/socket.io"),m=a.source,_=a.id,b=a.path,c=f[_]&&b in f[_].nsps,w=y.forceNew||y["force new connection"]||y.multiplex===!1||c;let S;return w?S=new i.Manager(m,y):(f[_]||(f[_]=new i.Manager(m,y)),S=f[_]),a.query&&!y.query&&(y.query=a.queryKey),S.socket(a.path,y)}Object.assign(u,{Manager:i.Manager,Socket:o.Socket,io:u,connect:u})},"./node_modules/socket.io-client/build/esm/manager.js":function(n,t,r){r.r(t),r.d(t,"Manager",function(){return g});var s=r("./node_modules/engine.io-client/build/esm/index.js"),i=r("./node_modules/socket.io-client/build/esm/socket.js"),o=r("./node_modules/socket.io-parser/build/esm/index.js"),l=r("./node_modules/socket.io-client/build/esm/on.js"),f=r("./node_modules/socket.io-client/build/esm/contrib/backo2.js"),u=r("./node_modules/@socket.io/component-emitter/index.mjs");class g extends u.Emitter{constructor(a,m){var _;super(),this.nsps={},this.subs=[],a&&typeof a=="object"&&(m=a,a=void 0),m=m||{},m.path=m.path||"/socket.io",this.opts=m,Object(s.installTimerFunctions)(this,m),this.reconnection(m.reconnection!==!1),this.reconnectionAttempts(m.reconnectionAttempts||1/0),this.reconnectionDelay(m.reconnectionDelay||1e3),this.reconnectionDelayMax(m.reconnectionDelayMax||5e3),this.randomizationFactor((_=m.randomizationFactor)!==null&&_!==void 0?_:.5),this.backoff=new f.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(m.timeout==null?2e4:m.timeout),this._readyState="closed",this.uri=a;const b=m.parser||o;this.encoder=new b.Encoder,this.decoder=new b.Decoder,this._autoConnect=m.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection}reconnectionAttempts(a){return a===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var m;return a===void 0?this._reconnectionDelay:(this._reconnectionDelay=a,(m=this.backoff)===null||m===void 0||m.setMin(a),this)}randomizationFactor(a){var m;return a===void 0?this._randomizationFactor:(this._randomizationFactor=a,(m=this.backoff)===null||m===void 0||m.setJitter(a),this)}reconnectionDelayMax(a){var m;return a===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,(m=this.backoff)===null||m===void 0||m.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(a){if(~this._readyState.indexOf("open"))return this;this.engine=new s.Socket(this.uri,this.opts);const m=this.engine,_=this;this._readyState="opening",this.skipReconnect=!1;const b=Object(l.on)(m,"open",function(){_.onopen(),a&&a()}),c=Object(l.on)(m,"error",w=>{_.cleanup(),_._readyState="closed",this.emitReserved("error",w),a?a(w):_.maybeReconnectOnOpen()});if(this._timeout!==!1){const w=this._timeout;w===0&&b();const S=this.setTimeoutFn(()=>{b(),m.close(),m.emit("error",new Error("timeout"))},w);this.opts.autoUnref&&S.unref(),this.subs.push(function(){clearTimeout(S)})}return this.subs.push(b),this.subs.push(c),this}connect(a){return this.open(a)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const a=this.engine;this.subs.push(Object(l.on)(a,"ping",this.onping.bind(this)),Object(l.on)(a,"data",this.ondata.bind(this)),Object(l.on)(a,"error",this.onerror.bind(this)),Object(l.on)(a,"close",this.onclose.bind(this)),Object(l.on)(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){try{this.decoder.add(a)}catch(m){this.onclose("parse error",m)}}ondecoded(a){Object(s.nextTick)(()=>{this.emitReserved("packet",a)},this.setTimeoutFn)}onerror(a){this.emitReserved("error",a)}socket(a,m){let _=this.nsps[a];return _?this._autoConnect&&!_.active&&_.connect():(_=new i.Socket(this,a,m),this.nsps[a]=_),_}_destroy(a){const m=Object.keys(this.nsps);for(const _ of m)if(this.nsps[_].active)return;this._close()}_packet(a){const m=this.encoder.encode(a);for(let _=0;_<m.length;_++)this.engine.write(m[_],a.options)}cleanup(){this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(a,m){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,m),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const a=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const m=this.backoff.duration();this._reconnecting=!0;const _=this.setTimeoutFn(()=>{a.skipReconnect||(this.emitReserved("reconnect_attempt",a.backoff.attempts),!a.skipReconnect&&a.open(b=>{b?(a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",b)):a.onreconnect()}))},m);this.opts.autoUnref&&_.unref(),this.subs.push(function(){clearTimeout(_)})}}onreconnect(){const a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}},"./node_modules/socket.io-client/build/esm/on.js":function(n,t,r){r.r(t),r.d(t,"on",function(){return s});function s(i,o,l){return i.on(o,l),function(){i.off(o,l)}}},"./node_modules/socket.io-client/build/esm/socket.js":function(n,t,r){r.r(t),r.d(t,"Socket",function(){return f});var s=r("./node_modules/socket.io-parser/build/esm/index.js"),i=r("./node_modules/socket.io-client/build/esm/on.js"),o=r("./node_modules/@socket.io/component-emitter/index.mjs");const l=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class f extends o.Emitter{constructor(g,y,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=g,this.nsp=y,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const g=this.io;this.subs=[Object(i.on)(g,"open",this.onopen.bind(this)),Object(i.on)(g,"packet",this.onpacket.bind(this)),Object(i.on)(g,"error",this.onerror.bind(this)),Object(i.on)(g,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...g){return g.unshift("message"),this.emit.apply(this,g),this}emit(g,...y){if(l.hasOwnProperty(g))throw new Error('"'+g.toString()+'" is a reserved event name');if(y.unshift(g),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(y),this;const a={type:s.PacketType.EVENT,data:y};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof y[y.length-1]=="function"){const b=this.ids++,c=y.pop();this._registerAckCallback(b,c),a.id=b}const m=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!m||!this.connected)||(this.connected?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(g,y){var a;const m=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(m===void 0){this.acks[g]=y;return}const _=this.io.setTimeoutFn(()=>{delete this.acks[g];for(let b=0;b<this.sendBuffer.length;b++)this.sendBuffer[b].id===g&&this.sendBuffer.splice(b,1);y.call(this,new Error("operation has timed out"))},m);this.acks[g]=(...b)=>{this.io.clearTimeoutFn(_),y.apply(this,[null,...b])}}emitWithAck(g,...y){const a=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((m,_)=>{y.push((b,c)=>a?b?_(b):m(c):m(b)),this.emit(g,...y)})}_addToQueue(g){let y;typeof g[g.length-1]=="function"&&(y=g.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:g,flags:Object.assign({fromQueue:!0},this.flags)};g.push((m,..._)=>a!==this._queue[0]?void 0:(m!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),y&&y(m)):(this._queue.shift(),y&&y(null,..._)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(g=!1){if(!this.connected||this._queue.length===0)return;const y=this._queue[0];y.pending&&!g||(y.pending=!0,y.tryCount++,this.flags=y.flags,this.emit.apply(this,y.args))}packet(g){g.nsp=this.nsp,this.io._packet(g)}onopen(){typeof this.auth=="function"?this.auth(g=>{this._sendConnectPacket(g)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(g){this.packet({type:s.PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},g):g})}onerror(g){this.connected||this.emitReserved("connect_error",g)}onclose(g,y){this.connected=!1,delete this.id,this.emitReserved("disconnect",g,y)}onpacket(g){if(g.nsp===this.nsp)switch(g.type){case s.PacketType.CONNECT:g.data&&g.data.sid?this.onconnect(g.data.sid,g.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case s.PacketType.EVENT:case s.PacketType.BINARY_EVENT:this.onevent(g);break;case s.PacketType.ACK:case s.PacketType.BINARY_ACK:this.onack(g);break;case s.PacketType.DISCONNECT:this.ondisconnect();break;case s.PacketType.CONNECT_ERROR:this.destroy();const a=new Error(g.data.message);a.data=g.data.data,this.emitReserved("connect_error",a);break}}onevent(g){const y=g.data||[];g.id!=null&&y.push(this.ack(g.id)),this.connected?this.emitEvent(y):this.receiveBuffer.push(Object.freeze(y))}emitEvent(g){if(this._anyListeners&&this._anyListeners.length){const y=this._anyListeners.slice();for(const a of y)a.apply(this,g)}super.emit.apply(this,g),this._pid&&g.length&&typeof g[g.length-1]=="string"&&(this._lastOffset=g[g.length-1])}ack(g){const y=this;let a=!1;return function(...m){a||(a=!0,y.packet({type:s.PacketType.ACK,id:g,data:m}))}}onack(g){const y=this.acks[g.id];typeof y=="function"&&(y.apply(this,g.data),delete this.acks[g.id])}onconnect(g,y){this.id=g,this.recovered=y&&this._pid===y,this._pid=y,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(g=>this.emitEvent(g)),this.receiveBuffer=[],this.sendBuffer.forEach(g=>{this.notifyOutgoingListeners(g),this.packet(g)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(g=>g()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:s.PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(g){return this.flags.compress=g,this}get volatile(){return this.flags.volatile=!0,this}timeout(g){return this.flags.timeout=g,this}onAny(g){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(g),this}prependAny(g){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(g),this}offAny(g){if(!this._anyListeners)return this;if(g){const y=this._anyListeners;for(let a=0;a<y.length;a++)if(g===y[a])return y.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(g){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(g),this}prependAnyOutgoing(g){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(g),this}offAnyOutgoing(g){if(!this._anyOutgoingListeners)return this;if(g){const y=this._anyOutgoingListeners;for(let a=0;a<y.length;a++)if(g===y[a])return y.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(g){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const y=this._anyOutgoingListeners.slice();for(const a of y)a.apply(this,g.data)}}}},"./node_modules/socket.io-client/build/esm/url.js":function(n,t,r){r.r(t),r.d(t,"url",function(){return i});var s=r("./node_modules/engine.io-client/build/esm/index.js");function i(o,l="",f){let u=o;f=f||typeof location<"u"&&location,o==null&&(o=f.protocol+"//"+f.host),typeof o=="string"&&(o.charAt(0)==="/"&&(o.charAt(1)==="/"?o=f.protocol+o:o=f.host+o),/^(https?|wss?):\/\//.test(o)||(typeof f<"u"?o=f.protocol+"//"+o:o="https://"+o),u=Object(s.parse)(o)),u.port||(/^(http|ws)$/.test(u.protocol)?u.port="80":/^(http|ws)s$/.test(u.protocol)&&(u.port="443")),u.path=u.path||"/";const y=u.host.indexOf(":")!==-1?"["+u.host+"]":u.host;return u.id=u.protocol+"://"+y+":"+u.port+l,u.href=u.protocol+"://"+y+(f&&f.port===u.port?"":":"+u.port),u}},"./node_modules/socket.io-parser/build/esm/binary.js":function(n,t,r){r.r(t),r.d(t,"deconstructPacket",function(){return i}),r.d(t,"reconstructPacket",function(){return l});var s=r("./node_modules/socket.io-parser/build/esm/is-binary.js");function i(u){const g=[],y=u.data,a=u;return a.data=o(y,g),a.attachments=g.length,{packet:a,buffers:g}}function o(u,g){if(!u)return u;if(Object(s.isBinary)(u)){const y={_placeholder:!0,num:g.length};return g.push(u),y}else if(Array.isArray(u)){const y=new Array(u.length);for(let a=0;a<u.length;a++)y[a]=o(u[a],g);return y}else if(typeof u=="object"&&!(u instanceof Date)){const y={};for(const a in u)Object.prototype.hasOwnProperty.call(u,a)&&(y[a]=o(u[a],g));return y}return u}function l(u,g){return u.data=f(u.data,g),delete u.attachments,u}function f(u,g){if(!u)return u;if(u&&u._placeholder===!0){if(typeof u.num=="number"&&u.num>=0&&u.num<g.length)return g[u.num];throw new Error("illegal attachments")}else if(Array.isArray(u))for(let y=0;y<u.length;y++)u[y]=f(u[y],g);else if(typeof u=="object")for(const y in u)Object.prototype.hasOwnProperty.call(u,y)&&(u[y]=f(u[y],g));return u}},"./node_modules/socket.io-parser/build/esm/index.js":function(n,t,r){r.r(t),r.d(t,"protocol",function(){return f}),r.d(t,"PacketType",function(){return u}),r.d(t,"Encoder",function(){return g}),r.d(t,"Decoder",function(){return a});var s=r("./node_modules/@socket.io/component-emitter/index.mjs"),i=r("./node_modules/socket.io-parser/build/esm/binary.js"),o=r("./node_modules/socket.io-parser/build/esm/is-binary.js");const l=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],f=5;var u;(function(_){_[_.CONNECT=0]="CONNECT",_[_.DISCONNECT=1]="DISCONNECT",_[_.EVENT=2]="EVENT",_[_.ACK=3]="ACK",_[_.CONNECT_ERROR=4]="CONNECT_ERROR",_[_.BINARY_EVENT=5]="BINARY_EVENT",_[_.BINARY_ACK=6]="BINARY_ACK"})(u||(u={}));class g{constructor(b){this.replacer=b}encode(b){return(b.type===u.EVENT||b.type===u.ACK)&&Object(o.hasBinary)(b)?this.encodeAsBinary({type:b.type===u.EVENT?u.BINARY_EVENT:u.BINARY_ACK,nsp:b.nsp,data:b.data,id:b.id}):[this.encodeAsString(b)]}encodeAsString(b){let c=""+b.type;return(b.type===u.BINARY_EVENT||b.type===u.BINARY_ACK)&&(c+=b.attachments+"-"),b.nsp&&b.nsp!=="/"&&(c+=b.nsp+","),b.id!=null&&(c+=b.id),b.data!=null&&(c+=JSON.stringify(b.data,this.replacer)),c}encodeAsBinary(b){const c=Object(i.deconstructPacket)(b),w=this.encodeAsString(c.packet),S=c.buffers;return S.unshift(w),S}}function y(_){return Object.prototype.toString.call(_)==="[object Object]"}class a extends s.Emitter{constructor(b){super(),this.reviver=b}add(b){let c;if(typeof b=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");c=this.decodeString(b);const w=c.type===u.BINARY_EVENT;w||c.type===u.BINARY_ACK?(c.type=w?u.EVENT:u.ACK,this.reconstructor=new m(c),c.attachments===0&&super.emitReserved("decoded",c)):super.emitReserved("decoded",c)}else if(Object(o.isBinary)(b)||b.base64)if(this.reconstructor)c=this.reconstructor.takeBinaryData(b),c&&(this.reconstructor=null,super.emitReserved("decoded",c));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+b)}decodeString(b){let c=0;const w={type:Number(b.charAt(0))};if(u[w.type]===void 0)throw new Error("unknown packet type "+w.type);if(w.type===u.BINARY_EVENT||w.type===u.BINARY_ACK){const E=c+1;for(;b.charAt(++c)!=="-"&&c!=b.length;);const I=b.substring(E,c);if(I!=Number(I)||b.charAt(c)!=="-")throw new Error("Illegal attachments");w.attachments=Number(I)}if(b.charAt(c+1)==="/"){const E=c+1;for(;++c&&!(b.charAt(c)===","||c===b.length););w.nsp=b.substring(E,c)}else w.nsp="/";const S=b.charAt(c+1);if(S!==""&&Number(S)==S){const E=c+1;for(;++c;){const I=b.charAt(c);if(I==null||Number(I)!=I){--c;break}if(c===b.length)break}w.id=Number(b.substring(E,c+1))}if(b.charAt(++c)){const E=this.tryParse(b.substr(c));if(a.isPayloadValid(w.type,E))w.data=E;else throw new Error("invalid payload")}return w}tryParse(b){try{return JSON.parse(b,this.reviver)}catch{return!1}}static isPayloadValid(b,c){switch(b){case u.CONNECT:return y(c);case u.DISCONNECT:return c===void 0;case u.CONNECT_ERROR:return typeof c=="string"||y(c);case u.EVENT:case u.BINARY_EVENT:return Array.isArray(c)&&(typeof c[0]=="number"||typeof c[0]=="string"&&l.indexOf(c[0])===-1);case u.ACK:case u.BINARY_ACK:return Array.isArray(c)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class m{constructor(b){this.packet=b,this.buffers=[],this.reconPack=b}takeBinaryData(b){if(this.buffers.push(b),this.buffers.length===this.reconPack.attachments){const c=Object(i.reconstructPacket)(this.reconPack,this.buffers);return this.finishedReconstruction(),c}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},"./node_modules/socket.io-parser/build/esm/is-binary.js":function(n,t,r){r.r(t),r.d(t,"isBinary",function(){return u}),r.d(t,"hasBinary",function(){return g});const s=typeof ArrayBuffer=="function",i=y=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(y):y.buffer instanceof ArrayBuffer,o=Object.prototype.toString,l=typeof Blob=="function"||typeof Blob<"u"&&o.call(Blob)==="[object BlobConstructor]",f=typeof File=="function"||typeof File<"u"&&o.call(File)==="[object FileConstructor]";function u(y){return s&&(y instanceof ArrayBuffer||i(y))||l&&y instanceof Blob||f&&y instanceof File}function g(y,a){if(!y||typeof y!="object")return!1;if(Array.isArray(y)){for(let m=0,_=y.length;m<_;m++)if(g(y[m]))return!0;return!1}if(u(y))return!0;if(y.toJSON&&typeof y.toJSON=="function"&&arguments.length===1)return g(y.toJSON(),!0);for(const m in y)if(Object.prototype.hasOwnProperty.call(y,m)&&g(y[m]))return!0;return!1}},"./node_modules/webpack/buildin/global.js":function(n,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}n.exports=r},"./node_modules/worker-loader/dist/workers/InlineWorker.js":function(n,t,r){var s=window.URL||window.webkitURL;n.exports=function(i,o){try{try{var l;try{var f=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;l=new f,l.append(i),l=l.getBlob()}catch{l=new Blob([i])}return new Worker(s.createObjectURL(l))}catch{return new Worker("data:application/javascript,"+encodeURIComponent(i))}}catch{if(!o)throw Error("Inline worker is not supported");return new Worker(o)}}},"./package.json":function(n){n.exports=JSON.parse('{"name":"imjoy-rpc","version":"0.5.46","description":"Remote procedure calls for ImJoy.","module":"index.js","types":"index.d.ts","scripts":{"build":"rm -rf dist && npm run build-umd","build-umd":"webpack --config webpack.config.js --mode development && NODE_ENV=production webpack --config webpack.config.js --mode production --devtool source-map ","watch":"NODE_ENV=production webpack --watch --progress --config webpack.config.js --mode production --devtool source-map","publish-npm":"npm install && npm run build && npm publish","serve":"webpack-dev-server","stats":"webpack --profile --json > stats.json","stats-prod":"webpack --profile --json --mode production > stats-prod.json","analyze":"webpack-bundle-analyzer -p 9999 stats.json","analyze-prod":"webpack-bundle-analyzer -p 9999 stats-prod.json","clean":"rimraf dist/*","deploy":"npm run build && node deploy-site.js","format":"prettier --write \\"{src,tests}/**/**\\"","check-format":"prettier --check \\"{src,tests}/**/**\\"","test":"karma start --single-run --browsers ChromeHeadless,FirefoxHeadless karma.conf.js","test-watch":"karma start --auto-watch --browsers ChromeDebugging karma.conf.js --debug"},"repository":{"type":"git","url":"git+https://github.com/imjoy-team/imjoy-rpc.git"},"keywords":["imjoy","rpc"],"author":"imjoy-team <imjoy.team@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/imjoy-team/imjoy-rpc/issues"},"homepage":"https://github.com/imjoy-team/imjoy-rpc","dependencies":{"@msgpack/msgpack":"^2.7.1","socket.io-client":"^4.6.2"},"devDependencies":{"@babel/core":"^7.16.12","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/polyfill":"^7.12.1","@babel/preset-env":"^7.16.11","@types/requirejs":"^2.1.34","babel-core":"^6.26.0","babel-eslint":"^10.1.0","babel-loader":"^8.2.3","babel-runtime":"^6.26.0","chai":"^4.3.6","clean-webpack-plugin":"^0.1.19","copy-webpack-plugin":"^5.1.2","eslint":"^6.8.0","eslint-config-prettier":"^4.2.0","eslint-loader":"^4.0.2","file-loader":"^0.11.2","fs-extra":"^0.30.0","gh-pages":"^2.0.1","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","json-loader":"^0.5.4","karma":"^6.3.12","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^1.3.0","karma-mocha":"^2.0.1","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"0.0.32","karma-webpack":"^4.0.2","lerna":"^6.0.3","lodash.debounce":"^4.0.8","mocha":"^10.1.0","postcss":"^7.0.36","prettier":"^1.6.1","rimraf":"^2.6.2","schema-utils":"^0.4.3","style-loader":"^0.18.1","ts-loader":"^9.4.3","url-loader":"^0.5.9","webpack":"^4.46.0","webpack-bundle-analyzer":"^4.7.0","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.3","webpack-merge":"^4.1.1","workbox-webpack-plugin":"^4.3.1","worker-loader":"^2.0.0","write-file-webpack-plugin":"^4.5.1"},"eslintConfig":{"globals":{"document":true,"window":true}}}')},"./src/main.js":function(n,t,r){r.r(t),r.d(t,"waitForInitialization",function(){return m}),r.d(t,"setupRPC",function(){return _});var s=r("./src/plugin.webworker.js"),i=r.n(s),o=r("./src/pluginIframe.js"),l=r("./src/utils.js");r.d(t,"loadRequirements",function(){return l.loadRequirements});var f=r("./src/rpc.js");r.d(t,"RPC",function(){return f.RPC}),r.d(t,"API_VERSION",function(){return f.API_VERSION});var u=r("./package.json");r.d(t,"VERSION",function(){return u.version});function g(){try{return window.self!==window.top}catch{return!0}}function y(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function a(b){if(!b.allow_execution)throw new Error("web-worker plugin can only work with allow_execution=true");let c=null;b.broadcastChannel&&(c=new BroadcastChannel(b.broadcastChannel));const w=new i.a,S=setTimeout(function(){w.terminate(),console.warn("Plugin failed to start as a web-worker, running in an iframe instead."),Object(o.default)(b)},2e3),E=Object(l.randId)();w.addEventListener("message",function(I){let A;const T=I.data;if(T.type==="worker-ready"){w.postMessage({type:"connectRPC",config:b}),clearTimeout(S);return}else T.type==="initialized"?(T.config=Object.assign({},b,T.config),T.origin=globalThis.location.origin,T.peer_id=E):T.type==="imjoy_remote_api_ready"?globalThis.dispatchEvent(new CustomEvent("imjoy_remote_api_ready",{detail:null})):T.type==="cacheRequirements"&&typeof cache_requirements=="function"?cache_requirements(T.requirements):T.type==="disconnect"?w.terminate():T.__transferables__&&(A=T.__transferables__,delete T.__transferables__);c?c.postMessage(T):parent.postMessage(T,b.target_origin||"*",A)}),(c||window).addEventListener("message",function(I){if(I.type==="message"&&(c||b.target_origin==="*"||I.origin===b.target_origin)){let A;const T=I.data;T.__transferables__&&(A=T.__transferables__,delete T.__transferables__),T.peer_id===E?w.postMessage(T,A):b.debug&&console.log(`connection peer id mismatch ${T.peer_id} !== ${E}`)}})}function m(b){y()&&(globalThis.parent=self),b=b||{},b.enable_service_worker&&(Object(l.setupServiceWorker)(b.base_url,b.target_origin,b.cache_requirements),b.enable_service_worker=!1),b.cache_requirements&&delete b.cache_requirements;const c=b.target_origin||"*";if(b.credential_required&&typeof b.verify_credential!="function")throw new Error("Please also provide the `verify_credential` function with `credential_required`.");if(b.credential_required&&c==="*")throw new Error("`target_origin` was set to `*` with `credential_required=true`, there is a security risk that you may leak the credential to website from other origin. Please specify the `target_origin` explicitly.");const w=()=>{globalThis.removeEventListener("message",E)},S=Object(l.randId)(),E=I=>{if(I.type==="message"&&(!I.origin||c==="*"||I.origin===c))if(I.data.type==="initialize"){w(),I.data.peer_id!==S&&console.warn(`${I.data.config&&I.data.config.name}: connection peer id mismatch ${I.data.peer_id} !== ${S}`);const A=I.data.config;c!=="*"&&(A.target_origin=c),b.credential_required?b.verify_credential(A.credential).then(T=>{if(T&&T.auth&&!T.error)A.auth=T.auth,_(A).then(()=>{console.log("ImJoy RPC loaded successfully!")});else throw new Error("Failed to verify the credentail:"+(T&&T.error))}):_(A).then(()=>{console.log("ImJoy RPC loaded successfully!")})}else throw new Error(`unrecognized message: ${I.data}`)};globalThis.addEventListener("message",E),y()?parent.postMessage({type:"imjoyRPCReady",config:b,peer_id:S}):parent.postMessage({type:"imjoyRPCReady",config:b,peer_id:S},"*")}function _(b){return b=b||{},b.name=b.name||Object(l.randId)(),b=Object(l.normalizeConfig)(b),b.enable_service_worker&&Object(l.setupServiceWorker)(b.base_url,b.target_origin,b.cache_requirements),b.cache_requirements&&delete b.cache_requirements,new Promise((c,w)=>{const S=E=>{const I=E.detail;b.expose_api_globally&&(globalThis.api=I),c(I),globalThis.removeEventListener("imjoy_remote_api_ready",S)};if(g()){if(b.type==="web-worker")try{a(b)}catch{Object(o.default)(b)}else if(["rpc-window","rpc-worker","iframe","window"].includes(b.type))Object(o.default)(b);else{console.error("Unsupported plugin type: "+b.type),w("Unsupported plugin type: "+b.type);return}globalThis.addEventListener("imjoy_remote_api_ready",S)}else y()?Object(o.default)(b):w(new Error("imjoy-rpc should only run inside an iframe or a webworker."))})}},"./src/plugin.webworker.js":function(n,t,r){n.exports=function(){return r("./node_modules/worker-loader/dist/workers/InlineWorker.js")(`/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/plugin.webworker.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/plugin.webworker.js":
/*!*********************************!*\\
  !*** ./src/plugin.webworker.js ***!
  \\*********************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _pluginCore_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pluginCore.js */ "./src/pluginCore.js");
/* harmony import */ var _rpc_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rpc.js */ "./src/rpc.js");
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils.js */ "./src/utils.js");
/**
 * Contains the routines loaded by the plugin Worker under web-browser.
 *
 * Initializes the web environment version of the platform-dependent
 * connection object for the plugin site
 */




// make sure this runs inside a webworker
if (
  typeof WorkerGlobalScope === "undefined" ||
  !self ||
  !(self instanceof WorkerGlobalScope)
) {
  throw new Error("This script can only loaded in a webworker");
}

async function executeEsModule(content) {
  const dataUri =
    "data:text/javascript;charset=utf-8," + encodeURIComponent(content);
  await import(/* webpackIgnore: true */ dataUri);
}

/**
 * Connection object provided to the RPC constructor,
 * plugin site implementation for the web-based environment.
 * Global will be then cleared to prevent exposure into the
 * Worker, so we put this local connection object into a closure
 */
class Connection extends _utils_js__WEBPACK_IMPORTED_MODULE_2__["MessageEmitter"] {
  constructor(config) {
    super(config && config.debug);
    this.config = config || {};
  }
  connect() {
    self.addEventListener("message", e => {
      this._fire(e.data.type, e.data);
    });
    this.emit({
      type: "initialized",
      config: this.config
    });
  }
  disconnect() {
    this._fire("beforeDisconnect");
    self.close();
    this._fire("disconnected");
  }
  emit(data) {
    let transferables = undefined;
    if (data.__transferables__) {
      transferables = data.__transferables__;
      delete data.__transferables__;
    }
    self.postMessage(data, transferables);
  }
  async execute(code) {
    if (code.type === "requirements") {
      await Object(_utils_js__WEBPACK_IMPORTED_MODULE_2__["loadRequirementsInWebworker"])(code.requirements);
    } else if (code.type === "script") {
      try {
        if (code.attrs.type === "module") {
          await executeEsModule(code.content);
        } else {
          eval(code.content);
        }
      } catch (e) {
        console.error(e.message, e.stack);
        throw e;
      }
    } else {
      throw "unsupported code type.";
    }
    if (code.type === "requirements") {
      self.postMessage({
        type: "cacheRequirements",
        requirements: code.requirements
      });
    }
  }
}
const config = {
  type: "web-worker",
  dedicated_thread: true,
  allow_execution: true,
  lang: "javascript",
  api_version: _rpc_js__WEBPACK_IMPORTED_MODULE_1__["API_VERSION"]
};
const conn = new Connection(config);
conn.on("connectRPC", data => {
  Object(_pluginCore_js__WEBPACK_IMPORTED_MODULE_0__["connectRPC"])(conn, Object.assign(data.config, config));
});
conn.connect();
self.postMessage({
  type: "worker-ready"
});


/***/ }),

/***/ "./src/pluginCore.js":
/*!***************************!*\\
  !*** ./src/pluginCore.js ***!
  \\***************************/
/*! exports provided: connectRPC */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "connectRPC", function() { return connectRPC; });
/* harmony import */ var _rpc_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rpc.js */ "./src/rpc.js");
/**
 * Core plugin script loaded into the plugin process/thread.
 *
 * Initializes the plugin-site API global methods.
 */

function connectRPC(connection, config) {
  config = config || {};
  const codecs = {};
  const rpc = new _rpc_js__WEBPACK_IMPORTED_MODULE_0__["RPC"](connection, config, codecs);
  rpc.on("getInterface", function () {
    launchConnected();
  });
  rpc.on("remoteReady", function () {
    const api = rpc.getRemote() || {};

    api.registerCodec = function (config) {
      if (!config["name"] || !config["encoder"] && !config["decoder"]) {
        throw new Error("Invalid codec format, please make sure you provide a name, type, encoder and decoder.");
      } else {
        if (config.type) {
          for (let k of Object.keys(codecs)) {
            if (codecs[k].type === config.type || k === config.name) {
              delete codecs[k];
              console.warn("Remove duplicated codec: " + k);
            }
          }
        }

        codecs[config["name"]] = config;
      }
    };

    api.init = function (config) {
      // register a minimal plugin api
      rpc.setInterface({
        setup() {}

      }, config);
    };

    api.disposeObject = function (obj) {
      rpc.disposeObject(obj);
    };

    api.export = function (_interface, config) {
      rpc.setInterface(_interface, config);
    };

    api.onLoad = function (handler) {
      handler = checkHandler(handler);

      if (connected) {
        handler();
      } else {
        connectedHandlers.push(handler);
      }
    };

    api.dispose = function (_interface) {
      rpc.disconnect();
    };

    api._rpc = rpc;

    if (typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope) {
      self.api = api;
      self.postMessage({
        type: "imjoy_remote_api_ready"
      });
      self.dispatchEvent(new CustomEvent("imjoy_remote_api_ready", {
        detail: api
      }));
    } else if (typeof window) {
      window.dispatchEvent(new CustomEvent("imjoy_remote_api_ready", {
        detail: api
      }));
    }
  });
  let connected = false;
  const connectedHandlers = [];

  const launchConnected = function () {
    if (!connected) {
      connected = true;
      let handler;

      while (handler = connectedHandlers.pop()) {
        handler();
      }
    }
  };

  const checkHandler = function (handler) {
    const type = typeof handler;

    if (type !== "function") {
      const msg = "A function may only be subsribed to the event, " + type + " was provided instead";
      throw new Error(msg);
    }

    return handler;
  };

  return rpc;
}

/***/ }),

/***/ "./src/rpc.js":
/*!********************!*\\
  !*** ./src/rpc.js ***!
  \\********************/
/*! exports provided: API_VERSION, RPC */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_VERSION", function() { return API_VERSION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RPC", function() { return RPC; });
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ "./src/utils.js");
/**
 * Contains the RPC object used both by the application
 * site, and by each plugin
 */

const API_VERSION = "0.2.3";
const ArrayBufferView = Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array())).constructor;

function _appendBuffer(buffer1, buffer2) {
  const tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);
  tmp.set(new Uint8Array(buffer1), 0);
  tmp.set(new Uint8Array(buffer2), buffer1.byteLength);
  return tmp.buffer;
}

function indexObject(obj, is) {
  if (!is) throw new Error("undefined index");
  if (typeof is === "string") return indexObject(obj, is.split("."));else if (is.length === 0) return obj;else return indexObject(obj[is[0]], is.slice(1));
}
/**
 * RPC object represents a single site in the
 * communication protocol between the application and the plugin
 *
 * @param {Object} connection a special object allowing to send
 * and receive messages from the opposite site (basically it
 * should only provide send() and onMessage() methods)
 */


class RPC extends _utils_js__WEBPACK_IMPORTED_MODULE_0__["MessageEmitter"] {
  constructor(connection, config, codecs) {
    super(config && config.debug);
    this._connection = connection;
    this.config = config || {};
    this._codecs = codecs || {};
    this._object_store = {};
    this._method_weakmap = new WeakMap();
    this._object_weakmap = new WeakMap();
    this._local_api = null;
    this._remote_set = false; // make sure there is an execute function

    const name = this.config.name;

    this._connection.execute = this._connection.execute || function () {
      throw new Error(\`connection.execute not implemented (in "\${name}")\`);
    };

    this._store = new ReferenceStore();
    this._method_refs = new ReferenceStore();

    this._method_refs.onReady(() => {
      this._fire("remoteIdle");
    });

    this._method_refs.onBusy(() => {
      this._fire("remoteBusy");
    });

    this._setupMessageHanlders();
  }

  init() {
    this._connection.emit({
      type: "initialized",
      config: this.config,
      peer_id: this._connection.peer_id
    });
  }

  setConfig(config) {
    if (config) for (const k of Object.keys(config)) {
      this.config[k] = config[k];
    }
  }
  /**
   * Set a handler to be called when received a responce from the
   * remote site reporting that the previously provided interface
   * has been successfully set as remote for that site
   *
   * @param {Function} handler
   */


  getRemoteCallStack() {
    return this._method_refs.getStack();
  }
  /**
   * @returns {Object} set of remote interface methods
   */


  getRemote() {
    return this._remote_interface;
  }
  /**
   * Sets the interface of this site making it available to the
   * remote site by sending a message with a set of methods names
   *
   * @param {Object} _interface to set
   */


  setInterface(_interface, config) {
    config = config || {};
    this.config.name = config.name || this.config.name;
    this.config.description = config.description || this.config.description;

    if (this.config.forwarding_functions) {
      for (let func_name of this.config.forwarding_functions) {
        const _remote = this._remote_interface;

        if (_remote[func_name]) {
          if (_interface.constructor === Object) {
            if (!_interface[func_name]) {
              _interface[func_name] = (...args) => {
                _remote[func_name](...args);
              };
            }
          } else if (_interface.constructor.constructor === Function) {
            if (!_interface.constructor.prototype[func_name]) {
              _interface.constructor.prototype[func_name] = (...args) => {
                _remote[func_name](...args);
              };
            }
          }
        }
      }
    }

    this._local_api = _interface;
    if (!this._remote_set) this._fire("interfaceAvailable");else this.sendInterface();
    return new Promise(resolve => {
      this.once("interfaceSetAsRemote", resolve);
    });
  }
  /**
   * Sends the actual interface to the remote site upon it was
   * updated or by a special request of the remote site
   */


  sendInterface() {
    if (!this._local_api) {
      throw new Error("interface is not set.");
    }

    this._encode(this._local_api, true).then(api => {
      this._connection.emit({
        type: "setInterface",
        api: api
      });
    });
  }

  _disposeObject(objectId) {
    if (this._object_store[objectId]) {
      delete this._object_store[objectId];
    } else {
      throw new Error(\`Object (id=\${objectId}) not found.\`);
    }
  }

  disposeObject(obj) {
    return new Promise((resolve, reject) => {
      if (this._object_weakmap.has(obj)) {
        const objectId = this._object_weakmap.get(obj);

        this._connection.once("disposed", data => {
          if (data.error) reject(new Error(data.error));else resolve();
        });

        this._connection.emit({
          type: "disposeObject",
          object_id: objectId
        });
      } else {
        throw new Error("Invalid object");
      }
    });
  }
  /**
   * Handles a message from the remote site
   */


  _setupMessageHanlders() {
    this._connection.on("init", this.init);

    this._connection.on("execute", data => {
      Promise.resolve(this._connection.execute(data.code)).then(() => {
        this._connection.emit({
          type: "executed"
        });
      }).catch(e => {
        console.error(e);

        this._connection.emit({
          type: "executed",
          error: String(e)
        });
      });
    });

    this._connection.on("method", async data => {
      let resolve, reject, method, method_this, args, result;

      try {
        if (data.promise) {
          [resolve, reject] = await this._unwrap(data.promise, false);
        }

        const _interface = this._object_store[data.object_id];
        method = indexObject(_interface, data.name);

        if (data.name.includes(".")) {
          const tmp = data.name.split(".");
          const intf_index = tmp.slice(0, tmp.length - 1).join(".");
          method_this = indexObject(_interface, intf_index);
        } else {
          method_this = _interface;
        }

        args = await this._unwrap(data.args, true);

        if (data.promise) {
          result = method.apply(method_this, args);

          if (result instanceof Promise || method.constructor && method.constructor.name === "AsyncFunction") {
            result.then(resolve).catch(reject);
          } else {
            resolve(result);
          }
        } else {
          method.apply(method_this, args);
        }
      } catch (err) {
        console.error(this.config.name, err);

        if (reject) {
          reject(err);
        }
      }
    });

    this._connection.on("callback", async data => {
      let resolve, reject, method, args, result;

      try {
        if (data.promise) {
          [resolve, reject] = await this._unwrap(data.promise, false);
        }

        if (data.promise) {
          method = this._store.fetch(data.id);
          args = await this._unwrap(data.args, true);

          if (!method) {
            throw new Error("Callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");
          }

          result = method.apply(null, args);

          if (result instanceof Promise || method.constructor && method.constructor.name === "AsyncFunction") {
            result.then(resolve).catch(reject);
          } else {
            resolve(result);
          }
        } else {
          method = this._store.fetch(data.id);
          args = await this._unwrap(data.args, true);

          if (!method) {
            throw new Error("Please notice that callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");
          }

          method.apply(null, args);
        }
      } catch (err) {
        console.error(this.config.name, err);

        if (reject) {
          reject(err);
        }
      }
    });

    this._connection.on("disposeObject", data => {
      try {
        this._disposeObject(data.object_id);

        this._connection.emit({
          type: "disposed"
        });
      } catch (e) {
        console.error(e);

        this._connection.emit({
          type: "disposed",
          error: String(e)
        });
      }
    });

    this._connection.on("setInterface", data => {
      this._setRemoteInterface(data.api);
    });

    this._connection.on("getInterface", () => {
      this._fire("getInterface");

      if (this._local_api) {
        this.sendInterface();
      } else {
        this.once("interfaceAvailable", () => {
          this.sendInterface();
        });
      }
    });

    this._connection.on("interfaceSetAsRemote", () => {
      this._remote_set = true;

      this._fire("interfaceSetAsRemote");
    });

    this._connection.on("disconnect", () => {
      this._fire("beforeDisconnect");

      this._connection.disconnect();

      this._fire("disconnected");
    });
  }
  /**
   * Sends a requests to the remote site asking it to provide its
   * current interface
   */


  requestRemote() {
    this._connection.emit({
      type: "getInterface"
    });
  }

  _ndarray(typedArray, shape, dtype) {
    const _dtype = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["typedArrayToDtype"])(typedArray);

    if (dtype && dtype !== _dtype) {
      throw "dtype doesn't match the type of the array: " + _dtype + " != " + dtype;
    }

    shape = shape || [typedArray.length];
    return {
      _rtype: "ndarray",
      _rvalue: typedArray.buffer,
      _rshape: shape,
      _rdtype: _dtype
    };
  }
  /**
   * Sets the new remote interface provided by the other site
   *
   * @param {Array} names list of function names
   */


  _setRemoteInterface(api) {
    this._decode(api).then(intf => {
      // update existing interface instead of recreating it
      // this will preserve the object reference
      if (this._remote_interface) {
        // clear the interface
        for (let k in this._remote_interface) delete this._remote_interface[k]; // then assign the new interfaces


        Object.assign(this._remote_interface, intf);
      } else this._remote_interface = intf;

      this._fire("remoteReady");

      this._reportRemoteSet();
    });
  }
  /**
   * Generates the wrapped function corresponding to a single remote
   * method. When the generated function is called, it will send the
   * corresponding message to the remote site asking it to execute
   * the particular method of its interface
   *
   * @param {String} name of the remote method
   *
   * @returns {Function} wrapped remote method
   */


  _genRemoteMethod(targetId, name, objectId) {
    const me = this;

    const remoteMethod = function () {
      return new Promise(async (resolve, reject) => {
        let id = null;

        try {
          id = me._method_refs.put(objectId ? objectId + "/" + name : name);

          const wrapped_resolve = function () {
            if (id !== null) me._method_refs.fetch(id);
            return resolve.apply(this, arguments);
          };

          const wrapped_reject = function () {
            if (id !== null) me._method_refs.fetch(id);
            return reject.apply(this, arguments);
          };

          const encodedPromise = await me._wrap([wrapped_resolve, wrapped_reject]); // store the key id for removing them from the reference store together

          wrapped_resolve.__promise_pair = encodedPromise[1]._rvalue;
          wrapped_reject.__promise_pair = encodedPromise[0]._rvalue;
          let args = Array.prototype.slice.call(arguments);
          const argLength = args.length; // if the last argument is an object, mark it as kwargs

          const withKwargs = argLength > 0 && typeof args[argLength - 1] === "object" && args[argLength - 1] !== null && args[argLength - 1]._rkwargs;
          if (withKwargs) delete args[argLength - 1]._rkwargs;

          if (name === "register" || name === "registerService" || name === "register_service" || name === "export" || name === "on") {
            args = await me._wrap(args, true);
          } else {
            args = await me._wrap(args);
          }

          const transferables = args.__transferables__;
          if (transferables) delete args.__transferables__;

          me._connection.emit({
            type: "method",
            target_id: targetId,
            name: name,
            object_id: objectId,
            args: args,
            promise: encodedPromise,
            with_kwargs: withKwargs
          }, transferables);
        } catch (e) {
          if (id) me._method_refs.fetch(id);
          reject(\`Failed to exectue remote method (interface: \${objectId || me.id}, method: \${name}), error: \${e}\`);
        }
      });
    };

    remoteMethod.__remote_method = true;
    return remoteMethod;
  }
  /**
   * Sends a responce reporting that interface just provided by the
   * remote site was successfully set by this site as remote
   */


  _reportRemoteSet() {
    this._connection.emit({
      type: "interfaceSetAsRemote"
    });
  }
  /**
   * Prepares the provided set of remote method arguments for
   * sending to the remote site, replaces all the callbacks with
   * identifiers
   *
   * @param {Array} args to wrap
   *
   * @returns {Array} wrapped arguments
   */


  async _encode(aObject, asInterface, objectId) {
    const aType = typeof aObject;

    if (aType === "number" || aType === "string" || aType === "boolean" || aObject === null || aObject === undefined || aObject instanceof ArrayBuffer) {
      return aObject;
    }

    let bObject;

    if (typeof aObject === "function") {
      if (asInterface) {
        if (!objectId) throw new Error("objectId is not specified.");
        bObject = {
          _rtype: "interface",
          _rtarget_id: this._connection.peer_id,
          _rintf: objectId,
          _rvalue: asInterface
        };

        this._method_weakmap.set(aObject, bObject);
      } else if (this._method_weakmap.has(aObject)) {
        bObject = this._method_weakmap.get(aObject);
      } else {
        const cid = this._store.put(aObject);

        bObject = {
          _rtype: "callback",
          _rtarget_id: this._connection.peer_id,
          _rname: aObject.constructor && aObject.constructor.name || cid,
          _rvalue: cid
        };
      }

      return bObject;
    } // skip if already encoded


    if (aObject.constructor instanceof Object && aObject._rtype) {
      // make sure the interface functions are encoded
      if (aObject._rintf) {
        const temp = aObject._rtype;
        delete aObject._rtype;
        bObject = await this._encode(aObject, asInterface, objectId);
        bObject._rtype = temp;
      } else {
        bObject = aObject;
      }

      return bObject;
    }

    const transferables = [];
    const _transfer = aObject._transfer;
    const isarray = Array.isArray(aObject);

    for (let tp of Object.keys(this._codecs)) {
      const codec = this._codecs[tp];

      if (codec.encoder && aObject instanceof codec.type) {
        // TODO: what if multiple encoders found
        let encodedObj = await Promise.resolve(codec.encoder(aObject));
        if (encodedObj && !encodedObj._rtype) encodedObj._rtype = codec.name; // encode the functions in the interface object

        if (encodedObj && encodedObj._rintf) {
          const temp = encodedObj._rtype;
          delete encodedObj._rtype;
          encodedObj = await this._encode(encodedObj, asInterface, objectId);
          encodedObj._rtype = temp;
        }

        bObject = encodedObj;
        return bObject;
      }
    }

    if (
    /*global tf*/
    typeof tf !== "undefined" && tf.Tensor && aObject instanceof tf.Tensor) {
      const v_buffer = aObject.dataSync();

      if (aObject._transfer || _transfer) {
        transferables.push(v_buffer.buffer);
        delete aObject._transfer;
      }

      bObject = {
        _rtype: "ndarray",
        _rvalue: v_buffer.buffer,
        _rshape: aObject.shape,
        _rdtype: aObject.dtype
      };
    } else if (
    /*global nj*/
    typeof nj !== "undefined" && nj.NdArray && aObject instanceof nj.NdArray) {
      const dtype = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["typedArrayToDtype"])(aObject.selection.data);

      if (aObject._transfer || _transfer) {
        transferables.push(aObject.selection.data.buffer);
        delete aObject._transfer;
      }

      bObject = {
        _rtype: "ndarray",
        _rvalue: aObject.selection.data.buffer,
        _rshape: aObject.shape,
        _rdtype: dtype
      };
    } else if (aObject instanceof Error) {
      console.error(aObject);
      bObject = {
        _rtype: "error",
        _rvalue: aObject.toString()
      };
    } else if (typeof File !== "undefined" && aObject instanceof File) {
      bObject = {
        _rtype: "file",
        _rvalue: aObject,
        _rpath: aObject._path || aObject.webkitRelativePath
      };
    } // send objects supported by structure clone algorithm
    // https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm
    else if (aObject !== Object(aObject) || aObject instanceof Boolean || aObject instanceof String || aObject instanceof Date || aObject instanceof RegExp || aObject instanceof ImageData || typeof FileList !== "undefined" && aObject instanceof FileList || typeof FileSystemDirectoryHandle !== "undefined" && aObject instanceof FileSystemDirectoryHandle || typeof FileSystemFileHandle !== "undefined" && aObject instanceof FileSystemFileHandle || typeof FileSystemHandle !== "undefined" && aObject instanceof FileSystemHandle || typeof FileSystemWritableFileStream !== "undefined" && aObject instanceof FileSystemWritableFileStream) {
      bObject = aObject; // TODO: avoid object such as DynamicPlugin instance.
    } else if (typeof File !== "undefined" && aObject instanceof File) {
      bObject = {
        _rtype: "file",
        _rname: aObject.name,
        _rmime: aObject.type,
        _rvalue: aObject,
        _rpath: aObject._path || aObject.webkitRelativePath
      };
    } else if (aObject instanceof Blob) {
      bObject = {
        _rtype: "blob",
        _rvalue: aObject
      };
    } else if (aObject instanceof ArrayBufferView) {
      if (aObject._transfer || _transfer) {
        transferables.push(aObject.buffer);
        delete aObject._transfer;
      }

      const dtype = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["typedArrayToDtype"])(aObject);
      bObject = {
        _rtype: "typedarray",
        _rvalue: aObject.buffer,
        _rdtype: dtype
      };
    } else if (aObject instanceof DataView) {
      if (aObject._transfer || _transfer) {
        transferables.push(aObject.buffer);
        delete aObject._transfer;
      }

      bObject = {
        _rtype: "memoryview",
        _rvalue: aObject.buffer
      };
    } else if (aObject instanceof Set) {
      bObject = {
        _rtype: "set",
        _rvalue: await this._encode(Array.from(aObject), asInterface)
      };
    } else if (aObject instanceof Map) {
      bObject = {
        _rtype: "orderedmap",
        _rvalue: await this._encode(Array.from(aObject), asInterface)
      };
    } else if (aObject.constructor instanceof Object || Array.isArray(aObject)) {
      bObject = isarray ? [] : {};
      let keys; // an object/array

      if (aObject.constructor === Object || Array.isArray(aObject)) {
        keys = Object.keys(aObject);
      } // a class
      else if (aObject.constructor === Function) {
        throw new Error("Please instantiate the class before exportting it.");
      } // instance of a class
      else if (aObject.constructor.constructor === Function) {
        keys = Object.getOwnPropertyNames(Object.getPrototypeOf(aObject)).concat(Object.keys(aObject)); // TODO: use a proxy object to represent the actual object
        // always encode class instance as interface

        asInterface = true;
      } else {
        throw Error("Unsupported interface type");
      }

      let hasFunction = false; // encode interfaces

      if (aObject._rintf || asInterface) {
        if (!objectId) {
          if (typeof aObject._rintf === "string" && aObject._rintf.length > 0) {
            objectId = aObject._rintf; // enable custom object id
          } else {
            objectId = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["randId"])();
          } // Note: object with the same id will be overwritten


          if (this._object_store[objectId]) console.warn(\`Overwritting interface object with the same id: \${objectId}\`);
          this._object_store[objectId] = aObject;
        }

        for (let k of keys) {
          if (k === "constructor") continue;

          if (k.startsWith("_")) {
            continue;
          }

          bObject[k] = await this._encode(aObject[k], typeof asInterface === "string" ? asInterface + "." + k : k, objectId);

          if (typeof aObject[k] === "function") {
            hasFunction = true;
          }
        } // object id for dispose the object remotely


        if (hasFunction) bObject._rintf = objectId; // remove interface when closed

        if (aObject.on && typeof aObject.on === "function") {
          aObject.on("close", () => {
            delete this._object_store[objectId];
          });
        }
      } else {
        for (let k of keys) {
          if (["hasOwnProperty", "constructor"].includes(k)) continue;
          bObject[k] = await this._encode(aObject[k]);
        }
      } // for example, browserFS object

    } else if (typeof aObject === "object") {
      const keys = Object.getOwnPropertyNames(Object.getPrototypeOf(aObject)).concat(Object.keys(aObject));
      const objectId = Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__["randId"])();

      for (let k of keys) {
        if (["hasOwnProperty", "constructor"].includes(k)) continue; // encode as interface

        bObject[k] = await this._encode(aObject[k], k, bObject);
      } // object id, used for dispose the object


      bObject._rintf = objectId;
    } else {
      throw "imjoy-rpc: Unsupported data type:" + aObject;
    }

    if (transferables.length > 0) {
      bObject.__transferables__ = transferables;
    }

    if (!bObject) {
      throw new Error("Failed to encode object");
    }

    return bObject;
  }

  async _decode(aObject, withPromise) {
    if (!aObject) {
      return aObject;
    }

    let bObject;

    if (aObject["_rtype"]) {
      if (this._codecs[aObject._rtype] && this._codecs[aObject._rtype].decoder) {
        if (aObject._rintf) {
          const temp = aObject._rtype;
          delete aObject._rtype;
          aObject = await this._decode(aObject, withPromise);
          aObject._rtype = temp;
        }

        bObject = await Promise.resolve(this._codecs[aObject._rtype].decoder(aObject));
      } else if (aObject._rtype === "callback") {
        bObject = this._genRemoteCallback(aObject._rtarget_id, aObject._rvalue, withPromise);
      } else if (aObject._rtype === "interface") {
        bObject = this._genRemoteMethod(aObject._rtarget_id, aObject._rvalue, aObject._rintf);
      } else if (aObject._rtype === "ndarray") {
        /*global nj tf*/
        //create build array/tensor if used in the plugin
        if (typeof nj !== "undefined" && nj.array) {
          if (Array.isArray(aObject._rvalue)) {
            aObject._rvalue = aObject._rvalue.reduce(_appendBuffer);
          }

          bObject = nj.array(new Uint8(aObject._rvalue), aObject._rdtype).reshape(aObject._rshape);
        } else if (typeof tf !== "undefined" && tf.Tensor) {
          if (Array.isArray(aObject._rvalue)) {
            aObject._rvalue = aObject._rvalue.reduce(_appendBuffer);
          }

          const arraytype = _utils_js__WEBPACK_IMPORTED_MODULE_0__["dtypeToTypedArray"][aObject._rdtype];
          bObject = tf.tensor(new arraytype(aObject._rvalue), aObject._rshape, aObject._rdtype);
        } else {
          //keep it as regular if transfered to the main app
          bObject = aObject;
        }
      } else if (aObject._rtype === "error") {
        bObject = new Error(aObject._rvalue);
      } else if (aObject._rtype === "file") {
        if (aObject._rvalue instanceof File) {
          bObject = aObject._rvalue; //patch _path

          bObject._path = aObject._rpath;
        } else {
          bObject = new File([aObject._rvalue], aObject._rname, {
            type: aObject._rmime
          });
          bObject._path = aObject._rpath;
        }
      } else if (aObject._rtype === "typedarray") {
        const arraytype = _utils_js__WEBPACK_IMPORTED_MODULE_0__["dtypeToTypedArray"][aObject._rdtype];
        if (!arraytype) throw new Error("unsupported dtype: " + aObject._rdtype);
        bObject = new arraytype(aObject._rvalue);
      } else if (aObject._rtype === "memoryview") {
        bObject = new DataView(aObject._rvalue);
      } else if (aObject._rtype === "blob") {
        if (aObject._rvalue instanceof Blob) {
          bObject = aObject._rvalue;
        } else {
          bObject = new Blob([aObject._rvalue], {
            type: aObject._rmime
          });
        }
      } else if (aObject._rtype === "orderedmap") {
        bObject = new Map(await this._decode(aObject._rvalue, withPromise));
      } else if (aObject._rtype === "set") {
        bObject = new Set(await this._decode(aObject._rvalue, withPromise));
      } else {
        // make sure all the interface functions are decoded
        if (aObject._rintf) {
          const temp = aObject._rtype;
          delete aObject._rtype;
          bObject = await this._decode(aObject, withPromise);
          bObject._rtype = temp;
        } else bObject = aObject;
      }
    } else if (aObject.constructor === Object || Array.isArray(aObject)) {
      const isarray = Array.isArray(aObject);
      bObject = isarray ? [] : {};

      for (let k of Object.keys(aObject)) {
        if (isarray || aObject.hasOwnProperty(k)) {
          const v = aObject[k];
          bObject[k] = await this._decode(v, withPromise);
        }
      }
    } else {
      bObject = aObject;
    }

    if (bObject === undefined) {
      throw new Error("Failed to decode object");
    } // store the object id for dispose


    if (aObject._rintf) {
      this._object_weakmap.set(bObject, aObject._rintf);
    }

    return bObject;
  }

  async _wrap(args, asInterface) {
    return await this._encode(args, asInterface);
  }
  /**
   * Unwraps the set of arguments delivered from the remote site,
   * replaces all callback identifiers with a function which will
   * initiate sending that callback identifier back to other site
   *
   * @param {Object} args to unwrap
   *
   * @param {Boolean} withPromise is true means this the callback should contain a promise
   *
   * @returns {Array} unwrapped args
   */


  async _unwrap(args, withPromise) {
    return await this._decode(args, withPromise);
  }
  /**
   * Generates the wrapped function corresponding to a single remote
   * callback. When the generated function is called, it will send
   * the corresponding message to the remote site asking it to
   * execute the particular callback previously saved during a call
   * by the remote site a method from the interface of this site
   *
   * @param {Number} id of the remote callback to execute
   * @param {Number} argNum argument index of the callback
   * @param {Boolean} withPromise is true means this the callback should contain a promise
   *
   * @returns {Function} wrapped remote callback
   */


  _genRemoteCallback(targetId, cid, withPromise) {
    const me = this;
    let remoteCallback;

    if (withPromise) {
      remoteCallback = function () {
        return new Promise(async (resolve, reject) => {
          const args = await me._wrap(Array.prototype.slice.call(arguments));
          const argLength = args.length; // if the last argument is an object, mark it as kwargs

          const withKwargs = argLength > 0 && typeof args[argLength - 1] === "object" && args[argLength - 1] !== null && args[argLength - 1]._rkwargs;
          if (withKwargs) delete args[argLength - 1]._rkwargs;
          const transferables = args.__transferables__;
          if (transferables) delete args.__transferables__;
          const encodedPromise = await me._wrap([resolve, reject]); // store the key id for removing them from the reference store together

          resolve.__promise_pair = encodedPromise[1]._rvalue;
          reject.__promise_pair = encodedPromise[0]._rvalue;

          try {
            me._connection.emit({
              type: "callback",
              target_id: targetId,
              id: cid,
              args: args,
              promise: encodedPromise,
              with_kwargs: withKwargs
            }, transferables);
          } catch (e) {
            reject(\`Failed to exectue remote callback ( id: \${cid}).\`);
          }
        });
      };

      return remoteCallback;
    } else {
      remoteCallback = async function () {
        const args = await me._wrap(Array.prototype.slice.call(arguments));
        const argLength = args.length; // if the last argument is an object, mark it as kwargs

        const withKwargs = argLength > 0 && typeof args[argLength - 1] === "object" && args[argLength - 1] !== null && args[argLength - 1]._rkwargs;
        if (withKwargs) delete args[argLength - 1]._rkwargs;
        const transferables = args.__transferables__;
        if (transferables) delete args.__transferables__;
        return me._connection.emit({
          type: "callback",
          target_id: targetId,
          id: cid,
          args: args,
          with_kwargs: withKwargs
        }, transferables);
      };

      return remoteCallback;
    }
  }

  reset() {
    this._event_handlers = {};
    this._once_handlers = {};
    this._remote_interface = null;
    this._object_store = {};
    this._method_weakmap = new WeakMap();
    this._object_weakmap = new WeakMap();
    this._local_api = null;
    this._store = new ReferenceStore();
    this._method_refs = new ReferenceStore();
  }
  /**
   * Sends the notification message and breaks the connection
   */


  disconnect() {
    this._connection.emit({
      type: "disconnect"
    });

    this.reset();
    setTimeout(() => {
      this._connection.disconnect();
    }, 2000);
  }

}
/**
 * ReferenceStore is a special object which stores other objects
 * and provides the references (number) instead. This reference
 * may then be sent over a json-based communication channel (IPC
 * to another Node.js process or a message to the Worker). Other
 * site may then provide the reference in the responce message
 * implying the given object should be activated.
 *
 * Primary usage for the ReferenceStore is a storage for the
 * callbacks, which therefore makes it possible to initiate a
 * callback execution by the opposite site (which normally cannot
 * directly execute functions over the communication channel).
 *
 * Each stored object can only be fetched once and is not
 * available for the second time. Each stored object must be
 * fetched, since otherwise it will remain stored forever and
 * consume memory.
 *
 * Stored object indeces are simply the numbers, which are however
 * released along with the objects, and are later reused again (in
 * order to postpone the overflow, which should not likely happen,
 * but anyway).
 */

class ReferenceStore {
  constructor() {
    this._store = {}; // stored object

    this._indices = [0]; // smallest available indices

    this._readyHandler = function () {};

    this._busyHandler = function () {};

    this._readyHandler();
  }
  /**
   * call handler when the store is empty
   *
   * @param {FUNCTION} id of a handler
   */


  onReady(readyHandler) {
    this._readyHandler = readyHandler || function () {};
  }
  /**
   * call handler when the store is not empty
   *
   * @param {FUNCTION} id of a handler
   */


  onBusy(busyHandler) {
    this._busyHandler = busyHandler || function () {};
  }
  /**
   * get the length of the store
   *
   */


  getStack() {
    return Object.keys(this._store).length;
  }
  /**
   * @function _genId() generates the new reference id
   *
   * @returns {Number} smallest available id and reserves it
   */


  _genId() {
    let id;

    if (this._indices.length === 1) {
      id = this._indices[0]++;
    } else {
      id = this._indices.shift();
    }

    return id;
  }
  /**
   * Releases the given reference id so that it will be available by
   * another object stored
   *
   * @param {Number} id to release
   */


  _releaseId(id) {
    for (let i = 0; i < this._indices.length; i++) {
      if (id < this._indices[i]) {
        this._indices.splice(i, 0, id);

        break;
      }
    } // cleaning-up the sequence tail


    for (let i = this._indices.length - 1; i >= 0; i--) {
      if (this._indices[i] - 1 === this._indices[i - 1]) {
        this._indices.pop();
      } else {
        break;
      }
    }
  }
  /**
   * Stores the given object and returns the refernce id instead
   *
   * @param {Object} obj to store
   *
   * @returns {Number} reference id of the stored object
   */


  put(obj) {
    if (this._busyHandler && Object.keys(this._store).length === 0) {
      this._busyHandler();
    }

    const id = this._genId();

    this._store[id] = obj;
    return id;
  }
  /**
   * Retrieves previously stored object and releases its reference
   *
   * @param {Number} id of an object to retrieve
   */


  fetch(id) {
    const obj = this._store[id];

    if (obj && !obj.__remote_method) {
      delete this._store[id];

      this._releaseId(id);

      if (this._readyHandler && Object.keys(this._store).length === 0) {
        this._readyHandler();
      }
    }

    if (obj && obj.__promise_pair) {
      this.fetch(obj.__promise_pair);
    }

    return obj;
  }

}

/***/ }),

/***/ "./src/utils.js":
/*!**********************!*\\
  !*** ./src/utils.js ***!
  \\**********************/
/*! exports provided: randId, dtypeToTypedArray, loadRequirementsInWindow, loadRequirementsInWebworker, loadRequirements, normalizeConfig, typedArrayToDtypeMapping, typedArrayToDtype, cacheRequirements, setupServiceWorker, urlJoin, MessageEmitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "randId", function() { return randId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtypeToTypedArray", function() { return dtypeToTypedArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadRequirementsInWindow", function() { return loadRequirementsInWindow; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadRequirementsInWebworker", function() { return loadRequirementsInWebworker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadRequirements", function() { return loadRequirements; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "normalizeConfig", function() { return normalizeConfig; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "typedArrayToDtypeMapping", function() { return typedArrayToDtypeMapping; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "typedArrayToDtype", function() { return typedArrayToDtype; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cacheRequirements", function() { return cacheRequirements; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setupServiceWorker", function() { return setupServiceWorker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "urlJoin", function() { return urlJoin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageEmitter", function() { return MessageEmitter; });
function randId() {
  return Math.random().toString(36).substr(2, 10) + new Date().getTime();
}
const dtypeToTypedArray = {
  int8: Int8Array,
  int16: Int16Array,
  int32: Int32Array,
  uint8: Uint8Array,
  uint16: Uint16Array,
  uint32: Uint32Array,
  float32: Float32Array,
  float64: Float64Array,
  array: Array
};
async function loadRequirementsInWindow(requirements) {
  function _importScript(url) {
    //url is URL of external file, implementationCode is the code
    //to be called from the file, location is the location to
    //insert the <script> element
    return new Promise((resolve, reject) => {
      var scriptTag = document.createElement("script");
      scriptTag.src = url;
      scriptTag.type = "text/javascript";
      scriptTag.onload = resolve;

      scriptTag.onreadystatechange = function () {
        if (this.readyState === "loaded" || this.readyState === "complete") {
          resolve();
        }
      };

      scriptTag.onerror = reject;
      document.head.appendChild(scriptTag);
    });
  } // support importScripts outside web worker


  async function importScripts() {
    var args = Array.prototype.slice.call(arguments),
        len = args.length,
        i = 0;

    for (; i < len; i++) {
      await _importScript(args[i]);
    }
  }

  if (requirements && (Array.isArray(requirements) || typeof requirements === "string")) {
    try {
      var link_node;
      requirements = typeof requirements === "string" ? [requirements] : requirements;

      if (Array.isArray(requirements)) {
        for (var i = 0; i < requirements.length; i++) {
          if (requirements[i].toLowerCase().endsWith(".css") || requirements[i].startsWith("css:")) {
            if (requirements[i].startsWith("css:")) {
              requirements[i] = requirements[i].slice(4);
            }

            link_node = document.createElement("link");
            link_node.rel = "stylesheet";
            link_node.href = requirements[i];
            document.head.appendChild(link_node);
          } else if (requirements[i].toLowerCase().endsWith(".mjs") || requirements[i].startsWith("mjs:")) {
            // import esmodule
            if (requirements[i].startsWith("mjs:")) {
              requirements[i] = requirements[i].slice(4);
            }

            await import(
            /* webpackIgnore: true */
            requirements[i]);
          } else if (requirements[i].toLowerCase().endsWith(".js") || requirements[i].startsWith("js:")) {
            if (requirements[i].startsWith("js:")) {
              requirements[i] = requirements[i].slice(3);
            }

            await importScripts(requirements[i]);
          } else if (requirements[i].startsWith("http")) {
            await importScripts(requirements[i]);
          } else if (requirements[i].startsWith("cache:")) {//ignore cache
          } else {
            console.log("Unprocessed requirements url: " + requirements[i]);
          }
        }
      } else {
        throw "unsupported requirements definition";
      }
    } catch (e) {
      throw "failed to import required scripts: " + requirements.toString();
    }
  }
}
async function loadRequirementsInWebworker(requirements) {
  if (requirements && (Array.isArray(requirements) || typeof requirements === "string")) {
    try {
      if (!Array.isArray(requirements)) {
        requirements = [requirements];
      }

      for (var i = 0; i < requirements.length; i++) {
        if (requirements[i].toLowerCase().endsWith(".css") || requirements[i].startsWith("css:")) {
          throw "unable to import css in a webworker";
        } else if (requirements[i].toLowerCase().endsWith(".js") || requirements[i].startsWith("js:")) {
          if (requirements[i].startsWith("js:")) {
            requirements[i] = requirements[i].slice(3);
          }

          importScripts(requirements[i]);
        } else if (requirements[i].startsWith("http")) {
          importScripts(requirements[i]);
        } else if (requirements[i].startsWith("cache:")) {//ignore cache
        } else {
          console.log("Unprocessed requirements url: " + requirements[i]);
        }
      }
    } catch (e) {
      throw "failed to import required scripts: " + requirements.toString();
    }
  }
}
function loadRequirements(requirements) {
  if (typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope) {
    return loadRequirementsInWebworker(requirements);
  } else {
    return loadRequirementsInWindow(requirements);
  }
}
function normalizeConfig(config) {
  config.version = config.version || "0.1.0";
  config.description = config.description || \`[TODO: add description for \${config.name} ]\`;
  config.type = config.type || "rpc-window";
  config.id = config.id || randId();
  config.target_origin = config.target_origin || "*";
  config.allow_execution = config.allow_execution || false; // remove functions

  config = Object.keys(config).reduce((p, c) => {
    if (typeof config[c] !== "function") p[c] = config[c];
    return p;
  }, {});
  return config;
}
const typedArrayToDtypeMapping = {
  Int8Array: "int8",
  Int16Array: "int16",
  Int32Array: "int32",
  Uint8Array: "uint8",
  Uint16Array: "uint16",
  Uint32Array: "uint32",
  Float32Array: "float32",
  Float64Array: "float64",
  Array: "array"
};
const typedArrayToDtypeKeys = [];

for (const arrType of Object.keys(typedArrayToDtypeMapping)) {
  typedArrayToDtypeKeys.push(eval(arrType));
}

function typedArrayToDtype(obj) {
  let dtype = typedArrayToDtypeMapping[obj.constructor.name];

  if (!dtype) {
    const pt = Object.getPrototypeOf(obj);

    for (const arrType of typedArrayToDtypeKeys) {
      if (pt instanceof arrType) {
        dtype = typedArrayToDtypeMapping[arrType.name];
        break;
      }
    }
  }

  return dtype;
}

function cacheUrlInServiceWorker(url) {
  return new Promise(function (resolve, reject) {
    const message = {
      command: "add",
      url: url
    };

    if (!navigator.serviceWorker || !navigator.serviceWorker.register) {
      reject("Service worker is not supported.");
      return;
    }

    const messageChannel = new MessageChannel();

    messageChannel.port1.onmessage = function (event) {
      if (event.data && event.data.error) {
        reject(event.data.error);
      } else {
        resolve(event.data && event.data.result);
      }
    };

    if (navigator.serviceWorker && navigator.serviceWorker.controller) {
      navigator.serviceWorker.controller.postMessage(message, [messageChannel.port2]);
    } else {
      reject("Service worker controller is not available");
    }
  });
}

async function cacheRequirements(requirements) {
  requirements = requirements || [];

  if (!Array.isArray(requirements)) {
    requirements = [requirements];
  }

  for (let req of requirements) {
    //remove prefix
    if (req.startsWith("js:")) req = req.slice(3);
    if (req.startsWith("css:")) req = req.slice(4);
    if (req.startsWith("cache:")) req = req.slice(6);
    if (!req.startsWith("http")) continue;
    await cacheUrlInServiceWorker(req).catch(e => {
      console.error(e);
    });
  }
}
function setupServiceWorker(baseUrl, targetOrigin, cacheCallback) {
  // register service worker for offline access
  if ("serviceWorker" in navigator) {
    baseUrl = baseUrl || "/";
    navigator.serviceWorker.register(baseUrl + "plugin-service-worker.js").then(function (registration) {
      // Registration was successful
      console.log("ServiceWorker registration successful with scope: ", registration.scope);
    }, function (err) {
      // registration failed :(
      console.log("ServiceWorker registration failed: ", err);
    });
    targetOrigin = targetOrigin || "*";
    cacheCallback = cacheCallback || cacheRequirements;

    if (cacheCallback && typeof cacheCallback !== "function") {
      throw new Error("config.cache_requirements must be a function");
    }

    window.addEventListener("message", function (e) {
      if (targetOrigin === "*" || e.origin === targetOrigin) {
        const m = e.data;

        if (m.type === "cacheRequirements") {
          cacheCallback(m.requirements);
        }
      }
    });
  }
} //#Source https://bit.ly/2neWfJ2

function urlJoin(...args) {
  return args.join("/").replace(/[\\/]+/g, "/").replace(/^(.+):\\//, "$1://").replace(/^file:/, "file:/").replace(/\\/(\\?|&|#[^!])/g, "$1").replace(/\\?/g, "&").replace("&", "?");
}
class MessageEmitter {
  constructor(debug) {
    this._event_handlers = {};
    this._once_handlers = {};
    this._debug = debug;
  }

  emit() {
    throw new Error("emit is not implemented");
  }

  on(event, handler) {
    if (!this._event_handlers[event]) {
      this._event_handlers[event] = [];
    }

    this._event_handlers[event].push(handler);
  }

  once(event, handler) {
    handler.___event_run_once = true;
    this.on(event, handler);
  }

  off(event, handler) {
    if (!event && !handler) {
      // remove all events handlers
      this._event_handlers = {};
    } else if (event && !handler) {
      // remove all hanlders for the event
      if (this._event_handlers[event]) this._event_handlers[event] = [];
    } else {
      // remove a specific handler
      if (this._event_handlers[event]) {
        const idx = this._event_handlers[event].indexOf(handler);

        if (idx >= 0) {
          this._event_handlers[event].splice(idx, 1);
        }
      }
    }
  }

  _fire(event, data) {
    if (this._event_handlers[event]) {
      var i = this._event_handlers[event].length;

      while (i--) {
        const handler = this._event_handlers[event][i];

        try {
          handler(data);
        } catch (e) {
          console.error(e);
        } finally {
          if (handler.___event_run_once) {
            this._event_handlers[event].splice(i, 1);
          }
        }
      }
    } else {
      if (this._debug) {
        console.warn("unhandled event", event, data);
      }
    }
  }

}

/***/ })

/******/ });
//# sourceMappingURL=plugin.webworker.js.map`,null)}},"./src/pluginCore.js":function(n,t,r){r.r(t),r.d(t,"connectRPC",function(){return i});var s=r("./src/rpc.js");function i(o,l){l=l||{};const f={},u=new s.RPC(o,l,f);u.on("getInterface",function(){a()}),u.on("remoteReady",function(){const _=u.getRemote()||{};_.registerCodec=function(b){if(!b.name||!b.encoder&&!b.decoder)throw new Error("Invalid codec format, please make sure you provide a name, type, encoder and decoder.");if(b.type)for(let c of Object.keys(f))(f[c].type===b.type||c===b.name)&&(delete f[c],console.warn("Remove duplicated codec: "+c));f[b.name]=b},_.init=function(b){u.setInterface({setup(){}},b)},_.disposeObject=function(b){u.disposeObject(b)},_.export=function(b,c){u.setInterface(b,c)},_.onLoad=function(b){b=m(b),g?b():y.push(b)},_.dispose=function(b){u.disconnect()},_._rpc=u,typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?(self.api=_,self.postMessage({type:"imjoy_remote_api_ready"}),self.dispatchEvent(new CustomEvent("imjoy_remote_api_ready",{detail:_}))):window.dispatchEvent(new CustomEvent("imjoy_remote_api_ready",{detail:_}))});let g=!1;const y=[],a=function(){if(!g){g=!0;let _;for(;_=y.pop();)_()}},m=function(_){const b=typeof _;if(b!=="function"){const c="A function may only be subsribed to the event, "+b+" was provided instead";throw new Error(c)}return _};return u}},"./src/pluginIframe.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Connection",function(){return Connection}),__webpack_require__.d(__webpack_exports__,"default",function(){return setupIframe});var _pluginCore_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/pluginCore.js"),_rpc_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/rpc.js"),_utils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils.js");function _htmlToElement(n){var t=document.createElement("template");return n=n.trim(),t.innerHTML=n,t.content.firstChild}const _inWebWorker=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;async function executeEsModule(n){const t="data:text/javascript;charset=utf-8,"+encodeURIComponent(n);await __vitePreload(()=>import(t),__vite__mapDeps([]))}class Connection extends _utils_js__WEBPACK_IMPORTED_MODULE_2__.MessageEmitter{constructor(n){super(n&&n.debug),this.config=n||{},this.peer_id=Object(_utils_js__WEBPACK_IMPORTED_MODULE_2__.randId)()}connect(){this.config.target_origin=this.config.target_origin||"*",this.config.broadcastChannel?this.broadcastChannel=new BroadcastChannel(this.config.broadcastChannel):this.broadcastChannel=null,this.broadcastChannel?this.broadcastChannel.addEventListener("message",this):globalThis.addEventListener("message",this),this.emit({type:"initialized",config:this.config,origin:globalThis.location.origin,peer_id:this.peer_id}),this._fire("connected")}handleEvent(n){n.type==="message"&&(this.broadcastChannel||this.config.target_origin==="*"||!n.origin||n.origin===this.config.target_origin)&&(n.data.peer_id===this.peer_id?this._fire(n.data.type,n.data):this.config.debug&&console.log(`connection peer id mismatch ${n.data.peer_id} !== ${this.peer_id}`))}disconnect(){this._fire("beforeDisconnect"),globalThis.removeEventListener("message",this),this._fire("disconnected")}emit(n){let t;this.broadcastChannel?this.broadcastChannel.postMessage(n):n.__transferables__?(t=n.__transferables__,delete n.__transferables__):_inWebWorker?self.postMessage(n,t):parent.postMessage(n,this.config.target_origin,t)}async execute(code){try{if(code.type==="requirements")await Object(_utils_js__WEBPACK_IMPORTED_MODULE_2__.loadRequirementsInWindow)(code.requirements);else if(code.type==="script")if(code.src){var script_node=document.createElement("script");script_node.setAttribute("type",code.attrs.type),script_node.setAttribute("src",code.src),document.head.appendChild(script_node)}else if(code.content&&code.attrs.lang==="javascript")code.attrs.type==="module"?await executeEsModule(code.content):eval(code.content);else{var node=document.createElement("script");for(let n in code.attrs)node.setAttribute(n,code.attrs[n]);node.appendChild(document.createTextNode(code.content)),document.body.appendChild(node)}else if(code.type==="style"){const n=document.createElement("style");code.src&&(n.src=code.src),n.innerHTML=code.content,document.head.appendChild(n)}else if(code.type==="link"){const n=document.createElement("link");code.rel&&(n.rel=code.rel),code.href&&(n.href=code.href),code.attrs&&code.attrs.type&&(n.type=code.attrs.type),document.head.appendChild(n)}else if(code.type==="html")document.body.appendChild(_htmlToElement(code.content));else throw"unsupported code type.";_inWebWorker?self.postMessage({type:"executed"}):parent.postMessage({type:"executed"},this.config.target_origin)}catch(n){console.error("failed to execute scripts: ",code,n),_inWebWorker?self.postMessage({type:"executed",error:n.stack||String(n)}):parent.postMessage({type:"executed",error:n.stack||String(n)},this.config.target_origin)}}}function setupIframe(n){n=n||{},n.dedicated_thread=!1,n.lang="javascript",n.api_version=_rpc_js__WEBPACK_IMPORTED_MODULE_1__.API_VERSION;const t=new Connection(n);Object(_pluginCore_js__WEBPACK_IMPORTED_MODULE_0__.connectRPC)(t,n),t.connect()}},"./src/rpc.js":function(n,t,r){r.r(t),r.d(t,"API_VERSION",function(){return i}),r.d(t,"RPC",function(){return u});var s=r("./src/utils.js");const i="0.2.3",o=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;function l(y,a){const m=new Uint8Array(y.byteLength+a.byteLength);return m.set(new Uint8Array(y),0),m.set(new Uint8Array(a),y.byteLength),m.buffer}function f(y,a){if(!a)throw new Error("undefined index");return typeof a=="string"?f(y,a.split(".")):a.length===0?y:f(y[a[0]],a.slice(1))}class u extends s.MessageEmitter{constructor(a,m,_){super(m&&m.debug),this._connection=a,this.config=m||{},this._codecs=_||{},this._object_store={},this._method_weakmap=new WeakMap,this._object_weakmap=new WeakMap,this._local_api=null,this._remote_set=!1;const b=this.config.name;this._connection.execute=this._connection.execute||function(){throw new Error(`connection.execute not implemented (in "${b}")`)},this._store=new g,this._method_refs=new g,this._method_refs.onReady(()=>{this._fire("remoteIdle")}),this._method_refs.onBusy(()=>{this._fire("remoteBusy")}),this._setupMessageHanlders()}init(){this._connection.emit({type:"initialized",config:this.config,peer_id:this._connection.peer_id})}setConfig(a){if(a)for(const m of Object.keys(a))this.config[m]=a[m]}getRemoteCallStack(){return this._method_refs.getStack()}getRemote(){return this._remote_interface}setInterface(a,m){if(m=m||{},this.config.name=m.name||this.config.name,this.config.description=m.description||this.config.description,this.config.forwarding_functions)for(let _ of this.config.forwarding_functions){const b=this._remote_interface;b[_]&&(a.constructor===Object?a[_]||(a[_]=(...c)=>{b[_](...c)}):a.constructor.constructor===Function&&(a.constructor.prototype[_]||(a.constructor.prototype[_]=(...c)=>{b[_](...c)})))}return this._local_api=a,this._remote_set?this.sendInterface():this._fire("interfaceAvailable"),new Promise(_=>{this.once("interfaceSetAsRemote",_)})}sendInterface(){if(!this._local_api)throw new Error("interface is not set.");this._encode(this._local_api,!0).then(a=>{this._connection.emit({type:"setInterface",api:a})})}_disposeObject(a){if(this._object_store[a])delete this._object_store[a];else throw new Error(`Object (id=${a}) not found.`)}disposeObject(a){return new Promise((m,_)=>{if(this._object_weakmap.has(a)){const b=this._object_weakmap.get(a);this._connection.once("disposed",c=>{c.error?_(new Error(c.error)):m()}),this._connection.emit({type:"disposeObject",object_id:b})}else throw new Error("Invalid object")})}_setupMessageHanlders(){this._connection.on("init",this.init),this._connection.on("execute",a=>{Promise.resolve(this._connection.execute(a.code)).then(()=>{this._connection.emit({type:"executed"})}).catch(m=>{console.error(m),this._connection.emit({type:"executed",error:String(m)})})}),this._connection.on("method",async a=>{let m,_,b,c,w,S;try{a.promise&&([m,_]=await this._unwrap(a.promise,!1));const E=this._object_store[a.object_id];if(b=f(E,a.name),a.name.includes(".")){const I=a.name.split("."),A=I.slice(0,I.length-1).join(".");c=f(E,A)}else c=E;w=await this._unwrap(a.args,!0),a.promise?(S=b.apply(c,w),S instanceof Promise||b.constructor&&b.constructor.name==="AsyncFunction"?S.then(m).catch(_):m(S)):b.apply(c,w)}catch(E){console.error(this.config.name,E),_&&_(E)}}),this._connection.on("callback",async a=>{let m,_,b,c,w;try{if(a.promise&&([m,_]=await this._unwrap(a.promise,!1)),a.promise){if(b=this._store.fetch(a.id),c=await this._unwrap(a.args,!0),!b)throw new Error("Callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");w=b.apply(null,c),w instanceof Promise||b.constructor&&b.constructor.name==="AsyncFunction"?w.then(m).catch(_):m(w)}else{if(b=this._store.fetch(a.id),c=await this._unwrap(a.args,!0),!b)throw new Error("Please notice that callback function can only called once, if you want to call a function for multiple times, please make it as a plugin api function. See https://imjoy.io/docs for more details.");b.apply(null,c)}}catch(S){console.error(this.config.name,S),_&&_(S)}}),this._connection.on("disposeObject",a=>{try{this._disposeObject(a.object_id),this._connection.emit({type:"disposed"})}catch(m){console.error(m),this._connection.emit({type:"disposed",error:String(m)})}}),this._connection.on("setInterface",a=>{this._setRemoteInterface(a.api)}),this._connection.on("getInterface",()=>{this._fire("getInterface"),this._local_api?this.sendInterface():this.once("interfaceAvailable",()=>{this.sendInterface()})}),this._connection.on("interfaceSetAsRemote",()=>{this._remote_set=!0,this._fire("interfaceSetAsRemote")}),this._connection.on("disconnect",()=>{this._fire("beforeDisconnect"),this._connection.disconnect(),this._fire("disconnected")})}requestRemote(){this._connection.emit({type:"getInterface"})}_ndarray(a,m,_){const b=Object(s.typedArrayToDtype)(a);if(_&&_!==b)throw"dtype doesn't match the type of the array: "+b+" != "+_;return m=m||[a.length],{_rtype:"ndarray",_rvalue:a.buffer,_rshape:m,_rdtype:b}}_setRemoteInterface(a){this._decode(a).then(m=>{if(this._remote_interface){for(let _ in this._remote_interface)delete this._remote_interface[_];Object.assign(this._remote_interface,m)}else this._remote_interface=m;this._fire("remoteReady"),this._reportRemoteSet()})}_genRemoteMethod(a,m,_){const b=this,c=function(){return new Promise(async(w,S)=>{let E=null;try{E=b._method_refs.put(_?_+"/"+m:m);const I=function(){return E!==null&&b._method_refs.fetch(E),w.apply(this,arguments)},A=function(){return E!==null&&b._method_refs.fetch(E),S.apply(this,arguments)},T=await b._wrap([I,A]);I.__promise_pair=T[1]._rvalue,A.__promise_pair=T[0]._rvalue;let O=Array.prototype.slice.call(arguments);const C=O.length,k=C>0&&typeof O[C-1]=="object"&&O[C-1]!==null&&O[C-1]._rkwargs;k&&delete O[C-1]._rkwargs,m==="register"||m==="registerService"||m==="register_service"||m==="export"||m==="on"?O=await b._wrap(O,!0):O=await b._wrap(O);const P=O.__transferables__;P&&delete O.__transferables__,b._connection.emit({type:"method",target_id:a,name:m,object_id:_,args:O,promise:T,with_kwargs:k},P)}catch(I){E&&b._method_refs.fetch(E),S(`Failed to exectue remote method (interface: ${_||b.id}, method: ${m}), error: ${I}`)}})};return c.__remote_method=!0,c}_reportRemoteSet(){this._connection.emit({type:"interfaceSetAsRemote"})}async _encode(a,m,_){const b=typeof a;if(b==="number"||b==="string"||b==="boolean"||a===null||a===void 0||a instanceof ArrayBuffer)return a;let c;if(typeof a=="function"){if(m){if(!_)throw new Error("objectId is not specified.");c={_rtype:"interface",_rtarget_id:this._connection.peer_id,_rintf:_,_rvalue:m},this._method_weakmap.set(a,c)}else if(this._method_weakmap.has(a))c=this._method_weakmap.get(a);else{const I=this._store.put(a);c={_rtype:"callback",_rtarget_id:this._connection.peer_id,_rname:a.constructor&&a.constructor.name||I,_rvalue:I}}return c}if(a.constructor instanceof Object&&a._rtype){if(a._rintf){const I=a._rtype;delete a._rtype,c=await this._encode(a,m,_),c._rtype=I}else c=a;return c}const w=[],S=a._transfer,E=Array.isArray(a);for(let I of Object.keys(this._codecs)){const A=this._codecs[I];if(A.encoder&&a instanceof A.type){let T=await Promise.resolve(A.encoder(a));if(T&&!T._rtype&&(T._rtype=A.name),T&&T._rintf){const O=T._rtype;delete T._rtype,T=await this._encode(T,m,_),T._rtype=O}return c=T,c}}if(typeof tf<"u"&&tf.Tensor&&a instanceof tf.Tensor){const I=a.dataSync();(a._transfer||S)&&(w.push(I.buffer),delete a._transfer),c={_rtype:"ndarray",_rvalue:I.buffer,_rshape:a.shape,_rdtype:a.dtype}}else if(typeof nj<"u"&&nj.NdArray&&a instanceof nj.NdArray){const I=Object(s.typedArrayToDtype)(a.selection.data);(a._transfer||S)&&(w.push(a.selection.data.buffer),delete a._transfer),c={_rtype:"ndarray",_rvalue:a.selection.data.buffer,_rshape:a.shape,_rdtype:I}}else if(a instanceof Error)console.error(a),c={_rtype:"error",_rvalue:a.toString()};else if(typeof File<"u"&&a instanceof File)c={_rtype:"file",_rvalue:a,_rpath:a._path||a.webkitRelativePath};else if(a!==Object(a)||a instanceof Boolean||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof ImageData||typeof FileList<"u"&&a instanceof FileList||typeof FileSystemDirectoryHandle<"u"&&a instanceof FileSystemDirectoryHandle||typeof FileSystemFileHandle<"u"&&a instanceof FileSystemFileHandle||typeof FileSystemHandle<"u"&&a instanceof FileSystemHandle||typeof FileSystemWritableFileStream<"u"&&a instanceof FileSystemWritableFileStream)c=a;else if(typeof File<"u"&&a instanceof File)c={_rtype:"file",_rname:a.name,_rmime:a.type,_rvalue:a,_rpath:a._path||a.webkitRelativePath};else if(a instanceof Blob)c={_rtype:"blob",_rvalue:a};else if(a instanceof o){(a._transfer||S)&&(w.push(a.buffer),delete a._transfer);const I=Object(s.typedArrayToDtype)(a);c={_rtype:"typedarray",_rvalue:a.buffer,_rdtype:I}}else if(a instanceof DataView)(a._transfer||S)&&(w.push(a.buffer),delete a._transfer),c={_rtype:"memoryview",_rvalue:a.buffer};else if(a instanceof Set)c={_rtype:"set",_rvalue:await this._encode(Array.from(a),m)};else if(a instanceof Map)c={_rtype:"orderedmap",_rvalue:await this._encode(Array.from(a),m)};else if(a.constructor instanceof Object||Array.isArray(a)){c=E?[]:{};let I;if(a.constructor===Object||Array.isArray(a))I=Object.keys(a);else{if(a.constructor===Function)throw new Error("Please instantiate the class before exportting it.");if(a.constructor.constructor===Function)I=Object.getOwnPropertyNames(Object.getPrototypeOf(a)).concat(Object.keys(a)),m=!0;else throw Error("Unsupported interface type")}let A=!1;if(a._rintf||m){_||(typeof a._rintf=="string"&&a._rintf.length>0?_=a._rintf:_=Object(s.randId)(),this._object_store[_]&&console.warn(`Overwritting interface object with the same id: ${_}`),this._object_store[_]=a);for(let T of I)T!=="constructor"&&(T.startsWith("_")||(c[T]=await this._encode(a[T],typeof m=="string"?m+"."+T:T,_),typeof a[T]=="function"&&(A=!0)));A&&(c._rintf=_),a.on&&typeof a.on=="function"&&a.on("close",()=>{delete this._object_store[_]})}else for(let T of I)["hasOwnProperty","constructor"].includes(T)||(c[T]=await this._encode(a[T]))}else if(typeof a=="object"){const I=Object.getOwnPropertyNames(Object.getPrototypeOf(a)).concat(Object.keys(a)),A=Object(s.randId)();for(let T of I)["hasOwnProperty","constructor"].includes(T)||(c[T]=await this._encode(a[T],T,c));c._rintf=A}else throw"imjoy-rpc: Unsupported data type:"+a;if(w.length>0&&(c.__transferables__=w),!c)throw new Error("Failed to encode object");return c}async _decode(a,m){if(!a)return a;let _;if(a._rtype)if(this._codecs[a._rtype]&&this._codecs[a._rtype].decoder){if(a._rintf){const b=a._rtype;delete a._rtype,a=await this._decode(a,m),a._rtype=b}_=await Promise.resolve(this._codecs[a._rtype].decoder(a))}else if(a._rtype==="callback")_=this._genRemoteCallback(a._rtarget_id,a._rvalue,m);else if(a._rtype==="interface")_=this._genRemoteMethod(a._rtarget_id,a._rvalue,a._rintf);else if(a._rtype==="ndarray")if(typeof nj<"u"&&nj.array)Array.isArray(a._rvalue)&&(a._rvalue=a._rvalue.reduce(l)),_=nj.array(new Uint8(a._rvalue),a._rdtype).reshape(a._rshape);else if(typeof tf<"u"&&tf.Tensor){Array.isArray(a._rvalue)&&(a._rvalue=a._rvalue.reduce(l));const b=s.dtypeToTypedArray[a._rdtype];_=tf.tensor(new b(a._rvalue),a._rshape,a._rdtype)}else _=a;else if(a._rtype==="error")_=new Error(a._rvalue);else if(a._rtype==="file")a._rvalue instanceof File?(_=a._rvalue,_._path=a._rpath):(_=new File([a._rvalue],a._rname,{type:a._rmime}),_._path=a._rpath);else if(a._rtype==="typedarray"){const b=s.dtypeToTypedArray[a._rdtype];if(!b)throw new Error("unsupported dtype: "+a._rdtype);_=new b(a._rvalue)}else if(a._rtype==="memoryview")_=new DataView(a._rvalue);else if(a._rtype==="blob")a._rvalue instanceof Blob?_=a._rvalue:_=new Blob([a._rvalue],{type:a._rmime});else if(a._rtype==="orderedmap")_=new Map(await this._decode(a._rvalue,m));else if(a._rtype==="set")_=new Set(await this._decode(a._rvalue,m));else if(a._rintf){const b=a._rtype;delete a._rtype,_=await this._decode(a,m),_._rtype=b}else _=a;else if(a.constructor===Object||Array.isArray(a)){const b=Array.isArray(a);_=b?[]:{};for(let c of Object.keys(a))if(b||a.hasOwnProperty(c)){const w=a[c];_[c]=await this._decode(w,m)}}else _=a;if(_===void 0)throw new Error("Failed to decode object");return a._rintf&&this._object_weakmap.set(_,a._rintf),_}async _wrap(a,m){return await this._encode(a,m)}async _unwrap(a,m){return await this._decode(a,m)}_genRemoteCallback(a,m,_){const b=this;let c;return _?(c=function(){return new Promise(async(w,S)=>{const E=await b._wrap(Array.prototype.slice.call(arguments)),I=E.length,A=I>0&&typeof E[I-1]=="object"&&E[I-1]!==null&&E[I-1]._rkwargs;A&&delete E[I-1]._rkwargs;const T=E.__transferables__;T&&delete E.__transferables__;const O=await b._wrap([w,S]);w.__promise_pair=O[1]._rvalue,S.__promise_pair=O[0]._rvalue;try{b._connection.emit({type:"callback",target_id:a,id:m,args:E,promise:O,with_kwargs:A},T)}catch{S(`Failed to exectue remote callback ( id: ${m}).`)}})},c):(c=async function(){const w=await b._wrap(Array.prototype.slice.call(arguments)),S=w.length,E=S>0&&typeof w[S-1]=="object"&&w[S-1]!==null&&w[S-1]._rkwargs;E&&delete w[S-1]._rkwargs;const I=w.__transferables__;return I&&delete w.__transferables__,b._connection.emit({type:"callback",target_id:a,id:m,args:w,with_kwargs:E},I)},c)}reset(){this._event_handlers={},this._once_handlers={},this._remote_interface=null,this._object_store={},this._method_weakmap=new WeakMap,this._object_weakmap=new WeakMap,this._local_api=null,this._store=new g,this._method_refs=new g}disconnect(){this._connection.emit({type:"disconnect"}),this.reset(),setTimeout(()=>{this._connection.disconnect()},2e3)}}class g{constructor(){this._store={},this._indices=[0],this._readyHandler=function(){},this._busyHandler=function(){},this._readyHandler()}onReady(a){this._readyHandler=a||function(){}}onBusy(a){this._busyHandler=a||function(){}}getStack(){return Object.keys(this._store).length}_genId(){let a;return this._indices.length===1?a=this._indices[0]++:a=this._indices.shift(),a}_releaseId(a){for(let m=0;m<this._indices.length;m++)if(a<this._indices[m]){this._indices.splice(m,0,a);break}for(let m=this._indices.length-1;m>=0&&this._indices[m]-1===this._indices[m-1];m--)this._indices.pop()}put(a){this._busyHandler&&Object.keys(this._store).length===0&&this._busyHandler();const m=this._genId();return this._store[m]=a,m}fetch(a){const m=this._store[a];return m&&!m.__remote_method&&(delete this._store[a],this._releaseId(a),this._readyHandler&&Object.keys(this._store).length===0&&this._readyHandler()),m&&m.__promise_pair&&this.fetch(m.__promise_pair),m}}},"./src/socketIOMain.js":function(n,t,r){r.r(t),r.d(t,"Connection",function(){return g}),r.d(t,"connectToServer",function(){return y});var s=r("./src/pluginCore.js"),i=r("./src/rpc.js");r.d(t,"RPC",function(){return i.RPC}),r.d(t,"API_VERSION",function(){return i.API_VERSION});var o=r("./src/utils.js");r.d(t,"loadRequirements",function(){return o.loadRequirements});var l=r("./node_modules/socket.io-client/build/esm/index.js"),f=r("./src/main.js");r.d(t,"setupRPC",function(){return f.setupRPC}),r.d(t,"waitForInitialization",function(){return f.waitForInitialization});var u=r("./package.json");r.d(t,"VERSION",function(){return u.version});class g extends o.MessageEmitter{constructor(m){super(m&&m.debug),this.config=m||{},this.peer_id=Object(o.randId)()}init(){return new Promise((m,_)=>{const b=this.config,c=b.server_url,w={};b.token&&(w.Authorization="Bearer "+b.token);const S=new URL(c).pathname,E=Object(l.default)(c,{withCredentials:!0,extraHeaders:w,path:(S.endsWith("/")?S.slice(0,-1):S)+"/socket.io"});let I=!1;E.on("connect",()=>{if(I){console.warn("Skipping reconnect to the server");return}E.emit("register_plugin",b,A=>{if(!A.success){console.error(A.detail),_(A.detail);return}I=!0,this.plugin_id=A.plugin_id,E.on("plugin_message",T=>{T.peer_id===this.peer_id?this._fire(T.type,T):this.config.debug&&console.log(`connection peer id mismatch ${T.peer_id} !== ${this.peer_id}`)}),this.once("initialize",()=>{this.rpc?this.rpc.once("remoteReady",()=>{this.rpc.sendInterface()}):this.rpc=Object(s.connectRPC)(this,b),this.connect(),m()}),this.emit({type:"imjoyRPCReady",config:b,peer_id:this.peer_id})}),this._disconnected=!1}),E.on("connect_error",()=>{_("connection error"),this._fire("connectFailure")}),E.on("disconnect",()=>{_("disconnected"),this.disconnect(),this._fire("disconnected")}),this.socket=E})}connect(){this.emit({type:"initialized",config:this.config,origin:globalThis.location.origin,peer_id:this.peer_id}),this._fire("connected")}reset(){this._event_handlers={},this._once_handlers={}}execute(){throw new Error("Execution is not allowed for socketio connection")}disconnect(){this._fire("beforeDisconnect"),this.socket.disconnect(),this.init(),this._fire("disconnected")}emit(m){m.plugin_id=this.plugin_id,this.socket.emit("plugin_message",m,_=>{_.success||this._fire("error",m.detail)})}}function y(a){if(a=a||{},!a.server_url)throw new Error("Server URL is not specified.");return a.name=a.name||Object(o.randId)(),a=Object(o.normalizeConfig)(a),new Promise((m,_)=>{const b=w=>{const S=w.detail;a.expose_api_globally&&(globalThis.api=S),m(S),globalThis.removeEventListener("imjoy_remote_api_ready",b)};globalThis.addEventListener("imjoy_remote_api_ready",b),a=a||{},a.dedicated_thread=!1,a.lang="javascript",a.api_version=i.API_VERSION,new g(a).init().catch(_)})}},"./src/utils.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"randId",function(){return randId}),__webpack_require__.d(__webpack_exports__,"dtypeToTypedArray",function(){return dtypeToTypedArray}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWindow",function(){return loadRequirementsInWindow}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWebworker",function(){return loadRequirementsInWebworker}),__webpack_require__.d(__webpack_exports__,"loadRequirements",function(){return loadRequirements}),__webpack_require__.d(__webpack_exports__,"normalizeConfig",function(){return normalizeConfig}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtypeMapping",function(){return typedArrayToDtypeMapping}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtype",function(){return typedArrayToDtype}),__webpack_require__.d(__webpack_exports__,"cacheRequirements",function(){return cacheRequirements}),__webpack_require__.d(__webpack_exports__,"setupServiceWorker",function(){return setupServiceWorker}),__webpack_require__.d(__webpack_exports__,"urlJoin",function(){return urlJoin}),__webpack_require__.d(__webpack_exports__,"MessageEmitter",function(){return MessageEmitter});function randId(){return Math.random().toString(36).substr(2,10)+new Date().getTime()}const dtypeToTypedArray={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,array:Array};async function loadRequirementsInWindow(n){function t(o){return new Promise((l,f)=>{var u=document.createElement("script");u.src=o,u.type="text/javascript",u.onload=l,u.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&l()},u.onerror=f,document.head.appendChild(u)})}async function r(){for(var o=Array.prototype.slice.call(arguments),l=o.length,f=0;f<l;f++)await t(o[f])}if(n&&(Array.isArray(n)||typeof n=="string"))try{var s;if(n=typeof n=="string"?[n]:n,Array.isArray(n))for(var i=0;i<n.length;i++)n[i].toLowerCase().endsWith(".css")||n[i].startsWith("css:")?(n[i].startsWith("css:")&&(n[i]=n[i].slice(4)),s=document.createElement("link"),s.rel="stylesheet",s.href=n[i],document.head.appendChild(s)):n[i].toLowerCase().endsWith(".mjs")||n[i].startsWith("mjs:")?(n[i].startsWith("mjs:")&&(n[i]=n[i].slice(4)),await __vitePreload(()=>import(n[i]),__vite__mapDeps([]))):n[i].toLowerCase().endsWith(".js")||n[i].startsWith("js:")?(n[i].startsWith("js:")&&(n[i]=n[i].slice(3)),await r(n[i])):n[i].startsWith("http")?await r(n[i]):n[i].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[i]);else throw"unsupported requirements definition"}catch{throw"failed to import required scripts: "+n.toString()}}async function loadRequirementsInWebworker(n){if(n&&(Array.isArray(n)||typeof n=="string"))try{Array.isArray(n)||(n=[n]);for(var t=0;t<n.length;t++){if(n[t].toLowerCase().endsWith(".css")||n[t].startsWith("css:"))throw"unable to import css in a webworker";n[t].toLowerCase().endsWith(".js")||n[t].startsWith("js:")?(n[t].startsWith("js:")&&(n[t]=n[t].slice(3)),importScripts(n[t])):n[t].startsWith("http")?importScripts(n[t]):n[t].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[t])}}catch{throw"failed to import required scripts: "+n.toString()}}function loadRequirements(n){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?loadRequirementsInWebworker(n):loadRequirementsInWindow(n)}function normalizeConfig(n){return n.version=n.version||"0.1.0",n.description=n.description||`[TODO: add description for ${n.name} ]`,n.type=n.type||"rpc-window",n.id=n.id||randId(),n.target_origin=n.target_origin||"*",n.allow_execution=n.allow_execution||!1,n=Object.keys(n).reduce((t,r)=>(typeof n[r]!="function"&&(t[r]=n[r]),t),{}),n}const typedArrayToDtypeMapping={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"array"},typedArrayToDtypeKeys=[];for(const arrType of Object.keys(typedArrayToDtypeMapping))typedArrayToDtypeKeys.push(eval(arrType));function typedArrayToDtype(n){let t=typedArrayToDtypeMapping[n.constructor.name];if(!t){const r=Object.getPrototypeOf(n);for(const s of typedArrayToDtypeKeys)if(r instanceof s){t=typedArrayToDtypeMapping[s.name];break}}return t}function cacheUrlInServiceWorker(n){return new Promise(function(t,r){const s={command:"add",url:n};if(!navigator.serviceWorker||!navigator.serviceWorker.register){r("Service worker is not supported.");return}const i=new MessageChannel;i.port1.onmessage=function(o){o.data&&o.data.error?r(o.data.error):t(o.data&&o.data.result)},navigator.serviceWorker&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(s,[i.port2]):r("Service worker controller is not available")})}async function cacheRequirements(n){n=n||[],Array.isArray(n)||(n=[n]);for(let t of n)t.startsWith("js:")&&(t=t.slice(3)),t.startsWith("css:")&&(t=t.slice(4)),t.startsWith("cache:")&&(t=t.slice(6)),t.startsWith("http")&&await cacheUrlInServiceWorker(t).catch(r=>{console.error(r)})}function setupServiceWorker(n,t,r){if("serviceWorker"in navigator){if(n=n||"/",navigator.serviceWorker.register(n+"plugin-service-worker.js").then(function(s){console.log("ServiceWorker registration successful with scope: ",s.scope)},function(s){console.log("ServiceWorker registration failed: ",s)}),t=t||"*",r=r||cacheRequirements,r&&typeof r!="function")throw new Error("config.cache_requirements must be a function");window.addEventListener("message",function(s){if(t==="*"||s.origin===t){const i=s.data;i.type==="cacheRequirements"&&r(i.requirements)}})}}function urlJoin(...n){return n.join("/").replace(/[\/]+/g,"/").replace(/^(.+):\//,"$1://").replace(/^file:/,"file:/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/\?/g,"&").replace("&","?")}class MessageEmitter{constructor(t){this._event_handlers={},this._once_handlers={},this._debug=t}emit(){throw new Error("emit is not implemented")}on(t,r){this._event_handlers[t]||(this._event_handlers[t]=[]),this._event_handlers[t].push(r)}once(t,r){r.___event_run_once=!0,this.on(t,r)}off(t,r){if(!t&&!r)this._event_handlers={};else if(t&&!r)this._event_handlers[t]&&(this._event_handlers[t]=[]);else if(this._event_handlers[t]){const s=this._event_handlers[t].indexOf(r);s>=0&&this._event_handlers[t].splice(s,1)}}_fire(t,r){if(this._event_handlers[t])for(var s=this._event_handlers[t].length;s--;){const i=this._event_handlers[t][s];try{i(r)}catch(o){console.error(o)}finally{i.___event_run_once&&this._event_handlers[t].splice(s,1)}}else this._debug&&console.warn("unhandled event",t,r)}}}})})})(imjoyRpcSocketio);var imjoyRpcSocketioExports=imjoyRpcSocketio.exports,hyphaRpc={exports:{}};(function(module,exports){var define_process_env_default={};(function(t,r){module.exports=r()})(window,function(){return function(n){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return n[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=n,r.c=t,r.d=function(s,i,o){r.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:o})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,i){if(i&1&&(s=r(s)),i&8||i&4&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),i&2&&typeof s!="string")for(var l in s)r.d(o,l,(function(f){return s[f]}).bind(null,l));return o},r.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(i,"a",i),i},r.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},r.p="",r(r.s="./src/hypha/rpc.js")}({"./node_modules/@msgpack/msgpack/dist.es5+esm/CachedKeyDecoder.mjs":function(n,t,r){r.r(t),r.d(t,"CachedKeyDecoder",function(){return l});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),i=16,o=16,l=function(){function f(u,g){u===void 0&&(u=i),g===void 0&&(g=o),this.maxKeyLength=u,this.maxLengthPerKey=g,this.hit=0,this.miss=0,this.caches=[];for(var y=0;y<this.maxKeyLength;y++)this.caches.push([])}return f.prototype.canBeCached=function(u){return u>0&&u<=this.maxKeyLength},f.prototype.find=function(u,g,y){var a=this.caches[y-1];e:for(var m=0,_=a;m<_.length;m++){for(var b=_[m],c=b.bytes,w=0;w<y;w++)if(c[w]!==u[g+w])continue e;return b.str}return null},f.prototype.store=function(u,g){var y=this.caches[u.length-1],a={bytes:u,str:g};y.length>=this.maxLengthPerKey?y[Math.random()*y.length|0]=a:y.push(a)},f.prototype.decode=function(u,g,y){var a=this.find(u,g,y);if(a!=null)return this.hit++,a;this.miss++;var m=Object(s.utf8DecodeJs)(u,g,y),_=Uint8Array.prototype.slice.call(u,g,g+y);return this.store(_,m),m},f}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs":function(n,t,r){r.r(t),r.d(t,"DecodeError",function(){return i});var s=function(){var o=function(l,f){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,g){u.__proto__=g}||function(u,g){for(var y in g)Object.prototype.hasOwnProperty.call(g,y)&&(u[y]=g[y])},o(l,f)};return function(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");o(l,f);function u(){this.constructor=l}l.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)}}(),i=function(o){s(l,o);function l(f){var u=o.call(this,f)||this,g=Object.create(l.prototype);return Object.setPrototypeOf(u,g),Object.defineProperty(u,"name",{configurable:!0,enumerable:!1,value:l.name}),u}return l}(Error)},"./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs":function(n,t,r){r.r(t),r.d(t,"DataViewIndexOutOfBoundsError",function(){return I}),r.d(t,"Decoder",function(){return O});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/prettyByte.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),f=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs"),u=r("./node_modules/@msgpack/msgpack/dist.es5+esm/CachedKeyDecoder.mjs"),g=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs"),y=function(C,k,P,N){function L(F){return F instanceof P?F:new P(function(V){V(F)})}return new(P||(P=Promise))(function(F,V){function j(X){try{U(N.next(X))}catch(J){V(J)}}function K(X){try{U(N.throw(X))}catch(J){V(J)}}function U(X){X.done?F(X.value):L(X.value).then(j,K)}U((N=N.apply(C,k||[])).next())})},a=function(C,k){var P={label:0,sent:function(){if(F[0]&1)throw F[1];return F[1]},trys:[],ops:[]},N,L,F,V;return V={next:j(0),throw:j(1),return:j(2)},typeof Symbol=="function"&&(V[Symbol.iterator]=function(){return this}),V;function j(U){return function(X){return K([U,X])}}function K(U){if(N)throw new TypeError("Generator is already executing.");for(;P;)try{if(N=1,L&&(F=U[0]&2?L.return:U[0]?L.throw||((F=L.return)&&F.call(L),0):L.next)&&!(F=F.call(L,U[1])).done)return F;switch(L=0,F&&(U=[U[0]&2,F.value]),U[0]){case 0:case 1:F=U;break;case 4:return P.label++,{value:U[1],done:!1};case 5:P.label++,L=U[1],U=[0];continue;case 7:U=P.ops.pop(),P.trys.pop();continue;default:if(F=P.trys,!(F=F.length>0&&F[F.length-1])&&(U[0]===6||U[0]===2)){P=0;continue}if(U[0]===3&&(!F||U[1]>F[0]&&U[1]<F[3])){P.label=U[1];break}if(U[0]===6&&P.label<F[1]){P.label=F[1],F=U;break}if(F&&P.label<F[2]){P.label=F[2],P.ops.push(U);break}F[2]&&P.ops.pop(),P.trys.pop();continue}U=k.call(C,P)}catch(X){U=[6,X],L=0}finally{N=F=0}if(U[0]&5)throw U[1];return{value:U[0]?U[1]:void 0,done:!0}}},m=function(C){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k=C[Symbol.asyncIterator],P;return k?k.call(C):(C=typeof __values=="function"?__values(C):C[Symbol.iterator](),P={},N("next"),N("throw"),N("return"),P[Symbol.asyncIterator]=function(){return this},P);function N(F){P[F]=C[F]&&function(V){return new Promise(function(j,K){V=C[F](V),L(j,K,V.done,V.value)})}}function L(F,V,j,K){Promise.resolve(K).then(function(U){F({value:U,done:j})},V)}},_=function(C){return this instanceof _?(this.v=C,this):new _(C)},b=function(C,k,P){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var N=P.apply(C,k||[]),L,F=[];return L={},V("next"),V("throw"),V("return"),L[Symbol.asyncIterator]=function(){return this},L;function V(Y){N[Y]&&(L[Y]=function(te){return new Promise(function(se,de){F.push([Y,te,se,de])>1||j(Y,te)})})}function j(Y,te){try{K(N[Y](te))}catch(se){J(F[0][3],se)}}function K(Y){Y.value instanceof _?Promise.resolve(Y.value.v).then(U,X):J(F[0][2],Y)}function U(Y){j("next",Y)}function X(Y){j("throw",Y)}function J(Y,te){Y(te),F.shift(),F.length&&j(F[0][0],F[0][1])}},c=function(C){var k=typeof C;return k==="string"||k==="number"},w=-1,S=new DataView(new ArrayBuffer(0)),E=new Uint8Array(S.buffer),I=function(){try{S.getInt8(0)}catch(C){return C.constructor}throw new Error("never reached")}(),A=new I("Insufficient data"),T=new u.CachedKeyDecoder,O=function(){function C(k,P,N,L,F,V,j,K){k===void 0&&(k=i.ExtensionCodec.defaultCodec),P===void 0&&(P=void 0),N===void 0&&(N=o.UINT32_MAX),L===void 0&&(L=o.UINT32_MAX),F===void 0&&(F=o.UINT32_MAX),V===void 0&&(V=o.UINT32_MAX),j===void 0&&(j=o.UINT32_MAX),K===void 0&&(K=T),this.extensionCodec=k,this.context=P,this.maxStrLength=N,this.maxBinLength=L,this.maxArrayLength=F,this.maxMapLength=V,this.maxExtLength=j,this.keyDecoder=K,this.totalPos=0,this.pos=0,this.view=S,this.bytes=E,this.headByte=w,this.stack=[]}return C.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=w,this.stack.length=0},C.prototype.setBuffer=function(k){this.bytes=Object(f.ensureUint8Array)(k),this.view=Object(f.createDataView)(this.bytes),this.pos=0},C.prototype.appendBuffer=function(k){if(this.headByte===w&&!this.hasRemaining(1))this.setBuffer(k);else{var P=this.bytes.subarray(this.pos),N=Object(f.ensureUint8Array)(k),L=new Uint8Array(P.length+N.length);L.set(P),L.set(N,P.length),this.setBuffer(L)}},C.prototype.hasRemaining=function(k){return this.view.byteLength-this.pos>=k},C.prototype.createExtraByteError=function(k){var P=this,N=P.view,L=P.pos;return new RangeError("Extra "+(N.byteLength-L)+" of "+N.byteLength+" byte(s) found at buffer["+k+"]")},C.prototype.decode=function(k){this.reinitializeState(),this.setBuffer(k);var P=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return P},C.prototype.decodeMulti=function(k){return a(this,function(P){switch(P.label){case 0:this.reinitializeState(),this.setBuffer(k),P.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return P.sent(),[3,1];case 3:return[2]}})},C.prototype.decodeAsync=function(k){var P,N,L,F;return y(this,void 0,void 0,function(){var V,j,K,U,X,J,Y,te;return a(this,function(se){switch(se.label){case 0:V=!1,se.label=1;case 1:se.trys.push([1,6,7,12]),P=m(k),se.label=2;case 2:return[4,P.next()];case 3:if(N=se.sent(),!!N.done)return[3,5];if(K=N.value,V)throw this.createExtraByteError(this.totalPos);this.appendBuffer(K);try{j=this.doDecodeSync(),V=!0}catch(de){if(!(de instanceof I))throw de}this.totalPos+=this.pos,se.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return U=se.sent(),L={error:U},[3,12];case 7:return se.trys.push([7,,10,11]),N&&!N.done&&(F=P.return)?[4,F.call(P)]:[3,9];case 8:se.sent(),se.label=9;case 9:return[3,11];case 10:if(L)throw L.error;return[7];case 11:return[7];case 12:if(V){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,j]}throw X=this,J=X.headByte,Y=X.pos,te=X.totalPos,new RangeError("Insufficient data in parsing "+Object(s.prettyByte)(J)+" at "+te+" ("+Y+" in the current buffer)")}})})},C.prototype.decodeArrayStream=function(k){return this.decodeMultiAsync(k,!0)},C.prototype.decodeStream=function(k){return this.decodeMultiAsync(k,!1)},C.prototype.decodeMultiAsync=function(k,P){return b(this,arguments,function(){var L,F,V,j,K,U,X,J,Y;return a(this,function(te){switch(te.label){case 0:L=P,F=-1,te.label=1;case 1:te.trys.push([1,13,14,19]),V=m(k),te.label=2;case 2:return[4,_(V.next())];case 3:if(j=te.sent(),!!j.done)return[3,12];if(K=j.value,P&&F===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(K),L&&(F=this.readArraySize(),L=!1,this.complete()),te.label=4;case 4:te.trys.push([4,9,,10]),te.label=5;case 5:return[4,_(this.doDecodeSync())];case 6:return[4,te.sent()];case 7:return te.sent(),--F===0?[3,8]:[3,5];case 8:return[3,10];case 9:if(U=te.sent(),!(U instanceof I))throw U;return[3,10];case 10:this.totalPos+=this.pos,te.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return X=te.sent(),J={error:X},[3,19];case 14:return te.trys.push([14,,17,18]),j&&!j.done&&(Y=V.return)?[4,_(Y.call(V))]:[3,16];case 15:te.sent(),te.label=16;case 16:return[3,18];case 17:if(J)throw J.error;return[7];case 18:return[7];case 19:return[2]}})})},C.prototype.doDecodeSync=function(){e:for(;;){var k=this.readHeadByte(),P=void 0;if(k>=224)P=k-256;else if(k<192)if(k<128)P=k;else if(k<144){var N=k-128;if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k<160){var N=k-144;if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else{var L=k-160;P=this.decodeUtf8String(L,0)}else if(k===192)P=null;else if(k===194)P=!1;else if(k===195)P=!0;else if(k===202)P=this.readF32();else if(k===203)P=this.readF64();else if(k===204)P=this.readU8();else if(k===205)P=this.readU16();else if(k===206)P=this.readU32();else if(k===207)P=this.readU64();else if(k===208)P=this.readI8();else if(k===209)P=this.readI16();else if(k===210)P=this.readI32();else if(k===211)P=this.readI64();else if(k===217){var L=this.lookU8();P=this.decodeUtf8String(L,1)}else if(k===218){var L=this.lookU16();P=this.decodeUtf8String(L,2)}else if(k===219){var L=this.lookU32();P=this.decodeUtf8String(L,4)}else if(k===220){var N=this.readU16();if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else if(k===221){var N=this.readU32();if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else if(k===222){var N=this.readU16();if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k===223){var N=this.readU32();if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k===196){var N=this.lookU8();P=this.decodeBinary(N,1)}else if(k===197){var N=this.lookU16();P=this.decodeBinary(N,2)}else if(k===198){var N=this.lookU32();P=this.decodeBinary(N,4)}else if(k===212)P=this.decodeExtension(1,0);else if(k===213)P=this.decodeExtension(2,0);else if(k===214)P=this.decodeExtension(4,0);else if(k===215)P=this.decodeExtension(8,0);else if(k===216)P=this.decodeExtension(16,0);else if(k===199){var N=this.lookU8();P=this.decodeExtension(N,1)}else if(k===200){var N=this.lookU16();P=this.decodeExtension(N,2)}else if(k===201){var N=this.lookU32();P=this.decodeExtension(N,4)}else throw new g.DecodeError("Unrecognized type byte: "+Object(s.prettyByte)(k));this.complete();for(var F=this.stack;F.length>0;){var V=F[F.length-1];if(V.type===0)if(V.array[V.position]=P,V.position++,V.position===V.size)F.pop(),P=V.array;else continue e;else if(V.type===1){if(!c(P))throw new g.DecodeError("The type of key must be string or number but "+typeof P);if(P==="__proto__")throw new g.DecodeError("The key __proto__ is not allowed");V.key=P,V.type=2;continue e}else if(V.map[V.key]=P,V.readCount++,V.readCount===V.size)F.pop(),P=V.map;else{V.key=null,V.type=1;continue e}}return P}},C.prototype.readHeadByte=function(){return this.headByte===w&&(this.headByte=this.readU8()),this.headByte},C.prototype.complete=function(){this.headByte=w},C.prototype.readArraySize=function(){var k=this.readHeadByte();switch(k){case 220:return this.readU16();case 221:return this.readU32();default:{if(k<160)return k-144;throw new g.DecodeError("Unrecognized array type byte: "+Object(s.prettyByte)(k))}}},C.prototype.pushMapState=function(k){if(k>this.maxMapLength)throw new g.DecodeError("Max length exceeded: map length ("+k+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:k,key:null,readCount:0,map:{}})},C.prototype.pushArrayState=function(k){if(k>this.maxArrayLength)throw new g.DecodeError("Max length exceeded: array length ("+k+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:k,array:new Array(k),position:0})},C.prototype.decodeUtf8String=function(k,P){var N;if(k>this.maxStrLength)throw new g.DecodeError("Max length exceeded: UTF-8 byte length ("+k+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+P+k)throw A;var L=this.pos+P,F;return this.stateIsMapKey()&&(!((N=this.keyDecoder)===null||N===void 0)&&N.canBeCached(k))?F=this.keyDecoder.decode(this.bytes,L,k):k>l.TEXT_DECODER_THRESHOLD?F=Object(l.utf8DecodeTD)(this.bytes,L,k):F=Object(l.utf8DecodeJs)(this.bytes,L,k),this.pos+=P+k,F},C.prototype.stateIsMapKey=function(){if(this.stack.length>0){var k=this.stack[this.stack.length-1];return k.type===1}return!1},C.prototype.decodeBinary=function(k,P){if(k>this.maxBinLength)throw new g.DecodeError("Max length exceeded: bin length ("+k+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(k+P))throw A;var N=this.pos+P,L=this.bytes.subarray(N,N+k);return this.pos+=P+k,L},C.prototype.decodeExtension=function(k,P){if(k>this.maxExtLength)throw new g.DecodeError("Max length exceeded: ext length ("+k+") > maxExtLength ("+this.maxExtLength+")");var N=this.view.getInt8(this.pos+P),L=this.decodeBinary(k,P+1);return this.extensionCodec.decode(L,N,this.context)},C.prototype.lookU8=function(){return this.view.getUint8(this.pos)},C.prototype.lookU16=function(){return this.view.getUint16(this.pos)},C.prototype.lookU32=function(){return this.view.getUint32(this.pos)},C.prototype.readU8=function(){var k=this.view.getUint8(this.pos);return this.pos++,k},C.prototype.readI8=function(){var k=this.view.getInt8(this.pos);return this.pos++,k},C.prototype.readU16=function(){var k=this.view.getUint16(this.pos);return this.pos+=2,k},C.prototype.readI16=function(){var k=this.view.getInt16(this.pos);return this.pos+=2,k},C.prototype.readU32=function(){var k=this.view.getUint32(this.pos);return this.pos+=4,k},C.prototype.readI32=function(){var k=this.view.getInt32(this.pos);return this.pos+=4,k},C.prototype.readU64=function(){var k=Object(o.getUint64)(this.view,this.pos);return this.pos+=8,k},C.prototype.readI64=function(){var k=Object(o.getInt64)(this.view,this.pos);return this.pos+=8,k},C.prototype.readF32=function(){var k=this.view.getFloat32(this.pos);return this.pos+=4,k},C.prototype.readF64=function(){var k=this.view.getFloat64(this.pos);return this.pos+=8,k},C}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs":function(n,t,r){r.r(t),r.d(t,"DEFAULT_MAX_DEPTH",function(){return f}),r.d(t,"DEFAULT_INITIAL_BUFFER_SIZE",function(){return u}),r.d(t,"Encoder",function(){return g});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs"),f=100,u=2048,g=function(){function y(a,m,_,b,c,w,S,E){a===void 0&&(a=i.ExtensionCodec.defaultCodec),m===void 0&&(m=void 0),_===void 0&&(_=f),b===void 0&&(b=u),c===void 0&&(c=!1),w===void 0&&(w=!1),S===void 0&&(S=!1),E===void 0&&(E=!1),this.extensionCodec=a,this.context=m,this.maxDepth=_,this.initialBufferSize=b,this.sortKeys=c,this.forceFloat32=w,this.ignoreUndefined=S,this.forceIntegerToFloat=E,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return y.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},y.prototype.reinitializeState=function(){this.pos=0},y.prototype.encode=function(a){return this.reinitializeState(),this.doEncode(a,1),this.getUint8Array()},y.prototype.doEncode=function(a,m){if(m>this.maxDepth)throw new Error("Too deep objects in depth "+m);a==null?this.encodeNil():typeof a=="boolean"?this.encodeBoolean(a):typeof a=="number"?this.encodeNumber(a):typeof a=="string"?this.encodeString(a):this.encodeObject(a,m)},y.prototype.ensureBufferSizeToWrite=function(a){var m=this.pos+a;this.view.byteLength<m&&this.resizeBuffer(m*2)},y.prototype.resizeBuffer=function(a){var m=new ArrayBuffer(a),_=new Uint8Array(m),b=new DataView(m);_.set(this.bytes),this.view=b,this.bytes=_},y.prototype.encodeNil=function(){this.writeU8(192)},y.prototype.encodeBoolean=function(a){a===!1?this.writeU8(194):this.writeU8(195)},y.prototype.encodeNumber=function(a){Number.isSafeInteger(a)&&!this.forceIntegerToFloat?a>=0?a<128?this.writeU8(a):a<256?(this.writeU8(204),this.writeU8(a)):a<65536?(this.writeU8(205),this.writeU16(a)):a<4294967296?(this.writeU8(206),this.writeU32(a)):(this.writeU8(207),this.writeU64(a)):a>=-32?this.writeU8(224|a+32):a>=-128?(this.writeU8(208),this.writeI8(a)):a>=-32768?(this.writeU8(209),this.writeI16(a)):a>=-2147483648?(this.writeU8(210),this.writeI32(a)):(this.writeU8(211),this.writeI64(a)):this.forceFloat32?(this.writeU8(202),this.writeF32(a)):(this.writeU8(203),this.writeF64(a))},y.prototype.writeStringHeader=function(a){if(a<32)this.writeU8(160+a);else if(a<256)this.writeU8(217),this.writeU8(a);else if(a<65536)this.writeU8(218),this.writeU16(a);else if(a<4294967296)this.writeU8(219),this.writeU32(a);else throw new Error("Too long string: "+a+" bytes in UTF-8")},y.prototype.encodeString=function(a){var m=5,_=a.length;if(_>s.TEXT_ENCODER_THRESHOLD){var b=Object(s.utf8Count)(a);this.ensureBufferSizeToWrite(m+b),this.writeStringHeader(b),Object(s.utf8EncodeTE)(a,this.bytes,this.pos),this.pos+=b}else{var b=Object(s.utf8Count)(a);this.ensureBufferSizeToWrite(m+b),this.writeStringHeader(b),Object(s.utf8EncodeJs)(a,this.bytes,this.pos),this.pos+=b}},y.prototype.encodeObject=function(a,m){var _=this.extensionCodec.tryToEncode(a,this.context);if(_!=null)this.encodeExtension(_);else if(Array.isArray(a))this.encodeArray(a,m);else if(ArrayBuffer.isView(a))this.encodeBinary(a);else if(typeof a=="object")this.encodeMap(a,m);else throw new Error("Unrecognized object: "+Object.prototype.toString.apply(a))},y.prototype.encodeBinary=function(a){var m=a.byteLength;if(m<256)this.writeU8(196),this.writeU8(m);else if(m<65536)this.writeU8(197),this.writeU16(m);else if(m<4294967296)this.writeU8(198),this.writeU32(m);else throw new Error("Too large binary: "+m);var _=Object(l.ensureUint8Array)(a);this.writeU8a(_)},y.prototype.encodeArray=function(a,m){var _=a.length;if(_<16)this.writeU8(144+_);else if(_<65536)this.writeU8(220),this.writeU16(_);else if(_<4294967296)this.writeU8(221),this.writeU32(_);else throw new Error("Too large array: "+_);for(var b=0,c=a;b<c.length;b++){var w=c[b];this.doEncode(w,m+1)}},y.prototype.countWithoutUndefined=function(a,m){for(var _=0,b=0,c=m;b<c.length;b++){var w=c[b];a[w]!==void 0&&_++}return _},y.prototype.encodeMap=function(a,m){var _=Object.keys(a);this.sortKeys&&_.sort();var b=this.ignoreUndefined?this.countWithoutUndefined(a,_):_.length;if(b<16)this.writeU8(128+b);else if(b<65536)this.writeU8(222),this.writeU16(b);else if(b<4294967296)this.writeU8(223),this.writeU32(b);else throw new Error("Too large map object: "+b);for(var c=0,w=_;c<w.length;c++){var S=w[c],E=a[S];this.ignoreUndefined&&E===void 0||(this.encodeString(S),this.doEncode(E,m+1))}},y.prototype.encodeExtension=function(a){var m=a.data.length;if(m===1)this.writeU8(212);else if(m===2)this.writeU8(213);else if(m===4)this.writeU8(214);else if(m===8)this.writeU8(215);else if(m===16)this.writeU8(216);else if(m<256)this.writeU8(199),this.writeU8(m);else if(m<65536)this.writeU8(200),this.writeU16(m);else if(m<4294967296)this.writeU8(201),this.writeU32(m);else throw new Error("Too large extension object: "+m);this.writeI8(a.type),this.writeU8a(a.data)},y.prototype.writeU8=function(a){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,a),this.pos++},y.prototype.writeU8a=function(a){var m=a.length;this.ensureBufferSizeToWrite(m),this.bytes.set(a,this.pos),this.pos+=m},y.prototype.writeI8=function(a){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,a),this.pos++},y.prototype.writeU16=function(a){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,a),this.pos+=2},y.prototype.writeI16=function(a){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,a),this.pos+=2},y.prototype.writeU32=function(a){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,a),this.pos+=4},y.prototype.writeI32=function(a){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,a),this.pos+=4},y.prototype.writeF32=function(a){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,a),this.pos+=4},y.prototype.writeF64=function(a){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,a),this.pos+=8},y.prototype.writeU64=function(a){this.ensureBufferSizeToWrite(8),Object(o.setUint64)(this.view,this.pos,a),this.pos+=8},y.prototype.writeI64=function(a){this.ensureBufferSizeToWrite(8),Object(o.setInt64)(this.view,this.pos,a),this.pos+=8},y}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs":function(n,t,r){r.r(t),r.d(t,"ExtData",function(){return s});var s=function(){function i(o,l){this.type=o,this.data=l}return i}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs":function(n,t,r){r.r(t),r.d(t,"ExtensionCodec",function(){return o});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs"),o=function(){function l(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(i.timestampExtension)}return l.prototype.register=function(f){var u=f.type,g=f.encode,y=f.decode;if(u>=0)this.encoders[u]=g,this.decoders[u]=y;else{var a=1+u;this.builtInEncoders[a]=g,this.builtInDecoders[a]=y}},l.prototype.tryToEncode=function(f,u){for(var g=0;g<this.builtInEncoders.length;g++){var y=this.builtInEncoders[g];if(y!=null){var a=y(f,u);if(a!=null){var m=-1-g;return new s.ExtData(m,a)}}}for(var g=0;g<this.encoders.length;g++){var y=this.encoders[g];if(y!=null){var a=y(f,u);if(a!=null){var m=g;return new s.ExtData(m,a)}}}return f instanceof s.ExtData?f:null},l.prototype.decode=function(f,u,g){var y=u<0?this.builtInDecoders[-1-u]:this.decoders[u];return y?y(f,u,g):new s.ExtData(u,f)},l.defaultCodec=new l,l}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs":function(n,t,r){r.r(t),r.d(t,"defaultDecodeOptions",function(){return i}),r.d(t,"decode",function(){return o}),r.d(t,"decodeMulti",function(){return l});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs"),i={};function o(f,u){u===void 0&&(u=i);var g=new s.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength);return g.decode(f)}function l(f,u){u===void 0&&(u=i);var g=new s.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength);return g.decodeMulti(f)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/decodeAsync.mjs":function(n,t,r){r.r(t),r.d(t,"decodeAsync",function(){return u}),r.d(t,"decodeArrayStream",function(){return g}),r.d(t,"decodeMultiStream",function(){return y}),r.d(t,"decodeStream",function(){return a});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/stream.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs"),l=function(m,_,b,c){function w(S){return S instanceof b?S:new b(function(E){E(S)})}return new(b||(b=Promise))(function(S,E){function I(O){try{T(c.next(O))}catch(C){E(C)}}function A(O){try{T(c.throw(O))}catch(C){E(C)}}function T(O){O.done?S(O.value):w(O.value).then(I,A)}T((c=c.apply(m,_||[])).next())})},f=function(m,_){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},c,w,S,E;return E={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function I(T){return function(O){return A([T,O])}}function A(T){if(c)throw new TypeError("Generator is already executing.");for(;b;)try{if(c=1,w&&(S=T[0]&2?w.return:T[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,T[1])).done)return S;switch(w=0,S&&(T=[T[0]&2,S.value]),T[0]){case 0:case 1:S=T;break;case 4:return b.label++,{value:T[1],done:!1};case 5:b.label++,w=T[1],T=[0];continue;case 7:T=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(T[0]===6||T[0]===2)){b=0;continue}if(T[0]===3&&(!S||T[1]>S[0]&&T[1]<S[3])){b.label=T[1];break}if(T[0]===6&&b.label<S[1]){b.label=S[1],S=T;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(T);break}S[2]&&b.ops.pop(),b.trys.pop();continue}T=_.call(m,b)}catch(O){T=[6,O],w=0}finally{c=S=0}if(T[0]&5)throw T[1];return{value:T[0]?T[1]:void 0,done:!0}}};function u(m,_){return _===void 0&&(_=o.defaultDecodeOptions),l(this,void 0,void 0,function(){var b,c;return f(this,function(w){return b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength),[2,c.decodeAsync(b)]})})}function g(m,_){_===void 0&&(_=o.defaultDecodeOptions);var b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength);return c.decodeArrayStream(b)}function y(m,_){_===void 0&&(_=o.defaultDecodeOptions);var b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength);return c.decodeStream(b)}function a(m,_){return _===void 0&&(_=o.defaultDecodeOptions),y(m,_)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/encode.mjs":function(n,t,r){r.r(t),r.d(t,"encode",function(){return o});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs"),i={};function o(l,f){f===void 0&&(f=i);var u=new s.Encoder(f.extensionCodec,f.context,f.maxDepth,f.initialBufferSize,f.sortKeys,f.forceFloat32,f.ignoreUndefined,f.forceIntegerToFloat);return u.encode(l)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/index.mjs":function(n,t,r){r.r(t);var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/encode.mjs");r.d(t,"encode",function(){return s.encode});var i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs");r.d(t,"decode",function(){return i.decode}),r.d(t,"decodeMulti",function(){return i.decodeMulti});var o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decodeAsync.mjs");r.d(t,"decodeAsync",function(){return o.decodeAsync}),r.d(t,"decodeArrayStream",function(){return o.decodeArrayStream}),r.d(t,"decodeMultiStream",function(){return o.decodeMultiStream}),r.d(t,"decodeStream",function(){return o.decodeStream});var l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs");r.d(t,"Decoder",function(){return l.Decoder}),r.d(t,"DataViewIndexOutOfBoundsError",function(){return l.DataViewIndexOutOfBoundsError});var f=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs");r.d(t,"DecodeError",function(){return f.DecodeError});var u=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs");r.d(t,"Encoder",function(){return u.Encoder});var g=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs");r.d(t,"ExtensionCodec",function(){return g.ExtensionCodec});var y=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs");r.d(t,"ExtData",function(){return y.ExtData});var a=r("./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs");r.d(t,"EXT_TIMESTAMP",function(){return a.EXT_TIMESTAMP}),r.d(t,"encodeDateToTimeSpec",function(){return a.encodeDateToTimeSpec}),r.d(t,"encodeTimeSpecToTimestamp",function(){return a.encodeTimeSpecToTimestamp}),r.d(t,"decodeTimestampToTimeSpec",function(){return a.decodeTimestampToTimeSpec}),r.d(t,"encodeTimestampExtension",function(){return a.encodeTimestampExtension}),r.d(t,"decodeTimestampExtension",function(){return a.decodeTimestampExtension})},"./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs":function(n,t,r){r.r(t),r.d(t,"EXT_TIMESTAMP",function(){return o}),r.d(t,"encodeTimeSpecToTimestamp",function(){return u}),r.d(t,"encodeDateToTimeSpec",function(){return g}),r.d(t,"encodeTimestampExtension",function(){return y}),r.d(t,"decodeTimestampToTimeSpec",function(){return a}),r.d(t,"decodeTimestampExtension",function(){return m}),r.d(t,"timestampExtension",function(){return _});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),o=-1,l=4294967296-1,f=17179869184-1;function u(b){var c=b.sec,w=b.nsec;if(c>=0&&w>=0&&c<=f)if(w===0&&c<=l){var S=new Uint8Array(4),E=new DataView(S.buffer);return E.setUint32(0,c),S}else{var I=c/4294967296,A=c&4294967295,S=new Uint8Array(8),E=new DataView(S.buffer);return E.setUint32(0,w<<2|I&3),E.setUint32(4,A),S}else{var S=new Uint8Array(12),E=new DataView(S.buffer);return E.setUint32(0,w),Object(i.setInt64)(E,4,c),S}}function g(b){var c=b.getTime(),w=Math.floor(c/1e3),S=(c-w*1e3)*1e6,E=Math.floor(S/1e9);return{sec:w+E,nsec:S-E*1e9}}function y(b){if(b instanceof Date){var c=g(b);return u(c)}else return null}function a(b){var c=new DataView(b.buffer,b.byteOffset,b.byteLength);switch(b.byteLength){case 4:{var w=c.getUint32(0),S=0;return{sec:w,nsec:S}}case 8:{var E=c.getUint32(0),I=c.getUint32(4),w=(E&3)*4294967296+I,S=E>>>2;return{sec:w,nsec:S}}case 12:{var w=Object(i.getInt64)(c,4),S=c.getUint32(0);return{sec:w,nsec:S}}default:throw new s.DecodeError("Unrecognized data size for timestamp (expected 4, 8, or 12): "+b.length)}}function m(b){var c=a(b);return new Date(c.sec*1e3+c.nsec/1e6)}var _={type:o,encode:y,decode:m}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs":function(n,t,r){r.r(t),r.d(t,"UINT32_MAX",function(){return s}),r.d(t,"setUint64",function(){return i}),r.d(t,"setInt64",function(){return o}),r.d(t,"getInt64",function(){return l}),r.d(t,"getUint64",function(){return f});var s=4294967295;function i(u,g,y){var a=y/4294967296,m=y;u.setUint32(g,a),u.setUint32(g+4,m)}function o(u,g,y){var a=Math.floor(y/4294967296),m=y;u.setUint32(g,a),u.setUint32(g+4,m)}function l(u,g){var y=u.getInt32(g),a=u.getUint32(g+4);return y*4294967296+a}function f(u,g){var y=u.getUint32(g),a=u.getUint32(g+4);return y*4294967296+a}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/prettyByte.mjs":function(n,t,r){r.r(t),r.d(t,"prettyByte",function(){return s});function s(i){return(i<0?"-":"")+"0x"+Math.abs(i).toString(16).padStart(2,"0")}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/stream.mjs":function(n,t,r){r.r(t),r.d(t,"isAsyncIterable",function(){return l}),r.d(t,"asyncIterableFromStream",function(){return u}),r.d(t,"ensureAsyncIterable",function(){return g});var s=function(y,a){var m={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,b,c,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(I){return function(A){return E([I,A])}}function E(I){if(_)throw new TypeError("Generator is already executing.");for(;m;)try{if(_=1,b&&(c=I[0]&2?b.return:I[0]?b.throw||((c=b.return)&&c.call(b),0):b.next)&&!(c=c.call(b,I[1])).done)return c;switch(b=0,c&&(I=[I[0]&2,c.value]),I[0]){case 0:case 1:c=I;break;case 4:return m.label++,{value:I[1],done:!1};case 5:m.label++,b=I[1],I=[0];continue;case 7:I=m.ops.pop(),m.trys.pop();continue;default:if(c=m.trys,!(c=c.length>0&&c[c.length-1])&&(I[0]===6||I[0]===2)){m=0;continue}if(I[0]===3&&(!c||I[1]>c[0]&&I[1]<c[3])){m.label=I[1];break}if(I[0]===6&&m.label<c[1]){m.label=c[1],c=I;break}if(c&&m.label<c[2]){m.label=c[2],m.ops.push(I);break}c[2]&&m.ops.pop(),m.trys.pop();continue}I=a.call(y,m)}catch(A){I=[6,A],b=0}finally{_=c=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},i=function(y){return this instanceof i?(this.v=y,this):new i(y)},o=function(y,a,m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=m.apply(y,a||[]),b,c=[];return b={},w("next"),w("throw"),w("return"),b[Symbol.asyncIterator]=function(){return this},b;function w(O){_[O]&&(b[O]=function(C){return new Promise(function(k,P){c.push([O,C,k,P])>1||S(O,C)})})}function S(O,C){try{E(_[O](C))}catch(k){T(c[0][3],k)}}function E(O){O.value instanceof i?Promise.resolve(O.value.v).then(I,A):T(c[0][2],O)}function I(O){S("next",O)}function A(O){S("throw",O)}function T(O,C){O(C),c.shift(),c.length&&S(c[0][0],c[0][1])}};function l(y){return y[Symbol.asyncIterator]!=null}function f(y){if(y==null)throw new Error("Assertion Failure: value must not be null nor undefined")}function u(y){return o(this,arguments,function(){var m,_,b,c;return s(this,function(w){switch(w.label){case 0:m=y.getReader(),w.label=1;case 1:w.trys.push([1,,9,10]),w.label=2;case 2:return[4,i(m.read())];case 3:return _=w.sent(),b=_.done,c=_.value,b?[4,i(void 0)]:[3,5];case 4:return[2,w.sent()];case 5:return f(c),[4,i(c)];case 6:return[4,w.sent()];case 7:return w.sent(),[3,2];case 8:return[3,10];case 9:return m.releaseLock(),[7];case 10:return[2]}})})}function g(y){return l(y)?y:u(y)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs":function(n,t,r){r.r(t),r.d(t,"ensureUint8Array",function(){return s}),r.d(t,"createDataView",function(){return i});function s(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o instanceof ArrayBuffer?new Uint8Array(o):Uint8Array.from(o)}function i(o){if(o instanceof ArrayBuffer)return new DataView(o);var l=s(o);return new DataView(l.buffer,l.byteOffset,l.byteLength)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs":function(n,t,r){r.r(t),r.d(t,"utf8Count",function(){return o}),r.d(t,"utf8EncodeJs",function(){return l}),r.d(t,"TEXT_ENCODER_THRESHOLD",function(){return u}),r.d(t,"utf8EncodeTE",function(){return a}),r.d(t,"utf8DecodeJs",function(){return _}),r.d(t,"TEXT_DECODER_THRESHOLD",function(){return c}),r.d(t,"utf8DecodeTD",function(){return w});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),i=(typeof process>"u"||define_process_env_default.TEXT_ENCODING!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function o(S){for(var E=S.length,I=0,A=0;A<E;){var T=S.charCodeAt(A++);if(T&4294967168)if(!(T&4294965248))I+=2;else{if(T>=55296&&T<=56319&&A<E){var O=S.charCodeAt(A);(O&64512)===56320&&(++A,T=((T&1023)<<10)+(O&1023)+65536)}T&4294901760?I+=4:I+=3}else{I++;continue}}return I}function l(S,E,I){for(var A=S.length,T=I,O=0;O<A;){var C=S.charCodeAt(O++);if(C&4294967168)if(!(C&4294965248))E[T++]=C>>6&31|192;else{if(C>=55296&&C<=56319&&O<A){var k=S.charCodeAt(O);(k&64512)===56320&&(++O,C=((C&1023)<<10)+(k&1023)+65536)}C&4294901760?(E[T++]=C>>18&7|240,E[T++]=C>>12&63|128,E[T++]=C>>6&63|128):(E[T++]=C>>12&15|224,E[T++]=C>>6&63|128)}else{E[T++]=C;continue}E[T++]=C&63|128}}var f=i?new TextEncoder:void 0,u=i?typeof process<"u"&&define_process_env_default.TEXT_ENCODING!=="force"?200:0:s.UINT32_MAX;function g(S,E,I){E.set(f.encode(S),I)}function y(S,E,I){f.encodeInto(S,E.subarray(I))}var a=f!=null&&f.encodeInto?y:g,m=4096;function _(S,E,I){for(var A=E,T=A+I,O=[],C="";A<T;){var k=S[A++];if(!(k&128))O.push(k);else if((k&224)===192){var P=S[A++]&63;O.push((k&31)<<6|P)}else if((k&240)===224){var P=S[A++]&63,N=S[A++]&63;O.push((k&31)<<12|P<<6|N)}else if((k&248)===240){var P=S[A++]&63,N=S[A++]&63,L=S[A++]&63,F=(k&7)<<18|P<<12|N<<6|L;F>65535&&(F-=65536,O.push(F>>>10&1023|55296),F=56320|F&1023),O.push(F)}else O.push(k);O.length>=m&&(C+=String.fromCharCode.apply(String,O),O.length=0)}return O.length>0&&(C+=String.fromCharCode.apply(String,O)),C}var b=i?new TextDecoder:null,c=i?typeof process<"u"&&define_process_env_default.TEXT_DECODER!=="force"?200:0:s.UINT32_MAX;function w(S,E,I){var A=S.subarray(E,E+I);return b.decode(A)}},"./src/hypha/rpc.js":function(n,t,r){r.r(t),r.d(t,"API_VERSION",function(){return o}),r.d(t,"RPC",function(){return _});var s=r("./src/hypha/utils.js"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/index.mjs");const o="0.3.0",l=1024*500,f=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;function u(b,c){const w=new Uint8Array(b.byteLength+c.byteLength);return w.set(new Uint8Array(b),0),w.set(new Uint8Array(c),b.byteLength),w.buffer}function g(b,c){if(!c)throw new Error("undefined index");return typeof c=="string"?g(b,c.split(".")):c.length===0?b:g(b[c[0]],c.slice(1))}function y(b){const c=b.toString(),w=c.match(/function\s*(\w*)/),S=w&&w[1]||"",E=c.match(/\(([^)]*)\)/);let I="";E&&(I=E[1].split(",").map(k=>k.replace(/\/\*.*?\*\//g,"").replace(/\/\/.*$/g,"")).filter(k=>k.trim().length>0).map(k=>k.trim()).join(", "));let A=c.match(/\)\s*\{\s*\/\*([\s\S]*?)\*\//);const T=A&&A[1].trim()||"";A=c.match(/\)\s*\{\s*(\/\/[\s\S]*?)\n\s*[^\s\/]/);const O=A&&A[1].split(`
`).map(k=>k.replace(/^\/\/\s*/,"").trim()).join(`
`)||"",C=T||O;return S&&I.length>0&&{name:S,sig:I,doc:C}}function a(b){var c=b.map(function(E){return E.byteLength}),w=c.reduce(function(E,I){return E+I},0),S=new Uint8Array(w);return c.reduce(function(E,I,A){return S.set(new Uint8Array(b[A]),E),E+I},0),S.buffer}class m{constructor(c,w,S,E){this._timeout=c,this._callback=w,this._args=S,this._label=E||"timer",this._task=null,this.started=!1}start(){this.started?this.reset():(this._task=setTimeout(()=>{this._callback.apply(this,this._args)},this._timeout*1e3),this.started=!0)}clear(){this._task?(clearTimeout(this._task),this._task=null,this.started=!1):console.warn(`Clearing a timer (${this._label}) which is not started`)}reset(){this._task&&clearTimeout(this._task),this._task=setTimeout(()=>{this._callback.apply(this,this._args)},this._timeout*1e3),this.started=!0}}class _ extends s.MessageEmitter{constructor(c,{client_id:w=null,manager_id:S=null,default_context:E=null,name:I=null,codecs:A=null,method_timeout:T=null,max_message_buffer_size:O=0,debug:C=!1,workspace:k=null}){super(C),this._codecs=A||{},Object(s.assert)(w&&typeof w=="string"),Object(s.assert)(w,"client_id is required"),this._client_id=w,this._name=I,this._connection_info=null,this._workspace=null,this._local_workspace=k,this.manager_id=S,this.default_context=E||{},this._method_annotations=new WeakMap,this._manager_service=null,this._max_message_buffer_size=O,this._chunk_store={},this._method_timeout=T||30,this._services={},this._object_store={services:this._services},c?(this.add_service({id:"built-in",type:"built-in",name:"RPC built-in services",config:{require_context:!0,visibility:"public"},ping:this._ping.bind(this),get_service:this.get_local_service.bind(this),register_service:this.register_service.bind(this),message_cache:{create:this._create_message.bind(this),append:this._append_message.bind(this),process:this._process_message.bind(this),remove:this._remove_message.bind(this)}}),this.on("method",this._handle_method.bind(this)),Object(s.assert)(c.emit_message&&c.on_message),this._emit_message=c.emit_message.bind(c),c.on_message(this._on_message.bind(this)),this._connection=c,this._get_connection_info()):this._emit_message=function(){console.log("No connection to emit message")}}async _get_connection_info(){if(this.manager_id)try{if(await this.get_manager_service(30),Object(s.assert)(this._manager_service),this._connection_info=await this._manager_service.get_connection_info(),this._connection_info.reconnection_token&&this._connection.set_reconnection_token){this._connection.set_reconnection_token(this._connection_info.reconnection_token);const c=this._connection_info.reconnection_expires_in*.8;this._get_connection_info_task=setTimeout(this._get_connection_info.bind(this),c*1e3)}}catch(c){console.warn("Failed to fetch user info from ",this.manager_id,c)}}register_codec(c){if(!c.name||!c.encoder&&!c.decoder)throw new Error("Invalid codec format, please make sure you provide a name, type, encoder and decoder.");if(c.type)for(let w of Object.keys(this._codecs))(this._codecs[w].type===c.type||w===c.name)&&(delete this._codecs[w],console.warn("Remove duplicated codec: "+w));this._codecs[c.name]=c}async _ping(c,w){return Object(s.assert)(c=="ping"),"pong"}async ping(c,w){let S=this._generate_remote_method({_rtarget:c,_rmethod:"services.built-in.ping",_rpromise:!0,_rdoc:"Ping a remote client",_rsig:"ping(msg)"});Object(s.assert)(await S("ping",w)=="pong")}_create_message(c,w,S,E){if(w){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}if(this._object_store.message_cache||(this._object_store.message_cache={}),!S&&this._object_store.message_cache[c])throw new Error(`Message with the same key (${c}) already exists in the cache store, please use overwrite=true or remove it first.`);this._object_store.message_cache[c]=[]}_append_message(c,w,S,E){if(S){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}const I=this._object_store.message_cache;if(!I[c])throw new Error(`Message with key ${c} does not exists.`);Object(s.assert)(w instanceof f),I[c].push(w)}_remove_message(c,w){const S=this._object_store.message_cache;if(!S[c])throw new Error(`Message with key ${c} does not exists.`);delete S[c]}_process_message(c,w,S){if(w){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}const E=this._object_store.message_cache;if(Object(s.assert)(!!S,"Context is required"),!E[c])throw new Error(`Message with key ${c} does not exists.`);E[c]=a(E[c]),console.debug(`Processing message ${c} (size=${E[c].length})`);let I=Object(i.decodeMulti)(E[c]);const{done:A,value:T}=I.next(),O=T;if(Object.assign(O,{from:S.from,to:S.to,user:S.user}),O.ctx=JSON.parse(JSON.stringify(O)),Object.assign(O.ctx,this.default_context),!A){let C=I.next();Object.assign(O,C.value)}this._fire(O.type,O),delete E[c]}_on_message(c){try{Object(s.assert)(c instanceof ArrayBuffer);let w=Object(i.decodeMulti)(c);const{done:S,value:E}=w.next(),I=E;if(I.ctx=JSON.parse(JSON.stringify(I)),Object.assign(I.ctx,this.default_context),!S){let A=w.next();Object.assign(I,A.value)}this._fire(I.type,I)}catch{console.error(e)}}reset(){this._event_handlers={},this._services={}}async disconnect(){this._get_connection_info_task&&(clearTimeout(this._get_connection_info_task),this._get_connection_info_task=null),this._fire("disconnect")}async get_manager_service(c){this.manager_id&&!this._manager_service&&(this._manager_service=await this.get_remote_service(`${this.manager_id}:default`,c))}get_all_local_services(){return this._services}get_local_service(c,w){Object(s.assert)(c);const[S,E]=w.to.split("/");Object(s.assert)(E===this._client_id,"Services can only be accessed locally");const I=this._services[c];if(!I)throw new Error("Service not found: "+c);if(I.config.visibility=="public"||w.from.startsWith(S+"/"))return I;throw new Error("Permission denied for service: "+c)}async get_remote_service(c,w){w=w===void 0?this._method_timeout:w,!c&&this.manager_id?c=this.manager_id:c.includes(":")||(c=this._client_id+":"+c);const S=c.split(":")[0];Object(s.assert)(S);try{const E=this._generate_remote_method({_rtarget:S,_rmethod:"services.built-in.get_service",_rpromise:!0,_rdoc:"Get a remote service",_rsig:"get_service(service_id)"}),I=await Object(s.waitFor)(E(c.split(":")[1]),w,"Timeout Error: Failed to get remote service: "+c);return I.id=c,I}catch(E){throw console.error("Failed to get remote service: "+c,E),E}}_annotate_service_methods(c,w,S,E,I){if(typeof c=="function"){let A=w.split(".")[1];this._method_annotations.set(c,{require_context:Array.isArray(S)?S.includes(A):!!S,run_in_executor:E,method_id:"services."+w,visibility:I})}else if(c instanceof Array||c instanceof Object)for(let A of Object.keys(c)){let T=c[A];if(typeof T=="function"&&T.__rpc_object__){let O=T.__rpc_object__._rtarget;if(O.includes("/")&&(O=O.split("/")[1]),this._client_id===O)c instanceof Array&&(c=c.slice()),c[A]=g(this._object_store,T.__rpc_object__._rmethod),T=c[A];else throw new Error(`Local method not found: ${T.__rpc_object__._rmethod}, client id mismatch ${this._client_id} != ${O}`)}this._annotate_service_methods(T,w+"."+A,S,E,I)}}add_service(c,w){if(!c||Array.isArray(c))throw new Error("Invalid service object");if(c.constructor===Object)c=Object.assign({},c);else{const A={},T=Object.getOwnPropertyNames(c).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(c)));for(let O of T)O!=="constructor"&&(typeof c[O]=="function"?A[O]=c[O].bind(c):A[O]=c[O]);c.id=c.id||"default",c=A}Object(s.assert)(c.id&&typeof c.id=="string",`Service id not found: ${c}`),c.name||(c.name=c.id),c.config||(c.config={}),c.type||(c.type="generic");let S=!1,E=!1;c.config.require_context&&(S=c.config.require_context),c.config.run_in_executor&&(E=!0);const I=c.config.visibility||"protected";if(Object(s.assert)(["protected","public"].includes(I)),this._annotate_service_methods(c,c.id,S,E,I),this._services[c.id])if(w)delete this._services[c.id];else throw new Error(`Service already exists: ${c.id}, please specify a different id (not ${c.id}) or overwrite=true`);return this._services[c.id]=c,c}async register_service(c,w,S,E){if(S===void 0&&(S=!0),E){const[A,T]=E.to.split("/");Object(s.assert)(T===this._client_id),Object(s.assert)(A===E.from.split("/")[0],"Services can only be registered from the same workspace")}const I=this.add_service(c,w);return S&&(this._fire("service-updated",{service_id:I.id,api:I,type:"add"}),await this._notify_service_update()),{id:`${this._client_id}:${I.id}`,type:I.type,name:I.name,description:I.description||"",config:I.config}}async unregister_service(c,w){if(c instanceof Object&&(c=c.id),!this._services[c])throw new Error(`Service not found: ${c}`);const S=this._services[c];delete this._services[c],this._fire("service-updated",{service_id:c,api:S,type:"remove"}),await this._notify_service_update()}_ndarray(c,w,S){const E=Object(s.typedArrayToDtype)(c);if(S&&S!==E)throw"dtype doesn't match the type of the array: "+E+" != "+S;return w=w||[c.length],{_rtype:"ndarray",_rvalue:c.buffer,_rshape:w,_rdtype:E}}_encode_callback(c,w,S,E,I,A){let T=`${S}.${c}`,O={_rtype:"method",_rtarget:A?`${A}/${this._client_id}`:this._client_id,_rmethod:T,_rpromise:!1};const C=this;return[O,function(){try{w.apply(null,Array.prototype.slice.call(arguments))}catch(P){console.error("Error in callback:",T,P)}finally{E&&C._object_store[S]&&delete C._object_store[S],I&&I.started&&I.clear()}}]}async _encode_promise(c,w,S,E,I,A){let T=this._get_session_store(S,!0);Object(s.assert)(T,`Failed to create session store ${S} due to invalid parent`);let O={};return I&&w&&this._method_timeout?(O.heartbeat=await this._encode(I.reset.bind(I),S,A),O.interval=this._method_timeout/2,T.timer=I):I=null,[O.resolve,T.resolve]=this._encode_callback("resolve",c,S,E,I,A),[O.reject,T.reject]=this._encode_callback("reject",w,S,E,I,A),O}async _send_chunks(c,w,S){let E=await this.get_remote_service(`${w}:built-in`);Object(s.assert)(E.message_cache,"Remote client does not support message caching for long message.");let I=E.message_cache,A=S||Object(s.randId)();await I.create(A,!!S);let T=c.length,O=Math.ceil(T/l);for(let C=0;C<O;C++){let k=C*l;await I.append(A,c.slice(k,k+l),!!S)}await I.process(A,!!S)}_generate_remote_method(c,w,S,E,I){let A=c._rtarget;E&&!A.includes("/")&&(A=E+"/"+A,c._rtarget=A);let T=c._rmethod,O=c._rpromise;const C=this;function k(){return new Promise(async(N,L)=>{let F=Object(s.randId)();S&&(F=S+"."+F);let V=C._get_session_store(F,!0);if(!V){L(new Error(`Runtime Error: Failed to get session store ${F}`));return}V.target_id=A;const j=await C._encode(Array.prototype.slice.call(arguments),F,I),K=j.length,U=K>0&&typeof j[K-1]=="object"&&j[K-1]!==null&&j[K-1]._rkwargs;U&&delete j[K-1]._rkwargs;let X={type:"method",from:C._local_workspace?C._local_workspace+"/"+C._client_id:C._client_id,to:A,method:T},J={};j&&(J.args=j),U&&(J.with_kwargs=U),w&&(X.parent=w);let Y=null;if(O){X.session=F;let de=`${A}:${T}`;Y=new m(C._method_timeout,L,[`Method call time out: ${de}`],de),J.promise=await C._encode_promise(N,L,F,!0,Y,I)}let te=Object(i.encode)(X);if(J){const de=Object(i.encode)(J);te=new Uint8Array([...te,...de])}te.length<=l+1024?C._emit_message(te).then(function(){Y&&Y.start()}):C._send_chunks(te,A,w).then(function(){Y&&Y.start()})})}k.__rpc_object__=c;const P=T.split(".");return k.__name__=P[P.length-1],k.__doc__=c._rdoc,k.__sig__=c._rsig,k}async _notify_service_update(){if(this.manager_id)try{await this.get_manager_service(30),Object(s.assert)(this._manager_service),await this._manager_service.update_client_info(this.get_client_info())}catch(c){console.warn("Failed to notify service update to",this.manager_id,c)}}get_client_info(){const c=[];for(let w of Object.values(this._services))c.push({id:`${this._client_id}:${w.id}`,type:w.type,name:w.name,description:w.description||"",config:w.config});return{id:this._client_id,services:c}}async _handle_method(c){let w=null;try{Object(s.assert)(c.method&&c.ctx&&c.from);const S=c.from+":"+c.method,E=c.from.split("/")[0];c.to=c.to.includes("/")?c.to:E+"/"+c.to,c.ctx.to=c.to;const I=c.to.split("/")[0],A=c.parent;let T,O;if(c.promise){const P=await this._decode(c.promise,c.session,A,E,I);if(T=P.resolve,O=P.reject,P.heartbeat&&P.interval){async function N(){try{await P.heartbeat()}catch(L){console.error(L)}}w=setInterval(N,P.interval*1e3)}}let C;try{C=g(this._object_store,c.method)}catch(P){throw console.debug("Failed to find method",S,P),new Error(`Method not found: ${S}`)}if(Object(s.assert)(C&&typeof C=="function","Invalid method: "+S),this._method_annotations.has(C)){if(this._method_annotations.get(C).visibility==="protected"&&I!==E)throw new Error("Permission denied for protected method "+S+", workspace mismatch: "+I+" != "+E)}else{let P=this._object_store[c.method.split(".")[0]].target_id;if(I===E&&P&&P.indexOf("/")===-1&&(P=I+"/"+P),P!==c.from)throw new Error("Access denied for method call ("+S+") from "+c.from)}A&&Object(s.assert)(this._get_session_store(A,!0)!==null,"Parent session was closed: "+A);let k;if(c.args?k=await this._decode(c.args,c.session,null,E,null):k=[],this._method_annotations.has(C)&&this._method_annotations.get(C).require_context&&k.push(c.ctx),c.promise){const P=C.apply(null,k);P instanceof Promise?P.then(N=>{T(N),clearInterval(w)}).catch(N=>{O(N),clearInterval(w)}):(T(P),clearInterval(w))}else C.apply(null,k),clearInterval(w)}catch(S){console.error("Error during calling method: ",S),clearInterval(w)}}encode(c,w){return this._encode(c,w)}_get_session_store(c,w){let S=this._object_store;const E=c.split(".");if(w){const I=E.length-1;for(let A of E.slice(0,I)){if(!S[A])return null;S=S[A]}return S[E[I]]||(S[E[I]]={}),S[E[I]]}else{for(let I of E){if(!S[I])return null;S=S[I]}return S}}async _encode(c,w,S){const E=typeof c;if(E==="number"||E==="string"||E==="boolean"||c===null||c===void 0||c instanceof Uint8Array)return c;if(c instanceof ArrayBuffer)return{_rtype:"memoryview",_rvalue:new Uint8Array(c)};if(c.__rpc_object__)return c.__rpc_object__;let I;if(c.constructor instanceof Object&&c._rtype){const T=c._rtype;return delete c._rtype,I=await this._encode(c,w,S),I._rtype=T,I}if(typeof c=="function"){if(this._method_annotations.has(c)){let T=this._method_annotations.get(c);I={_rtype:"method",_rtarget:this._client_id,_rmethod:T.method_id,_rpromise:!0}}else{Object(s.assert)(typeof w=="string");let T;c.__name__?T=`${Object(s.randId)()}-${c.__name__}`:T=Object(s.randId)(),I={_rtype:"method",_rtarget:this._client_id,_rmethod:`${w}.${T}`,_rpromise:!0};let O=this._get_session_store(w,!0);Object(s.assert)(O!==null,`Failed to create session store ${w} due to invalid parent`),O[T]=c}if(I._rdoc=c.__doc__,I._rsig=c.__sig__,!I._rdoc||!I._rsig)try{const T=y(c);T&&!I._rdoc&&(I._rdoc=`${T.doc}`),T&&!I._rsig&&(I._rsig=`${T.name}(${T.sig})`)}catch{console.error("Failed to extract function docstring:",c)}return I}const A=Array.isArray(c);for(let T of Object.keys(this._codecs)){const O=this._codecs[T];if(O.encoder&&c instanceof O.type){let C=await Promise.resolve(O.encoder(c));if(C&&!C._rtype&&(C._rtype=O.name),typeof C=="object"){const k=C._rtype;delete C._rtype,C=await this._encode(C,w,S),C._rtype=k}return I=C,I}}if(typeof tf<"u"&&tf.Tensor&&c instanceof tf.Tensor){const T=c.dataSync();I={_rtype:"ndarray",_rvalue:new Uint8Array(T.buffer),_rshape:c.shape,_rdtype:c.dtype}}else if(typeof nj<"u"&&nj.NdArray&&c instanceof nj.NdArray){const T=Object(s.typedArrayToDtype)(c.selection.data);I={_rtype:"ndarray",_rvalue:new Uint8Array(c.selection.data.buffer),_rshape:c.shape,_rdtype:T}}else if(c instanceof Error)console.error(c),I={_rtype:"error",_rvalue:c.toString()};else if(c!==Object(c)||c instanceof Boolean||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof ImageData||typeof FileList<"u"&&c instanceof FileList||typeof FileSystemDirectoryHandle<"u"&&c instanceof FileSystemDirectoryHandle||typeof FileSystemFileHandle<"u"&&c instanceof FileSystemFileHandle||typeof FileSystemHandle<"u"&&c instanceof FileSystemHandle||typeof FileSystemWritableFileStream<"u"&&c instanceof FileSystemWritableFileStream)I=c;else if(c instanceof Blob){let T=function(k){O=k},O=0;async function C(k){let P;k?P=c.slice(O,O+k):P=c.slice(O);const N=new Uint8Array(await P.arrayBuffer());return O=O+N.byteLength,N}I={_rtype:"iostream",_rnative:"js:blob",type:c.type,name:c.name,size:c.size,path:c._path||c.webkitRelativePath,read:await this._encode(C,w,S),seek:await this._encode(T,w,S)}}else if(c instanceof f){const T=Object(s.typedArrayToDtype)(c);I={_rtype:"typedarray",_rvalue:new Uint8Array(c.buffer),_rdtype:T}}else if(c instanceof DataView)I={_rtype:"memoryview",_rvalue:new Uint8Array(c.buffer)};else if(c instanceof Set)I={_rtype:"set",_rvalue:await this._encode(Array.from(c),w,S)};else if(c instanceof Map)I={_rtype:"orderedmap",_rvalue:await this._encode(Array.from(c),w,S)};else if(c.constructor instanceof Object||Array.isArray(c)){I=A?[]:{};const T=Object.keys(c);for(let O of T)I[O]=await this._encode(c[O],w,S)}else throw`imjoy-rpc: Unsupported data type: ${c}, you can register a custom codec to encode/decode the object.`;if(!I)throw new Error("Failed to encode object");return I}async decode(c){return await this._decode(c)}async _decode(c,w,S,E,I){if(!c)return c;let A;if(c._rtype)if(this._codecs[c._rtype]&&this._codecs[c._rtype].decoder){const T=c._rtype;delete c._rtype,c=await this._decode(c,w,S,E,I),c._rtype=T,A=await Promise.resolve(this._codecs[c._rtype].decoder(c))}else if(c._rtype==="method")A=this._generate_remote_method(c,w,S,E,I);else if(c._rtype==="ndarray")if(typeof nj<"u"&&nj.array)Array.isArray(c._rvalue)&&(c._rvalue=c._rvalue.reduce(u)),A=nj.array(new Uint8(c._rvalue),c._rdtype).reshape(c._rshape);else if(typeof tf<"u"&&tf.Tensor){Array.isArray(c._rvalue)&&(c._rvalue=c._rvalue.reduce(u));const T=s.dtypeToTypedArray[c._rdtype];A=tf.tensor(new T(c._rvalue),c._rshape,c._rdtype)}else A=c;else if(c._rtype==="error")A=new Error(c._rvalue);else if(c._rtype==="typedarray"){const T=s.dtypeToTypedArray[c._rdtype];if(!T)throw new Error("unsupported dtype: "+c._rdtype);const O=c._rvalue.buffer.slice(c._rvalue.byteOffset,c._rvalue.byteOffset+c._rvalue.byteLength);A=new T(O)}else if(c._rtype==="memoryview")A=c._rvalue.buffer.slice(c._rvalue.byteOffset,c._rvalue.byteOffset+c._rvalue.byteLength);else if(c._rtype==="iostream"){if(c._rnative==="js:blob"){const O=await(await this._generate_remote_method(c.read,w,S,E,I))();A=new Blob([O],{type:c.type,name:c.name})}else{A={};for(let T of Object.keys(c))T.startsWith("_")||(A[T]=await this._decode(c[T],w,S,E,I))}A.__rpc_object__=c}else if(c._rtype==="orderedmap")A=new Map(await this._decode(c._rvalue,w,S,E,I));else if(c._rtype==="set")A=new Set(await this._decode(c._rvalue,w,S,E,I));else{const T=c._rtype;delete c._rtype,A=await this._decode(c,w,S,E,I),A._rtype=T}else if(c.constructor===Object||Array.isArray(c)){const T=Array.isArray(c);A=T?[]:{};for(let O of Object.keys(c))if(T||c.hasOwnProperty(O)){const C=c[O];A[O]=await this._decode(C,w,S,E,I)}}else A=c;if(A===void 0)throw new Error("Failed to decode object");return A}}},"./src/hypha/utils.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"randId",function(){return randId}),__webpack_require__.d(__webpack_exports__,"dtypeToTypedArray",function(){return dtypeToTypedArray}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWindow",function(){return loadRequirementsInWindow}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWebworker",function(){return loadRequirementsInWebworker}),__webpack_require__.d(__webpack_exports__,"loadRequirements",function(){return loadRequirements}),__webpack_require__.d(__webpack_exports__,"normalizeConfig",function(){return normalizeConfig}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtypeMapping",function(){return typedArrayToDtypeMapping}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtype",function(){return typedArrayToDtype}),__webpack_require__.d(__webpack_exports__,"cacheRequirements",function(){return cacheRequirements}),__webpack_require__.d(__webpack_exports__,"setupServiceWorker",function(){return setupServiceWorker}),__webpack_require__.d(__webpack_exports__,"assert",function(){return assert}),__webpack_require__.d(__webpack_exports__,"urlJoin",function(){return urlJoin}),__webpack_require__.d(__webpack_exports__,"waitFor",function(){return waitFor}),__webpack_require__.d(__webpack_exports__,"MessageEmitter",function(){return MessageEmitter});function randId(){return Math.random().toString(36).substr(2,10)+new Date().getTime()}const dtypeToTypedArray={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,array:Array};async function loadRequirementsInWindow(n){function t(o){return new Promise((l,f)=>{var u=document.createElement("script");u.src=o,u.type="text/javascript",u.onload=l,u.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&l()},u.onerror=f,document.head.appendChild(u)})}async function r(){for(var o=Array.prototype.slice.call(arguments),l=o.length,f=0;f<l;f++)await t(o[f])}if(n&&(Array.isArray(n)||typeof n=="string"))try{var s;if(n=typeof n=="string"?[n]:n,Array.isArray(n))for(var i=0;i<n.length;i++)n[i].toLowerCase().endsWith(".css")||n[i].startsWith("css:")?(n[i].startsWith("css:")&&(n[i]=n[i].slice(4)),s=document.createElement("link"),s.rel="stylesheet",s.href=n[i],document.head.appendChild(s)):n[i].toLowerCase().endsWith(".mjs")||n[i].startsWith("mjs:")?(n[i].startsWith("mjs:")&&(n[i]=n[i].slice(4)),await __vitePreload(()=>import(n[i]),__vite__mapDeps([]))):n[i].toLowerCase().endsWith(".js")||n[i].startsWith("js:")?(n[i].startsWith("js:")&&(n[i]=n[i].slice(3)),await r(n[i])):n[i].startsWith("http")?await r(n[i]):n[i].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[i]);else throw"unsupported requirements definition"}catch{throw"failed to import required scripts: "+n.toString()}}async function loadRequirementsInWebworker(n){if(n&&(Array.isArray(n)||typeof n=="string"))try{Array.isArray(n)||(n=[n]);for(var t=0;t<n.length;t++){if(n[t].toLowerCase().endsWith(".css")||n[t].startsWith("css:"))throw"unable to import css in a webworker";n[t].toLowerCase().endsWith(".js")||n[t].startsWith("js:")?(n[t].startsWith("js:")&&(n[t]=n[t].slice(3)),importScripts(n[t])):n[t].startsWith("http")?importScripts(n[t]):n[t].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[t])}}catch{throw"failed to import required scripts: "+n.toString()}}function loadRequirements(n){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?loadRequirementsInWebworker(n):loadRequirementsInWindow(n)}function normalizeConfig(n){return n.version=n.version||"0.1.0",n.description=n.description||`[TODO: add description for ${n.name} ]`,n.type=n.type||"rpc-window",n.id=n.id||randId(),n.target_origin=n.target_origin||"*",n.allow_execution=n.allow_execution||!1,n=Object.keys(n).reduce((t,r)=>(typeof n[r]!="function"&&(t[r]=n[r]),t),{}),n}const typedArrayToDtypeMapping={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"array"},typedArrayToDtypeKeys=[];for(const arrType of Object.keys(typedArrayToDtypeMapping))typedArrayToDtypeKeys.push(eval(arrType));function typedArrayToDtype(n){let t=typedArrayToDtypeMapping[n.constructor.name];if(!t){const r=Object.getPrototypeOf(n);for(const s of typedArrayToDtypeKeys)if(r instanceof s){t=typedArrayToDtypeMapping[s.name];break}}return t}function cacheUrlInServiceWorker(n){return new Promise(function(t,r){const s={command:"add",url:n};if(!navigator.serviceWorker||!navigator.serviceWorker.register){r("Service worker is not supported.");return}const i=new MessageChannel;i.port1.onmessage=function(o){o.data&&o.data.error?r(o.data.error):t(o.data&&o.data.result)},navigator.serviceWorker&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(s,[i.port2]):r("Service worker controller is not available")})}async function cacheRequirements(n){n=n||[],Array.isArray(n)||(n=[n]);for(let t of n)t.startsWith("js:")&&(t=t.slice(3)),t.startsWith("css:")&&(t=t.slice(4)),t.startsWith("cache:")&&(t=t.slice(6)),t.startsWith("http")&&await cacheUrlInServiceWorker(t).catch(r=>{console.error(r)})}function setupServiceWorker(n,t,r){if("serviceWorker"in navigator){if(n=n||"/",navigator.serviceWorker.register(n+"plugin-service-worker.js").then(function(s){console.log("ServiceWorker registration successful with scope: ",s.scope)},function(s){console.log("ServiceWorker registration failed: ",s)}),t=t||"*",r=r||cacheRequirements,r&&typeof r!="function")throw new Error("config.cache_requirements must be a function");window.addEventListener("message",function(s){if(t==="*"||s.origin===t){const i=s.data;i.type==="cacheRequirements"&&r(i.requirements)}})}}function assert(n,t){if(!n)throw new Error(t||"Assertion failed")}function urlJoin(...n){return n.join("/").replace(/[\/]+/g,"/").replace(/^(.+):\//,"$1://").replace(/^file:/,"file:/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/\?/g,"&").replace("&","?")}function waitFor(n,t,r){let s;return Promise.race([n,new Promise((i,o)=>s=setTimeout(()=>{o(r||"Timeout Error")},t*1e3))]).finally(()=>clearTimeout(s))}class MessageEmitter{constructor(t){this._event_handlers={},this._once_handlers={},this._debug=t}emit(){throw new Error("emit is not implemented")}on(t,r){this._event_handlers[t]||(this._event_handlers[t]=[]),this._event_handlers[t].push(r)}once(t,r){r.___event_run_once=!0,this.on(t,r)}off(t,r){if(!t&&!r)this._event_handlers={};else if(t&&!r)this._event_handlers[t]&&(this._event_handlers[t]=[]);else if(this._event_handlers[t]){const s=this._event_handlers[t].indexOf(r);s>=0&&this._event_handlers[t].splice(s,1)}}_fire(t,r){if(this._event_handlers[t])for(var s=this._event_handlers[t].length;s--;){const i=this._event_handlers[t][s];try{i(r)}catch(o){console.error(o)}finally{i.___event_run_once&&this._event_handlers[t].splice(s,1)}}else this._debug&&console.warn("unhandled event",t,r)}}}})})})(hyphaRpc);var hyphaRpcExports=hyphaRpc.exports,hyphaRpcWebsocket={exports:{}};(function(module,exports){var define_process_env_default={};(function(t,r){module.exports=r()})(window,function(){return function(n){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return n[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=n,r.c=t,r.d=function(s,i,o){r.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:o})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,i){if(i&1&&(s=r(s)),i&8||i&4&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),i&2&&typeof s!="string")for(var l in s)r.d(o,l,(function(f){return s[f]}).bind(null,l));return o},r.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(i,"a",i),i},r.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},r.p="",r(r.s="./src/hypha/websocket-client.js")}({"./node_modules/@msgpack/msgpack/dist.es5+esm/CachedKeyDecoder.mjs":function(n,t,r){r.r(t),r.d(t,"CachedKeyDecoder",function(){return l});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),i=16,o=16,l=function(){function f(u,g){u===void 0&&(u=i),g===void 0&&(g=o),this.maxKeyLength=u,this.maxLengthPerKey=g,this.hit=0,this.miss=0,this.caches=[];for(var y=0;y<this.maxKeyLength;y++)this.caches.push([])}return f.prototype.canBeCached=function(u){return u>0&&u<=this.maxKeyLength},f.prototype.find=function(u,g,y){var a=this.caches[y-1];e:for(var m=0,_=a;m<_.length;m++){for(var b=_[m],c=b.bytes,w=0;w<y;w++)if(c[w]!==u[g+w])continue e;return b.str}return null},f.prototype.store=function(u,g){var y=this.caches[u.length-1],a={bytes:u,str:g};y.length>=this.maxLengthPerKey?y[Math.random()*y.length|0]=a:y.push(a)},f.prototype.decode=function(u,g,y){var a=this.find(u,g,y);if(a!=null)return this.hit++,a;this.miss++;var m=Object(s.utf8DecodeJs)(u,g,y),_=Uint8Array.prototype.slice.call(u,g,g+y);return this.store(_,m),m},f}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs":function(n,t,r){r.r(t),r.d(t,"DecodeError",function(){return i});var s=function(){var o=function(l,f){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,g){u.__proto__=g}||function(u,g){for(var y in g)Object.prototype.hasOwnProperty.call(g,y)&&(u[y]=g[y])},o(l,f)};return function(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");o(l,f);function u(){this.constructor=l}l.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)}}(),i=function(o){s(l,o);function l(f){var u=o.call(this,f)||this,g=Object.create(l.prototype);return Object.setPrototypeOf(u,g),Object.defineProperty(u,"name",{configurable:!0,enumerable:!1,value:l.name}),u}return l}(Error)},"./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs":function(n,t,r){r.r(t),r.d(t,"DataViewIndexOutOfBoundsError",function(){return I}),r.d(t,"Decoder",function(){return O});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/prettyByte.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),f=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs"),u=r("./node_modules/@msgpack/msgpack/dist.es5+esm/CachedKeyDecoder.mjs"),g=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs"),y=function(C,k,P,N){function L(F){return F instanceof P?F:new P(function(V){V(F)})}return new(P||(P=Promise))(function(F,V){function j(X){try{U(N.next(X))}catch(J){V(J)}}function K(X){try{U(N.throw(X))}catch(J){V(J)}}function U(X){X.done?F(X.value):L(X.value).then(j,K)}U((N=N.apply(C,k||[])).next())})},a=function(C,k){var P={label:0,sent:function(){if(F[0]&1)throw F[1];return F[1]},trys:[],ops:[]},N,L,F,V;return V={next:j(0),throw:j(1),return:j(2)},typeof Symbol=="function"&&(V[Symbol.iterator]=function(){return this}),V;function j(U){return function(X){return K([U,X])}}function K(U){if(N)throw new TypeError("Generator is already executing.");for(;P;)try{if(N=1,L&&(F=U[0]&2?L.return:U[0]?L.throw||((F=L.return)&&F.call(L),0):L.next)&&!(F=F.call(L,U[1])).done)return F;switch(L=0,F&&(U=[U[0]&2,F.value]),U[0]){case 0:case 1:F=U;break;case 4:return P.label++,{value:U[1],done:!1};case 5:P.label++,L=U[1],U=[0];continue;case 7:U=P.ops.pop(),P.trys.pop();continue;default:if(F=P.trys,!(F=F.length>0&&F[F.length-1])&&(U[0]===6||U[0]===2)){P=0;continue}if(U[0]===3&&(!F||U[1]>F[0]&&U[1]<F[3])){P.label=U[1];break}if(U[0]===6&&P.label<F[1]){P.label=F[1],F=U;break}if(F&&P.label<F[2]){P.label=F[2],P.ops.push(U);break}F[2]&&P.ops.pop(),P.trys.pop();continue}U=k.call(C,P)}catch(X){U=[6,X],L=0}finally{N=F=0}if(U[0]&5)throw U[1];return{value:U[0]?U[1]:void 0,done:!0}}},m=function(C){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k=C[Symbol.asyncIterator],P;return k?k.call(C):(C=typeof __values=="function"?__values(C):C[Symbol.iterator](),P={},N("next"),N("throw"),N("return"),P[Symbol.asyncIterator]=function(){return this},P);function N(F){P[F]=C[F]&&function(V){return new Promise(function(j,K){V=C[F](V),L(j,K,V.done,V.value)})}}function L(F,V,j,K){Promise.resolve(K).then(function(U){F({value:U,done:j})},V)}},_=function(C){return this instanceof _?(this.v=C,this):new _(C)},b=function(C,k,P){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var N=P.apply(C,k||[]),L,F=[];return L={},V("next"),V("throw"),V("return"),L[Symbol.asyncIterator]=function(){return this},L;function V(Y){N[Y]&&(L[Y]=function(te){return new Promise(function(se,de){F.push([Y,te,se,de])>1||j(Y,te)})})}function j(Y,te){try{K(N[Y](te))}catch(se){J(F[0][3],se)}}function K(Y){Y.value instanceof _?Promise.resolve(Y.value.v).then(U,X):J(F[0][2],Y)}function U(Y){j("next",Y)}function X(Y){j("throw",Y)}function J(Y,te){Y(te),F.shift(),F.length&&j(F[0][0],F[0][1])}},c=function(C){var k=typeof C;return k==="string"||k==="number"},w=-1,S=new DataView(new ArrayBuffer(0)),E=new Uint8Array(S.buffer),I=function(){try{S.getInt8(0)}catch(C){return C.constructor}throw new Error("never reached")}(),A=new I("Insufficient data"),T=new u.CachedKeyDecoder,O=function(){function C(k,P,N,L,F,V,j,K){k===void 0&&(k=i.ExtensionCodec.defaultCodec),P===void 0&&(P=void 0),N===void 0&&(N=o.UINT32_MAX),L===void 0&&(L=o.UINT32_MAX),F===void 0&&(F=o.UINT32_MAX),V===void 0&&(V=o.UINT32_MAX),j===void 0&&(j=o.UINT32_MAX),K===void 0&&(K=T),this.extensionCodec=k,this.context=P,this.maxStrLength=N,this.maxBinLength=L,this.maxArrayLength=F,this.maxMapLength=V,this.maxExtLength=j,this.keyDecoder=K,this.totalPos=0,this.pos=0,this.view=S,this.bytes=E,this.headByte=w,this.stack=[]}return C.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=w,this.stack.length=0},C.prototype.setBuffer=function(k){this.bytes=Object(f.ensureUint8Array)(k),this.view=Object(f.createDataView)(this.bytes),this.pos=0},C.prototype.appendBuffer=function(k){if(this.headByte===w&&!this.hasRemaining(1))this.setBuffer(k);else{var P=this.bytes.subarray(this.pos),N=Object(f.ensureUint8Array)(k),L=new Uint8Array(P.length+N.length);L.set(P),L.set(N,P.length),this.setBuffer(L)}},C.prototype.hasRemaining=function(k){return this.view.byteLength-this.pos>=k},C.prototype.createExtraByteError=function(k){var P=this,N=P.view,L=P.pos;return new RangeError("Extra "+(N.byteLength-L)+" of "+N.byteLength+" byte(s) found at buffer["+k+"]")},C.prototype.decode=function(k){this.reinitializeState(),this.setBuffer(k);var P=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return P},C.prototype.decodeMulti=function(k){return a(this,function(P){switch(P.label){case 0:this.reinitializeState(),this.setBuffer(k),P.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return P.sent(),[3,1];case 3:return[2]}})},C.prototype.decodeAsync=function(k){var P,N,L,F;return y(this,void 0,void 0,function(){var V,j,K,U,X,J,Y,te;return a(this,function(se){switch(se.label){case 0:V=!1,se.label=1;case 1:se.trys.push([1,6,7,12]),P=m(k),se.label=2;case 2:return[4,P.next()];case 3:if(N=se.sent(),!!N.done)return[3,5];if(K=N.value,V)throw this.createExtraByteError(this.totalPos);this.appendBuffer(K);try{j=this.doDecodeSync(),V=!0}catch(de){if(!(de instanceof I))throw de}this.totalPos+=this.pos,se.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return U=se.sent(),L={error:U},[3,12];case 7:return se.trys.push([7,,10,11]),N&&!N.done&&(F=P.return)?[4,F.call(P)]:[3,9];case 8:se.sent(),se.label=9;case 9:return[3,11];case 10:if(L)throw L.error;return[7];case 11:return[7];case 12:if(V){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,j]}throw X=this,J=X.headByte,Y=X.pos,te=X.totalPos,new RangeError("Insufficient data in parsing "+Object(s.prettyByte)(J)+" at "+te+" ("+Y+" in the current buffer)")}})})},C.prototype.decodeArrayStream=function(k){return this.decodeMultiAsync(k,!0)},C.prototype.decodeStream=function(k){return this.decodeMultiAsync(k,!1)},C.prototype.decodeMultiAsync=function(k,P){return b(this,arguments,function(){var L,F,V,j,K,U,X,J,Y;return a(this,function(te){switch(te.label){case 0:L=P,F=-1,te.label=1;case 1:te.trys.push([1,13,14,19]),V=m(k),te.label=2;case 2:return[4,_(V.next())];case 3:if(j=te.sent(),!!j.done)return[3,12];if(K=j.value,P&&F===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(K),L&&(F=this.readArraySize(),L=!1,this.complete()),te.label=4;case 4:te.trys.push([4,9,,10]),te.label=5;case 5:return[4,_(this.doDecodeSync())];case 6:return[4,te.sent()];case 7:return te.sent(),--F===0?[3,8]:[3,5];case 8:return[3,10];case 9:if(U=te.sent(),!(U instanceof I))throw U;return[3,10];case 10:this.totalPos+=this.pos,te.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return X=te.sent(),J={error:X},[3,19];case 14:return te.trys.push([14,,17,18]),j&&!j.done&&(Y=V.return)?[4,_(Y.call(V))]:[3,16];case 15:te.sent(),te.label=16;case 16:return[3,18];case 17:if(J)throw J.error;return[7];case 18:return[7];case 19:return[2]}})})},C.prototype.doDecodeSync=function(){e:for(;;){var k=this.readHeadByte(),P=void 0;if(k>=224)P=k-256;else if(k<192)if(k<128)P=k;else if(k<144){var N=k-128;if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k<160){var N=k-144;if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else{var L=k-160;P=this.decodeUtf8String(L,0)}else if(k===192)P=null;else if(k===194)P=!1;else if(k===195)P=!0;else if(k===202)P=this.readF32();else if(k===203)P=this.readF64();else if(k===204)P=this.readU8();else if(k===205)P=this.readU16();else if(k===206)P=this.readU32();else if(k===207)P=this.readU64();else if(k===208)P=this.readI8();else if(k===209)P=this.readI16();else if(k===210)P=this.readI32();else if(k===211)P=this.readI64();else if(k===217){var L=this.lookU8();P=this.decodeUtf8String(L,1)}else if(k===218){var L=this.lookU16();P=this.decodeUtf8String(L,2)}else if(k===219){var L=this.lookU32();P=this.decodeUtf8String(L,4)}else if(k===220){var N=this.readU16();if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else if(k===221){var N=this.readU32();if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else if(k===222){var N=this.readU16();if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k===223){var N=this.readU32();if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k===196){var N=this.lookU8();P=this.decodeBinary(N,1)}else if(k===197){var N=this.lookU16();P=this.decodeBinary(N,2)}else if(k===198){var N=this.lookU32();P=this.decodeBinary(N,4)}else if(k===212)P=this.decodeExtension(1,0);else if(k===213)P=this.decodeExtension(2,0);else if(k===214)P=this.decodeExtension(4,0);else if(k===215)P=this.decodeExtension(8,0);else if(k===216)P=this.decodeExtension(16,0);else if(k===199){var N=this.lookU8();P=this.decodeExtension(N,1)}else if(k===200){var N=this.lookU16();P=this.decodeExtension(N,2)}else if(k===201){var N=this.lookU32();P=this.decodeExtension(N,4)}else throw new g.DecodeError("Unrecognized type byte: "+Object(s.prettyByte)(k));this.complete();for(var F=this.stack;F.length>0;){var V=F[F.length-1];if(V.type===0)if(V.array[V.position]=P,V.position++,V.position===V.size)F.pop(),P=V.array;else continue e;else if(V.type===1){if(!c(P))throw new g.DecodeError("The type of key must be string or number but "+typeof P);if(P==="__proto__")throw new g.DecodeError("The key __proto__ is not allowed");V.key=P,V.type=2;continue e}else if(V.map[V.key]=P,V.readCount++,V.readCount===V.size)F.pop(),P=V.map;else{V.key=null,V.type=1;continue e}}return P}},C.prototype.readHeadByte=function(){return this.headByte===w&&(this.headByte=this.readU8()),this.headByte},C.prototype.complete=function(){this.headByte=w},C.prototype.readArraySize=function(){var k=this.readHeadByte();switch(k){case 220:return this.readU16();case 221:return this.readU32();default:{if(k<160)return k-144;throw new g.DecodeError("Unrecognized array type byte: "+Object(s.prettyByte)(k))}}},C.prototype.pushMapState=function(k){if(k>this.maxMapLength)throw new g.DecodeError("Max length exceeded: map length ("+k+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:k,key:null,readCount:0,map:{}})},C.prototype.pushArrayState=function(k){if(k>this.maxArrayLength)throw new g.DecodeError("Max length exceeded: array length ("+k+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:k,array:new Array(k),position:0})},C.prototype.decodeUtf8String=function(k,P){var N;if(k>this.maxStrLength)throw new g.DecodeError("Max length exceeded: UTF-8 byte length ("+k+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+P+k)throw A;var L=this.pos+P,F;return this.stateIsMapKey()&&(!((N=this.keyDecoder)===null||N===void 0)&&N.canBeCached(k))?F=this.keyDecoder.decode(this.bytes,L,k):k>l.TEXT_DECODER_THRESHOLD?F=Object(l.utf8DecodeTD)(this.bytes,L,k):F=Object(l.utf8DecodeJs)(this.bytes,L,k),this.pos+=P+k,F},C.prototype.stateIsMapKey=function(){if(this.stack.length>0){var k=this.stack[this.stack.length-1];return k.type===1}return!1},C.prototype.decodeBinary=function(k,P){if(k>this.maxBinLength)throw new g.DecodeError("Max length exceeded: bin length ("+k+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(k+P))throw A;var N=this.pos+P,L=this.bytes.subarray(N,N+k);return this.pos+=P+k,L},C.prototype.decodeExtension=function(k,P){if(k>this.maxExtLength)throw new g.DecodeError("Max length exceeded: ext length ("+k+") > maxExtLength ("+this.maxExtLength+")");var N=this.view.getInt8(this.pos+P),L=this.decodeBinary(k,P+1);return this.extensionCodec.decode(L,N,this.context)},C.prototype.lookU8=function(){return this.view.getUint8(this.pos)},C.prototype.lookU16=function(){return this.view.getUint16(this.pos)},C.prototype.lookU32=function(){return this.view.getUint32(this.pos)},C.prototype.readU8=function(){var k=this.view.getUint8(this.pos);return this.pos++,k},C.prototype.readI8=function(){var k=this.view.getInt8(this.pos);return this.pos++,k},C.prototype.readU16=function(){var k=this.view.getUint16(this.pos);return this.pos+=2,k},C.prototype.readI16=function(){var k=this.view.getInt16(this.pos);return this.pos+=2,k},C.prototype.readU32=function(){var k=this.view.getUint32(this.pos);return this.pos+=4,k},C.prototype.readI32=function(){var k=this.view.getInt32(this.pos);return this.pos+=4,k},C.prototype.readU64=function(){var k=Object(o.getUint64)(this.view,this.pos);return this.pos+=8,k},C.prototype.readI64=function(){var k=Object(o.getInt64)(this.view,this.pos);return this.pos+=8,k},C.prototype.readF32=function(){var k=this.view.getFloat32(this.pos);return this.pos+=4,k},C.prototype.readF64=function(){var k=this.view.getFloat64(this.pos);return this.pos+=8,k},C}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs":function(n,t,r){r.r(t),r.d(t,"DEFAULT_MAX_DEPTH",function(){return f}),r.d(t,"DEFAULT_INITIAL_BUFFER_SIZE",function(){return u}),r.d(t,"Encoder",function(){return g});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs"),f=100,u=2048,g=function(){function y(a,m,_,b,c,w,S,E){a===void 0&&(a=i.ExtensionCodec.defaultCodec),m===void 0&&(m=void 0),_===void 0&&(_=f),b===void 0&&(b=u),c===void 0&&(c=!1),w===void 0&&(w=!1),S===void 0&&(S=!1),E===void 0&&(E=!1),this.extensionCodec=a,this.context=m,this.maxDepth=_,this.initialBufferSize=b,this.sortKeys=c,this.forceFloat32=w,this.ignoreUndefined=S,this.forceIntegerToFloat=E,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return y.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},y.prototype.reinitializeState=function(){this.pos=0},y.prototype.encode=function(a){return this.reinitializeState(),this.doEncode(a,1),this.getUint8Array()},y.prototype.doEncode=function(a,m){if(m>this.maxDepth)throw new Error("Too deep objects in depth "+m);a==null?this.encodeNil():typeof a=="boolean"?this.encodeBoolean(a):typeof a=="number"?this.encodeNumber(a):typeof a=="string"?this.encodeString(a):this.encodeObject(a,m)},y.prototype.ensureBufferSizeToWrite=function(a){var m=this.pos+a;this.view.byteLength<m&&this.resizeBuffer(m*2)},y.prototype.resizeBuffer=function(a){var m=new ArrayBuffer(a),_=new Uint8Array(m),b=new DataView(m);_.set(this.bytes),this.view=b,this.bytes=_},y.prototype.encodeNil=function(){this.writeU8(192)},y.prototype.encodeBoolean=function(a){a===!1?this.writeU8(194):this.writeU8(195)},y.prototype.encodeNumber=function(a){Number.isSafeInteger(a)&&!this.forceIntegerToFloat?a>=0?a<128?this.writeU8(a):a<256?(this.writeU8(204),this.writeU8(a)):a<65536?(this.writeU8(205),this.writeU16(a)):a<4294967296?(this.writeU8(206),this.writeU32(a)):(this.writeU8(207),this.writeU64(a)):a>=-32?this.writeU8(224|a+32):a>=-128?(this.writeU8(208),this.writeI8(a)):a>=-32768?(this.writeU8(209),this.writeI16(a)):a>=-2147483648?(this.writeU8(210),this.writeI32(a)):(this.writeU8(211),this.writeI64(a)):this.forceFloat32?(this.writeU8(202),this.writeF32(a)):(this.writeU8(203),this.writeF64(a))},y.prototype.writeStringHeader=function(a){if(a<32)this.writeU8(160+a);else if(a<256)this.writeU8(217),this.writeU8(a);else if(a<65536)this.writeU8(218),this.writeU16(a);else if(a<4294967296)this.writeU8(219),this.writeU32(a);else throw new Error("Too long string: "+a+" bytes in UTF-8")},y.prototype.encodeString=function(a){var m=5,_=a.length;if(_>s.TEXT_ENCODER_THRESHOLD){var b=Object(s.utf8Count)(a);this.ensureBufferSizeToWrite(m+b),this.writeStringHeader(b),Object(s.utf8EncodeTE)(a,this.bytes,this.pos),this.pos+=b}else{var b=Object(s.utf8Count)(a);this.ensureBufferSizeToWrite(m+b),this.writeStringHeader(b),Object(s.utf8EncodeJs)(a,this.bytes,this.pos),this.pos+=b}},y.prototype.encodeObject=function(a,m){var _=this.extensionCodec.tryToEncode(a,this.context);if(_!=null)this.encodeExtension(_);else if(Array.isArray(a))this.encodeArray(a,m);else if(ArrayBuffer.isView(a))this.encodeBinary(a);else if(typeof a=="object")this.encodeMap(a,m);else throw new Error("Unrecognized object: "+Object.prototype.toString.apply(a))},y.prototype.encodeBinary=function(a){var m=a.byteLength;if(m<256)this.writeU8(196),this.writeU8(m);else if(m<65536)this.writeU8(197),this.writeU16(m);else if(m<4294967296)this.writeU8(198),this.writeU32(m);else throw new Error("Too large binary: "+m);var _=Object(l.ensureUint8Array)(a);this.writeU8a(_)},y.prototype.encodeArray=function(a,m){var _=a.length;if(_<16)this.writeU8(144+_);else if(_<65536)this.writeU8(220),this.writeU16(_);else if(_<4294967296)this.writeU8(221),this.writeU32(_);else throw new Error("Too large array: "+_);for(var b=0,c=a;b<c.length;b++){var w=c[b];this.doEncode(w,m+1)}},y.prototype.countWithoutUndefined=function(a,m){for(var _=0,b=0,c=m;b<c.length;b++){var w=c[b];a[w]!==void 0&&_++}return _},y.prototype.encodeMap=function(a,m){var _=Object.keys(a);this.sortKeys&&_.sort();var b=this.ignoreUndefined?this.countWithoutUndefined(a,_):_.length;if(b<16)this.writeU8(128+b);else if(b<65536)this.writeU8(222),this.writeU16(b);else if(b<4294967296)this.writeU8(223),this.writeU32(b);else throw new Error("Too large map object: "+b);for(var c=0,w=_;c<w.length;c++){var S=w[c],E=a[S];this.ignoreUndefined&&E===void 0||(this.encodeString(S),this.doEncode(E,m+1))}},y.prototype.encodeExtension=function(a){var m=a.data.length;if(m===1)this.writeU8(212);else if(m===2)this.writeU8(213);else if(m===4)this.writeU8(214);else if(m===8)this.writeU8(215);else if(m===16)this.writeU8(216);else if(m<256)this.writeU8(199),this.writeU8(m);else if(m<65536)this.writeU8(200),this.writeU16(m);else if(m<4294967296)this.writeU8(201),this.writeU32(m);else throw new Error("Too large extension object: "+m);this.writeI8(a.type),this.writeU8a(a.data)},y.prototype.writeU8=function(a){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,a),this.pos++},y.prototype.writeU8a=function(a){var m=a.length;this.ensureBufferSizeToWrite(m),this.bytes.set(a,this.pos),this.pos+=m},y.prototype.writeI8=function(a){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,a),this.pos++},y.prototype.writeU16=function(a){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,a),this.pos+=2},y.prototype.writeI16=function(a){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,a),this.pos+=2},y.prototype.writeU32=function(a){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,a),this.pos+=4},y.prototype.writeI32=function(a){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,a),this.pos+=4},y.prototype.writeF32=function(a){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,a),this.pos+=4},y.prototype.writeF64=function(a){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,a),this.pos+=8},y.prototype.writeU64=function(a){this.ensureBufferSizeToWrite(8),Object(o.setUint64)(this.view,this.pos,a),this.pos+=8},y.prototype.writeI64=function(a){this.ensureBufferSizeToWrite(8),Object(o.setInt64)(this.view,this.pos,a),this.pos+=8},y}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs":function(n,t,r){r.r(t),r.d(t,"ExtData",function(){return s});var s=function(){function i(o,l){this.type=o,this.data=l}return i}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs":function(n,t,r){r.r(t),r.d(t,"ExtensionCodec",function(){return o});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs"),o=function(){function l(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(i.timestampExtension)}return l.prototype.register=function(f){var u=f.type,g=f.encode,y=f.decode;if(u>=0)this.encoders[u]=g,this.decoders[u]=y;else{var a=1+u;this.builtInEncoders[a]=g,this.builtInDecoders[a]=y}},l.prototype.tryToEncode=function(f,u){for(var g=0;g<this.builtInEncoders.length;g++){var y=this.builtInEncoders[g];if(y!=null){var a=y(f,u);if(a!=null){var m=-1-g;return new s.ExtData(m,a)}}}for(var g=0;g<this.encoders.length;g++){var y=this.encoders[g];if(y!=null){var a=y(f,u);if(a!=null){var m=g;return new s.ExtData(m,a)}}}return f instanceof s.ExtData?f:null},l.prototype.decode=function(f,u,g){var y=u<0?this.builtInDecoders[-1-u]:this.decoders[u];return y?y(f,u,g):new s.ExtData(u,f)},l.defaultCodec=new l,l}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs":function(n,t,r){r.r(t),r.d(t,"defaultDecodeOptions",function(){return i}),r.d(t,"decode",function(){return o}),r.d(t,"decodeMulti",function(){return l});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs"),i={};function o(f,u){u===void 0&&(u=i);var g=new s.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength);return g.decode(f)}function l(f,u){u===void 0&&(u=i);var g=new s.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength);return g.decodeMulti(f)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/decodeAsync.mjs":function(n,t,r){r.r(t),r.d(t,"decodeAsync",function(){return u}),r.d(t,"decodeArrayStream",function(){return g}),r.d(t,"decodeMultiStream",function(){return y}),r.d(t,"decodeStream",function(){return a});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/stream.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs"),l=function(m,_,b,c){function w(S){return S instanceof b?S:new b(function(E){E(S)})}return new(b||(b=Promise))(function(S,E){function I(O){try{T(c.next(O))}catch(C){E(C)}}function A(O){try{T(c.throw(O))}catch(C){E(C)}}function T(O){O.done?S(O.value):w(O.value).then(I,A)}T((c=c.apply(m,_||[])).next())})},f=function(m,_){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},c,w,S,E;return E={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function I(T){return function(O){return A([T,O])}}function A(T){if(c)throw new TypeError("Generator is already executing.");for(;b;)try{if(c=1,w&&(S=T[0]&2?w.return:T[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,T[1])).done)return S;switch(w=0,S&&(T=[T[0]&2,S.value]),T[0]){case 0:case 1:S=T;break;case 4:return b.label++,{value:T[1],done:!1};case 5:b.label++,w=T[1],T=[0];continue;case 7:T=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(T[0]===6||T[0]===2)){b=0;continue}if(T[0]===3&&(!S||T[1]>S[0]&&T[1]<S[3])){b.label=T[1];break}if(T[0]===6&&b.label<S[1]){b.label=S[1],S=T;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(T);break}S[2]&&b.ops.pop(),b.trys.pop();continue}T=_.call(m,b)}catch(O){T=[6,O],w=0}finally{c=S=0}if(T[0]&5)throw T[1];return{value:T[0]?T[1]:void 0,done:!0}}};function u(m,_){return _===void 0&&(_=o.defaultDecodeOptions),l(this,void 0,void 0,function(){var b,c;return f(this,function(w){return b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength),[2,c.decodeAsync(b)]})})}function g(m,_){_===void 0&&(_=o.defaultDecodeOptions);var b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength);return c.decodeArrayStream(b)}function y(m,_){_===void 0&&(_=o.defaultDecodeOptions);var b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength);return c.decodeStream(b)}function a(m,_){return _===void 0&&(_=o.defaultDecodeOptions),y(m,_)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/encode.mjs":function(n,t,r){r.r(t),r.d(t,"encode",function(){return o});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs"),i={};function o(l,f){f===void 0&&(f=i);var u=new s.Encoder(f.extensionCodec,f.context,f.maxDepth,f.initialBufferSize,f.sortKeys,f.forceFloat32,f.ignoreUndefined,f.forceIntegerToFloat);return u.encode(l)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/index.mjs":function(n,t,r){r.r(t);var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/encode.mjs");r.d(t,"encode",function(){return s.encode});var i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs");r.d(t,"decode",function(){return i.decode}),r.d(t,"decodeMulti",function(){return i.decodeMulti});var o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decodeAsync.mjs");r.d(t,"decodeAsync",function(){return o.decodeAsync}),r.d(t,"decodeArrayStream",function(){return o.decodeArrayStream}),r.d(t,"decodeMultiStream",function(){return o.decodeMultiStream}),r.d(t,"decodeStream",function(){return o.decodeStream});var l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs");r.d(t,"Decoder",function(){return l.Decoder}),r.d(t,"DataViewIndexOutOfBoundsError",function(){return l.DataViewIndexOutOfBoundsError});var f=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs");r.d(t,"DecodeError",function(){return f.DecodeError});var u=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs");r.d(t,"Encoder",function(){return u.Encoder});var g=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs");r.d(t,"ExtensionCodec",function(){return g.ExtensionCodec});var y=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs");r.d(t,"ExtData",function(){return y.ExtData});var a=r("./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs");r.d(t,"EXT_TIMESTAMP",function(){return a.EXT_TIMESTAMP}),r.d(t,"encodeDateToTimeSpec",function(){return a.encodeDateToTimeSpec}),r.d(t,"encodeTimeSpecToTimestamp",function(){return a.encodeTimeSpecToTimestamp}),r.d(t,"decodeTimestampToTimeSpec",function(){return a.decodeTimestampToTimeSpec}),r.d(t,"encodeTimestampExtension",function(){return a.encodeTimestampExtension}),r.d(t,"decodeTimestampExtension",function(){return a.decodeTimestampExtension})},"./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs":function(n,t,r){r.r(t),r.d(t,"EXT_TIMESTAMP",function(){return o}),r.d(t,"encodeTimeSpecToTimestamp",function(){return u}),r.d(t,"encodeDateToTimeSpec",function(){return g}),r.d(t,"encodeTimestampExtension",function(){return y}),r.d(t,"decodeTimestampToTimeSpec",function(){return a}),r.d(t,"decodeTimestampExtension",function(){return m}),r.d(t,"timestampExtension",function(){return _});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),o=-1,l=4294967296-1,f=17179869184-1;function u(b){var c=b.sec,w=b.nsec;if(c>=0&&w>=0&&c<=f)if(w===0&&c<=l){var S=new Uint8Array(4),E=new DataView(S.buffer);return E.setUint32(0,c),S}else{var I=c/4294967296,A=c&4294967295,S=new Uint8Array(8),E=new DataView(S.buffer);return E.setUint32(0,w<<2|I&3),E.setUint32(4,A),S}else{var S=new Uint8Array(12),E=new DataView(S.buffer);return E.setUint32(0,w),Object(i.setInt64)(E,4,c),S}}function g(b){var c=b.getTime(),w=Math.floor(c/1e3),S=(c-w*1e3)*1e6,E=Math.floor(S/1e9);return{sec:w+E,nsec:S-E*1e9}}function y(b){if(b instanceof Date){var c=g(b);return u(c)}else return null}function a(b){var c=new DataView(b.buffer,b.byteOffset,b.byteLength);switch(b.byteLength){case 4:{var w=c.getUint32(0),S=0;return{sec:w,nsec:S}}case 8:{var E=c.getUint32(0),I=c.getUint32(4),w=(E&3)*4294967296+I,S=E>>>2;return{sec:w,nsec:S}}case 12:{var w=Object(i.getInt64)(c,4),S=c.getUint32(0);return{sec:w,nsec:S}}default:throw new s.DecodeError("Unrecognized data size for timestamp (expected 4, 8, or 12): "+b.length)}}function m(b){var c=a(b);return new Date(c.sec*1e3+c.nsec/1e6)}var _={type:o,encode:y,decode:m}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs":function(n,t,r){r.r(t),r.d(t,"UINT32_MAX",function(){return s}),r.d(t,"setUint64",function(){return i}),r.d(t,"setInt64",function(){return o}),r.d(t,"getInt64",function(){return l}),r.d(t,"getUint64",function(){return f});var s=4294967295;function i(u,g,y){var a=y/4294967296,m=y;u.setUint32(g,a),u.setUint32(g+4,m)}function o(u,g,y){var a=Math.floor(y/4294967296),m=y;u.setUint32(g,a),u.setUint32(g+4,m)}function l(u,g){var y=u.getInt32(g),a=u.getUint32(g+4);return y*4294967296+a}function f(u,g){var y=u.getUint32(g),a=u.getUint32(g+4);return y*4294967296+a}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/prettyByte.mjs":function(n,t,r){r.r(t),r.d(t,"prettyByte",function(){return s});function s(i){return(i<0?"-":"")+"0x"+Math.abs(i).toString(16).padStart(2,"0")}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/stream.mjs":function(n,t,r){r.r(t),r.d(t,"isAsyncIterable",function(){return l}),r.d(t,"asyncIterableFromStream",function(){return u}),r.d(t,"ensureAsyncIterable",function(){return g});var s=function(y,a){var m={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,b,c,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(I){return function(A){return E([I,A])}}function E(I){if(_)throw new TypeError("Generator is already executing.");for(;m;)try{if(_=1,b&&(c=I[0]&2?b.return:I[0]?b.throw||((c=b.return)&&c.call(b),0):b.next)&&!(c=c.call(b,I[1])).done)return c;switch(b=0,c&&(I=[I[0]&2,c.value]),I[0]){case 0:case 1:c=I;break;case 4:return m.label++,{value:I[1],done:!1};case 5:m.label++,b=I[1],I=[0];continue;case 7:I=m.ops.pop(),m.trys.pop();continue;default:if(c=m.trys,!(c=c.length>0&&c[c.length-1])&&(I[0]===6||I[0]===2)){m=0;continue}if(I[0]===3&&(!c||I[1]>c[0]&&I[1]<c[3])){m.label=I[1];break}if(I[0]===6&&m.label<c[1]){m.label=c[1],c=I;break}if(c&&m.label<c[2]){m.label=c[2],m.ops.push(I);break}c[2]&&m.ops.pop(),m.trys.pop();continue}I=a.call(y,m)}catch(A){I=[6,A],b=0}finally{_=c=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},i=function(y){return this instanceof i?(this.v=y,this):new i(y)},o=function(y,a,m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=m.apply(y,a||[]),b,c=[];return b={},w("next"),w("throw"),w("return"),b[Symbol.asyncIterator]=function(){return this},b;function w(O){_[O]&&(b[O]=function(C){return new Promise(function(k,P){c.push([O,C,k,P])>1||S(O,C)})})}function S(O,C){try{E(_[O](C))}catch(k){T(c[0][3],k)}}function E(O){O.value instanceof i?Promise.resolve(O.value.v).then(I,A):T(c[0][2],O)}function I(O){S("next",O)}function A(O){S("throw",O)}function T(O,C){O(C),c.shift(),c.length&&S(c[0][0],c[0][1])}};function l(y){return y[Symbol.asyncIterator]!=null}function f(y){if(y==null)throw new Error("Assertion Failure: value must not be null nor undefined")}function u(y){return o(this,arguments,function(){var m,_,b,c;return s(this,function(w){switch(w.label){case 0:m=y.getReader(),w.label=1;case 1:w.trys.push([1,,9,10]),w.label=2;case 2:return[4,i(m.read())];case 3:return _=w.sent(),b=_.done,c=_.value,b?[4,i(void 0)]:[3,5];case 4:return[2,w.sent()];case 5:return f(c),[4,i(c)];case 6:return[4,w.sent()];case 7:return w.sent(),[3,2];case 8:return[3,10];case 9:return m.releaseLock(),[7];case 10:return[2]}})})}function g(y){return l(y)?y:u(y)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs":function(n,t,r){r.r(t),r.d(t,"ensureUint8Array",function(){return s}),r.d(t,"createDataView",function(){return i});function s(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o instanceof ArrayBuffer?new Uint8Array(o):Uint8Array.from(o)}function i(o){if(o instanceof ArrayBuffer)return new DataView(o);var l=s(o);return new DataView(l.buffer,l.byteOffset,l.byteLength)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs":function(n,t,r){r.r(t),r.d(t,"utf8Count",function(){return o}),r.d(t,"utf8EncodeJs",function(){return l}),r.d(t,"TEXT_ENCODER_THRESHOLD",function(){return u}),r.d(t,"utf8EncodeTE",function(){return a}),r.d(t,"utf8DecodeJs",function(){return _}),r.d(t,"TEXT_DECODER_THRESHOLD",function(){return c}),r.d(t,"utf8DecodeTD",function(){return w});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),i=(typeof process>"u"||define_process_env_default.TEXT_ENCODING!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function o(S){for(var E=S.length,I=0,A=0;A<E;){var T=S.charCodeAt(A++);if(T&4294967168)if(!(T&4294965248))I+=2;else{if(T>=55296&&T<=56319&&A<E){var O=S.charCodeAt(A);(O&64512)===56320&&(++A,T=((T&1023)<<10)+(O&1023)+65536)}T&4294901760?I+=4:I+=3}else{I++;continue}}return I}function l(S,E,I){for(var A=S.length,T=I,O=0;O<A;){var C=S.charCodeAt(O++);if(C&4294967168)if(!(C&4294965248))E[T++]=C>>6&31|192;else{if(C>=55296&&C<=56319&&O<A){var k=S.charCodeAt(O);(k&64512)===56320&&(++O,C=((C&1023)<<10)+(k&1023)+65536)}C&4294901760?(E[T++]=C>>18&7|240,E[T++]=C>>12&63|128,E[T++]=C>>6&63|128):(E[T++]=C>>12&15|224,E[T++]=C>>6&63|128)}else{E[T++]=C;continue}E[T++]=C&63|128}}var f=i?new TextEncoder:void 0,u=i?typeof process<"u"&&define_process_env_default.TEXT_ENCODING!=="force"?200:0:s.UINT32_MAX;function g(S,E,I){E.set(f.encode(S),I)}function y(S,E,I){f.encodeInto(S,E.subarray(I))}var a=f!=null&&f.encodeInto?y:g,m=4096;function _(S,E,I){for(var A=E,T=A+I,O=[],C="";A<T;){var k=S[A++];if(!(k&128))O.push(k);else if((k&224)===192){var P=S[A++]&63;O.push((k&31)<<6|P)}else if((k&240)===224){var P=S[A++]&63,N=S[A++]&63;O.push((k&31)<<12|P<<6|N)}else if((k&248)===240){var P=S[A++]&63,N=S[A++]&63,L=S[A++]&63,F=(k&7)<<18|P<<12|N<<6|L;F>65535&&(F-=65536,O.push(F>>>10&1023|55296),F=56320|F&1023),O.push(F)}else O.push(k);O.length>=m&&(C+=String.fromCharCode.apply(String,O),O.length=0)}return O.length>0&&(C+=String.fromCharCode.apply(String,O)),C}var b=i?new TextDecoder:null,c=i?typeof process<"u"&&define_process_env_default.TEXT_DECODER!=="force"?200:0:s.UINT32_MAX;function w(S,E,I){var A=S.subarray(E,E+I);return b.decode(A)}},"./package.json":function(n){n.exports=JSON.parse('{"name":"imjoy-rpc","version":"0.5.46","description":"Remote procedure calls for ImJoy.","module":"index.js","types":"index.d.ts","scripts":{"build":"rm -rf dist && npm run build-umd","build-umd":"webpack --config webpack.config.js --mode development && NODE_ENV=production webpack --config webpack.config.js --mode production --devtool source-map ","watch":"NODE_ENV=production webpack --watch --progress --config webpack.config.js --mode production --devtool source-map","publish-npm":"npm install && npm run build && npm publish","serve":"webpack-dev-server","stats":"webpack --profile --json > stats.json","stats-prod":"webpack --profile --json --mode production > stats-prod.json","analyze":"webpack-bundle-analyzer -p 9999 stats.json","analyze-prod":"webpack-bundle-analyzer -p 9999 stats-prod.json","clean":"rimraf dist/*","deploy":"npm run build && node deploy-site.js","format":"prettier --write \\"{src,tests}/**/**\\"","check-format":"prettier --check \\"{src,tests}/**/**\\"","test":"karma start --single-run --browsers ChromeHeadless,FirefoxHeadless karma.conf.js","test-watch":"karma start --auto-watch --browsers ChromeDebugging karma.conf.js --debug"},"repository":{"type":"git","url":"git+https://github.com/imjoy-team/imjoy-rpc.git"},"keywords":["imjoy","rpc"],"author":"imjoy-team <imjoy.team@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/imjoy-team/imjoy-rpc/issues"},"homepage":"https://github.com/imjoy-team/imjoy-rpc","dependencies":{"@msgpack/msgpack":"^2.7.1","socket.io-client":"^4.6.2"},"devDependencies":{"@babel/core":"^7.16.12","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/polyfill":"^7.12.1","@babel/preset-env":"^7.16.11","@types/requirejs":"^2.1.34","babel-core":"^6.26.0","babel-eslint":"^10.1.0","babel-loader":"^8.2.3","babel-runtime":"^6.26.0","chai":"^4.3.6","clean-webpack-plugin":"^0.1.19","copy-webpack-plugin":"^5.1.2","eslint":"^6.8.0","eslint-config-prettier":"^4.2.0","eslint-loader":"^4.0.2","file-loader":"^0.11.2","fs-extra":"^0.30.0","gh-pages":"^2.0.1","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","json-loader":"^0.5.4","karma":"^6.3.12","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^1.3.0","karma-mocha":"^2.0.1","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"0.0.32","karma-webpack":"^4.0.2","lerna":"^6.0.3","lodash.debounce":"^4.0.8","mocha":"^10.1.0","postcss":"^7.0.36","prettier":"^1.6.1","rimraf":"^2.6.2","schema-utils":"^0.4.3","style-loader":"^0.18.1","ts-loader":"^9.4.3","url-loader":"^0.5.9","webpack":"^4.46.0","webpack-bundle-analyzer":"^4.7.0","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.3","webpack-merge":"^4.1.1","workbox-webpack-plugin":"^4.3.1","worker-loader":"^2.0.0","write-file-webpack-plugin":"^4.5.1"},"eslintConfig":{"globals":{"document":true,"window":true}}}')},"./src/hypha/rpc.js":function(n,t,r){r.r(t),r.d(t,"API_VERSION",function(){return o}),r.d(t,"RPC",function(){return _});var s=r("./src/hypha/utils.js"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/index.mjs");const o="0.3.0",l=1024*500,f=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;function u(b,c){const w=new Uint8Array(b.byteLength+c.byteLength);return w.set(new Uint8Array(b),0),w.set(new Uint8Array(c),b.byteLength),w.buffer}function g(b,c){if(!c)throw new Error("undefined index");return typeof c=="string"?g(b,c.split(".")):c.length===0?b:g(b[c[0]],c.slice(1))}function y(b){const c=b.toString(),w=c.match(/function\s*(\w*)/),S=w&&w[1]||"",E=c.match(/\(([^)]*)\)/);let I="";E&&(I=E[1].split(",").map(k=>k.replace(/\/\*.*?\*\//g,"").replace(/\/\/.*$/g,"")).filter(k=>k.trim().length>0).map(k=>k.trim()).join(", "));let A=c.match(/\)\s*\{\s*\/\*([\s\S]*?)\*\//);const T=A&&A[1].trim()||"";A=c.match(/\)\s*\{\s*(\/\/[\s\S]*?)\n\s*[^\s\/]/);const O=A&&A[1].split(`
`).map(k=>k.replace(/^\/\/\s*/,"").trim()).join(`
`)||"",C=T||O;return S&&I.length>0&&{name:S,sig:I,doc:C}}function a(b){var c=b.map(function(E){return E.byteLength}),w=c.reduce(function(E,I){return E+I},0),S=new Uint8Array(w);return c.reduce(function(E,I,A){return S.set(new Uint8Array(b[A]),E),E+I},0),S.buffer}class m{constructor(c,w,S,E){this._timeout=c,this._callback=w,this._args=S,this._label=E||"timer",this._task=null,this.started=!1}start(){this.started?this.reset():(this._task=setTimeout(()=>{this._callback.apply(this,this._args)},this._timeout*1e3),this.started=!0)}clear(){this._task?(clearTimeout(this._task),this._task=null,this.started=!1):console.warn(`Clearing a timer (${this._label}) which is not started`)}reset(){this._task&&clearTimeout(this._task),this._task=setTimeout(()=>{this._callback.apply(this,this._args)},this._timeout*1e3),this.started=!0}}class _ extends s.MessageEmitter{constructor(c,{client_id:w=null,manager_id:S=null,default_context:E=null,name:I=null,codecs:A=null,method_timeout:T=null,max_message_buffer_size:O=0,debug:C=!1,workspace:k=null}){super(C),this._codecs=A||{},Object(s.assert)(w&&typeof w=="string"),Object(s.assert)(w,"client_id is required"),this._client_id=w,this._name=I,this._connection_info=null,this._workspace=null,this._local_workspace=k,this.manager_id=S,this.default_context=E||{},this._method_annotations=new WeakMap,this._manager_service=null,this._max_message_buffer_size=O,this._chunk_store={},this._method_timeout=T||30,this._services={},this._object_store={services:this._services},c?(this.add_service({id:"built-in",type:"built-in",name:"RPC built-in services",config:{require_context:!0,visibility:"public"},ping:this._ping.bind(this),get_service:this.get_local_service.bind(this),register_service:this.register_service.bind(this),message_cache:{create:this._create_message.bind(this),append:this._append_message.bind(this),process:this._process_message.bind(this),remove:this._remove_message.bind(this)}}),this.on("method",this._handle_method.bind(this)),Object(s.assert)(c.emit_message&&c.on_message),this._emit_message=c.emit_message.bind(c),c.on_message(this._on_message.bind(this)),this._connection=c,this._get_connection_info()):this._emit_message=function(){console.log("No connection to emit message")}}async _get_connection_info(){if(this.manager_id)try{if(await this.get_manager_service(30),Object(s.assert)(this._manager_service),this._connection_info=await this._manager_service.get_connection_info(),this._connection_info.reconnection_token&&this._connection.set_reconnection_token){this._connection.set_reconnection_token(this._connection_info.reconnection_token);const c=this._connection_info.reconnection_expires_in*.8;this._get_connection_info_task=setTimeout(this._get_connection_info.bind(this),c*1e3)}}catch(c){console.warn("Failed to fetch user info from ",this.manager_id,c)}}register_codec(c){if(!c.name||!c.encoder&&!c.decoder)throw new Error("Invalid codec format, please make sure you provide a name, type, encoder and decoder.");if(c.type)for(let w of Object.keys(this._codecs))(this._codecs[w].type===c.type||w===c.name)&&(delete this._codecs[w],console.warn("Remove duplicated codec: "+w));this._codecs[c.name]=c}async _ping(c,w){return Object(s.assert)(c=="ping"),"pong"}async ping(c,w){let S=this._generate_remote_method({_rtarget:c,_rmethod:"services.built-in.ping",_rpromise:!0,_rdoc:"Ping a remote client",_rsig:"ping(msg)"});Object(s.assert)(await S("ping",w)=="pong")}_create_message(c,w,S,E){if(w){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}if(this._object_store.message_cache||(this._object_store.message_cache={}),!S&&this._object_store.message_cache[c])throw new Error(`Message with the same key (${c}) already exists in the cache store, please use overwrite=true or remove it first.`);this._object_store.message_cache[c]=[]}_append_message(c,w,S,E){if(S){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}const I=this._object_store.message_cache;if(!I[c])throw new Error(`Message with key ${c} does not exists.`);Object(s.assert)(w instanceof f),I[c].push(w)}_remove_message(c,w){const S=this._object_store.message_cache;if(!S[c])throw new Error(`Message with key ${c} does not exists.`);delete S[c]}_process_message(c,w,S){if(w){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}const E=this._object_store.message_cache;if(Object(s.assert)(!!S,"Context is required"),!E[c])throw new Error(`Message with key ${c} does not exists.`);E[c]=a(E[c]),console.debug(`Processing message ${c} (size=${E[c].length})`);let I=Object(i.decodeMulti)(E[c]);const{done:A,value:T}=I.next(),O=T;if(Object.assign(O,{from:S.from,to:S.to,user:S.user}),O.ctx=JSON.parse(JSON.stringify(O)),Object.assign(O.ctx,this.default_context),!A){let C=I.next();Object.assign(O,C.value)}this._fire(O.type,O),delete E[c]}_on_message(c){try{Object(s.assert)(c instanceof ArrayBuffer);let w=Object(i.decodeMulti)(c);const{done:S,value:E}=w.next(),I=E;if(I.ctx=JSON.parse(JSON.stringify(I)),Object.assign(I.ctx,this.default_context),!S){let A=w.next();Object.assign(I,A.value)}this._fire(I.type,I)}catch{console.error(e)}}reset(){this._event_handlers={},this._services={}}async disconnect(){this._get_connection_info_task&&(clearTimeout(this._get_connection_info_task),this._get_connection_info_task=null),this._fire("disconnect")}async get_manager_service(c){this.manager_id&&!this._manager_service&&(this._manager_service=await this.get_remote_service(`${this.manager_id}:default`,c))}get_all_local_services(){return this._services}get_local_service(c,w){Object(s.assert)(c);const[S,E]=w.to.split("/");Object(s.assert)(E===this._client_id,"Services can only be accessed locally");const I=this._services[c];if(!I)throw new Error("Service not found: "+c);if(I.config.visibility=="public"||w.from.startsWith(S+"/"))return I;throw new Error("Permission denied for service: "+c)}async get_remote_service(c,w){w=w===void 0?this._method_timeout:w,!c&&this.manager_id?c=this.manager_id:c.includes(":")||(c=this._client_id+":"+c);const S=c.split(":")[0];Object(s.assert)(S);try{const E=this._generate_remote_method({_rtarget:S,_rmethod:"services.built-in.get_service",_rpromise:!0,_rdoc:"Get a remote service",_rsig:"get_service(service_id)"}),I=await Object(s.waitFor)(E(c.split(":")[1]),w,"Timeout Error: Failed to get remote service: "+c);return I.id=c,I}catch(E){throw console.error("Failed to get remote service: "+c,E),E}}_annotate_service_methods(c,w,S,E,I){if(typeof c=="function"){let A=w.split(".")[1];this._method_annotations.set(c,{require_context:Array.isArray(S)?S.includes(A):!!S,run_in_executor:E,method_id:"services."+w,visibility:I})}else if(c instanceof Array||c instanceof Object)for(let A of Object.keys(c)){let T=c[A];if(typeof T=="function"&&T.__rpc_object__){let O=T.__rpc_object__._rtarget;if(O.includes("/")&&(O=O.split("/")[1]),this._client_id===O)c instanceof Array&&(c=c.slice()),c[A]=g(this._object_store,T.__rpc_object__._rmethod),T=c[A];else throw new Error(`Local method not found: ${T.__rpc_object__._rmethod}, client id mismatch ${this._client_id} != ${O}`)}this._annotate_service_methods(T,w+"."+A,S,E,I)}}add_service(c,w){if(!c||Array.isArray(c))throw new Error("Invalid service object");if(c.constructor===Object)c=Object.assign({},c);else{const A={},T=Object.getOwnPropertyNames(c).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(c)));for(let O of T)O!=="constructor"&&(typeof c[O]=="function"?A[O]=c[O].bind(c):A[O]=c[O]);c.id=c.id||"default",c=A}Object(s.assert)(c.id&&typeof c.id=="string",`Service id not found: ${c}`),c.name||(c.name=c.id),c.config||(c.config={}),c.type||(c.type="generic");let S=!1,E=!1;c.config.require_context&&(S=c.config.require_context),c.config.run_in_executor&&(E=!0);const I=c.config.visibility||"protected";if(Object(s.assert)(["protected","public"].includes(I)),this._annotate_service_methods(c,c.id,S,E,I),this._services[c.id])if(w)delete this._services[c.id];else throw new Error(`Service already exists: ${c.id}, please specify a different id (not ${c.id}) or overwrite=true`);return this._services[c.id]=c,c}async register_service(c,w,S,E){if(S===void 0&&(S=!0),E){const[A,T]=E.to.split("/");Object(s.assert)(T===this._client_id),Object(s.assert)(A===E.from.split("/")[0],"Services can only be registered from the same workspace")}const I=this.add_service(c,w);return S&&(this._fire("service-updated",{service_id:I.id,api:I,type:"add"}),await this._notify_service_update()),{id:`${this._client_id}:${I.id}`,type:I.type,name:I.name,description:I.description||"",config:I.config}}async unregister_service(c,w){if(c instanceof Object&&(c=c.id),!this._services[c])throw new Error(`Service not found: ${c}`);const S=this._services[c];delete this._services[c],this._fire("service-updated",{service_id:c,api:S,type:"remove"}),await this._notify_service_update()}_ndarray(c,w,S){const E=Object(s.typedArrayToDtype)(c);if(S&&S!==E)throw"dtype doesn't match the type of the array: "+E+" != "+S;return w=w||[c.length],{_rtype:"ndarray",_rvalue:c.buffer,_rshape:w,_rdtype:E}}_encode_callback(c,w,S,E,I,A){let T=`${S}.${c}`,O={_rtype:"method",_rtarget:A?`${A}/${this._client_id}`:this._client_id,_rmethod:T,_rpromise:!1};const C=this;return[O,function(){try{w.apply(null,Array.prototype.slice.call(arguments))}catch(P){console.error("Error in callback:",T,P)}finally{E&&C._object_store[S]&&delete C._object_store[S],I&&I.started&&I.clear()}}]}async _encode_promise(c,w,S,E,I,A){let T=this._get_session_store(S,!0);Object(s.assert)(T,`Failed to create session store ${S} due to invalid parent`);let O={};return I&&w&&this._method_timeout?(O.heartbeat=await this._encode(I.reset.bind(I),S,A),O.interval=this._method_timeout/2,T.timer=I):I=null,[O.resolve,T.resolve]=this._encode_callback("resolve",c,S,E,I,A),[O.reject,T.reject]=this._encode_callback("reject",w,S,E,I,A),O}async _send_chunks(c,w,S){let E=await this.get_remote_service(`${w}:built-in`);Object(s.assert)(E.message_cache,"Remote client does not support message caching for long message.");let I=E.message_cache,A=S||Object(s.randId)();await I.create(A,!!S);let T=c.length,O=Math.ceil(T/l);for(let C=0;C<O;C++){let k=C*l;await I.append(A,c.slice(k,k+l),!!S)}await I.process(A,!!S)}_generate_remote_method(c,w,S,E,I){let A=c._rtarget;E&&!A.includes("/")&&(A=E+"/"+A,c._rtarget=A);let T=c._rmethod,O=c._rpromise;const C=this;function k(){return new Promise(async(N,L)=>{let F=Object(s.randId)();S&&(F=S+"."+F);let V=C._get_session_store(F,!0);if(!V){L(new Error(`Runtime Error: Failed to get session store ${F}`));return}V.target_id=A;const j=await C._encode(Array.prototype.slice.call(arguments),F,I),K=j.length,U=K>0&&typeof j[K-1]=="object"&&j[K-1]!==null&&j[K-1]._rkwargs;U&&delete j[K-1]._rkwargs;let X={type:"method",from:C._local_workspace?C._local_workspace+"/"+C._client_id:C._client_id,to:A,method:T},J={};j&&(J.args=j),U&&(J.with_kwargs=U),w&&(X.parent=w);let Y=null;if(O){X.session=F;let de=`${A}:${T}`;Y=new m(C._method_timeout,L,[`Method call time out: ${de}`],de),J.promise=await C._encode_promise(N,L,F,!0,Y,I)}let te=Object(i.encode)(X);if(J){const de=Object(i.encode)(J);te=new Uint8Array([...te,...de])}te.length<=l+1024?C._emit_message(te).then(function(){Y&&Y.start()}):C._send_chunks(te,A,w).then(function(){Y&&Y.start()})})}k.__rpc_object__=c;const P=T.split(".");return k.__name__=P[P.length-1],k.__doc__=c._rdoc,k.__sig__=c._rsig,k}async _notify_service_update(){if(this.manager_id)try{await this.get_manager_service(30),Object(s.assert)(this._manager_service),await this._manager_service.update_client_info(this.get_client_info())}catch(c){console.warn("Failed to notify service update to",this.manager_id,c)}}get_client_info(){const c=[];for(let w of Object.values(this._services))c.push({id:`${this._client_id}:${w.id}`,type:w.type,name:w.name,description:w.description||"",config:w.config});return{id:this._client_id,services:c}}async _handle_method(c){let w=null;try{Object(s.assert)(c.method&&c.ctx&&c.from);const S=c.from+":"+c.method,E=c.from.split("/")[0];c.to=c.to.includes("/")?c.to:E+"/"+c.to,c.ctx.to=c.to;const I=c.to.split("/")[0],A=c.parent;let T,O;if(c.promise){const P=await this._decode(c.promise,c.session,A,E,I);if(T=P.resolve,O=P.reject,P.heartbeat&&P.interval){async function N(){try{await P.heartbeat()}catch(L){console.error(L)}}w=setInterval(N,P.interval*1e3)}}let C;try{C=g(this._object_store,c.method)}catch(P){throw console.debug("Failed to find method",S,P),new Error(`Method not found: ${S}`)}if(Object(s.assert)(C&&typeof C=="function","Invalid method: "+S),this._method_annotations.has(C)){if(this._method_annotations.get(C).visibility==="protected"&&I!==E)throw new Error("Permission denied for protected method "+S+", workspace mismatch: "+I+" != "+E)}else{let P=this._object_store[c.method.split(".")[0]].target_id;if(I===E&&P&&P.indexOf("/")===-1&&(P=I+"/"+P),P!==c.from)throw new Error("Access denied for method call ("+S+") from "+c.from)}A&&Object(s.assert)(this._get_session_store(A,!0)!==null,"Parent session was closed: "+A);let k;if(c.args?k=await this._decode(c.args,c.session,null,E,null):k=[],this._method_annotations.has(C)&&this._method_annotations.get(C).require_context&&k.push(c.ctx),c.promise){const P=C.apply(null,k);P instanceof Promise?P.then(N=>{T(N),clearInterval(w)}).catch(N=>{O(N),clearInterval(w)}):(T(P),clearInterval(w))}else C.apply(null,k),clearInterval(w)}catch(S){console.error("Error during calling method: ",S),clearInterval(w)}}encode(c,w){return this._encode(c,w)}_get_session_store(c,w){let S=this._object_store;const E=c.split(".");if(w){const I=E.length-1;for(let A of E.slice(0,I)){if(!S[A])return null;S=S[A]}return S[E[I]]||(S[E[I]]={}),S[E[I]]}else{for(let I of E){if(!S[I])return null;S=S[I]}return S}}async _encode(c,w,S){const E=typeof c;if(E==="number"||E==="string"||E==="boolean"||c===null||c===void 0||c instanceof Uint8Array)return c;if(c instanceof ArrayBuffer)return{_rtype:"memoryview",_rvalue:new Uint8Array(c)};if(c.__rpc_object__)return c.__rpc_object__;let I;if(c.constructor instanceof Object&&c._rtype){const T=c._rtype;return delete c._rtype,I=await this._encode(c,w,S),I._rtype=T,I}if(typeof c=="function"){if(this._method_annotations.has(c)){let T=this._method_annotations.get(c);I={_rtype:"method",_rtarget:this._client_id,_rmethod:T.method_id,_rpromise:!0}}else{Object(s.assert)(typeof w=="string");let T;c.__name__?T=`${Object(s.randId)()}-${c.__name__}`:T=Object(s.randId)(),I={_rtype:"method",_rtarget:this._client_id,_rmethod:`${w}.${T}`,_rpromise:!0};let O=this._get_session_store(w,!0);Object(s.assert)(O!==null,`Failed to create session store ${w} due to invalid parent`),O[T]=c}if(I._rdoc=c.__doc__,I._rsig=c.__sig__,!I._rdoc||!I._rsig)try{const T=y(c);T&&!I._rdoc&&(I._rdoc=`${T.doc}`),T&&!I._rsig&&(I._rsig=`${T.name}(${T.sig})`)}catch{console.error("Failed to extract function docstring:",c)}return I}const A=Array.isArray(c);for(let T of Object.keys(this._codecs)){const O=this._codecs[T];if(O.encoder&&c instanceof O.type){let C=await Promise.resolve(O.encoder(c));if(C&&!C._rtype&&(C._rtype=O.name),typeof C=="object"){const k=C._rtype;delete C._rtype,C=await this._encode(C,w,S),C._rtype=k}return I=C,I}}if(typeof tf<"u"&&tf.Tensor&&c instanceof tf.Tensor){const T=c.dataSync();I={_rtype:"ndarray",_rvalue:new Uint8Array(T.buffer),_rshape:c.shape,_rdtype:c.dtype}}else if(typeof nj<"u"&&nj.NdArray&&c instanceof nj.NdArray){const T=Object(s.typedArrayToDtype)(c.selection.data);I={_rtype:"ndarray",_rvalue:new Uint8Array(c.selection.data.buffer),_rshape:c.shape,_rdtype:T}}else if(c instanceof Error)console.error(c),I={_rtype:"error",_rvalue:c.toString()};else if(c!==Object(c)||c instanceof Boolean||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof ImageData||typeof FileList<"u"&&c instanceof FileList||typeof FileSystemDirectoryHandle<"u"&&c instanceof FileSystemDirectoryHandle||typeof FileSystemFileHandle<"u"&&c instanceof FileSystemFileHandle||typeof FileSystemHandle<"u"&&c instanceof FileSystemHandle||typeof FileSystemWritableFileStream<"u"&&c instanceof FileSystemWritableFileStream)I=c;else if(c instanceof Blob){let T=function(k){O=k},O=0;async function C(k){let P;k?P=c.slice(O,O+k):P=c.slice(O);const N=new Uint8Array(await P.arrayBuffer());return O=O+N.byteLength,N}I={_rtype:"iostream",_rnative:"js:blob",type:c.type,name:c.name,size:c.size,path:c._path||c.webkitRelativePath,read:await this._encode(C,w,S),seek:await this._encode(T,w,S)}}else if(c instanceof f){const T=Object(s.typedArrayToDtype)(c);I={_rtype:"typedarray",_rvalue:new Uint8Array(c.buffer),_rdtype:T}}else if(c instanceof DataView)I={_rtype:"memoryview",_rvalue:new Uint8Array(c.buffer)};else if(c instanceof Set)I={_rtype:"set",_rvalue:await this._encode(Array.from(c),w,S)};else if(c instanceof Map)I={_rtype:"orderedmap",_rvalue:await this._encode(Array.from(c),w,S)};else if(c.constructor instanceof Object||Array.isArray(c)){I=A?[]:{};const T=Object.keys(c);for(let O of T)I[O]=await this._encode(c[O],w,S)}else throw`imjoy-rpc: Unsupported data type: ${c}, you can register a custom codec to encode/decode the object.`;if(!I)throw new Error("Failed to encode object");return I}async decode(c){return await this._decode(c)}async _decode(c,w,S,E,I){if(!c)return c;let A;if(c._rtype)if(this._codecs[c._rtype]&&this._codecs[c._rtype].decoder){const T=c._rtype;delete c._rtype,c=await this._decode(c,w,S,E,I),c._rtype=T,A=await Promise.resolve(this._codecs[c._rtype].decoder(c))}else if(c._rtype==="method")A=this._generate_remote_method(c,w,S,E,I);else if(c._rtype==="ndarray")if(typeof nj<"u"&&nj.array)Array.isArray(c._rvalue)&&(c._rvalue=c._rvalue.reduce(u)),A=nj.array(new Uint8(c._rvalue),c._rdtype).reshape(c._rshape);else if(typeof tf<"u"&&tf.Tensor){Array.isArray(c._rvalue)&&(c._rvalue=c._rvalue.reduce(u));const T=s.dtypeToTypedArray[c._rdtype];A=tf.tensor(new T(c._rvalue),c._rshape,c._rdtype)}else A=c;else if(c._rtype==="error")A=new Error(c._rvalue);else if(c._rtype==="typedarray"){const T=s.dtypeToTypedArray[c._rdtype];if(!T)throw new Error("unsupported dtype: "+c._rdtype);const O=c._rvalue.buffer.slice(c._rvalue.byteOffset,c._rvalue.byteOffset+c._rvalue.byteLength);A=new T(O)}else if(c._rtype==="memoryview")A=c._rvalue.buffer.slice(c._rvalue.byteOffset,c._rvalue.byteOffset+c._rvalue.byteLength);else if(c._rtype==="iostream"){if(c._rnative==="js:blob"){const O=await(await this._generate_remote_method(c.read,w,S,E,I))();A=new Blob([O],{type:c.type,name:c.name})}else{A={};for(let T of Object.keys(c))T.startsWith("_")||(A[T]=await this._decode(c[T],w,S,E,I))}A.__rpc_object__=c}else if(c._rtype==="orderedmap")A=new Map(await this._decode(c._rvalue,w,S,E,I));else if(c._rtype==="set")A=new Set(await this._decode(c._rvalue,w,S,E,I));else{const T=c._rtype;delete c._rtype,A=await this._decode(c,w,S,E,I),A._rtype=T}else if(c.constructor===Object||Array.isArray(c)){const T=Array.isArray(c);A=T?[]:{};for(let O of Object.keys(c))if(T||c.hasOwnProperty(O)){const C=c[O];A[O]=await this._decode(C,w,S,E,I)}}else A=c;if(A===void 0)throw new Error("Failed to decode object");return A}}},"./src/hypha/utils.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"randId",function(){return randId}),__webpack_require__.d(__webpack_exports__,"dtypeToTypedArray",function(){return dtypeToTypedArray}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWindow",function(){return loadRequirementsInWindow}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWebworker",function(){return loadRequirementsInWebworker}),__webpack_require__.d(__webpack_exports__,"loadRequirements",function(){return loadRequirements}),__webpack_require__.d(__webpack_exports__,"normalizeConfig",function(){return normalizeConfig}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtypeMapping",function(){return typedArrayToDtypeMapping}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtype",function(){return typedArrayToDtype}),__webpack_require__.d(__webpack_exports__,"cacheRequirements",function(){return cacheRequirements}),__webpack_require__.d(__webpack_exports__,"setupServiceWorker",function(){return setupServiceWorker}),__webpack_require__.d(__webpack_exports__,"assert",function(){return assert}),__webpack_require__.d(__webpack_exports__,"urlJoin",function(){return urlJoin}),__webpack_require__.d(__webpack_exports__,"waitFor",function(){return waitFor}),__webpack_require__.d(__webpack_exports__,"MessageEmitter",function(){return MessageEmitter});function randId(){return Math.random().toString(36).substr(2,10)+new Date().getTime()}const dtypeToTypedArray={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,array:Array};async function loadRequirementsInWindow(n){function t(o){return new Promise((l,f)=>{var u=document.createElement("script");u.src=o,u.type="text/javascript",u.onload=l,u.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&l()},u.onerror=f,document.head.appendChild(u)})}async function r(){for(var o=Array.prototype.slice.call(arguments),l=o.length,f=0;f<l;f++)await t(o[f])}if(n&&(Array.isArray(n)||typeof n=="string"))try{var s;if(n=typeof n=="string"?[n]:n,Array.isArray(n))for(var i=0;i<n.length;i++)n[i].toLowerCase().endsWith(".css")||n[i].startsWith("css:")?(n[i].startsWith("css:")&&(n[i]=n[i].slice(4)),s=document.createElement("link"),s.rel="stylesheet",s.href=n[i],document.head.appendChild(s)):n[i].toLowerCase().endsWith(".mjs")||n[i].startsWith("mjs:")?(n[i].startsWith("mjs:")&&(n[i]=n[i].slice(4)),await __vitePreload(()=>import(n[i]),__vite__mapDeps([]))):n[i].toLowerCase().endsWith(".js")||n[i].startsWith("js:")?(n[i].startsWith("js:")&&(n[i]=n[i].slice(3)),await r(n[i])):n[i].startsWith("http")?await r(n[i]):n[i].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[i]);else throw"unsupported requirements definition"}catch{throw"failed to import required scripts: "+n.toString()}}async function loadRequirementsInWebworker(n){if(n&&(Array.isArray(n)||typeof n=="string"))try{Array.isArray(n)||(n=[n]);for(var t=0;t<n.length;t++){if(n[t].toLowerCase().endsWith(".css")||n[t].startsWith("css:"))throw"unable to import css in a webworker";n[t].toLowerCase().endsWith(".js")||n[t].startsWith("js:")?(n[t].startsWith("js:")&&(n[t]=n[t].slice(3)),importScripts(n[t])):n[t].startsWith("http")?importScripts(n[t]):n[t].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[t])}}catch{throw"failed to import required scripts: "+n.toString()}}function loadRequirements(n){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?loadRequirementsInWebworker(n):loadRequirementsInWindow(n)}function normalizeConfig(n){return n.version=n.version||"0.1.0",n.description=n.description||`[TODO: add description for ${n.name} ]`,n.type=n.type||"rpc-window",n.id=n.id||randId(),n.target_origin=n.target_origin||"*",n.allow_execution=n.allow_execution||!1,n=Object.keys(n).reduce((t,r)=>(typeof n[r]!="function"&&(t[r]=n[r]),t),{}),n}const typedArrayToDtypeMapping={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"array"},typedArrayToDtypeKeys=[];for(const arrType of Object.keys(typedArrayToDtypeMapping))typedArrayToDtypeKeys.push(eval(arrType));function typedArrayToDtype(n){let t=typedArrayToDtypeMapping[n.constructor.name];if(!t){const r=Object.getPrototypeOf(n);for(const s of typedArrayToDtypeKeys)if(r instanceof s){t=typedArrayToDtypeMapping[s.name];break}}return t}function cacheUrlInServiceWorker(n){return new Promise(function(t,r){const s={command:"add",url:n};if(!navigator.serviceWorker||!navigator.serviceWorker.register){r("Service worker is not supported.");return}const i=new MessageChannel;i.port1.onmessage=function(o){o.data&&o.data.error?r(o.data.error):t(o.data&&o.data.result)},navigator.serviceWorker&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(s,[i.port2]):r("Service worker controller is not available")})}async function cacheRequirements(n){n=n||[],Array.isArray(n)||(n=[n]);for(let t of n)t.startsWith("js:")&&(t=t.slice(3)),t.startsWith("css:")&&(t=t.slice(4)),t.startsWith("cache:")&&(t=t.slice(6)),t.startsWith("http")&&await cacheUrlInServiceWorker(t).catch(r=>{console.error(r)})}function setupServiceWorker(n,t,r){if("serviceWorker"in navigator){if(n=n||"/",navigator.serviceWorker.register(n+"plugin-service-worker.js").then(function(s){console.log("ServiceWorker registration successful with scope: ",s.scope)},function(s){console.log("ServiceWorker registration failed: ",s)}),t=t||"*",r=r||cacheRequirements,r&&typeof r!="function")throw new Error("config.cache_requirements must be a function");window.addEventListener("message",function(s){if(t==="*"||s.origin===t){const i=s.data;i.type==="cacheRequirements"&&r(i.requirements)}})}}function assert(n,t){if(!n)throw new Error(t||"Assertion failed")}function urlJoin(...n){return n.join("/").replace(/[\/]+/g,"/").replace(/^(.+):\//,"$1://").replace(/^file:/,"file:/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/\?/g,"&").replace("&","?")}function waitFor(n,t,r){let s;return Promise.race([n,new Promise((i,o)=>s=setTimeout(()=>{o(r||"Timeout Error")},t*1e3))]).finally(()=>clearTimeout(s))}class MessageEmitter{constructor(t){this._event_handlers={},this._once_handlers={},this._debug=t}emit(){throw new Error("emit is not implemented")}on(t,r){this._event_handlers[t]||(this._event_handlers[t]=[]),this._event_handlers[t].push(r)}once(t,r){r.___event_run_once=!0,this.on(t,r)}off(t,r){if(!t&&!r)this._event_handlers={};else if(t&&!r)this._event_handlers[t]&&(this._event_handlers[t]=[]);else if(this._event_handlers[t]){const s=this._event_handlers[t].indexOf(r);s>=0&&this._event_handlers[t].splice(s,1)}}_fire(t,r){if(this._event_handlers[t])for(var s=this._event_handlers[t].length;s--;){const i=this._event_handlers[t][s];try{i(r)}catch(o){console.error(o)}finally{i.___event_run_once&&this._event_handlers[t].splice(s,1)}}else this._debug&&console.warn("unhandled event",t,r)}}},"./src/hypha/webrtc-client.js":function(n,t,r){r.r(t),r.d(t,"getRTCService",function(){return u}),r.d(t,"registerRTCService",function(){return g});var s=r("./src/hypha/rpc.js"),i=r("./src/hypha/utils.js");class o{constructor(a){this._data_channel=a,this._handle_message=null,this._reconnection_token=null,this._data_channel.onmessage=async _=>{let b=_.data;b instanceof Blob&&(b=await b.arrayBuffer()),this._handle_message(b)};const m=this;this._data_channel.onclose=function(){console.log("websocket closed"),m._data_channel=null}}set_reconnection_token(a){this._reconnection_token=a}on_message(a){Object(i.assert)(a,"handler is required"),this._handle_message=a}async emit_message(a){Object(i.assert)(this._handle_message,"No handler for message");try{this._data_channel.send(a)}catch(m){throw console.error(`Failed to send data, error: ${m}`),m}}async disconnect(a){this._data_channel=null,console.info(`data channel connection disconnected (${a})`)}}async function l(y){Object(i.assert)(y.channel,"No channel provided"),Object(i.assert)(y.workspace,"No workspace provided");const a=y.channel,m=y.client_id||Object(i.randId)(),_=new o(a);return y.context=y.context||{},y.context.connection_type="webrtc",new s.RPC(_,{client_id:m,manager_id:null,default_context:y.context,name:y.name,method_timeout:y.method_timeout||10,workspace:y.workspace})}async function f(y,a,m,_,b){m=m||{};let c=new RTCSessionDescription({sdp:y.sdp,type:y.type}),w=new RTCPeerConnection({iceServers:m.ice_servers||[{urls:["stun:stun.l.google.com:19302"]}],sdpSemantics:"unified-plan"});a&&w.addEventListener("datachannel",async E=>{const I=E.channel;let A=null;b&&b.user&&(A={user:b.user});const T=await l({channel:I,client_id:I.label,workspace:a.config.workspace,context:A});T._services=a.rpc._services}),_&&await _(w),await w.setRemoteDescription(c);let S=await w.createAnswer();return await w.setLocalDescription(S),{sdp:w.localDescription.sdp,type:w.localDescription.type,workspace:a.config.workspace}}async function u(y,a,m){m=m||{},m.peer_id=m.peer_id||Object(i.randId)();const _=new RTCPeerConnection({iceServers:m.ice_servers||[{urls:["stun:stun.l.google.com:19302"]}],sdpSemantics:"unified-plan"});return new Promise(async(b,c)=>{try{_.addEventListener("connectionstatechange",()=>{_.connectionState==="failed"&&(_.close(),c(new Error("Connection failed")))},!1),m.on_init&&(await m.on_init(_),delete m.on_init);let w=_.createDataChannel(m.peer_id,{ordered:!0});w.binaryType="arraybuffer";const S=await _.createOffer();await _.setLocalDescription(S);const I=await(await y.getService(a)).offer({sdp:_.localDescription.sdp,type:_.localDescription.type});w.onopen=()=>{m.channel=w,m.workspace=I.workspace,setTimeout(async()=>{const A=await l(m);_.rpc=A;async function T(C){return await A.get_remote_service(m.peer_id+":"+C)}async function O(){await A.disconnect(),_.close()}_.get_service=T,_.getService=T,_.disconnect=O,_.register_codec=A.register_codec,_.registerCodec=A.register_codec,b(_)},500)},w.onclose=()=>c(new Error("Data channel closed")),await _.setRemoteDescription(new RTCSessionDescription({sdp:I.sdp,type:I.type}))}catch(w){c(w)}})}async function g(y,a,m){m=m||{visibility:"protected",require_context:!0};const _=m.on_init;delete m.on_init,await y.registerService({id:a,config:m,offer:(b,c)=>f(b,y,m,_,c)})}},"./src/hypha/websocket-client.js":function(n,t,r){r.r(t),r.d(t,"login",function(){return g}),r.d(t,"connectToServer",function(){return y});var s=r("./src/hypha/rpc.js");r.d(t,"RPC",function(){return s.RPC}),r.d(t,"API_VERSION",function(){return s.API_VERSION});var i=r("./src/hypha/utils.js");r.d(t,"loadRequirements",function(){return i.loadRequirements});var o=r("./src/hypha/webrtc-client.js");r.d(t,"getRTCService",function(){return o.getRTCService}),r.d(t,"registerRTCService",function(){return o.registerRTCService});var l=r("./package.json");r.d(t,"VERSION",function(){return l.version});class f{constructor(m,_,b,c,w=60){Object(i.assert)(m&&_,"server_url and client_id are required"),m=m+"?client_id="+_,b&&(m+="&workspace="+b),c&&(m+="&token="+c),this._websocket=null,this._handle_message=null,this._reconnection_token=null,this._server_url=m,this._timeout=w*1e3,this._opening=null,this._retry_count=0,this._closing=!1}set_reconnection_token(m){this._reconnection_token=m}on_message(m){Object(i.assert)(m,"handler is required"),this._handle_message=m}async open(){return this._opening?this._opening:(this._opening=new Promise((m,_)=>{const b=this._reconnection_token?`${this._server_url}&reconnection_token=${this._reconnection_token}`:this._server_url;console.info("Creating a new connection to ",b.split("?")[0]);const c=new WebSocket(b);c.binaryType="arraybuffer",c.onmessage=w=>{const S=w.data;this._handle_message(S)},c.onopen=()=>{this._websocket=c,console.info("WebSocket connection established"),this._retry_count=0,m()},c.onclose=w=>{console.log("websocket closed"),this._closing||(console.log("Websocket connection interrupted, retrying..."),this._retry_count++,setTimeout(()=>this.open(),this._timeout)),this._websocket=null},c.onerror=w=>{console.log("Error occurred in websocket connection: ",w),_(new Error("Websocket connection failed.")),this._websocket=null}}).finally(()=>{this._opening=null}),this._opening)}async emit_message(m){return Object(i.assert)(this._handle_message,"No handler for message"),(!this._websocket||this._websocket.readyState!==WebSocket.OPEN)&&await this.open(),new Promise((_,b)=>{if(!this._websocket)b(new Error("Websocket connection not available"));else if(this._websocket.readyState===WebSocket.CONNECTING){const c=setTimeout(()=>{b(new Error("WebSocket connection timed out"))},this._timeout);this._websocket.addEventListener("open",()=>{clearTimeout(c);try{this._websocket.send(m),_()}catch(w){console.error(`Failed to send data, error: ${w}`),b(w)}})}else if(this._websocket.readyState===WebSocket.OPEN)try{this._websocket.send(m),_()}catch(c){console.error(`Failed to send data, error: ${c}`),b(c)}else b(new Error("WebSocket is not in the OPEN or CONNECTING state"))})}disconnect(m){this._closing=!0;const _=this._websocket;this._websocket=null,_&&_.readyState===WebSocket.OPEN&&_.close(1e3,m),console.info(`Websocket connection disconnected (${m})`)}}function u(a){if(!a)throw new Error("server_url is required");return a.startsWith("http://")?a=a.replace("http://","ws://").replace(/\/$/,"")+"/ws":a.startsWith("https://")&&(a=a.replace("https://","wss://").replace(/\/$/,"")+"/ws"),a}async function g(a){const m=a.login_service_id||"public/*:hypha-login",_=a.login_timeout||60,b=a.login_callback,c=await y({name:"initial login client",server_url:a.server_url});try{const w=await c.get_service(m),S=await w.start();return b?await b(S):console.log(`Please open your browser and login at ${S.login_url}`),await w.check(S.key,_)}catch(w){throw w}finally{await c.disconnect()}}async function y(a){let m=a.client_id;m||(m=Object(i.randId)());let _=u(a.server_url),b=new f(_,m,a.workspace,a.token,a.method_timeout||60);await b.open();const c=new s.RPC(b,{client_id:m,manager_id:"workspace-manager",default_context:{connection_type:"websocket"},name:a.name,method_timeout:a.method_timeout}),w=await c.get_remote_service("workspace-manager:default");w.rpc=c;async function S(A){A.id="default",A.name=a.name||A.id,await c.register_service(A,!0)}async function E(A){return await w.get_service(A+":default")}async function I(){await c.disconnect(),await b.disconnect()}if(w.export=S,w.getPlugin=E,w.listPlugins=w.listServices,w.disconnect=I,w.registerCodec=c.register_codec.bind(c),a.webrtc&&await Object(o.registerRTCService)(w,m+"-rtc",a.webrtc_config),w.get_service||w.getService){const A=w.get_service||w.getService;w.get_service=async function(T,O,C){Object(i.assert)([void 0,!0,!1,"auto"].includes(O),"webrtc must be true, false or 'auto'");const k=await A(T);if(O===!0||O==="auto"){if(k.id.includes(":")&&k.id.includes("/")){const P=k.id.split(":")[0];try{const N=await Object(o.getRTCService)(w,P+":"+P.split("/")[1]+"-rtc",C),L=await N.get_service(k.id.split(":")[1]);return L._webrtc=!0,L._peer=N,L._service=k,L}catch(N){console.warn("Failed to get webrtc service, using websocket connection",N)}}if(O===!0)throw new Error("Failed to get the service via webrtc")}return k},w.getService=w.get_service}return w}}})})})(hyphaRpcWebsocket);var hyphaRpcWebsocketExports=hyphaRpcWebsocket.exports,hyphaRpcSse={exports:{}};(function(module,exports){var define_process_env_default={};(function(t,r){module.exports=r()})(window,function(){return function(n){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return n[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=n,r.c=t,r.d=function(s,i,o){r.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:o})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,i){if(i&1&&(s=r(s)),i&8||i&4&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),i&2&&typeof s!="string")for(var l in s)r.d(o,l,(function(f){return s[f]}).bind(null,l));return o},r.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(i,"a",i),i},r.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},r.p="",r(r.s="./src/hypha/sse-client.js")}({"./node_modules/@msgpack/msgpack/dist.es5+esm/CachedKeyDecoder.mjs":function(n,t,r){r.r(t),r.d(t,"CachedKeyDecoder",function(){return l});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),i=16,o=16,l=function(){function f(u,g){u===void 0&&(u=i),g===void 0&&(g=o),this.maxKeyLength=u,this.maxLengthPerKey=g,this.hit=0,this.miss=0,this.caches=[];for(var y=0;y<this.maxKeyLength;y++)this.caches.push([])}return f.prototype.canBeCached=function(u){return u>0&&u<=this.maxKeyLength},f.prototype.find=function(u,g,y){var a=this.caches[y-1];e:for(var m=0,_=a;m<_.length;m++){for(var b=_[m],c=b.bytes,w=0;w<y;w++)if(c[w]!==u[g+w])continue e;return b.str}return null},f.prototype.store=function(u,g){var y=this.caches[u.length-1],a={bytes:u,str:g};y.length>=this.maxLengthPerKey?y[Math.random()*y.length|0]=a:y.push(a)},f.prototype.decode=function(u,g,y){var a=this.find(u,g,y);if(a!=null)return this.hit++,a;this.miss++;var m=Object(s.utf8DecodeJs)(u,g,y),_=Uint8Array.prototype.slice.call(u,g,g+y);return this.store(_,m),m},f}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs":function(n,t,r){r.r(t),r.d(t,"DecodeError",function(){return i});var s=function(){var o=function(l,f){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,g){u.__proto__=g}||function(u,g){for(var y in g)Object.prototype.hasOwnProperty.call(g,y)&&(u[y]=g[y])},o(l,f)};return function(l,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");o(l,f);function u(){this.constructor=l}l.prototype=f===null?Object.create(f):(u.prototype=f.prototype,new u)}}(),i=function(o){s(l,o);function l(f){var u=o.call(this,f)||this,g=Object.create(l.prototype);return Object.setPrototypeOf(u,g),Object.defineProperty(u,"name",{configurable:!0,enumerable:!1,value:l.name}),u}return l}(Error)},"./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs":function(n,t,r){r.r(t),r.d(t,"DataViewIndexOutOfBoundsError",function(){return I}),r.d(t,"Decoder",function(){return O});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/prettyByte.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),f=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs"),u=r("./node_modules/@msgpack/msgpack/dist.es5+esm/CachedKeyDecoder.mjs"),g=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs"),y=function(C,k,P,N){function L(F){return F instanceof P?F:new P(function(V){V(F)})}return new(P||(P=Promise))(function(F,V){function j(X){try{U(N.next(X))}catch(J){V(J)}}function K(X){try{U(N.throw(X))}catch(J){V(J)}}function U(X){X.done?F(X.value):L(X.value).then(j,K)}U((N=N.apply(C,k||[])).next())})},a=function(C,k){var P={label:0,sent:function(){if(F[0]&1)throw F[1];return F[1]},trys:[],ops:[]},N,L,F,V;return V={next:j(0),throw:j(1),return:j(2)},typeof Symbol=="function"&&(V[Symbol.iterator]=function(){return this}),V;function j(U){return function(X){return K([U,X])}}function K(U){if(N)throw new TypeError("Generator is already executing.");for(;P;)try{if(N=1,L&&(F=U[0]&2?L.return:U[0]?L.throw||((F=L.return)&&F.call(L),0):L.next)&&!(F=F.call(L,U[1])).done)return F;switch(L=0,F&&(U=[U[0]&2,F.value]),U[0]){case 0:case 1:F=U;break;case 4:return P.label++,{value:U[1],done:!1};case 5:P.label++,L=U[1],U=[0];continue;case 7:U=P.ops.pop(),P.trys.pop();continue;default:if(F=P.trys,!(F=F.length>0&&F[F.length-1])&&(U[0]===6||U[0]===2)){P=0;continue}if(U[0]===3&&(!F||U[1]>F[0]&&U[1]<F[3])){P.label=U[1];break}if(U[0]===6&&P.label<F[1]){P.label=F[1],F=U;break}if(F&&P.label<F[2]){P.label=F[2],P.ops.push(U);break}F[2]&&P.ops.pop(),P.trys.pop();continue}U=k.call(C,P)}catch(X){U=[6,X],L=0}finally{N=F=0}if(U[0]&5)throw U[1];return{value:U[0]?U[1]:void 0,done:!0}}},m=function(C){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k=C[Symbol.asyncIterator],P;return k?k.call(C):(C=typeof __values=="function"?__values(C):C[Symbol.iterator](),P={},N("next"),N("throw"),N("return"),P[Symbol.asyncIterator]=function(){return this},P);function N(F){P[F]=C[F]&&function(V){return new Promise(function(j,K){V=C[F](V),L(j,K,V.done,V.value)})}}function L(F,V,j,K){Promise.resolve(K).then(function(U){F({value:U,done:j})},V)}},_=function(C){return this instanceof _?(this.v=C,this):new _(C)},b=function(C,k,P){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var N=P.apply(C,k||[]),L,F=[];return L={},V("next"),V("throw"),V("return"),L[Symbol.asyncIterator]=function(){return this},L;function V(Y){N[Y]&&(L[Y]=function(te){return new Promise(function(se,de){F.push([Y,te,se,de])>1||j(Y,te)})})}function j(Y,te){try{K(N[Y](te))}catch(se){J(F[0][3],se)}}function K(Y){Y.value instanceof _?Promise.resolve(Y.value.v).then(U,X):J(F[0][2],Y)}function U(Y){j("next",Y)}function X(Y){j("throw",Y)}function J(Y,te){Y(te),F.shift(),F.length&&j(F[0][0],F[0][1])}},c=function(C){var k=typeof C;return k==="string"||k==="number"},w=-1,S=new DataView(new ArrayBuffer(0)),E=new Uint8Array(S.buffer),I=function(){try{S.getInt8(0)}catch(C){return C.constructor}throw new Error("never reached")}(),A=new I("Insufficient data"),T=new u.CachedKeyDecoder,O=function(){function C(k,P,N,L,F,V,j,K){k===void 0&&(k=i.ExtensionCodec.defaultCodec),P===void 0&&(P=void 0),N===void 0&&(N=o.UINT32_MAX),L===void 0&&(L=o.UINT32_MAX),F===void 0&&(F=o.UINT32_MAX),V===void 0&&(V=o.UINT32_MAX),j===void 0&&(j=o.UINT32_MAX),K===void 0&&(K=T),this.extensionCodec=k,this.context=P,this.maxStrLength=N,this.maxBinLength=L,this.maxArrayLength=F,this.maxMapLength=V,this.maxExtLength=j,this.keyDecoder=K,this.totalPos=0,this.pos=0,this.view=S,this.bytes=E,this.headByte=w,this.stack=[]}return C.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=w,this.stack.length=0},C.prototype.setBuffer=function(k){this.bytes=Object(f.ensureUint8Array)(k),this.view=Object(f.createDataView)(this.bytes),this.pos=0},C.prototype.appendBuffer=function(k){if(this.headByte===w&&!this.hasRemaining(1))this.setBuffer(k);else{var P=this.bytes.subarray(this.pos),N=Object(f.ensureUint8Array)(k),L=new Uint8Array(P.length+N.length);L.set(P),L.set(N,P.length),this.setBuffer(L)}},C.prototype.hasRemaining=function(k){return this.view.byteLength-this.pos>=k},C.prototype.createExtraByteError=function(k){var P=this,N=P.view,L=P.pos;return new RangeError("Extra "+(N.byteLength-L)+" of "+N.byteLength+" byte(s) found at buffer["+k+"]")},C.prototype.decode=function(k){this.reinitializeState(),this.setBuffer(k);var P=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return P},C.prototype.decodeMulti=function(k){return a(this,function(P){switch(P.label){case 0:this.reinitializeState(),this.setBuffer(k),P.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return P.sent(),[3,1];case 3:return[2]}})},C.prototype.decodeAsync=function(k){var P,N,L,F;return y(this,void 0,void 0,function(){var V,j,K,U,X,J,Y,te;return a(this,function(se){switch(se.label){case 0:V=!1,se.label=1;case 1:se.trys.push([1,6,7,12]),P=m(k),se.label=2;case 2:return[4,P.next()];case 3:if(N=se.sent(),!!N.done)return[3,5];if(K=N.value,V)throw this.createExtraByteError(this.totalPos);this.appendBuffer(K);try{j=this.doDecodeSync(),V=!0}catch(de){if(!(de instanceof I))throw de}this.totalPos+=this.pos,se.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return U=se.sent(),L={error:U},[3,12];case 7:return se.trys.push([7,,10,11]),N&&!N.done&&(F=P.return)?[4,F.call(P)]:[3,9];case 8:se.sent(),se.label=9;case 9:return[3,11];case 10:if(L)throw L.error;return[7];case 11:return[7];case 12:if(V){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,j]}throw X=this,J=X.headByte,Y=X.pos,te=X.totalPos,new RangeError("Insufficient data in parsing "+Object(s.prettyByte)(J)+" at "+te+" ("+Y+" in the current buffer)")}})})},C.prototype.decodeArrayStream=function(k){return this.decodeMultiAsync(k,!0)},C.prototype.decodeStream=function(k){return this.decodeMultiAsync(k,!1)},C.prototype.decodeMultiAsync=function(k,P){return b(this,arguments,function(){var L,F,V,j,K,U,X,J,Y;return a(this,function(te){switch(te.label){case 0:L=P,F=-1,te.label=1;case 1:te.trys.push([1,13,14,19]),V=m(k),te.label=2;case 2:return[4,_(V.next())];case 3:if(j=te.sent(),!!j.done)return[3,12];if(K=j.value,P&&F===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(K),L&&(F=this.readArraySize(),L=!1,this.complete()),te.label=4;case 4:te.trys.push([4,9,,10]),te.label=5;case 5:return[4,_(this.doDecodeSync())];case 6:return[4,te.sent()];case 7:return te.sent(),--F===0?[3,8]:[3,5];case 8:return[3,10];case 9:if(U=te.sent(),!(U instanceof I))throw U;return[3,10];case 10:this.totalPos+=this.pos,te.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return X=te.sent(),J={error:X},[3,19];case 14:return te.trys.push([14,,17,18]),j&&!j.done&&(Y=V.return)?[4,_(Y.call(V))]:[3,16];case 15:te.sent(),te.label=16;case 16:return[3,18];case 17:if(J)throw J.error;return[7];case 18:return[7];case 19:return[2]}})})},C.prototype.doDecodeSync=function(){e:for(;;){var k=this.readHeadByte(),P=void 0;if(k>=224)P=k-256;else if(k<192)if(k<128)P=k;else if(k<144){var N=k-128;if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k<160){var N=k-144;if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else{var L=k-160;P=this.decodeUtf8String(L,0)}else if(k===192)P=null;else if(k===194)P=!1;else if(k===195)P=!0;else if(k===202)P=this.readF32();else if(k===203)P=this.readF64();else if(k===204)P=this.readU8();else if(k===205)P=this.readU16();else if(k===206)P=this.readU32();else if(k===207)P=this.readU64();else if(k===208)P=this.readI8();else if(k===209)P=this.readI16();else if(k===210)P=this.readI32();else if(k===211)P=this.readI64();else if(k===217){var L=this.lookU8();P=this.decodeUtf8String(L,1)}else if(k===218){var L=this.lookU16();P=this.decodeUtf8String(L,2)}else if(k===219){var L=this.lookU32();P=this.decodeUtf8String(L,4)}else if(k===220){var N=this.readU16();if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else if(k===221){var N=this.readU32();if(N!==0){this.pushArrayState(N),this.complete();continue e}else P=[]}else if(k===222){var N=this.readU16();if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k===223){var N=this.readU32();if(N!==0){this.pushMapState(N),this.complete();continue e}else P={}}else if(k===196){var N=this.lookU8();P=this.decodeBinary(N,1)}else if(k===197){var N=this.lookU16();P=this.decodeBinary(N,2)}else if(k===198){var N=this.lookU32();P=this.decodeBinary(N,4)}else if(k===212)P=this.decodeExtension(1,0);else if(k===213)P=this.decodeExtension(2,0);else if(k===214)P=this.decodeExtension(4,0);else if(k===215)P=this.decodeExtension(8,0);else if(k===216)P=this.decodeExtension(16,0);else if(k===199){var N=this.lookU8();P=this.decodeExtension(N,1)}else if(k===200){var N=this.lookU16();P=this.decodeExtension(N,2)}else if(k===201){var N=this.lookU32();P=this.decodeExtension(N,4)}else throw new g.DecodeError("Unrecognized type byte: "+Object(s.prettyByte)(k));this.complete();for(var F=this.stack;F.length>0;){var V=F[F.length-1];if(V.type===0)if(V.array[V.position]=P,V.position++,V.position===V.size)F.pop(),P=V.array;else continue e;else if(V.type===1){if(!c(P))throw new g.DecodeError("The type of key must be string or number but "+typeof P);if(P==="__proto__")throw new g.DecodeError("The key __proto__ is not allowed");V.key=P,V.type=2;continue e}else if(V.map[V.key]=P,V.readCount++,V.readCount===V.size)F.pop(),P=V.map;else{V.key=null,V.type=1;continue e}}return P}},C.prototype.readHeadByte=function(){return this.headByte===w&&(this.headByte=this.readU8()),this.headByte},C.prototype.complete=function(){this.headByte=w},C.prototype.readArraySize=function(){var k=this.readHeadByte();switch(k){case 220:return this.readU16();case 221:return this.readU32();default:{if(k<160)return k-144;throw new g.DecodeError("Unrecognized array type byte: "+Object(s.prettyByte)(k))}}},C.prototype.pushMapState=function(k){if(k>this.maxMapLength)throw new g.DecodeError("Max length exceeded: map length ("+k+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:k,key:null,readCount:0,map:{}})},C.prototype.pushArrayState=function(k){if(k>this.maxArrayLength)throw new g.DecodeError("Max length exceeded: array length ("+k+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:k,array:new Array(k),position:0})},C.prototype.decodeUtf8String=function(k,P){var N;if(k>this.maxStrLength)throw new g.DecodeError("Max length exceeded: UTF-8 byte length ("+k+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+P+k)throw A;var L=this.pos+P,F;return this.stateIsMapKey()&&(!((N=this.keyDecoder)===null||N===void 0)&&N.canBeCached(k))?F=this.keyDecoder.decode(this.bytes,L,k):k>l.TEXT_DECODER_THRESHOLD?F=Object(l.utf8DecodeTD)(this.bytes,L,k):F=Object(l.utf8DecodeJs)(this.bytes,L,k),this.pos+=P+k,F},C.prototype.stateIsMapKey=function(){if(this.stack.length>0){var k=this.stack[this.stack.length-1];return k.type===1}return!1},C.prototype.decodeBinary=function(k,P){if(k>this.maxBinLength)throw new g.DecodeError("Max length exceeded: bin length ("+k+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(k+P))throw A;var N=this.pos+P,L=this.bytes.subarray(N,N+k);return this.pos+=P+k,L},C.prototype.decodeExtension=function(k,P){if(k>this.maxExtLength)throw new g.DecodeError("Max length exceeded: ext length ("+k+") > maxExtLength ("+this.maxExtLength+")");var N=this.view.getInt8(this.pos+P),L=this.decodeBinary(k,P+1);return this.extensionCodec.decode(L,N,this.context)},C.prototype.lookU8=function(){return this.view.getUint8(this.pos)},C.prototype.lookU16=function(){return this.view.getUint16(this.pos)},C.prototype.lookU32=function(){return this.view.getUint32(this.pos)},C.prototype.readU8=function(){var k=this.view.getUint8(this.pos);return this.pos++,k},C.prototype.readI8=function(){var k=this.view.getInt8(this.pos);return this.pos++,k},C.prototype.readU16=function(){var k=this.view.getUint16(this.pos);return this.pos+=2,k},C.prototype.readI16=function(){var k=this.view.getInt16(this.pos);return this.pos+=2,k},C.prototype.readU32=function(){var k=this.view.getUint32(this.pos);return this.pos+=4,k},C.prototype.readI32=function(){var k=this.view.getInt32(this.pos);return this.pos+=4,k},C.prototype.readU64=function(){var k=Object(o.getUint64)(this.view,this.pos);return this.pos+=8,k},C.prototype.readI64=function(){var k=Object(o.getInt64)(this.view,this.pos);return this.pos+=8,k},C.prototype.readF32=function(){var k=this.view.getFloat32(this.pos);return this.pos+=4,k},C.prototype.readF64=function(){var k=this.view.getFloat64(this.pos);return this.pos+=8,k},C}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs":function(n,t,r){r.r(t),r.d(t,"DEFAULT_MAX_DEPTH",function(){return f}),r.d(t,"DEFAULT_INITIAL_BUFFER_SIZE",function(){return u}),r.d(t,"Encoder",function(){return g});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs"),f=100,u=2048,g=function(){function y(a,m,_,b,c,w,S,E){a===void 0&&(a=i.ExtensionCodec.defaultCodec),m===void 0&&(m=void 0),_===void 0&&(_=f),b===void 0&&(b=u),c===void 0&&(c=!1),w===void 0&&(w=!1),S===void 0&&(S=!1),E===void 0&&(E=!1),this.extensionCodec=a,this.context=m,this.maxDepth=_,this.initialBufferSize=b,this.sortKeys=c,this.forceFloat32=w,this.ignoreUndefined=S,this.forceIntegerToFloat=E,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return y.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},y.prototype.reinitializeState=function(){this.pos=0},y.prototype.encode=function(a){return this.reinitializeState(),this.doEncode(a,1),this.getUint8Array()},y.prototype.doEncode=function(a,m){if(m>this.maxDepth)throw new Error("Too deep objects in depth "+m);a==null?this.encodeNil():typeof a=="boolean"?this.encodeBoolean(a):typeof a=="number"?this.encodeNumber(a):typeof a=="string"?this.encodeString(a):this.encodeObject(a,m)},y.prototype.ensureBufferSizeToWrite=function(a){var m=this.pos+a;this.view.byteLength<m&&this.resizeBuffer(m*2)},y.prototype.resizeBuffer=function(a){var m=new ArrayBuffer(a),_=new Uint8Array(m),b=new DataView(m);_.set(this.bytes),this.view=b,this.bytes=_},y.prototype.encodeNil=function(){this.writeU8(192)},y.prototype.encodeBoolean=function(a){a===!1?this.writeU8(194):this.writeU8(195)},y.prototype.encodeNumber=function(a){Number.isSafeInteger(a)&&!this.forceIntegerToFloat?a>=0?a<128?this.writeU8(a):a<256?(this.writeU8(204),this.writeU8(a)):a<65536?(this.writeU8(205),this.writeU16(a)):a<4294967296?(this.writeU8(206),this.writeU32(a)):(this.writeU8(207),this.writeU64(a)):a>=-32?this.writeU8(224|a+32):a>=-128?(this.writeU8(208),this.writeI8(a)):a>=-32768?(this.writeU8(209),this.writeI16(a)):a>=-2147483648?(this.writeU8(210),this.writeI32(a)):(this.writeU8(211),this.writeI64(a)):this.forceFloat32?(this.writeU8(202),this.writeF32(a)):(this.writeU8(203),this.writeF64(a))},y.prototype.writeStringHeader=function(a){if(a<32)this.writeU8(160+a);else if(a<256)this.writeU8(217),this.writeU8(a);else if(a<65536)this.writeU8(218),this.writeU16(a);else if(a<4294967296)this.writeU8(219),this.writeU32(a);else throw new Error("Too long string: "+a+" bytes in UTF-8")},y.prototype.encodeString=function(a){var m=5,_=a.length;if(_>s.TEXT_ENCODER_THRESHOLD){var b=Object(s.utf8Count)(a);this.ensureBufferSizeToWrite(m+b),this.writeStringHeader(b),Object(s.utf8EncodeTE)(a,this.bytes,this.pos),this.pos+=b}else{var b=Object(s.utf8Count)(a);this.ensureBufferSizeToWrite(m+b),this.writeStringHeader(b),Object(s.utf8EncodeJs)(a,this.bytes,this.pos),this.pos+=b}},y.prototype.encodeObject=function(a,m){var _=this.extensionCodec.tryToEncode(a,this.context);if(_!=null)this.encodeExtension(_);else if(Array.isArray(a))this.encodeArray(a,m);else if(ArrayBuffer.isView(a))this.encodeBinary(a);else if(typeof a=="object")this.encodeMap(a,m);else throw new Error("Unrecognized object: "+Object.prototype.toString.apply(a))},y.prototype.encodeBinary=function(a){var m=a.byteLength;if(m<256)this.writeU8(196),this.writeU8(m);else if(m<65536)this.writeU8(197),this.writeU16(m);else if(m<4294967296)this.writeU8(198),this.writeU32(m);else throw new Error("Too large binary: "+m);var _=Object(l.ensureUint8Array)(a);this.writeU8a(_)},y.prototype.encodeArray=function(a,m){var _=a.length;if(_<16)this.writeU8(144+_);else if(_<65536)this.writeU8(220),this.writeU16(_);else if(_<4294967296)this.writeU8(221),this.writeU32(_);else throw new Error("Too large array: "+_);for(var b=0,c=a;b<c.length;b++){var w=c[b];this.doEncode(w,m+1)}},y.prototype.countWithoutUndefined=function(a,m){for(var _=0,b=0,c=m;b<c.length;b++){var w=c[b];a[w]!==void 0&&_++}return _},y.prototype.encodeMap=function(a,m){var _=Object.keys(a);this.sortKeys&&_.sort();var b=this.ignoreUndefined?this.countWithoutUndefined(a,_):_.length;if(b<16)this.writeU8(128+b);else if(b<65536)this.writeU8(222),this.writeU16(b);else if(b<4294967296)this.writeU8(223),this.writeU32(b);else throw new Error("Too large map object: "+b);for(var c=0,w=_;c<w.length;c++){var S=w[c],E=a[S];this.ignoreUndefined&&E===void 0||(this.encodeString(S),this.doEncode(E,m+1))}},y.prototype.encodeExtension=function(a){var m=a.data.length;if(m===1)this.writeU8(212);else if(m===2)this.writeU8(213);else if(m===4)this.writeU8(214);else if(m===8)this.writeU8(215);else if(m===16)this.writeU8(216);else if(m<256)this.writeU8(199),this.writeU8(m);else if(m<65536)this.writeU8(200),this.writeU16(m);else if(m<4294967296)this.writeU8(201),this.writeU32(m);else throw new Error("Too large extension object: "+m);this.writeI8(a.type),this.writeU8a(a.data)},y.prototype.writeU8=function(a){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,a),this.pos++},y.prototype.writeU8a=function(a){var m=a.length;this.ensureBufferSizeToWrite(m),this.bytes.set(a,this.pos),this.pos+=m},y.prototype.writeI8=function(a){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,a),this.pos++},y.prototype.writeU16=function(a){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,a),this.pos+=2},y.prototype.writeI16=function(a){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,a),this.pos+=2},y.prototype.writeU32=function(a){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,a),this.pos+=4},y.prototype.writeI32=function(a){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,a),this.pos+=4},y.prototype.writeF32=function(a){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,a),this.pos+=4},y.prototype.writeF64=function(a){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,a),this.pos+=8},y.prototype.writeU64=function(a){this.ensureBufferSizeToWrite(8),Object(o.setUint64)(this.view,this.pos,a),this.pos+=8},y.prototype.writeI64=function(a){this.ensureBufferSizeToWrite(8),Object(o.setInt64)(this.view,this.pos,a),this.pos+=8},y}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs":function(n,t,r){r.r(t),r.d(t,"ExtData",function(){return s});var s=function(){function i(o,l){this.type=o,this.data=l}return i}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs":function(n,t,r){r.r(t),r.d(t,"ExtensionCodec",function(){return o});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs"),o=function(){function l(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(i.timestampExtension)}return l.prototype.register=function(f){var u=f.type,g=f.encode,y=f.decode;if(u>=0)this.encoders[u]=g,this.decoders[u]=y;else{var a=1+u;this.builtInEncoders[a]=g,this.builtInDecoders[a]=y}},l.prototype.tryToEncode=function(f,u){for(var g=0;g<this.builtInEncoders.length;g++){var y=this.builtInEncoders[g];if(y!=null){var a=y(f,u);if(a!=null){var m=-1-g;return new s.ExtData(m,a)}}}for(var g=0;g<this.encoders.length;g++){var y=this.encoders[g];if(y!=null){var a=y(f,u);if(a!=null){var m=g;return new s.ExtData(m,a)}}}return f instanceof s.ExtData?f:null},l.prototype.decode=function(f,u,g){var y=u<0?this.builtInDecoders[-1-u]:this.decoders[u];return y?y(f,u,g):new s.ExtData(u,f)},l.defaultCodec=new l,l}()},"./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs":function(n,t,r){r.r(t),r.d(t,"defaultDecodeOptions",function(){return i}),r.d(t,"decode",function(){return o}),r.d(t,"decodeMulti",function(){return l});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs"),i={};function o(f,u){u===void 0&&(u=i);var g=new s.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength);return g.decode(f)}function l(f,u){u===void 0&&(u=i);var g=new s.Decoder(u.extensionCodec,u.context,u.maxStrLength,u.maxBinLength,u.maxArrayLength,u.maxMapLength,u.maxExtLength);return g.decodeMulti(f)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/decodeAsync.mjs":function(n,t,r){r.r(t),r.d(t,"decodeAsync",function(){return u}),r.d(t,"decodeArrayStream",function(){return g}),r.d(t,"decodeMultiStream",function(){return y}),r.d(t,"decodeStream",function(){return a});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/stream.mjs"),o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs"),l=function(m,_,b,c){function w(S){return S instanceof b?S:new b(function(E){E(S)})}return new(b||(b=Promise))(function(S,E){function I(O){try{T(c.next(O))}catch(C){E(C)}}function A(O){try{T(c.throw(O))}catch(C){E(C)}}function T(O){O.done?S(O.value):w(O.value).then(I,A)}T((c=c.apply(m,_||[])).next())})},f=function(m,_){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},c,w,S,E;return E={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function I(T){return function(O){return A([T,O])}}function A(T){if(c)throw new TypeError("Generator is already executing.");for(;b;)try{if(c=1,w&&(S=T[0]&2?w.return:T[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,T[1])).done)return S;switch(w=0,S&&(T=[T[0]&2,S.value]),T[0]){case 0:case 1:S=T;break;case 4:return b.label++,{value:T[1],done:!1};case 5:b.label++,w=T[1],T=[0];continue;case 7:T=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(T[0]===6||T[0]===2)){b=0;continue}if(T[0]===3&&(!S||T[1]>S[0]&&T[1]<S[3])){b.label=T[1];break}if(T[0]===6&&b.label<S[1]){b.label=S[1],S=T;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(T);break}S[2]&&b.ops.pop(),b.trys.pop();continue}T=_.call(m,b)}catch(O){T=[6,O],w=0}finally{c=S=0}if(T[0]&5)throw T[1];return{value:T[0]?T[1]:void 0,done:!0}}};function u(m,_){return _===void 0&&(_=o.defaultDecodeOptions),l(this,void 0,void 0,function(){var b,c;return f(this,function(w){return b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength),[2,c.decodeAsync(b)]})})}function g(m,_){_===void 0&&(_=o.defaultDecodeOptions);var b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength);return c.decodeArrayStream(b)}function y(m,_){_===void 0&&(_=o.defaultDecodeOptions);var b=Object(i.ensureAsyncIterable)(m),c=new s.Decoder(_.extensionCodec,_.context,_.maxStrLength,_.maxBinLength,_.maxArrayLength,_.maxMapLength,_.maxExtLength);return c.decodeStream(b)}function a(m,_){return _===void 0&&(_=o.defaultDecodeOptions),y(m,_)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/encode.mjs":function(n,t,r){r.r(t),r.d(t,"encode",function(){return o});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs"),i={};function o(l,f){f===void 0&&(f=i);var u=new s.Encoder(f.extensionCodec,f.context,f.maxDepth,f.initialBufferSize,f.sortKeys,f.forceFloat32,f.ignoreUndefined,f.forceIntegerToFloat);return u.encode(l)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/index.mjs":function(n,t,r){r.r(t);var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/encode.mjs");r.d(t,"encode",function(){return s.encode});var i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decode.mjs");r.d(t,"decode",function(){return i.decode}),r.d(t,"decodeMulti",function(){return i.decodeMulti});var o=r("./node_modules/@msgpack/msgpack/dist.es5+esm/decodeAsync.mjs");r.d(t,"decodeAsync",function(){return o.decodeAsync}),r.d(t,"decodeArrayStream",function(){return o.decodeArrayStream}),r.d(t,"decodeMultiStream",function(){return o.decodeMultiStream}),r.d(t,"decodeStream",function(){return o.decodeStream});var l=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Decoder.mjs");r.d(t,"Decoder",function(){return l.Decoder}),r.d(t,"DataViewIndexOutOfBoundsError",function(){return l.DataViewIndexOutOfBoundsError});var f=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs");r.d(t,"DecodeError",function(){return f.DecodeError});var u=r("./node_modules/@msgpack/msgpack/dist.es5+esm/Encoder.mjs");r.d(t,"Encoder",function(){return u.Encoder});var g=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs");r.d(t,"ExtensionCodec",function(){return g.ExtensionCodec});var y=r("./node_modules/@msgpack/msgpack/dist.es5+esm/ExtData.mjs");r.d(t,"ExtData",function(){return y.ExtData});var a=r("./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs");r.d(t,"EXT_TIMESTAMP",function(){return a.EXT_TIMESTAMP}),r.d(t,"encodeDateToTimeSpec",function(){return a.encodeDateToTimeSpec}),r.d(t,"encodeTimeSpecToTimestamp",function(){return a.encodeTimeSpecToTimestamp}),r.d(t,"decodeTimestampToTimeSpec",function(){return a.decodeTimestampToTimeSpec}),r.d(t,"encodeTimestampExtension",function(){return a.encodeTimestampExtension}),r.d(t,"decodeTimestampExtension",function(){return a.decodeTimestampExtension})},"./node_modules/@msgpack/msgpack/dist.es5+esm/timestamp.mjs":function(n,t,r){r.r(t),r.d(t,"EXT_TIMESTAMP",function(){return o}),r.d(t,"encodeTimeSpecToTimestamp",function(){return u}),r.d(t,"encodeDateToTimeSpec",function(){return g}),r.d(t,"encodeTimestampExtension",function(){return y}),r.d(t,"decodeTimestampToTimeSpec",function(){return a}),r.d(t,"decodeTimestampExtension",function(){return m}),r.d(t,"timestampExtension",function(){return _});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/DecodeError.mjs"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),o=-1,l=4294967296-1,f=17179869184-1;function u(b){var c=b.sec,w=b.nsec;if(c>=0&&w>=0&&c<=f)if(w===0&&c<=l){var S=new Uint8Array(4),E=new DataView(S.buffer);return E.setUint32(0,c),S}else{var I=c/4294967296,A=c&4294967295,S=new Uint8Array(8),E=new DataView(S.buffer);return E.setUint32(0,w<<2|I&3),E.setUint32(4,A),S}else{var S=new Uint8Array(12),E=new DataView(S.buffer);return E.setUint32(0,w),Object(i.setInt64)(E,4,c),S}}function g(b){var c=b.getTime(),w=Math.floor(c/1e3),S=(c-w*1e3)*1e6,E=Math.floor(S/1e9);return{sec:w+E,nsec:S-E*1e9}}function y(b){if(b instanceof Date){var c=g(b);return u(c)}else return null}function a(b){var c=new DataView(b.buffer,b.byteOffset,b.byteLength);switch(b.byteLength){case 4:{var w=c.getUint32(0),S=0;return{sec:w,nsec:S}}case 8:{var E=c.getUint32(0),I=c.getUint32(4),w=(E&3)*4294967296+I,S=E>>>2;return{sec:w,nsec:S}}case 12:{var w=Object(i.getInt64)(c,4),S=c.getUint32(0);return{sec:w,nsec:S}}default:throw new s.DecodeError("Unrecognized data size for timestamp (expected 4, 8, or 12): "+b.length)}}function m(b){var c=a(b);return new Date(c.sec*1e3+c.nsec/1e6)}var _={type:o,encode:y,decode:m}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs":function(n,t,r){r.r(t),r.d(t,"UINT32_MAX",function(){return s}),r.d(t,"setUint64",function(){return i}),r.d(t,"setInt64",function(){return o}),r.d(t,"getInt64",function(){return l}),r.d(t,"getUint64",function(){return f});var s=4294967295;function i(u,g,y){var a=y/4294967296,m=y;u.setUint32(g,a),u.setUint32(g+4,m)}function o(u,g,y){var a=Math.floor(y/4294967296),m=y;u.setUint32(g,a),u.setUint32(g+4,m)}function l(u,g){var y=u.getInt32(g),a=u.getUint32(g+4);return y*4294967296+a}function f(u,g){var y=u.getUint32(g),a=u.getUint32(g+4);return y*4294967296+a}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/prettyByte.mjs":function(n,t,r){r.r(t),r.d(t,"prettyByte",function(){return s});function s(i){return(i<0?"-":"")+"0x"+Math.abs(i).toString(16).padStart(2,"0")}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/stream.mjs":function(n,t,r){r.r(t),r.d(t,"isAsyncIterable",function(){return l}),r.d(t,"asyncIterableFromStream",function(){return u}),r.d(t,"ensureAsyncIterable",function(){return g});var s=function(y,a){var m={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},_,b,c,w;return w={next:S(0),throw:S(1),return:S(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function S(I){return function(A){return E([I,A])}}function E(I){if(_)throw new TypeError("Generator is already executing.");for(;m;)try{if(_=1,b&&(c=I[0]&2?b.return:I[0]?b.throw||((c=b.return)&&c.call(b),0):b.next)&&!(c=c.call(b,I[1])).done)return c;switch(b=0,c&&(I=[I[0]&2,c.value]),I[0]){case 0:case 1:c=I;break;case 4:return m.label++,{value:I[1],done:!1};case 5:m.label++,b=I[1],I=[0];continue;case 7:I=m.ops.pop(),m.trys.pop();continue;default:if(c=m.trys,!(c=c.length>0&&c[c.length-1])&&(I[0]===6||I[0]===2)){m=0;continue}if(I[0]===3&&(!c||I[1]>c[0]&&I[1]<c[3])){m.label=I[1];break}if(I[0]===6&&m.label<c[1]){m.label=c[1],c=I;break}if(c&&m.label<c[2]){m.label=c[2],m.ops.push(I);break}c[2]&&m.ops.pop(),m.trys.pop();continue}I=a.call(y,m)}catch(A){I=[6,A],b=0}finally{_=c=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},i=function(y){return this instanceof i?(this.v=y,this):new i(y)},o=function(y,a,m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _=m.apply(y,a||[]),b,c=[];return b={},w("next"),w("throw"),w("return"),b[Symbol.asyncIterator]=function(){return this},b;function w(O){_[O]&&(b[O]=function(C){return new Promise(function(k,P){c.push([O,C,k,P])>1||S(O,C)})})}function S(O,C){try{E(_[O](C))}catch(k){T(c[0][3],k)}}function E(O){O.value instanceof i?Promise.resolve(O.value.v).then(I,A):T(c[0][2],O)}function I(O){S("next",O)}function A(O){S("throw",O)}function T(O,C){O(C),c.shift(),c.length&&S(c[0][0],c[0][1])}};function l(y){return y[Symbol.asyncIterator]!=null}function f(y){if(y==null)throw new Error("Assertion Failure: value must not be null nor undefined")}function u(y){return o(this,arguments,function(){var m,_,b,c;return s(this,function(w){switch(w.label){case 0:m=y.getReader(),w.label=1;case 1:w.trys.push([1,,9,10]),w.label=2;case 2:return[4,i(m.read())];case 3:return _=w.sent(),b=_.done,c=_.value,b?[4,i(void 0)]:[3,5];case 4:return[2,w.sent()];case 5:return f(c),[4,i(c)];case 6:return[4,w.sent()];case 7:return w.sent(),[3,2];case 8:return[3,10];case 9:return m.releaseLock(),[7];case 10:return[2]}})})}function g(y){return l(y)?y:u(y)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/typedArrays.mjs":function(n,t,r){r.r(t),r.d(t,"ensureUint8Array",function(){return s}),r.d(t,"createDataView",function(){return i});function s(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o instanceof ArrayBuffer?new Uint8Array(o):Uint8Array.from(o)}function i(o){if(o instanceof ArrayBuffer)return new DataView(o);var l=s(o);return new DataView(l.buffer,l.byteOffset,l.byteLength)}},"./node_modules/@msgpack/msgpack/dist.es5+esm/utils/utf8.mjs":function(n,t,r){r.r(t),r.d(t,"utf8Count",function(){return o}),r.d(t,"utf8EncodeJs",function(){return l}),r.d(t,"TEXT_ENCODER_THRESHOLD",function(){return u}),r.d(t,"utf8EncodeTE",function(){return a}),r.d(t,"utf8DecodeJs",function(){return _}),r.d(t,"TEXT_DECODER_THRESHOLD",function(){return c}),r.d(t,"utf8DecodeTD",function(){return w});var s=r("./node_modules/@msgpack/msgpack/dist.es5+esm/utils/int.mjs"),i=(typeof process>"u"||define_process_env_default.TEXT_ENCODING!=="never")&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function o(S){for(var E=S.length,I=0,A=0;A<E;){var T=S.charCodeAt(A++);if(T&4294967168)if(!(T&4294965248))I+=2;else{if(T>=55296&&T<=56319&&A<E){var O=S.charCodeAt(A);(O&64512)===56320&&(++A,T=((T&1023)<<10)+(O&1023)+65536)}T&4294901760?I+=4:I+=3}else{I++;continue}}return I}function l(S,E,I){for(var A=S.length,T=I,O=0;O<A;){var C=S.charCodeAt(O++);if(C&4294967168)if(!(C&4294965248))E[T++]=C>>6&31|192;else{if(C>=55296&&C<=56319&&O<A){var k=S.charCodeAt(O);(k&64512)===56320&&(++O,C=((C&1023)<<10)+(k&1023)+65536)}C&4294901760?(E[T++]=C>>18&7|240,E[T++]=C>>12&63|128,E[T++]=C>>6&63|128):(E[T++]=C>>12&15|224,E[T++]=C>>6&63|128)}else{E[T++]=C;continue}E[T++]=C&63|128}}var f=i?new TextEncoder:void 0,u=i?typeof process<"u"&&define_process_env_default.TEXT_ENCODING!=="force"?200:0:s.UINT32_MAX;function g(S,E,I){E.set(f.encode(S),I)}function y(S,E,I){f.encodeInto(S,E.subarray(I))}var a=f!=null&&f.encodeInto?y:g,m=4096;function _(S,E,I){for(var A=E,T=A+I,O=[],C="";A<T;){var k=S[A++];if(!(k&128))O.push(k);else if((k&224)===192){var P=S[A++]&63;O.push((k&31)<<6|P)}else if((k&240)===224){var P=S[A++]&63,N=S[A++]&63;O.push((k&31)<<12|P<<6|N)}else if((k&248)===240){var P=S[A++]&63,N=S[A++]&63,L=S[A++]&63,F=(k&7)<<18|P<<12|N<<6|L;F>65535&&(F-=65536,O.push(F>>>10&1023|55296),F=56320|F&1023),O.push(F)}else O.push(k);O.length>=m&&(C+=String.fromCharCode.apply(String,O),O.length=0)}return O.length>0&&(C+=String.fromCharCode.apply(String,O)),C}var b=i?new TextDecoder:null,c=i?typeof process<"u"&&define_process_env_default.TEXT_DECODER!=="force"?200:0:s.UINT32_MAX;function w(S,E,I){var A=S.subarray(E,E+I);return b.decode(A)}},"./package.json":function(n){n.exports=JSON.parse('{"name":"imjoy-rpc","version":"0.5.46","description":"Remote procedure calls for ImJoy.","module":"index.js","types":"index.d.ts","scripts":{"build":"rm -rf dist && npm run build-umd","build-umd":"webpack --config webpack.config.js --mode development && NODE_ENV=production webpack --config webpack.config.js --mode production --devtool source-map ","watch":"NODE_ENV=production webpack --watch --progress --config webpack.config.js --mode production --devtool source-map","publish-npm":"npm install && npm run build && npm publish","serve":"webpack-dev-server","stats":"webpack --profile --json > stats.json","stats-prod":"webpack --profile --json --mode production > stats-prod.json","analyze":"webpack-bundle-analyzer -p 9999 stats.json","analyze-prod":"webpack-bundle-analyzer -p 9999 stats-prod.json","clean":"rimraf dist/*","deploy":"npm run build && node deploy-site.js","format":"prettier --write \\"{src,tests}/**/**\\"","check-format":"prettier --check \\"{src,tests}/**/**\\"","test":"karma start --single-run --browsers ChromeHeadless,FirefoxHeadless karma.conf.js","test-watch":"karma start --auto-watch --browsers ChromeDebugging karma.conf.js --debug"},"repository":{"type":"git","url":"git+https://github.com/imjoy-team/imjoy-rpc.git"},"keywords":["imjoy","rpc"],"author":"imjoy-team <imjoy.team@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/imjoy-team/imjoy-rpc/issues"},"homepage":"https://github.com/imjoy-team/imjoy-rpc","dependencies":{"@msgpack/msgpack":"^2.7.1","socket.io-client":"^4.6.2"},"devDependencies":{"@babel/core":"^7.16.12","@babel/plugin-syntax-dynamic-import":"^7.8.3","@babel/polyfill":"^7.12.1","@babel/preset-env":"^7.16.11","@types/requirejs":"^2.1.34","babel-core":"^6.26.0","babel-eslint":"^10.1.0","babel-loader":"^8.2.3","babel-runtime":"^6.26.0","chai":"^4.3.6","clean-webpack-plugin":"^0.1.19","copy-webpack-plugin":"^5.1.2","eslint":"^6.8.0","eslint-config-prettier":"^4.2.0","eslint-loader":"^4.0.2","file-loader":"^0.11.2","fs-extra":"^0.30.0","gh-pages":"^2.0.1","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","json-loader":"^0.5.4","karma":"^6.3.12","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^1.3.0","karma-mocha":"^2.0.1","karma-sourcemap-loader":"^0.3.8","karma-spec-reporter":"0.0.32","karma-webpack":"^4.0.2","lerna":"^6.0.3","lodash.debounce":"^4.0.8","mocha":"^10.1.0","postcss":"^7.0.36","prettier":"^1.6.1","rimraf":"^2.6.2","schema-utils":"^0.4.3","style-loader":"^0.18.1","ts-loader":"^9.4.3","url-loader":"^0.5.9","webpack":"^4.46.0","webpack-bundle-analyzer":"^4.7.0","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.3","webpack-merge":"^4.1.1","workbox-webpack-plugin":"^4.3.1","worker-loader":"^2.0.0","write-file-webpack-plugin":"^4.5.1"},"eslintConfig":{"globals":{"document":true,"window":true}}}')},"./src/hypha/rpc.js":function(n,t,r){r.r(t),r.d(t,"API_VERSION",function(){return o}),r.d(t,"RPC",function(){return _});var s=r("./src/hypha/utils.js"),i=r("./node_modules/@msgpack/msgpack/dist.es5+esm/index.mjs");const o="0.3.0",l=1024*500,f=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor;function u(b,c){const w=new Uint8Array(b.byteLength+c.byteLength);return w.set(new Uint8Array(b),0),w.set(new Uint8Array(c),b.byteLength),w.buffer}function g(b,c){if(!c)throw new Error("undefined index");return typeof c=="string"?g(b,c.split(".")):c.length===0?b:g(b[c[0]],c.slice(1))}function y(b){const c=b.toString(),w=c.match(/function\s*(\w*)/),S=w&&w[1]||"",E=c.match(/\(([^)]*)\)/);let I="";E&&(I=E[1].split(",").map(k=>k.replace(/\/\*.*?\*\//g,"").replace(/\/\/.*$/g,"")).filter(k=>k.trim().length>0).map(k=>k.trim()).join(", "));let A=c.match(/\)\s*\{\s*\/\*([\s\S]*?)\*\//);const T=A&&A[1].trim()||"";A=c.match(/\)\s*\{\s*(\/\/[\s\S]*?)\n\s*[^\s\/]/);const O=A&&A[1].split(`
`).map(k=>k.replace(/^\/\/\s*/,"").trim()).join(`
`)||"",C=T||O;return S&&I.length>0&&{name:S,sig:I,doc:C}}function a(b){var c=b.map(function(E){return E.byteLength}),w=c.reduce(function(E,I){return E+I},0),S=new Uint8Array(w);return c.reduce(function(E,I,A){return S.set(new Uint8Array(b[A]),E),E+I},0),S.buffer}class m{constructor(c,w,S,E){this._timeout=c,this._callback=w,this._args=S,this._label=E||"timer",this._task=null,this.started=!1}start(){this.started?this.reset():(this._task=setTimeout(()=>{this._callback.apply(this,this._args)},this._timeout*1e3),this.started=!0)}clear(){this._task?(clearTimeout(this._task),this._task=null,this.started=!1):console.warn(`Clearing a timer (${this._label}) which is not started`)}reset(){this._task&&clearTimeout(this._task),this._task=setTimeout(()=>{this._callback.apply(this,this._args)},this._timeout*1e3),this.started=!0}}class _ extends s.MessageEmitter{constructor(c,{client_id:w=null,manager_id:S=null,default_context:E=null,name:I=null,codecs:A=null,method_timeout:T=null,max_message_buffer_size:O=0,debug:C=!1,workspace:k=null}){super(C),this._codecs=A||{},Object(s.assert)(w&&typeof w=="string"),Object(s.assert)(w,"client_id is required"),this._client_id=w,this._name=I,this._connection_info=null,this._workspace=null,this._local_workspace=k,this.manager_id=S,this.default_context=E||{},this._method_annotations=new WeakMap,this._manager_service=null,this._max_message_buffer_size=O,this._chunk_store={},this._method_timeout=T||30,this._services={},this._object_store={services:this._services},c?(this.add_service({id:"built-in",type:"built-in",name:"RPC built-in services",config:{require_context:!0,visibility:"public"},ping:this._ping.bind(this),get_service:this.get_local_service.bind(this),register_service:this.register_service.bind(this),message_cache:{create:this._create_message.bind(this),append:this._append_message.bind(this),process:this._process_message.bind(this),remove:this._remove_message.bind(this)}}),this.on("method",this._handle_method.bind(this)),Object(s.assert)(c.emit_message&&c.on_message),this._emit_message=c.emit_message.bind(c),c.on_message(this._on_message.bind(this)),this._connection=c,this._get_connection_info()):this._emit_message=function(){console.log("No connection to emit message")}}async _get_connection_info(){if(this.manager_id)try{if(await this.get_manager_service(30),Object(s.assert)(this._manager_service),this._connection_info=await this._manager_service.get_connection_info(),this._connection_info.reconnection_token&&this._connection.set_reconnection_token){this._connection.set_reconnection_token(this._connection_info.reconnection_token);const c=this._connection_info.reconnection_expires_in*.8;this._get_connection_info_task=setTimeout(this._get_connection_info.bind(this),c*1e3)}}catch(c){console.warn("Failed to fetch user info from ",this.manager_id,c)}}register_codec(c){if(!c.name||!c.encoder&&!c.decoder)throw new Error("Invalid codec format, please make sure you provide a name, type, encoder and decoder.");if(c.type)for(let w of Object.keys(this._codecs))(this._codecs[w].type===c.type||w===c.name)&&(delete this._codecs[w],console.warn("Remove duplicated codec: "+w));this._codecs[c.name]=c}async _ping(c,w){return Object(s.assert)(c=="ping"),"pong"}async ping(c,w){let S=this._generate_remote_method({_rtarget:c,_rmethod:"services.built-in.ping",_rpromise:!0,_rdoc:"Ping a remote client",_rsig:"ping(msg)"});Object(s.assert)(await S("ping",w)=="pong")}_create_message(c,w,S,E){if(w){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}if(this._object_store.message_cache||(this._object_store.message_cache={}),!S&&this._object_store.message_cache[c])throw new Error(`Message with the same key (${c}) already exists in the cache store, please use overwrite=true or remove it first.`);this._object_store.message_cache[c]=[]}_append_message(c,w,S,E){if(S){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}const I=this._object_store.message_cache;if(!I[c])throw new Error(`Message with key ${c} does not exists.`);Object(s.assert)(w instanceof f),I[c].push(w)}_remove_message(c,w){const S=this._object_store.message_cache;if(!S[c])throw new Error(`Message with key ${c} does not exists.`);delete S[c]}_process_message(c,w,S){if(w){if(!this._object_store[c])throw new Error(`session does not exist anymore: ${c}`);this._object_store[c].timer.reset()}const E=this._object_store.message_cache;if(Object(s.assert)(!!S,"Context is required"),!E[c])throw new Error(`Message with key ${c} does not exists.`);E[c]=a(E[c]),console.debug(`Processing message ${c} (size=${E[c].length})`);let I=Object(i.decodeMulti)(E[c]);const{done:A,value:T}=I.next(),O=T;if(Object.assign(O,{from:S.from,to:S.to,user:S.user}),O.ctx=JSON.parse(JSON.stringify(O)),Object.assign(O.ctx,this.default_context),!A){let C=I.next();Object.assign(O,C.value)}this._fire(O.type,O),delete E[c]}_on_message(c){try{Object(s.assert)(c instanceof ArrayBuffer);let w=Object(i.decodeMulti)(c);const{done:S,value:E}=w.next(),I=E;if(I.ctx=JSON.parse(JSON.stringify(I)),Object.assign(I.ctx,this.default_context),!S){let A=w.next();Object.assign(I,A.value)}this._fire(I.type,I)}catch{console.error(e)}}reset(){this._event_handlers={},this._services={}}async disconnect(){this._get_connection_info_task&&(clearTimeout(this._get_connection_info_task),this._get_connection_info_task=null),this._fire("disconnect")}async get_manager_service(c){this.manager_id&&!this._manager_service&&(this._manager_service=await this.get_remote_service(`${this.manager_id}:default`,c))}get_all_local_services(){return this._services}get_local_service(c,w){Object(s.assert)(c);const[S,E]=w.to.split("/");Object(s.assert)(E===this._client_id,"Services can only be accessed locally");const I=this._services[c];if(!I)throw new Error("Service not found: "+c);if(I.config.visibility=="public"||w.from.startsWith(S+"/"))return I;throw new Error("Permission denied for service: "+c)}async get_remote_service(c,w){w=w===void 0?this._method_timeout:w,!c&&this.manager_id?c=this.manager_id:c.includes(":")||(c=this._client_id+":"+c);const S=c.split(":")[0];Object(s.assert)(S);try{const E=this._generate_remote_method({_rtarget:S,_rmethod:"services.built-in.get_service",_rpromise:!0,_rdoc:"Get a remote service",_rsig:"get_service(service_id)"}),I=await Object(s.waitFor)(E(c.split(":")[1]),w,"Timeout Error: Failed to get remote service: "+c);return I.id=c,I}catch(E){throw console.error("Failed to get remote service: "+c,E),E}}_annotate_service_methods(c,w,S,E,I){if(typeof c=="function"){let A=w.split(".")[1];this._method_annotations.set(c,{require_context:Array.isArray(S)?S.includes(A):!!S,run_in_executor:E,method_id:"services."+w,visibility:I})}else if(c instanceof Array||c instanceof Object)for(let A of Object.keys(c)){let T=c[A];if(typeof T=="function"&&T.__rpc_object__){let O=T.__rpc_object__._rtarget;if(O.includes("/")&&(O=O.split("/")[1]),this._client_id===O)c instanceof Array&&(c=c.slice()),c[A]=g(this._object_store,T.__rpc_object__._rmethod),T=c[A];else throw new Error(`Local method not found: ${T.__rpc_object__._rmethod}, client id mismatch ${this._client_id} != ${O}`)}this._annotate_service_methods(T,w+"."+A,S,E,I)}}add_service(c,w){if(!c||Array.isArray(c))throw new Error("Invalid service object");if(c.constructor===Object)c=Object.assign({},c);else{const A={},T=Object.getOwnPropertyNames(c).concat(Object.getOwnPropertyNames(Object.getPrototypeOf(c)));for(let O of T)O!=="constructor"&&(typeof c[O]=="function"?A[O]=c[O].bind(c):A[O]=c[O]);c.id=c.id||"default",c=A}Object(s.assert)(c.id&&typeof c.id=="string",`Service id not found: ${c}`),c.name||(c.name=c.id),c.config||(c.config={}),c.type||(c.type="generic");let S=!1,E=!1;c.config.require_context&&(S=c.config.require_context),c.config.run_in_executor&&(E=!0);const I=c.config.visibility||"protected";if(Object(s.assert)(["protected","public"].includes(I)),this._annotate_service_methods(c,c.id,S,E,I),this._services[c.id])if(w)delete this._services[c.id];else throw new Error(`Service already exists: ${c.id}, please specify a different id (not ${c.id}) or overwrite=true`);return this._services[c.id]=c,c}async register_service(c,w,S,E){if(S===void 0&&(S=!0),E){const[A,T]=E.to.split("/");Object(s.assert)(T===this._client_id),Object(s.assert)(A===E.from.split("/")[0],"Services can only be registered from the same workspace")}const I=this.add_service(c,w);return S&&(this._fire("service-updated",{service_id:I.id,api:I,type:"add"}),await this._notify_service_update()),{id:`${this._client_id}:${I.id}`,type:I.type,name:I.name,description:I.description||"",config:I.config}}async unregister_service(c,w){if(c instanceof Object&&(c=c.id),!this._services[c])throw new Error(`Service not found: ${c}`);const S=this._services[c];delete this._services[c],this._fire("service-updated",{service_id:c,api:S,type:"remove"}),await this._notify_service_update()}_ndarray(c,w,S){const E=Object(s.typedArrayToDtype)(c);if(S&&S!==E)throw"dtype doesn't match the type of the array: "+E+" != "+S;return w=w||[c.length],{_rtype:"ndarray",_rvalue:c.buffer,_rshape:w,_rdtype:E}}_encode_callback(c,w,S,E,I,A){let T=`${S}.${c}`,O={_rtype:"method",_rtarget:A?`${A}/${this._client_id}`:this._client_id,_rmethod:T,_rpromise:!1};const C=this;return[O,function(){try{w.apply(null,Array.prototype.slice.call(arguments))}catch(P){console.error("Error in callback:",T,P)}finally{E&&C._object_store[S]&&delete C._object_store[S],I&&I.started&&I.clear()}}]}async _encode_promise(c,w,S,E,I,A){let T=this._get_session_store(S,!0);Object(s.assert)(T,`Failed to create session store ${S} due to invalid parent`);let O={};return I&&w&&this._method_timeout?(O.heartbeat=await this._encode(I.reset.bind(I),S,A),O.interval=this._method_timeout/2,T.timer=I):I=null,[O.resolve,T.resolve]=this._encode_callback("resolve",c,S,E,I,A),[O.reject,T.reject]=this._encode_callback("reject",w,S,E,I,A),O}async _send_chunks(c,w,S){let E=await this.get_remote_service(`${w}:built-in`);Object(s.assert)(E.message_cache,"Remote client does not support message caching for long message.");let I=E.message_cache,A=S||Object(s.randId)();await I.create(A,!!S);let T=c.length,O=Math.ceil(T/l);for(let C=0;C<O;C++){let k=C*l;await I.append(A,c.slice(k,k+l),!!S)}await I.process(A,!!S)}_generate_remote_method(c,w,S,E,I){let A=c._rtarget;E&&!A.includes("/")&&(A=E+"/"+A,c._rtarget=A);let T=c._rmethod,O=c._rpromise;const C=this;function k(){return new Promise(async(N,L)=>{let F=Object(s.randId)();S&&(F=S+"."+F);let V=C._get_session_store(F,!0);if(!V){L(new Error(`Runtime Error: Failed to get session store ${F}`));return}V.target_id=A;const j=await C._encode(Array.prototype.slice.call(arguments),F,I),K=j.length,U=K>0&&typeof j[K-1]=="object"&&j[K-1]!==null&&j[K-1]._rkwargs;U&&delete j[K-1]._rkwargs;let X={type:"method",from:C._local_workspace?C._local_workspace+"/"+C._client_id:C._client_id,to:A,method:T},J={};j&&(J.args=j),U&&(J.with_kwargs=U),w&&(X.parent=w);let Y=null;if(O){X.session=F;let de=`${A}:${T}`;Y=new m(C._method_timeout,L,[`Method call time out: ${de}`],de),J.promise=await C._encode_promise(N,L,F,!0,Y,I)}let te=Object(i.encode)(X);if(J){const de=Object(i.encode)(J);te=new Uint8Array([...te,...de])}te.length<=l+1024?C._emit_message(te).then(function(){Y&&Y.start()}):C._send_chunks(te,A,w).then(function(){Y&&Y.start()})})}k.__rpc_object__=c;const P=T.split(".");return k.__name__=P[P.length-1],k.__doc__=c._rdoc,k.__sig__=c._rsig,k}async _notify_service_update(){if(this.manager_id)try{await this.get_manager_service(30),Object(s.assert)(this._manager_service),await this._manager_service.update_client_info(this.get_client_info())}catch(c){console.warn("Failed to notify service update to",this.manager_id,c)}}get_client_info(){const c=[];for(let w of Object.values(this._services))c.push({id:`${this._client_id}:${w.id}`,type:w.type,name:w.name,description:w.description||"",config:w.config});return{id:this._client_id,services:c}}async _handle_method(c){let w=null;try{Object(s.assert)(c.method&&c.ctx&&c.from);const S=c.from+":"+c.method,E=c.from.split("/")[0];c.to=c.to.includes("/")?c.to:E+"/"+c.to,c.ctx.to=c.to;const I=c.to.split("/")[0],A=c.parent;let T,O;if(c.promise){const P=await this._decode(c.promise,c.session,A,E,I);if(T=P.resolve,O=P.reject,P.heartbeat&&P.interval){async function N(){try{await P.heartbeat()}catch(L){console.error(L)}}w=setInterval(N,P.interval*1e3)}}let C;try{C=g(this._object_store,c.method)}catch(P){throw console.debug("Failed to find method",S,P),new Error(`Method not found: ${S}`)}if(Object(s.assert)(C&&typeof C=="function","Invalid method: "+S),this._method_annotations.has(C)){if(this._method_annotations.get(C).visibility==="protected"&&I!==E)throw new Error("Permission denied for protected method "+S+", workspace mismatch: "+I+" != "+E)}else{let P=this._object_store[c.method.split(".")[0]].target_id;if(I===E&&P&&P.indexOf("/")===-1&&(P=I+"/"+P),P!==c.from)throw new Error("Access denied for method call ("+S+") from "+c.from)}A&&Object(s.assert)(this._get_session_store(A,!0)!==null,"Parent session was closed: "+A);let k;if(c.args?k=await this._decode(c.args,c.session,null,E,null):k=[],this._method_annotations.has(C)&&this._method_annotations.get(C).require_context&&k.push(c.ctx),c.promise){const P=C.apply(null,k);P instanceof Promise?P.then(N=>{T(N),clearInterval(w)}).catch(N=>{O(N),clearInterval(w)}):(T(P),clearInterval(w))}else C.apply(null,k),clearInterval(w)}catch(S){console.error("Error during calling method: ",S),clearInterval(w)}}encode(c,w){return this._encode(c,w)}_get_session_store(c,w){let S=this._object_store;const E=c.split(".");if(w){const I=E.length-1;for(let A of E.slice(0,I)){if(!S[A])return null;S=S[A]}return S[E[I]]||(S[E[I]]={}),S[E[I]]}else{for(let I of E){if(!S[I])return null;S=S[I]}return S}}async _encode(c,w,S){const E=typeof c;if(E==="number"||E==="string"||E==="boolean"||c===null||c===void 0||c instanceof Uint8Array)return c;if(c instanceof ArrayBuffer)return{_rtype:"memoryview",_rvalue:new Uint8Array(c)};if(c.__rpc_object__)return c.__rpc_object__;let I;if(c.constructor instanceof Object&&c._rtype){const T=c._rtype;return delete c._rtype,I=await this._encode(c,w,S),I._rtype=T,I}if(typeof c=="function"){if(this._method_annotations.has(c)){let T=this._method_annotations.get(c);I={_rtype:"method",_rtarget:this._client_id,_rmethod:T.method_id,_rpromise:!0}}else{Object(s.assert)(typeof w=="string");let T;c.__name__?T=`${Object(s.randId)()}-${c.__name__}`:T=Object(s.randId)(),I={_rtype:"method",_rtarget:this._client_id,_rmethod:`${w}.${T}`,_rpromise:!0};let O=this._get_session_store(w,!0);Object(s.assert)(O!==null,`Failed to create session store ${w} due to invalid parent`),O[T]=c}if(I._rdoc=c.__doc__,I._rsig=c.__sig__,!I._rdoc||!I._rsig)try{const T=y(c);T&&!I._rdoc&&(I._rdoc=`${T.doc}`),T&&!I._rsig&&(I._rsig=`${T.name}(${T.sig})`)}catch{console.error("Failed to extract function docstring:",c)}return I}const A=Array.isArray(c);for(let T of Object.keys(this._codecs)){const O=this._codecs[T];if(O.encoder&&c instanceof O.type){let C=await Promise.resolve(O.encoder(c));if(C&&!C._rtype&&(C._rtype=O.name),typeof C=="object"){const k=C._rtype;delete C._rtype,C=await this._encode(C,w,S),C._rtype=k}return I=C,I}}if(typeof tf<"u"&&tf.Tensor&&c instanceof tf.Tensor){const T=c.dataSync();I={_rtype:"ndarray",_rvalue:new Uint8Array(T.buffer),_rshape:c.shape,_rdtype:c.dtype}}else if(typeof nj<"u"&&nj.NdArray&&c instanceof nj.NdArray){const T=Object(s.typedArrayToDtype)(c.selection.data);I={_rtype:"ndarray",_rvalue:new Uint8Array(c.selection.data.buffer),_rshape:c.shape,_rdtype:T}}else if(c instanceof Error)console.error(c),I={_rtype:"error",_rvalue:c.toString()};else if(c!==Object(c)||c instanceof Boolean||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof ImageData||typeof FileList<"u"&&c instanceof FileList||typeof FileSystemDirectoryHandle<"u"&&c instanceof FileSystemDirectoryHandle||typeof FileSystemFileHandle<"u"&&c instanceof FileSystemFileHandle||typeof FileSystemHandle<"u"&&c instanceof FileSystemHandle||typeof FileSystemWritableFileStream<"u"&&c instanceof FileSystemWritableFileStream)I=c;else if(c instanceof Blob){let T=function(k){O=k},O=0;async function C(k){let P;k?P=c.slice(O,O+k):P=c.slice(O);const N=new Uint8Array(await P.arrayBuffer());return O=O+N.byteLength,N}I={_rtype:"iostream",_rnative:"js:blob",type:c.type,name:c.name,size:c.size,path:c._path||c.webkitRelativePath,read:await this._encode(C,w,S),seek:await this._encode(T,w,S)}}else if(c instanceof f){const T=Object(s.typedArrayToDtype)(c);I={_rtype:"typedarray",_rvalue:new Uint8Array(c.buffer),_rdtype:T}}else if(c instanceof DataView)I={_rtype:"memoryview",_rvalue:new Uint8Array(c.buffer)};else if(c instanceof Set)I={_rtype:"set",_rvalue:await this._encode(Array.from(c),w,S)};else if(c instanceof Map)I={_rtype:"orderedmap",_rvalue:await this._encode(Array.from(c),w,S)};else if(c.constructor instanceof Object||Array.isArray(c)){I=A?[]:{};const T=Object.keys(c);for(let O of T)I[O]=await this._encode(c[O],w,S)}else throw`imjoy-rpc: Unsupported data type: ${c}, you can register a custom codec to encode/decode the object.`;if(!I)throw new Error("Failed to encode object");return I}async decode(c){return await this._decode(c)}async _decode(c,w,S,E,I){if(!c)return c;let A;if(c._rtype)if(this._codecs[c._rtype]&&this._codecs[c._rtype].decoder){const T=c._rtype;delete c._rtype,c=await this._decode(c,w,S,E,I),c._rtype=T,A=await Promise.resolve(this._codecs[c._rtype].decoder(c))}else if(c._rtype==="method")A=this._generate_remote_method(c,w,S,E,I);else if(c._rtype==="ndarray")if(typeof nj<"u"&&nj.array)Array.isArray(c._rvalue)&&(c._rvalue=c._rvalue.reduce(u)),A=nj.array(new Uint8(c._rvalue),c._rdtype).reshape(c._rshape);else if(typeof tf<"u"&&tf.Tensor){Array.isArray(c._rvalue)&&(c._rvalue=c._rvalue.reduce(u));const T=s.dtypeToTypedArray[c._rdtype];A=tf.tensor(new T(c._rvalue),c._rshape,c._rdtype)}else A=c;else if(c._rtype==="error")A=new Error(c._rvalue);else if(c._rtype==="typedarray"){const T=s.dtypeToTypedArray[c._rdtype];if(!T)throw new Error("unsupported dtype: "+c._rdtype);const O=c._rvalue.buffer.slice(c._rvalue.byteOffset,c._rvalue.byteOffset+c._rvalue.byteLength);A=new T(O)}else if(c._rtype==="memoryview")A=c._rvalue.buffer.slice(c._rvalue.byteOffset,c._rvalue.byteOffset+c._rvalue.byteLength);else if(c._rtype==="iostream"){if(c._rnative==="js:blob"){const O=await(await this._generate_remote_method(c.read,w,S,E,I))();A=new Blob([O],{type:c.type,name:c.name})}else{A={};for(let T of Object.keys(c))T.startsWith("_")||(A[T]=await this._decode(c[T],w,S,E,I))}A.__rpc_object__=c}else if(c._rtype==="orderedmap")A=new Map(await this._decode(c._rvalue,w,S,E,I));else if(c._rtype==="set")A=new Set(await this._decode(c._rvalue,w,S,E,I));else{const T=c._rtype;delete c._rtype,A=await this._decode(c,w,S,E,I),A._rtype=T}else if(c.constructor===Object||Array.isArray(c)){const T=Array.isArray(c);A=T?[]:{};for(let O of Object.keys(c))if(T||c.hasOwnProperty(O)){const C=c[O];A[O]=await this._decode(C,w,S,E,I)}}else A=c;if(A===void 0)throw new Error("Failed to decode object");return A}}},"./src/hypha/sse-client.js":function(n,t,r){r.r(t),r.d(t,"login",function(){return y}),r.d(t,"connectToServer",function(){return a});var s=r("./src/hypha/rpc.js");r.d(t,"RPC",function(){return s.RPC}),r.d(t,"API_VERSION",function(){return s.API_VERSION});var i=r("./src/hypha/utils.js");r.d(t,"loadRequirements",function(){return i.loadRequirements});var o=r("./src/hypha/webrtc-client.js");r.d(t,"getRTCService",function(){return o.getRTCService}),r.d(t,"registerRTCService",function(){return o.registerRTCService});var l=r("./package.json");r.d(t,"VERSION",function(){return l.version});function f(m,_="application/octet-stream"){return fetch(`data:${_};base64,${m}`).then(b=>b.arrayBuffer())}class u{constructor(_,b,c,w,S=120){Object(i.assert)(_&&b,"server_url and client_id are required"),_=_+"?client_id="+b,c&&(_+="&workspace="+c),w&&(_+="&token="+w),_+="&session_id="+Object(i.randId)(),this._events=null,this._handle_message=null,this._reconnection_token=null,this._server_url=_,this._timeout=S*1e3,this._opening=!1,this._retry_count=0,this._closing=!1}set_reconnection_token(_){this._reconnection_token=_}on_message(_){Object(i.assert)(_,"handler is required"),this._handle_message=_}open(){return this._opening?this._opening:(this._opening=new Promise((_,b)=>{const c=this._reconnection_token?`${this._server_url}&reconnection_token=${this._reconnection_token}`:this._server_url;console.info("Creating a new connection to ",c.split("?")[0]),this._events=new EventSource(c),this._events.onmessage=async w=>{const S=await f(w.data);this._handle_message(S)},this._events.onclose=w=>{console.log("eventsource closed"),this._closing||(console.log("Connection interrupted, retrying..."),this._retry_count++,setTimeout(()=>this.open(),this._timeout)),this._events=null,this._opening=!1,b("closed")},this._events.onerror=w=>{console.trace(),console.log("Error occurred in eventsource connection: ",w.message);debugger;b(w.toString())},this._events.onopen=w=>{_(!0)}}),this._opening)}async _send(_){await fetch(this._server_url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"octet-stream"},redirect:"follow",referrerPolicy:"no-referrer",body:_})}async emit_message(_){Object(i.assert)(this._handle_message,"No handler for message"),(!this._events||this._events.readyState===EventSource.CLOSED)&&await this.open(),await this._send(_)}disconnect(_){this._closing=!0;const b=this._events;this._events=null,b&&b.readyState===EventSource.OPEN&&b.close(),console.info(`EventSource connection disconnected (${_})`)}}function g(m){if(!m)throw new Error("server_url is required");return m=m.replace(/\/$/,"")+"/sse",m}async function y(m){const _=m.login_service_id||"public/*:hypha-login",b=m.login_timeout||120,c=m.login_callback,w=await a({name:"initial login client",server_url:m.server_url,method_timeout:b});try{const S=await w.get_service(_),E=await S.start();return c?await c(E):console.log(`Please open your browser and login at ${E.login_url}`),await S.check(E.key,b)}catch(S){throw S}finally{await w.disconnect()}}async function a(m){let _=m.client_id;_||(_=Object(i.randId)());let b=g(m.server_url),c=new u(b,_,m.workspace,m.token,m.method_timeout||120);await c.open();const w=new s.RPC(c,{client_id:_,manager_id:"workspace-manager",default_context:{connection_type:"eventsource"},name:m.name,method_timeout:m.method_timeout}),S=await w.get_remote_service("workspace-manager:default",m.method_timeout);S.rpc=w;async function E(T){T.id="default",T.name=m.name||T.id,await w.register_service(T,!0)}async function I(T){return await S.get_service(T+":default")}async function A(){await w.disconnect(),await c.disconnect()}if(S.export=E,S.getPlugin=I,S.listPlugins=S.listServices,S.disconnect=A,S.registerCodec=w.register_codec.bind(w),m.webrtc&&await Object(o.registerRTCService)(S,_+"-rtc",m.webrtc_config),S.get_service||S.getService){const T=S.get_service||S.getService;S.get_service=async function(O,C,k){Object(i.assert)([void 0,!0,!1,"auto"].includes(C),"webrtc must be true, false or 'auto'");const P=await T(O);if(C===!0||C==="auto"){if(P.id.includes(":")&&P.id.includes("/")){const N=P.id.split(":")[0];try{const L=await Object(o.getRTCService)(S,N+":"+N.split("/")[1]+"-rtc",k),F=await L.get_service(P.id.split(":")[1]);return F._webrtc=!0,F._peer=L,F._service=P,F}catch(L){console.warn("Failed to get webrtc service, using eventsource connection",L)}}if(C===!0)throw new Error("Failed to get the service via webrtc")}return P},S.getService=S.get_service}return S}},"./src/hypha/utils.js":function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"randId",function(){return randId}),__webpack_require__.d(__webpack_exports__,"dtypeToTypedArray",function(){return dtypeToTypedArray}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWindow",function(){return loadRequirementsInWindow}),__webpack_require__.d(__webpack_exports__,"loadRequirementsInWebworker",function(){return loadRequirementsInWebworker}),__webpack_require__.d(__webpack_exports__,"loadRequirements",function(){return loadRequirements}),__webpack_require__.d(__webpack_exports__,"normalizeConfig",function(){return normalizeConfig}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtypeMapping",function(){return typedArrayToDtypeMapping}),__webpack_require__.d(__webpack_exports__,"typedArrayToDtype",function(){return typedArrayToDtype}),__webpack_require__.d(__webpack_exports__,"cacheRequirements",function(){return cacheRequirements}),__webpack_require__.d(__webpack_exports__,"setupServiceWorker",function(){return setupServiceWorker}),__webpack_require__.d(__webpack_exports__,"assert",function(){return assert}),__webpack_require__.d(__webpack_exports__,"urlJoin",function(){return urlJoin}),__webpack_require__.d(__webpack_exports__,"waitFor",function(){return waitFor}),__webpack_require__.d(__webpack_exports__,"MessageEmitter",function(){return MessageEmitter});function randId(){return Math.random().toString(36).substr(2,10)+new Date().getTime()}const dtypeToTypedArray={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,array:Array};async function loadRequirementsInWindow(n){function t(o){return new Promise((l,f)=>{var u=document.createElement("script");u.src=o,u.type="text/javascript",u.onload=l,u.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&l()},u.onerror=f,document.head.appendChild(u)})}async function r(){for(var o=Array.prototype.slice.call(arguments),l=o.length,f=0;f<l;f++)await t(o[f])}if(n&&(Array.isArray(n)||typeof n=="string"))try{var s;if(n=typeof n=="string"?[n]:n,Array.isArray(n))for(var i=0;i<n.length;i++)n[i].toLowerCase().endsWith(".css")||n[i].startsWith("css:")?(n[i].startsWith("css:")&&(n[i]=n[i].slice(4)),s=document.createElement("link"),s.rel="stylesheet",s.href=n[i],document.head.appendChild(s)):n[i].toLowerCase().endsWith(".mjs")||n[i].startsWith("mjs:")?(n[i].startsWith("mjs:")&&(n[i]=n[i].slice(4)),await __vitePreload(()=>import(n[i]),__vite__mapDeps([]))):n[i].toLowerCase().endsWith(".js")||n[i].startsWith("js:")?(n[i].startsWith("js:")&&(n[i]=n[i].slice(3)),await r(n[i])):n[i].startsWith("http")?await r(n[i]):n[i].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[i]);else throw"unsupported requirements definition"}catch{throw"failed to import required scripts: "+n.toString()}}async function loadRequirementsInWebworker(n){if(n&&(Array.isArray(n)||typeof n=="string"))try{Array.isArray(n)||(n=[n]);for(var t=0;t<n.length;t++){if(n[t].toLowerCase().endsWith(".css")||n[t].startsWith("css:"))throw"unable to import css in a webworker";n[t].toLowerCase().endsWith(".js")||n[t].startsWith("js:")?(n[t].startsWith("js:")&&(n[t]=n[t].slice(3)),importScripts(n[t])):n[t].startsWith("http")?importScripts(n[t]):n[t].startsWith("cache:")||console.log("Unprocessed requirements url: "+n[t])}}catch{throw"failed to import required scripts: "+n.toString()}}function loadRequirements(n){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?loadRequirementsInWebworker(n):loadRequirementsInWindow(n)}function normalizeConfig(n){return n.version=n.version||"0.1.0",n.description=n.description||`[TODO: add description for ${n.name} ]`,n.type=n.type||"rpc-window",n.id=n.id||randId(),n.target_origin=n.target_origin||"*",n.allow_execution=n.allow_execution||!1,n=Object.keys(n).reduce((t,r)=>(typeof n[r]!="function"&&(t[r]=n[r]),t),{}),n}const typedArrayToDtypeMapping={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"array"},typedArrayToDtypeKeys=[];for(const arrType of Object.keys(typedArrayToDtypeMapping))typedArrayToDtypeKeys.push(eval(arrType));function typedArrayToDtype(n){let t=typedArrayToDtypeMapping[n.constructor.name];if(!t){const r=Object.getPrototypeOf(n);for(const s of typedArrayToDtypeKeys)if(r instanceof s){t=typedArrayToDtypeMapping[s.name];break}}return t}function cacheUrlInServiceWorker(n){return new Promise(function(t,r){const s={command:"add",url:n};if(!navigator.serviceWorker||!navigator.serviceWorker.register){r("Service worker is not supported.");return}const i=new MessageChannel;i.port1.onmessage=function(o){o.data&&o.data.error?r(o.data.error):t(o.data&&o.data.result)},navigator.serviceWorker&&navigator.serviceWorker.controller?navigator.serviceWorker.controller.postMessage(s,[i.port2]):r("Service worker controller is not available")})}async function cacheRequirements(n){n=n||[],Array.isArray(n)||(n=[n]);for(let t of n)t.startsWith("js:")&&(t=t.slice(3)),t.startsWith("css:")&&(t=t.slice(4)),t.startsWith("cache:")&&(t=t.slice(6)),t.startsWith("http")&&await cacheUrlInServiceWorker(t).catch(r=>{console.error(r)})}function setupServiceWorker(n,t,r){if("serviceWorker"in navigator){if(n=n||"/",navigator.serviceWorker.register(n+"plugin-service-worker.js").then(function(s){console.log("ServiceWorker registration successful with scope: ",s.scope)},function(s){console.log("ServiceWorker registration failed: ",s)}),t=t||"*",r=r||cacheRequirements,r&&typeof r!="function")throw new Error("config.cache_requirements must be a function");window.addEventListener("message",function(s){if(t==="*"||s.origin===t){const i=s.data;i.type==="cacheRequirements"&&r(i.requirements)}})}}function assert(n,t){if(!n)throw new Error(t||"Assertion failed")}function urlJoin(...n){return n.join("/").replace(/[\/]+/g,"/").replace(/^(.+):\//,"$1://").replace(/^file:/,"file:/").replace(/\/(\?|&|#[^!])/g,"$1").replace(/\?/g,"&").replace("&","?")}function waitFor(n,t,r){let s;return Promise.race([n,new Promise((i,o)=>s=setTimeout(()=>{o(r||"Timeout Error")},t*1e3))]).finally(()=>clearTimeout(s))}class MessageEmitter{constructor(t){this._event_handlers={},this._once_handlers={},this._debug=t}emit(){throw new Error("emit is not implemented")}on(t,r){this._event_handlers[t]||(this._event_handlers[t]=[]),this._event_handlers[t].push(r)}once(t,r){r.___event_run_once=!0,this.on(t,r)}off(t,r){if(!t&&!r)this._event_handlers={};else if(t&&!r)this._event_handlers[t]&&(this._event_handlers[t]=[]);else if(this._event_handlers[t]){const s=this._event_handlers[t].indexOf(r);s>=0&&this._event_handlers[t].splice(s,1)}}_fire(t,r){if(this._event_handlers[t])for(var s=this._event_handlers[t].length;s--;){const i=this._event_handlers[t][s];try{i(r)}catch(o){console.error(o)}finally{i.___event_run_once&&this._event_handlers[t].splice(s,1)}}else this._debug&&console.warn("unhandled event",t,r)}}},"./src/hypha/webrtc-client.js":function(n,t,r){r.r(t),r.d(t,"getRTCService",function(){return u}),r.d(t,"registerRTCService",function(){return g});var s=r("./src/hypha/rpc.js"),i=r("./src/hypha/utils.js");class o{constructor(a){this._data_channel=a,this._handle_message=null,this._reconnection_token=null,this._data_channel.onmessage=async _=>{let b=_.data;b instanceof Blob&&(b=await b.arrayBuffer()),this._handle_message(b)};const m=this;this._data_channel.onclose=function(){console.log("websocket closed"),m._data_channel=null}}set_reconnection_token(a){this._reconnection_token=a}on_message(a){Object(i.assert)(a,"handler is required"),this._handle_message=a}async emit_message(a){Object(i.assert)(this._handle_message,"No handler for message");try{this._data_channel.send(a)}catch(m){throw console.error(`Failed to send data, error: ${m}`),m}}async disconnect(a){this._data_channel=null,console.info(`data channel connection disconnected (${a})`)}}async function l(y){Object(i.assert)(y.channel,"No channel provided"),Object(i.assert)(y.workspace,"No workspace provided");const a=y.channel,m=y.client_id||Object(i.randId)(),_=new o(a);return y.context=y.context||{},y.context.connection_type="webrtc",new s.RPC(_,{client_id:m,manager_id:null,default_context:y.context,name:y.name,method_timeout:y.method_timeout||10,workspace:y.workspace})}async function f(y,a,m,_,b){m=m||{};let c=new RTCSessionDescription({sdp:y.sdp,type:y.type}),w=new RTCPeerConnection({iceServers:m.ice_servers||[{urls:["stun:stun.l.google.com:19302"]}],sdpSemantics:"unified-plan"});a&&w.addEventListener("datachannel",async E=>{const I=E.channel;let A=null;b&&b.user&&(A={user:b.user});const T=await l({channel:I,client_id:I.label,workspace:a.config.workspace,context:A});T._services=a.rpc._services}),_&&await _(w),await w.setRemoteDescription(c);let S=await w.createAnswer();return await w.setLocalDescription(S),{sdp:w.localDescription.sdp,type:w.localDescription.type,workspace:a.config.workspace}}async function u(y,a,m){m=m||{},m.peer_id=m.peer_id||Object(i.randId)();const _=new RTCPeerConnection({iceServers:m.ice_servers||[{urls:["stun:stun.l.google.com:19302"]}],sdpSemantics:"unified-plan"});return new Promise(async(b,c)=>{try{_.addEventListener("connectionstatechange",()=>{_.connectionState==="failed"&&(_.close(),c(new Error("Connection failed")))},!1),m.on_init&&(await m.on_init(_),delete m.on_init);let w=_.createDataChannel(m.peer_id,{ordered:!0});w.binaryType="arraybuffer";const S=await _.createOffer();await _.setLocalDescription(S);const I=await(await y.getService(a)).offer({sdp:_.localDescription.sdp,type:_.localDescription.type});w.onopen=()=>{m.channel=w,m.workspace=I.workspace,setTimeout(async()=>{const A=await l(m);_.rpc=A;async function T(C){return await A.get_remote_service(m.peer_id+":"+C)}async function O(){await A.disconnect(),_.close()}_.get_service=T,_.getService=T,_.disconnect=O,_.register_codec=A.register_codec,_.registerCodec=A.register_codec,b(_)},500)},w.onclose=()=>c(new Error("Data channel closed")),await _.setRemoteDescription(new RTCSessionDescription({sdp:I.sdp,type:I.type}))}catch(w){c(w)}})}async function g(y,a,m){m=m||{visibility:"protected",require_context:!0};const _=m.on_init;delete m.on_init,await y.registerService({id:a,config:m,offer:(b,c)=>f(b,y,m,_,c)})}}})})})(hyphaRpcSse);var hyphaRpcSseExports=hyphaRpcSse.exports,imjoyRpc={imjoyRPC:imjoyRpcExports,imjoyRPCSocketIO:imjoyRpcSocketioExports,hyphaRPC:hyphaRpcExports,hyphaWebsocketClient:hyphaRpcWebsocketExports,hyphaSSEClient:hyphaRpcSseExports};class TritonExecutor{constructor(t,r){this.serverUrl=t,this.serviceId=r}async init(){const t=await imjoyRpc.hyphaWebsocketClient.connectToServer({server_url:this.serverUrl,method_timeout:30,name:"client"});this.triton=await t.get_service(this.serviceId)}async loadModelConfig(t){const r=`${this.serverUrl}/triton/v2/models/${t}/config`;return await fetch(r).then(i=>i.json())}async loadModelRdf(t){let r;return r=await this.execute(t,void 0,!0),r.result.rdf}async execute(t,r=null,s=!1,i=null){return await this.triton.execute({_rkwargs:!0,inputs:[{model_id:t,inputs:r,return_rdf:s,weight_format:i}],model_name:"bioengine-model-runner",serialization:"imjoy"})}async runCellpose(t,r={}){return console.log("Running cellpose with parameters: ",r),await this.triton.execute({inputs:[t,r],model_name:"cellpose-python",decode_json:!0,_rkwargs:!0})}}class ModelRunner{constructor(t="https://ai.imjoy.io",r="triton-client"){this.tritonExecutor=new TritonExecutor(t,r),this.rdf=null,this.modelTritonConfig=null,this.inputEndianness=null,this.modelId=null}async init(){await this.tritonExecutor.init()}fixedTileSize(){if(this.rdf&&this.modelTritonConfig){const t=this.rdf.inputs[0],r=this.modelTritonConfig.input[0].dims;return r!==void 0&&!r.includes(-1)?r:t.shape instanceof Array?t.shape:!1}else return!1}getInputMinShape(){const t=this.rdf.inputs[0].axes;let r;const s=this.fixedTileSize();return s===!1?r=this.rdf.inputs[0].shape.min:r=s,t.split("").reduce((o,l,f)=>(o[l]=r[f],o),{})}getInputMaxShape(){const t=this.rdf.inputs[0].axes;let r;const s=this.fixedTileSize();return s!==!1?r=s:r=this.rdf.inputs[0].shape.min.map(()=>{}),t.split("").reduce((i,o,l)=>(i[o]=r[l],i),{})}getDefaultTileSizes(){const t=this.getInputMinShape(),r=Object.assign({},t),s=this.rdf.inputs[0].axes,i=this.fixedTileSize();return i===!1?(r.x=4*t.x,r.y=4*t.y):s.split("").map((o,l)=>{r[o]=i[l]}),r}getDefaultTileOverlaps(){const t=this.rdf.inputs[0],r=this.rdf.outputs[0],s=t.axes;let i={};return r.halo&&this.fixedTileSize()===!1?s.split("").map((o,l)=>{r.axes.includes(o)&&o!=="z"?i[o]=2*r.halo[l]:i[o]=0}):i=s.split("").reduce((o,l)=>(o[l]=0,o),{}),i}isImg2Img(){const t=this.rdf.outputs[0];return t.axes.includes("x")&&t.axes.includes("y")}async detectInputEndianness(){const t=this.rdf.test_inputs[0];t&&(this.inputEndianness=await getNpyEndianness(t)),console.log("Input endianness: "+this.inputEndianness)}async loadModel(t){if(this.modelId=t,t==="cellpose-python")this.rdf=loadCellposeRdf(),this.modelTritonConfig=await this.tritonExecutor.loadModelConfig(t);else{this.rdf=await this.tritonExecutor.loadModelRdf(t);const r=this.rdf.config.bioimageio.nickname;this.modelTritonConfig=await this.tritonExecutor.loadModelConfig(r),this.detectInputEndianness()}}async submitTensor(t,r=void 0){const s=this.inputEndianness==="<",i=this.rdf.inputs[0].data_type,o=tfjsToImJoy(t,s,i),l=this.modelId;let f;if(l==="cellpose-python")f=(await this.tritonExecutor.runCellpose(o,r)).mask;else{const u=await this.tritonExecutor.execute(l,[o]);if(!u.result.success)throw new Error(u.result.error);f=u.result.outputs[0]}return f}async runOneTensor(t,r,s=void 0){console.log("Input tile shape: "+t.shape);const[i,o]=r.pad(t);console.log("Padded tile shape: "+i.shape);let l=await this.submitTensor(i,s);console.log("Output tile shape: "+l._rshape);const f=imjoyToTfjs(l),u=this.rdf.outputs[0].axes.includes("x")&&this.rdf.outputs[0].axes.includes("y");let g=f;return u&&(g=r.crop(f,o)),g}async runTiles(t,r,s,i,o,l=void 0,f=void 0){f||(f=I=>{console.log(I)});let u;const g=this.fixedTileSize();g===!1?u=new ImgPadder(void 0,r.shape.min,r.shape.step,0):u=new ImgPadder(g,void 0,void 0,0);const y=r.axes.split("").map(I=>i[I]),a=r.axes.split("").map(I=>o[I]);console.log("tile size:",y,"overlap:",a);const m=new ImgTiler(t.shape,y,a),_=m.getNTiles();console.log("Number of tiles in each dimension: "+_);const b=m.getTiles();console.log("Number of tiles: "+b.length);const c=[];for(let I=0;I<b.length;I++){f(`Running the model... (${I+1}/${b.length})`);const A=b[I];console.log(A),A.slice(t);const T=await this.runOneTensor(A.data,u,l),O=new ImgTile(A.starts,A.ends,A.indexes);O.data=T,c.push(O)}const w=s.axes.includes("x")&&s.axes.includes("y");let S;w?S=new TileMerger(t.shape):S=new MeanTileMerger(t.shape);const E=S.mergeTiles(c).data;return console.log("Output image shape after merging: "+E.shape),E}}var browserPonyfill={exports:{}};(function(n,t){var r=typeof self<"u"?self:commonjsGlobal,s=function(){function o(){this.fetch=!1,this.DOMException=r.DOMException}return o.prototype=r,new o}();(function(o){(function(l){var f={searchParams:"URLSearchParams"in o,iterable:"Symbol"in o&&"iterator"in Symbol,blob:"FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in o,arrayBuffer:"ArrayBuffer"in o};function u(j){return j&&DataView.prototype.isPrototypeOf(j)}if(f.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],y=ArrayBuffer.isView||function(j){return j&&g.indexOf(Object.prototype.toString.call(j))>-1};function a(j){if(typeof j!="string"&&(j=String(j)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(j))throw new TypeError("Invalid character in header field name");return j.toLowerCase()}function m(j){return typeof j!="string"&&(j=String(j)),j}function _(j){var K={next:function(){var U=j.shift();return{done:U===void 0,value:U}}};return f.iterable&&(K[Symbol.iterator]=function(){return K}),K}function b(j){this.map={},j instanceof b?j.forEach(function(K,U){this.append(U,K)},this):Array.isArray(j)?j.forEach(function(K){this.append(K[0],K[1])},this):j&&Object.getOwnPropertyNames(j).forEach(function(K){this.append(K,j[K])},this)}b.prototype.append=function(j,K){j=a(j),K=m(K);var U=this.map[j];this.map[j]=U?U+", "+K:K},b.prototype.delete=function(j){delete this.map[a(j)]},b.prototype.get=function(j){return j=a(j),this.has(j)?this.map[j]:null},b.prototype.has=function(j){return this.map.hasOwnProperty(a(j))},b.prototype.set=function(j,K){this.map[a(j)]=m(K)},b.prototype.forEach=function(j,K){for(var U in this.map)this.map.hasOwnProperty(U)&&j.call(K,this.map[U],U,this)},b.prototype.keys=function(){var j=[];return this.forEach(function(K,U){j.push(U)}),_(j)},b.prototype.values=function(){var j=[];return this.forEach(function(K){j.push(K)}),_(j)},b.prototype.entries=function(){var j=[];return this.forEach(function(K,U){j.push([U,K])}),_(j)},f.iterable&&(b.prototype[Symbol.iterator]=b.prototype.entries);function c(j){if(j.bodyUsed)return Promise.reject(new TypeError("Already read"));j.bodyUsed=!0}function w(j){return new Promise(function(K,U){j.onload=function(){K(j.result)},j.onerror=function(){U(j.error)}})}function S(j){var K=new FileReader,U=w(K);return K.readAsArrayBuffer(j),U}function E(j){var K=new FileReader,U=w(K);return K.readAsText(j),U}function I(j){for(var K=new Uint8Array(j),U=new Array(K.length),X=0;X<K.length;X++)U[X]=String.fromCharCode(K[X]);return U.join("")}function A(j){if(j.slice)return j.slice(0);var K=new Uint8Array(j.byteLength);return K.set(new Uint8Array(j)),K.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(j){this._bodyInit=j,j?typeof j=="string"?this._bodyText=j:f.blob&&Blob.prototype.isPrototypeOf(j)?this._bodyBlob=j:f.formData&&FormData.prototype.isPrototypeOf(j)?this._bodyFormData=j:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(j)?this._bodyText=j.toString():f.arrayBuffer&&f.blob&&u(j)?(this._bodyArrayBuffer=A(j.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(j)||y(j))?this._bodyArrayBuffer=A(j):this._bodyText=j=Object.prototype.toString.call(j):this._bodyText="",this.headers.get("content-type")||(typeof j=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(j)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var j=c(this);if(j)return j;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(S)}),this.text=function(){var j=c(this);if(j)return j;if(this._bodyBlob)return E(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(I(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(P)}),this.json=function(){return this.text().then(JSON.parse)},this}var O=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(j){var K=j.toUpperCase();return O.indexOf(K)>-1?K:j}function k(j,K){K=K||{};var U=K.body;if(j instanceof k){if(j.bodyUsed)throw new TypeError("Already read");this.url=j.url,this.credentials=j.credentials,K.headers||(this.headers=new b(j.headers)),this.method=j.method,this.mode=j.mode,this.signal=j.signal,!U&&j._bodyInit!=null&&(U=j._bodyInit,j.bodyUsed=!0)}else this.url=String(j);if(this.credentials=K.credentials||this.credentials||"same-origin",(K.headers||!this.headers)&&(this.headers=new b(K.headers)),this.method=C(K.method||this.method||"GET"),this.mode=K.mode||this.mode||null,this.signal=K.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&U)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(U)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})};function P(j){var K=new FormData;return j.trim().split("&").forEach(function(U){if(U){var X=U.split("="),J=X.shift().replace(/\+/g," "),Y=X.join("=").replace(/\+/g," ");K.append(decodeURIComponent(J),decodeURIComponent(Y))}}),K}function N(j){var K=new b,U=j.replace(/\r?\n[\t ]+/g," ");return U.split(/\r?\n/).forEach(function(X){var J=X.split(":"),Y=J.shift().trim();if(Y){var te=J.join(":").trim();K.append(Y,te)}}),K}T.call(k.prototype);function L(j,K){K||(K={}),this.type="default",this.status=K.status===void 0?200:K.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in K?K.statusText:"OK",this.headers=new b(K.headers),this.url=K.url||"",this._initBody(j)}T.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new b(this.headers),url:this.url})},L.error=function(){var j=new L(null,{status:0,statusText:""});return j.type="error",j};var F=[301,302,303,307,308];L.redirect=function(j,K){if(F.indexOf(K)===-1)throw new RangeError("Invalid status code");return new L(null,{status:K,headers:{location:j}})},l.DOMException=o.DOMException;try{new l.DOMException}catch{l.DOMException=function(K,U){this.message=K,this.name=U;var X=Error(K);this.stack=X.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function V(j,K){return new Promise(function(U,X){var J=new k(j,K);if(J.signal&&J.signal.aborted)return X(new l.DOMException("Aborted","AbortError"));var Y=new XMLHttpRequest;function te(){Y.abort()}Y.onload=function(){var se={status:Y.status,statusText:Y.statusText,headers:N(Y.getAllResponseHeaders()||"")};se.url="responseURL"in Y?Y.responseURL:se.headers.get("X-Request-URL");var de="response"in Y?Y.response:Y.responseText;U(new L(de,se))},Y.onerror=function(){X(new TypeError("Network request failed"))},Y.ontimeout=function(){X(new TypeError("Network request failed"))},Y.onabort=function(){X(new l.DOMException("Aborted","AbortError"))},Y.open(J.method,J.url,!0),J.credentials==="include"?Y.withCredentials=!0:J.credentials==="omit"&&(Y.withCredentials=!1),"responseType"in Y&&f.blob&&(Y.responseType="blob"),J.headers.forEach(function(se,de){Y.setRequestHeader(de,se)}),J.signal&&(J.signal.addEventListener("abort",te),Y.onreadystatechange=function(){Y.readyState===4&&J.signal.removeEventListener("abort",te)}),Y.send(typeof J._bodyInit>"u"?null:J._bodyInit)})}return V.polyfill=!0,o.fetch||(o.fetch=V,o.Headers=b,o.Request=k,o.Response=L),l.Headers=b,l.Request=k,l.Response=L,l.fetch=V,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var i=s;t=i.fetch,t.default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,n.exports=t})(browserPonyfill,browserPonyfill.exports);var browserPonyfillExports=browserPonyfill.exports;const fetch$1=getDefaultExportFromCjs(browserPonyfillExports);class npyjs{constructor(t){t&&console.error(["No arguments accepted to npyjs constructor.","For usage, go to https://github.com/jhuapl-boss/npyjs."].join(" ")),this.dtypes={"<u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"|u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"<u2":{name:"uint16",size:16,arrayConstructor:Uint16Array},"|i1":{name:"int8",size:8,arrayConstructor:Int8Array},"<i2":{name:"int16",size:16,arrayConstructor:Int16Array},"<u4":{name:"uint32",size:32,arrayConstructor:Int32Array},"<i4":{name:"int32",size:32,arrayConstructor:Int32Array},"<u8":{name:"uint64",size:64,arrayConstructor:BigUint64Array},"<i8":{name:"int64",size:64,arrayConstructor:BigInt64Array},"<f4":{name:"float32",size:32,arrayConstructor:Float32Array},"<f8":{name:"float64",size:64,arrayConstructor:Float64Array}}}parse(t){const r=new DataView(t.slice(8,10)).getUint8(0),s=10+r,i=new TextDecoder("utf-8").decode(new Uint8Array(t.slice(10,10+r))),o=JSON.parse(i.toLowerCase().replace(/'/g,'"').replace("(","[").replace(/,*\),*/g,"]")),l=o.shape,f=this.dtypes[o.descr],u=new f.arrayConstructor(t,s);return{dtype:f.name,data:u,shape:l,fortranOrder:o.fortran_order}}async load(t,r,s){s=s||{};let i;t instanceof ArrayBuffer?i=t:i=await(await fetch$1(t,{...s})).arrayBuffer();const o=this.parse(i);return r?r(o):o}}class ImagejJsController{constructor(t){this.ij=t}async getImage(){return await this.ij.getImage({format:"ndarray",all:!0})}async viewFromUrl(t,r,s,i="input"){console.log("View image from url: "+t);let o;if(t.endsWith("/content")?o=t.split("/")[t.split("/").length-2]:o=t.split("/")[t.split("/").length-1],o.endsWith(".npy")){let l=new npyjs;const f=await fetch(t).then(b=>b.arrayBuffer()),u=await l.load(f),g=new Uint8Array(u.data.buffer.slice(u.data.byteOffset)),y={_rtype:"ndarray",_rdtype:u.dtype,_rshape:u.shape,_rvalue:g},a=inferImgAxesViaSpec(y._rshape,r.axes),m=imjoyToTfjs(y);if(i==="output"&&!(s.axes.includes("x")&&s.axes.includes("y"))){await this.showTableFromTensor(m,o);return}const _=processForShow(m,a);await this.showImgs(_,o)}else{const l=await fetch(t);if(!l.ok)throw new Error("Failed to load the image.");const f=await l.arrayBuffer();this.ij.viewImage(f,{name:o}).catch(u=>{throw new Error("Failed to view the image.")})}}async showTableFromTensor(t,r){t.arraySync().map(async i=>{await this.showTable(i,"Probability",r)})}async showTable(t,r,s){const i=t.map((l,f)=>f),o=`
Table.create("${s}")
Table.setColumn("Index", newArray(${i.join(",")}))
Table.setColumn("${r}", newArray(${t.join(",")}))
`;this.ij.runMacro(o)}async showImgs(t,r="output"){for(let s=0;s<t.length;s++){const i=t[s];console.log("Output image shape after processing: "+i._rshape);try{await this.ij.viewImage(i,{name:r})}catch{throw new Error("Failed to view the image.")}}}}async function waitState(n,t){const r=computed(n);for(;r.value!==t;)await new Promise(s=>setTimeout(s,100));console.log("State changed to the specific value")}async function waitRunable(){const n=useRunStore();await waitState(()=>n.runable,!0)}const useRunStore=defineStore("run",{state:()=>({queryCount:0,runable:!1,modelInitialized:!1,serverInitialized:!1}),actions:{async run(){await waitRunable(),this.queryCount++,await waitRunable()}}});function rdfHas(n,t){return n[t]!==void 0&&n[t].length>0}const _sfc_main$1={setup:()=>{const n=useStore(),t=useRunStore(),r=useServerStore(),s=ref(!0),i=ref(!1),o=ref(!1),l=ref(""),f=ref(!1),u=ref(!1),g=ref(!1),y=ref(!1),a=(c,w=!1,S=!1)=>{l.value=c,i.value=w,o.value=S},m=c=>{var w;(w=n==null?void 0:n.runner)!=null&&w.rdf?(f.value=c,u.value=c&&(rdfHas(n.runner.rdf,"test_inputs")||rdfHas(n.runner.rdf,"sample_inputs")),g.value=c&&(rdfHas(n.runner.rdf,"test_outputs")||rdfHas(n.runner.rdf,"sample_outputs")),y.value=c):(f.value=!1,u.value=!1,g.value=!1,y.value=!1)},_=async(c,w=void 0)=>{var T;const S=useStore(),E=useParametersStore(),I=useRunStore();w===void 0&&(w=S.runner),a(`Initializing model ${c}...`,!0),m(!1);try{await w.loadModel(c)}catch(O){throw a(`Failed to load model ${c}.`,!1,!0),console.error(O),O}E.$patch({tileSizes:w.getDefaultTileSizes(),tileOverlaps:w.getDefaultTileOverlaps(),additionalParametersSchema:((T=w==null?void 0:w.rdf)==null?void 0:T.additional_parameters)||[]});const A={};for(const O of E.additionalParametersSchema)for(const C of O.parameters)A[C.name]=C.default;console.log("Init additional parameters",A),E.$patch({additionalParameters:A}),m(!0),a(""),I.$patch({modelInitialized:!0})},b=async()=>{const c=useStore(),w=useParametersStore(),S=c.runner;a("Running the model...",!0),f.value=!1,console.log("Spec input axes: "+c.inputSpec.axes),console.log("Spec output axes: "+c.outputSpec.axes);try{const E=await c.viewerControl.getImage();let I=inferImgAxesViaSpec(E._rshape,c.inputSpec.axes,!0);console.log("Input image axes: "+I),console.log("Reshape image to match the input spec.");const A=imjoyToTfjs(E),T=mapAxes(A,I,c.inputSpec.axes),O=await S.runTiles(T,c.inputSpec,c.outputSpec,w.tileSizes,w.tileOverlaps,w.additionalParameters,C=>{a(C,!0)});if(S.isImg2Img()){const C=processForShow(O,c.outputSpec.axes);await c.viewerControl.showImgs(C,"output")}else await c.viewerControl.showTableFromTensor(O,"output")}catch(E){alert("Failed to run the model, see console for details."),a("Failed to run the model, see console for details.",!1,!0),f.value=!0,console.error(E);debugger;return}a(""),f.value=!0};return watch(()=>n.currentModel,c=>{var w;(w=n==null?void 0:n.runner)!=null&&w.rdf&&_(c.id)}),watch(()=>(r.serverUrl,r.serviceId),async()=>{const c=useStore(),w=useServerStore(),S=useRunStore(),E=c.runner.modelId;a("Initializing server...",!0),m(!1);try{const I=new ModelRunner(w.serverUrl,w.serviceId);await I.init(),await _(E,I),c.$patch({runner:I}),m(!0),a("")}catch(I){a("Failed to initialize the server.",!1,!0),m(!1),console.error(I)}finally{S.$patch({serverInitialized:!0})}}),watch(()=>i.value,()=>{t.$patch({runable:!i.value})}),watch(()=>t.queryCount,async c=>{await b()}),{waiting:i,error:o,info:l,buttonEnabledRun:f,buttonEnabledInput:u,buttonEnabledOutput:g,modelSelectEnable:y,setInfoPanel:a,turnButtons:m,initModel:_,runModel:b,newIjWindow:s}},data:()=>({ij:null,api:null}),computed:{infoColor(){return this.error?"red":"black"}},mounted(){this.init()},methods:{async init(){const n=useStore();this.setInfoPanel("Initializing...",!0),await this.initImJoy();const t=new ModelRunner(n.serverUrl,n.serviceId);await t.init(),n.$patch({runner:t});const r="10.5281/zenodo.5764892";await this.initModel(r),this.turnButtons(!1),this.setInfoPanel("Initializing ImageJ.JS ...",!0),await this.initImageJ(),n.$patch({viewerControl:new ImagejJsController(this.ij)}),this.setInfoPanel(""),this.turnButtons(!0)},async initImJoy(){function n(s=1e4){return new Promise((i,o)=>{const l=setInterval(()=>{window.app&&window.app.imjoy!==void 0&&(clearInterval(l),i(window.app.imjoy))},100);setTimeout(()=>{clearInterval(l),o(new Error("Timeout waiting for window.app.imjoy"))},s)})}const t=await n();console.log("ImJoy is ready:",t);const r=t;this.api=r},async initImageJ(){const n=await this.api.getWindow("ImageJ.JS");n?(this.newIjWindow=!1,this.ij=n):(window.self!==window.top&&(this.newIjWindow=!1),console.log("Create IJ window..."),this.ij=await this.api.createWindow({src:"https://ij.imjoy.io/",name:"ImageJ.JS",fullscreen:!1,window_id:"ij-container"}))},async loadTestInput(){const n=useStore(),t=n.runner;if(this.setInfoPanel("Loading test input...",!0),rdfHas(t.rdf,"test_inputs"))try{await n.viewerControl.viewFromUrl(t.rdf.test_inputs[0],n.inputSpec,n.outputSpec)}catch(r){console.log("Failed to load the test input, see console for details."),console.error(r),console.log("Loading sample input instead..."),await n.viewerControl.viewFromUrl(t.rdf.sample_inputs[0],n.inputSpec,n.outputSpec)}else rdfHas(t.rdf,"sample_inputs")?await n.viewerControl.viewFromUrl(t.rdf.sample_inputs[0],n.inputSpec,n.outputSpec):alert("No test input found.");this.setInfoPanel("")},async loadTestOutput(){const n=useStore(),t=n.runner;if(this.setInfoPanel("Loading test output...",!0),rdfHas(t.rdf,"test_outputs"))try{await n.viewerControl.viewFromUrl(t.rdf.test_outputs[0],n.inputSpec,n.outputSpec,"output")}catch(r){console.log("Failed to load the test output."),console.error(r),console.log("Loading sample output instead..."),await n.viewerControl.viewFromUrl(t.rdf.sample_outputs[0],n.inputSpec,n.outputSpec,"output")}else rdfHas(t.rdf,"sample_outputs")?await n.viewerControl.viewFromUrl(t.rdf.sample_outputs[0],n.inputSpec,n.outputSpec,"output"):alert("No test output found.");this.setInfoPanel("")}},components:{HideContainer,OverlayContainer,AdvanceSetting,LoadingAnimation,ModelSelect,ModelParameters}},_withScopeId=n=>(pushScopeId("data-v-3f26f115"),n=n(),popScopeId(),n),_hoisted_1={id:"test-run-body"},_hoisted_2={class:"model-selection"},_hoisted_3={class:"model-selection-line"},_hoisted_4=_withScopeId(()=>createBaseVNode("div",{class:"model-selection-label"},"Model",-1)),_hoisted_5=_withScopeId(()=>createBaseVNode("div",{class:"model-selection-tips"},[createTextVNode("ℹ️ Please visit "),createBaseVNode("a",{href:"https://bioimage.io/#/",target:"_blank"},"bioimage.io"),createTextVNode(" to view detailed information about the model.")],-1)),_hoisted_6={id:"buttons"},_hoisted_7={id:"info"},_hoisted_8={key:1},_hoisted_9=_withScopeId(()=>createBaseVNode("span",null,"💡Tip: Drag and drop your own image file below to try out the model. We support formats like .tiff, .png, and .jpg",-1)),_hoisted_10=[_hoisted_9],_hoisted_11={key:0,id:"ij-container"};function _sfc_render(n,t,r,s,i,o){const l=resolveComponent("ModelSelect"),f=resolveComponent("Button"),u=resolveComponent("ModelParameters"),g=resolveComponent("AdvanceSetting"),y=resolveComponent("OverlayContainer"),a=resolveComponent("HideContainer"),m=resolveComponent("LoadingAnimation");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[_hoisted_4,createVNode(l,{open:this.modelSelectEnable},null,8,["open"])]),_hoisted_5]),createBaseVNode("div",_hoisted_6,[createVNode(f,{disabled:!this.buttonEnabledInput,onClick:this.loadTestInput},{default:withCtx(()=>[createTextVNode(" Load sample image ")]),_:1},8,["disabled","onClick"]),createVNode(f,{class:"is-primary",disabled:!this.buttonEnabledRun,onClick:this.runModel},{default:withCtx(()=>[createTextVNode(" Run model ")]),_:1},8,["disabled","onClick"]),createVNode(f,{disabled:!this.buttonEnabledOutput,onClick:this.loadTestOutput},{default:withCtx(()=>[createTextVNode(" Show reference output ")]),_:1},8,["disabled","onClick"])]),createVNode(u,{overlay:n.waiting},null,8,["overlay"]),createVNode(a,{summary:"Advanced settings"},{default:withCtx(()=>[createVNode(y,{open:n.waiting},{default:withCtx(()=>[createVNode(g)]),_:1},8,["open"])]),_:1}),createBaseVNode("div",_hoisted_7,[this.waiting?(openBlock(),createBlock(m,{key:0})):n.$props.ij===null?(openBlock(),createElementBlock("div",_hoisted_8,_hoisted_10)):createCommentVNode("",!0),createBaseVNode("div",{id:"info-panel",style:normalizeStyle({color:o.infoColor})},toDisplayString(this.info),5)]),n.newIjWindow?(openBlock(),createElementBlock("div",_hoisted_11)):createCommentVNode("",!0)])}const RunPanel=_export_sfc(_sfc_main$1,[["render",_sfc_render],["__scopeId","data-v-3f26f115"]]),_sfc_main={__name:"App",setup(n){return(t,r)=>(openBlock(),createBlock(RunPanel))}};function setupStoreWatcher(){const n=effectScope();return n.run(()=>{const t=useStore(),r=useParametersStore();watch(()=>t.currentModel,s=>{console.log("currentModel changed",s)}),watch(()=>r.tileSizes,(s,i)=>{i.y!==i.x&&(i.y=i.x),console.log(i),r.$patch({tileSizes:i})},{deep:!0}),watch(()=>r.tileOverlaps,(s,i)=>{i.y!==i.x&&(i.y=i.x),console.log(i),r.$patch({tileOverlaps:i})},{deep:!0})}),()=>{n.stop()}}window.app={};async function setupImJoyApp(){const n=await loadImJoyBasicApp({name:"BioEgnine Web Client",process_url_query:!0,show_window_title:!1,show_progress_bar:!0,show_empty_window:!0,menu_style:{position:"absolute",right:0,top:"2px"},window_style:{width:"100%",height:"100%"},main_container:null,menu_container:"menu-container",window_manager_container:null,expose_api:!0,imjoy_api:{}}),t=n.imjoy.api;window.app.imjoy=t;const r=await createImjoyApi(t);return window.app.client=r,n.addMenuItem({label:"➕ Load Plugin",callback(){const s=prompt("Please type a ImJoy plugin URL","https://github.com/imjoy-team/imjoy-plugins/blob/master/repository/ImageAnnotator.imjoy.html");s&&n.loadPlugin(s)}}),n.addMenuItem({label:"➕ Chatbot",async callback(){await(await t.createWindow({src:"https://staging.chat.bioimage.io/public/apps/bioimageio-chatbot-client/index",name:"BioImage.IO Chatbot"})).registerExtension({_rintf:!0,name:"runImageJMacro",description:"Run a macro in ImageJ.JS",async get_schema(){return{type:"object",title:"RunImageJMacro",description:"Run a macro in ImageJ.JS",properties:{macro:{type:"string",description:"The macro to run"},args:{type:"object",description:"Arguments for the macro"}}}},async execute(i){let o=await t.getWindow("ImageJ.JS");o||(o=await t.createWindow({src:"https://ij.imjoy.io",name:"ImageJ.JS"}));try{return await o.runMacro(i.macro,i.args)}catch(l){return console.error(l),l.toString()}}})}}),n}async function createImjoyApi(n){function t(){n.log("Bioengine web client initialized.")}async function r(){await window.app.store.run.run()}function s(g){window.app.store.parameters.$patch({additionalParameters:g})}function i(){return window.app.store.global.models}async function o(g){console.log(g);const y=window.app.store.global,a=window.app.store.run;if(a.$patch({modelInitialized:!1}),typeof g=="string"){const m=g.toLowerCase();for(const _ of y.models)if(_.nickname.toLowerCase()===m||_.name.toLowerCase()===m||_.id.toLowerCase()===m){if(y.currentModel===_){a.$patch({modelInitialized:!0});return}y.$patch({currentModel:_});break}}else y.$patch({currentModel:g});await waitState(()=>a.modelInitialized,!0)}function l(g=void 0,y=void 0){const a=window.app.store.parameters,m={};Object.assign(m,a.tileSizes),g&&Object.assign(m,g);const _={};Object.assign(_,a.tileOverlaps),y&&Object.assign(_,y),a.$patch({tileSizes:m,tileOverlaps:_})}async function f(){await waitRunable()}async function u(g,y){const a=window.app.store.server,m=window.app.store.run;if(m.$patch({serverInitialized:!1}),a.serverUrl===g&&a.serviceId===y){m.$patch({serverInitialized:!0});return}a.$patch({serverUrl:g,serviceId:y}),await waitState(()=>m.serverInitialized,!0)}return{setup:t,runModel:r,setParameters:s,listModels:i,setModel:o,setTiling:l,waitForReady:f,setServerSetting:u}}async function initImJoy(){if(window.self!==window.top){const t=await(await loadImJoyRPC()).setupRPC({name:"bioengine-web-client"});window.app.imjoy=t;const r=await createImjoyApi(t);await t.export(r),window.api.client=r}else await setupImJoyApp()}const app=createApp(_sfc_main);initImJoy();app.use(PrimeVue,{unstyled:!1});app.component("Button",script$b);app.component("InputNumber",script$7);app.component("Dropdown",script);app.component("InputText",script$8);const pinia=createPinia();pinia.use(src_default);app.use(pinia);app.mount("#app");window.app.vue=app;window.app.store={global:useStore(),server:useServerStore(),parameters:useParametersStore(),run:useRunStore()};setupStoreWatcher();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}